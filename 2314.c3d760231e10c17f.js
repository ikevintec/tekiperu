"use strict";(self.webpackChunkmirage=self.webpackChunkmirage||[]).push([[2314],{32314:(se,v,n)=>{n.r(v),n.d(v,{FormasPagoModule:()=>ie});var p=n(69808),s=n(74202),T=n(82817),m=n(93075),e=n(5e3),Z=n(33343),g=n(59783),b=n(24394),c=n(45330),x=n(33379),C=n(20207),F=n(74297),P=n(14036),q=n(43724),y=n(31424),N=n(42841),I=n(17102),U=n(88205),_=n(40845);function M(t,i){1&t&&e._UZ(0,"p-message",15)}function S(t,i){1&t&&e._UZ(0,"p-message",19)}function E(t,i){if(1&t&&(e.TgZ(0,"div",4),e.TgZ(1,"label",16),e._uU(2,"Nombre (*)"),e.qZA(),e._UZ(3,"input",17),e.YNc(4,S,1,0,"p-message",18),e.qZA()),2&t){const o=e.oxw();e.xp6(4),e.Q6J("ngIf",o.modelForm.get("nombre").touched&&(null==o.modelForm.get("nombre").errors?null:o.modelForm.get("nombre").errors.required))}}function Y(t,i){1&t&&e._UZ(0,"p-message",23)}const u=function(){return{width:"100%"}};function J(t,i){if(1&t){const o=e.EpF();e.TgZ(0,"div",4),e.TgZ(1,"label",20),e._uU(2,"Tipo tarjeta (*)"),e.qZA(),e.TgZ(3,"p-dropdown",21),e.NdJ("onChange",function(){return e.CHM(o),e.oxw().changeTipoTarjeta()}),e.qZA(),e.YNc(4,Y,1,0,"p-message",22),e.qZA()}if(2&t){const o=e.oxw();e.xp6(3),e.Akn(e.DdM(5,u)),e.Q6J("showClear",!0)("options",o.listas.tiposTarjeta),e.xp6(1),e.Q6J("ngIf",o.modelForm.get("tipoTarjeta").touched&&(null==o.modelForm.get("tipoTarjeta").errors?null:o.modelForm.get("tipoTarjeta").errors.required))}}function j(t,i){1&t&&e._UZ(0,"p-message",24)}function Q(t,i){1&t&&(e.TgZ(0,"div",4),e.TgZ(1,"label",9),e._uU(2,"Requiere validaci\xf3n"),e.qZA(),e.TgZ(3,"div"),e._UZ(4,"p-toggleButton",25),e.qZA(),e.qZA()),2&t&&(e.xp6(4),e.Akn(e.DdM(2,u)))}function O(t,i){1&t&&(e.TgZ(0,"label",33),e._uU(1,"Subir imagen"),e.qZA())}function V(t,i){1&t&&(e.TgZ(0,"label",33),e._uU(1,"Editar imagen"),e.qZA())}function R(t,i){if(1&t&&(e.TgZ(0,"li"),e._uU(1),e.qZA()),2&t){const o=i.$implicit;e.xp6(1),e.AsE("",o.name," - ",o.size," bytes ")}}function B(t,i){if(1&t&&(e.TgZ(0,"ul"),e.YNc(1,R,2,2,"li",35),e.qZA()),2&t){const o=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",o.uploadedFiles)}}function z(t,i){if(1&t&&e.YNc(0,B,2,1,"ul",34),2&t){const o=e.oxw(2);e.Q6J("ngIf",o.uploadedFiles.length)}}function H(t,i){if(1&t&&e._UZ(0,"img",36),2&t){const o=e.oxw(2);e.Q6J("src",o.imagenUrl.value,e.LSH)}}function L(t,i){if(1&t){const o=e.EpF();e.TgZ(0,"div",4),e.YNc(1,O,2,0,"label",26),e.YNc(2,V,2,0,"label",26),e.TgZ(3,"div",0),e.TgZ(4,"div",1),e.TgZ(5,"p-fileUpload",27),e.NdJ("uploadHandler",function(r){return e.CHM(o),e.oxw().onFileUpload(r)}),e.YNc(6,z,1,1,"ng-template",28),e.qZA(),e.TgZ(7,"div",29),e.TgZ(8,"label",30),e._uU(9,"URL imagen"),e.qZA(),e._UZ(10,"input",31),e.qZA(),e.qZA(),e.TgZ(11,"div",1),e.YNc(12,H,1,1,"img",32),e.qZA(),e.qZA(),e.qZA()}if(2&t){const o=e.oxw();e.xp6(1),e.Q6J("ngIf",!o.isEdit),e.xp6(1),e.Q6J("ngIf",o.isEdit),e.xp6(3),e.Q6J("customUpload",!0)("multiple",!1),e.xp6(7),e.Q6J("ngIf",o.imagenUrl.value)}}let A=(()=>{class t{constructor(o,a,r,l,d,f,h,ne,re,me,le){this.route=o,this.router=a,this.paymentMethodService=r,this.messageService=l,this.confirmationService=d,this.fb=f,this.listas=h,this.ref=ne,this.config=re,this.userService=me,this.loginService=le,this.uploadedFiles=[],this.tiposMovimiento=[]}ngOnInit(){this.builderForm(),this.loadModel(),this.tiposMovimiento=[{label:"Ingreso",value:"INGRESO"},{label:"Egreso",value:"EGRESO"}]}builderForm(){this.modelForm=this.fb.group({id:[void 0,[]],formaPago:["EFECTIVO",[m.kI.required]],tipoTarjeta:[void 0,[]],nombre:["Efectivo",[m.kI.required]],imagenUrl:[void 0,[]],online:[!1,[m.kI.required]],requiereValidacion:[!1,[]],tipoMovimiento:["INGRESO",[]]})}submitForm(){if((0,T.c2)(this.modelForm),this.modelForm.valid){let o,a;this.isEdit?(o=this.paymentMethodService.edit(this.model.id,this.model),a="Forma de pago actualizado correctamente."):(o=this.paymentMethodService.save(this.model),a="Forma de pago registrado correctamente."),o.subscribe(r=>{this.messageService.add({severity:"success",summary:"Mensaje",detail:a}),this.ref.close(r)})}}modelToForm(o){this.modelForm.patchValue(o)}get textButtonAction(){return this.isEdit?"Actualizar":"Guardar"}get model(){return this.modelForm.getRawValue()}get isEdit(){return this.config.data.isEdit}get id(){return this.config.data.id}loadModel(){this.isEdit&&setTimeout(()=>this.paymentMethodService.findById(this.id).subscribe(o=>{o&&this.modelToForm(o)}))}changeFormaPago(){this.modelForm.patchValue({nombre:this.listas.formasPagoMantenimiento.find(o=>o.value===this.modelForm.get("formaPago").value).label}),"TARJETA"===this.modelForm.get("formaPago").value?(this.modelForm.get("tipoTarjeta").setValidators([m.kI.required]),this.modelForm.get("tipoTarjeta").updateValueAndValidity()):(this.modelForm.get("tipoTarjeta").setValue(void 0),this.modelForm.get("tipoTarjeta").clearValidators(),this.modelForm.get("tipoTarjeta").updateValueAndValidity()),"TRANSFERENCIA"!==this.modelForm.get("formaPago").value&&this.modelForm.get("imagenUrl").setValue(void 0)}changeTipoTarjeta(){this.modelForm.patchValue({nombre:this.listas.tiposTarjeta.find(o=>o.value===this.modelForm.get("tipoTarjeta").value).label})}changeOnline(){this.modelForm.get("online").value||this.modelForm.patchValue({requiereValidacion:!1})}onFileUpload(o){const a=new FormData,r=o.files[0];a.append("file",r,r.name),this.userService.uploadImage(this.loginService.getUser().empresa.id,a).subscribe(l=>{this.modelForm.patchValue({imagenUrl:l.url}),this.messageService.add({severity:"success",summary:"Archivo subido",detail:""})})}get imagenUrl(){return this.modelForm.get("imagenUrl")}}return t.\u0275fac=function(o){return new(o||t)(e.Y36(s.gz),e.Y36(s.F0),e.Y36(Z.X),e.Y36(g.ez),e.Y36(g.YP),e.Y36(m.qu),e.Y36(b.E),e.Y36(c.E7),e.Y36(c.S),e.Y36(x.i),e.Y36(C.r))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-forma-pago"]],decls:27,vars:16,consts:[[1,"grid"],[1,"col-12"],["novalidate","",3,"formGroup","ngSubmit"],[1,"grid","form-group"],[1,"col-12","md:col-6"],["for","formaPago",1,"label-form"],["appendTo","body","placeholder","Seleccione forma de pago","id","formaPago","formControlName","formaPago",3,"options","onChange"],["severity","error","text","Ingrese forma de pago",4,"ngIf"],["class","col-12 md:col-6",4,"ngIf"],["for","online",1,"label-form"],["id","online","onLabel","Si","offLabel","No","formControlName","online",3,"onChange"],["severity","error","text","Ingrese online",4,"ngIf"],["formControlName","tipoMovimiento",3,"options"],[1,"col-12",2,"text-align","center"],["pButton","","type","submit",2,"margin-right","0.4rem",3,"label"],["severity","error","text","Ingrese forma de pago"],["for","nombre",1,"label-form"],["formControlName","nombre","id","nombre","type","text","pInputText","",2,"width","100%","margin-bottom","0.2em"],["severity","error","text","Ingrese nombre",4,"ngIf"],["severity","error","text","Ingrese nombre"],["for","tipoTarjeta",1,"label-form"],["placeholder","Seleccione tipo de tarjeta","id","tipoTarjeta","formControlName","tipoTarjeta",3,"showClear","options","onChange"],["severity","error","text","Ingrese tipo de tarjeta",4,"ngIf"],["severity","error","text","Ingrese tipo de tarjeta"],["severity","error","text","Ingrese online"],["id","requiereValidacion","onLabel","Si","offLabel","No","formControlName","requiereValidacion"],["class","first label-form",4,"ngIf"],["accept","image/*","chooseLabel","Selecciona una imagen","uploadLabel","Subir imagen","cancelLabel","Cancelar","name","file","maxFileSize","1000000",3,"customUpload","multiple","uploadHandler"],["pTemplate","content"],[2,"margin-top","0.5rem"],[1,"label-form"],["onClick","this.select();","formControlName","imagenUrl","id","imagenUrl","type","text","pInputText","",2,"width","100%","margin-bottom","0.2em"],["style","width: 100%;",3,"src",4,"ngIf"],[1,"first","label-form"],[4,"ngIf"],[4,"ngFor","ngForOf"],[2,"width","100%",3,"src"]],template:function(o,a){1&o&&(e.TgZ(0,"p-card"),e.TgZ(1,"div",0),e.TgZ(2,"div",1),e.TgZ(3,"form",2),e.NdJ("ngSubmit",function(){return a.submitForm()}),e.TgZ(4,"div",3),e.TgZ(5,"div",4),e.TgZ(6,"label",5),e._uU(7,"Forma de pago (*)"),e.qZA(),e.TgZ(8,"p-dropdown",6),e.NdJ("onChange",function(){return a.changeFormaPago()}),e.qZA(),e.YNc(9,M,1,0,"p-message",7),e.qZA(),e.YNc(10,E,5,1,"div",8),e.YNc(11,J,5,6,"div",8),e.TgZ(12,"div",4),e.TgZ(13,"label",9),e._uU(14,"Online (*)"),e.qZA(),e.TgZ(15,"div"),e.TgZ(16,"p-toggleButton",10),e.NdJ("onChange",function(){return a.changeOnline()}),e.qZA(),e.qZA(),e.YNc(17,j,1,0,"p-message",11),e.qZA(),e.YNc(18,Q,5,3,"div",8),e.TgZ(19,"div",4),e.TgZ(20,"label",9),e._uU(21,"Tipo movimiento"),e.qZA(),e.TgZ(22,"div"),e._UZ(23,"p-selectButton",12),e.qZA(),e.qZA(),e.YNc(24,L,13,5,"div",8),e.TgZ(25,"div",13),e._UZ(26,"button",14),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&o&&(e.xp6(3),e.Q6J("formGroup",a.modelForm),e.xp6(5),e.Akn(e.DdM(14,u)),e.Q6J("options",a.listas.formasPagoMantenimiento),e.xp6(1),e.Q6J("ngIf",a.modelForm.get("formaPago").touched&&(null==a.modelForm.get("formaPago").errors?null:a.modelForm.get("formaPago").errors.required)),e.xp6(1),e.Q6J("ngIf","TRANSFERENCIA"===a.modelForm.get("formaPago").value),e.xp6(1),e.Q6J("ngIf","TARJETA"===a.modelForm.get("formaPago").value),e.xp6(5),e.Akn(e.DdM(15,u)),e.xp6(1),e.Q6J("ngIf",a.modelForm.get("online").touched&&(null==a.modelForm.get("online").errors?null:a.modelForm.get("online").errors.required)),e.xp6(1),e.Q6J("ngIf",a.modelForm.get("online").value),e.xp6(5),e.Q6J("options",a.tiposMovimiento),e.xp6(1),e.Q6J("ngIf","TRANSFERENCIA"===a.modelForm.get("formaPago").value),e.xp6(2),e.Q6J("label",a.textButtonAction))},directives:[F.Z,m._Y,m.JL,m.sg,P.Lt,m.JJ,m.u,p.O5,q.q,m.Fj,y.o,N.CO,I.UN,U.p,g.jx,p.sg,_.Hq],styles:[""]}),t})();var w=n(2385),D=n(47745),G=n(98952),X=n(4119);function $(t,i){1&t&&(e.TgZ(0,"tr"),e.TgZ(1,"th"),e._uU(2,"Forma de pago"),e.qZA(),e.TgZ(3,"th"),e._uU(4,"Nombre"),e.qZA(),e.TgZ(5,"th"),e._uU(6,"Tipo tarjeta"),e.qZA(),e.TgZ(7,"th"),e._uU(8,"Online"),e.qZA(),e.TgZ(9,"th"),e._uU(10,"Tipo"),e.qZA(),e.TgZ(11,"th"),e._uU(12,"Acciones"),e.qZA(),e.qZA())}function W(t,i){1&t&&(e.TgZ(0,"span"),e._uU(1,"Si"),e.qZA())}function K(t,i){1&t&&e._uU(0,"No")}function k(t,i){if(1&t){const o=e.EpF();e.TgZ(0,"tr"),e.TgZ(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e.YNc(8,W,2,0,"span",6),e.YNc(9,K,1,0,"ng-template",null,7,e.W1O),e.qZA(),e.TgZ(11,"td"),e._uU(12),e.qZA(),e.TgZ(13,"td",8),e.TgZ(14,"button",9),e.NdJ("click",function(){const l=e.CHM(o).$implicit;return e.oxw().deleteCity(l)}),e.qZA(),e.TgZ(15,"button",10),e.NdJ("click",function(){const l=e.CHM(o).$implicit;return e.oxw().openModalEdit(l)}),e.qZA(),e.qZA(),e.qZA()}if(2&t){const o=i.$implicit,a=e.MAs(10);e.xp6(2),e.Oqu(o.formaPago),e.xp6(2),e.Oqu(o.nombre),e.xp6(2),e.Oqu(o.tipoTarjeta),e.xp6(2),e.Q6J("ngIf",o.online)("ngIfElse",a),e.xp6(4),e.hij(" ",o.tipoMovimiento," ")}}function ee(t,i){if(1&t){const o=e.EpF();e.TgZ(0,"div",11),e.TgZ(1,"button",12),e.NdJ("click",function(){return e.CHM(o),e.oxw().openModalNew()}),e.qZA(),e.qZA()}}const oe=[{path:"",component:(()=>{class t{constructor(o,a,r,l,d,f,h){this.route=o,this.router=a,this.paymentMethodService=r,this.messageService=l,this.consultaDocumentosService=d,this.breadcrumbService=f,this.dialogService=h}ngOnInit(){this.breadcrumbService.setItems((0,T.kn)(this.route)),this.loadPaymentsMethods()}loadPaymentsMethods(){setTimeout(()=>this.paymentMethodService.findAll().subscribe(o=>this.formasPago=o))}deleteCity(o){this.paymentMethodService.delete(o.id).subscribe(()=>this.loadPaymentsMethods())}openModalNew(){this.dialogService.open(A,{data:{isEdit:!1},header:"Nueva forma de pago",width:"80%"}).onClose.subscribe(a=>{a&&this.loadPaymentsMethods()})}openModalEdit(o){this.dialogService.open(A,{data:{isEdit:!0,id:o.id},header:"Editar forma de pago",width:"80%"}).onClose.subscribe(r=>{r&&this.loadPaymentsMethods()})}}return t.\u0275fac=function(o){return new(o||t)(e.Y36(s.gz),e.Y36(s.F0),e.Y36(Z.X),e.Y36(g.ez),e.Y36(w.W),e.Y36(D.p),e.Y36(c.xA))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-formas-pago"]],decls:7,vars:1,consts:[[1,"grid"],[1,"col-12"],[3,"value"],["pTemplate","header"],["pTemplate","body"],["pTemplate","summary"],[4,"ngIf","ngIfElse"],["noOnline",""],[2,"text-align","center"],["pButton","","type","button","icon","pi pi-trash","pTooltip","Eliminar",1,"p-button-danger","ml-1","mr-1",3,"click"],["pButton","","type","button","icon","pi pi-pencil","pTooltip","Editar",1,"ml-1","mr-1",3,"click"],[2,"text-align","left"],["type","button","pButton","","icon","fa fa-plus","label","Nuevo",2,"margin-right","0.2rem",3,"click"]],template:function(o,a){1&o&&(e.TgZ(0,"p-card"),e.TgZ(1,"div",0),e.TgZ(2,"div",1),e.TgZ(3,"p-table",2),e.YNc(4,$,13,0,"ng-template",3),e.YNc(5,k,16,6,"ng-template",4),e.YNc(6,ee,2,0,"ng-template",5),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&o&&(e.xp6(3),e.Q6J("value",a.formasPago))},directives:[F.Z,G.iA,g.jx,p.O5,_.Hq,X.u],styles:[""]}),t})(),data:{breadcrumb:[{label:"Administraci\xf3n"},{label:"M\xe9todos de pago"}]}}];let te=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[[s.Bz.forChild(oe)],s.Bz]}),t})();var ae=n(20958);let ie=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({providers:[c.xA],imports:[[p.ez,te,ae.m]]}),t})()}}]);