"use strict";(self.webpackChunkmirage=self.webpackChunkmirage||[]).push([[4354],{47903:(Q,x,r)=>{r.d(x,{U:()=>C});var u=r(70655),q=r(24850),f=r(82817),p=r(85932),g=r(81575),M=r(30567),y=r(92340),e=r(5e3),b=r(74202),d=r(69808),l=r(59783),A=r(2314),Z=r(87488),N=r(20207),j=r(33379),F=r(24394),k=r(21602),Y=r(47745),R=r(74297),c=r(93075),S=r(80422),H=r(75652),O=r(14036),J=r(31424),D=r(98952),L=r(5766),w=r(4119),U=r(40845),I=r(15315),V=r(8929),T=r(7625),P=r(43724),E=r(29067),B=r(20657),G=r(68297);function K(n,o){1&n&&e._UZ(0,"p-message",18)}function X(n,o){1&n&&e._UZ(0,"p-message",19)}function W(n,o){1&n&&e._UZ(0,"p-message",20)}function ee(n,o){1&n&&e._UZ(0,"p-message",21)}function te(n,o){1&n&&e._UZ(0,"p-message",22)}class m{constructor(o,t,i,a){this.fb=o,this.messageService=t,this.confirmationService=i,this.accountsReceivableService=a,this.unsubscribe$=new V.xQ,this.amortizacion=new e.vpe,this.configCompany={}}ngOnInit(){this.puntoVenta$.pipe((0,T.R)(this.unsubscribe$)).subscribe(o=>{this.puntoVenta=o}),this.estacionVenta$.pipe((0,T.R)(this.unsubscribe$)).subscribe(o=>{this.estacionVenta=o}),this.configCompany$.pipe((0,T.R)(this.unsubscribe$)).subscribe(o=>{this.configCompany=o,this.builderForm()})}builderForm(){this.modelForm=this.fb.group({tipoMovimientoCaja:[void 0,[]],conceptoMovimientoCaja:[void 0,[]],monedaMovimientoCaja:[void 0,[c.kI.required]],pagos:[[],[c.kI.required]],monto:[void 0,[c.kI.required,c.kI.min(.01)]],descripcion:[void 0,[c.kI.required]],detalle:[void 0,[]]}),this.initForm()}initForm(){this.modelForm.get("monto").setValidators([c.kI.required,c.kI.min(.01),c.kI.max(Number(this.accountsReceivable.montoRestante.toFixed(2)))]);const o=this.configCompany.formasPago.find(i=>"EFECTIVO"===i.formaPago),t=[];o&&t.push({monto:0,nombre:"Efectivo",formaPago:E.XB.EFECTIVO,metodoPago:o}),this.modelForm.patchValue({tipoMovimientoCaja:E.Bb.INGRESO,conceptoMovimientoCaja:E._S.OTROS_INGRESOS,pagos:t,monto:0,monedaMovimientoCaja:this.accountsReceivable.ticket.codigoMoneda})}changeAmount(){console.log(this.modelForm.get("monto").value);const o=(0,f.He)(this.modelForm.get("monto").value.toFixed(2));this.modelForm.get("pagos").clearValidators();const t=this.configCompany.formasPago.find(a=>"EFECTIVO"===a.formaPago),i=[];t&&i.push({monto:Number(o),nombre:t.nombre,formaPago:t.formaPago,metodoPago:t}),this.modelForm.patchValue({pagos:i}),this.modelForm.get("pagos").setValidators([(0,f.Kv)(o)]),this.modelForm.get("pagos").updateValueAndValidity()}registrar(){if((0,f.c2)(this.modelForm),this.modelForm.valid){const o={cashRegisterDetail:this.modelForm.getRawValue(),accountsReceivable:{id:this.accountsReceivable.id}};this.confirmationService.confirm({message:"Estas seguro de registrar el pago?",accept:()=>{this.accountsReceivableService.saveDetail(o,[`idPuntoVenta=${this.puntoVenta.id}`,`idEstacionVenta=${this.estacionVenta.id}`].join("&")).subscribe(()=>{this.messageService.add({severity:"success",summary:"Mensaje",detail:"Pago registrado correctamente"}),this.amortizacion.emit(!0)})},acceptLabel:"Si",rejectLabel:"No"})}}}m.\u0275fac=function(o){return new(o||m)(e.Y36(c.qu),e.Y36(l.ez),e.Y36(l.YP),e.Y36(Z.b))},m.\u0275cmp=e.Xpm({type:m,selectors:[["app-amortizar-dialog"]],inputs:{accountsReceivable:"accountsReceivable"},outputs:{amortizacion:"amortizacion"},decls:26,vars:8,consts:[["novalidate","",3,"formGroup"],[1,"grid"],[1,"col-12","md:col-6"],["for","monto",1,"label-form"],["formControlName","monto","pKeyFilter","num","id","monto","type","text","pInputText","",2,"width","100%","margin-bottom","0.2em",3,"input"],["severity","error","text","Ingrese monto",4,"ngIf"],["severity","error","text","Ingrese monto m\xednimo",4,"ngIf"],["severity","error","text","Ingrese un monto menor al saldo restante",4,"ngIf"],["for","descripcion",1,"label-form"],["formControlName","descripcion","id","descripcion","type","text","pInputText","",2,"width","100%","margin-bottom","0.2em"],["severity","error","text","Ingrese descripci\xf3n",4,"ngIf"],["for","detalle",1,"label-form"],["formControlName","detalle","id","detalle","type","text","pInputText","",2,"width","100%","margin-bottom","0.2em"],[1,"col-12"],["formControlName","pagos","tipo","INGRESO",3,"total","moneda"],["severity","error","text","Pago incorrecto",4,"ngIf"],[1,"col-12",2,"text-align","center"],["pButton","","type","button","label","Registrar",1,"ml-1","mr-1",3,"click"],["severity","error","text","Ingrese monto"],["severity","error","text","Ingrese monto m\xednimo"],["severity","error","text","Ingrese un monto menor al saldo restante"],["severity","error","text","Ingrese descripci\xf3n"],["severity","error","text","Pago incorrecto"]],template:function(o,t){1&o&&(e.TgZ(0,"form",0),e.TgZ(1,"div",1),e.TgZ(2,"div",2),e.TgZ(3,"label",3),e._uU(4,"Monto (*)"),e.qZA(),e.TgZ(5,"input",4),e.NdJ("input",function(){return t.changeAmount()}),e.qZA(),e.YNc(6,K,1,0,"p-message",5),e.YNc(7,X,1,0,"p-message",6),e.YNc(8,W,1,0,"p-message",7),e.qZA(),e.TgZ(9,"div",2),e.TgZ(10,"label",8),e._uU(11,"Descripci\xf3n (*)"),e.qZA(),e._UZ(12,"input",9),e.YNc(13,ee,1,0,"p-message",10),e.qZA(),e.TgZ(14,"div",2),e.TgZ(15,"label",11),e._uU(16,"Detalle"),e.qZA(),e._UZ(17,"input",12),e.qZA(),e.TgZ(18,"div",13),e.TgZ(19,"label",11),e._uU(20,"Forma de pago (*)"),e.qZA(),e.TgZ(21,"p-card"),e._UZ(22,"app-forma-pago-venta",14),e.qZA(),e.YNc(23,te,1,0,"p-message",15),e.qZA(),e.TgZ(24,"div",16),e.TgZ(25,"button",17),e.NdJ("click",function(){return t.registrar()}),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&o&&(e.Q6J("formGroup",t.modelForm),e.xp6(6),e.Q6J("ngIf",t.modelForm.get("monto").touched&&(null==t.modelForm.get("monto").errors?null:t.modelForm.get("monto").errors.required)),e.xp6(1),e.Q6J("ngIf",t.modelForm.get("monto").touched&&(null==t.modelForm.get("monto").errors?null:t.modelForm.get("monto").errors.min)),e.xp6(1),e.Q6J("ngIf",t.modelForm.get("monto").touched&&(null==t.modelForm.get("monto").errors?null:t.modelForm.get("monto").errors.max)),e.xp6(5),e.Q6J("ngIf",t.modelForm.get("descripcion").touched&&(null==t.modelForm.get("descripcion").errors?null:t.modelForm.get("descripcion").errors.required)),e.xp6(9),e.Q6J("total",t.modelForm.get("monto").value)("moneda",t.modelForm.get("monedaMovimientoCaja").value),e.xp6(1),e.Q6J("ngIf",t.modelForm.get("pagos").touched&&(null==t.modelForm.get("pagos").errors?null:t.modelForm.get("pagos").errors.totalFormaPago)))},directives:[c._Y,c.JL,c.sg,c.Fj,c.JJ,c.u,B.Fr,J.o,d.O5,P.q,R.Z,G.M,U.Hq],styles:[""]}),(0,u.gn)([(0,p.Ph)(g.Z.getOffice)],m.prototype,"puntoVenta$",void 0),(0,u.gn)([(0,p.Ph)(g.Z.getSaleStation)],m.prototype,"estacionVenta$",void 0),(0,u.gn)([(0,p.Ph)(g.Z.getConfig)],m.prototype,"configCompany$",void 0);var $=r(77121);function oe(n,o){if(1&n&&(e.TgZ(0,"div",2),e.TgZ(1,"div",15),e.TgZ(2,"p",16),e.TgZ(3,"strong"),e._uU(4,"Documento:"),e.qZA(),e._uU(5),e.qZA(),e.qZA(),e.TgZ(6,"div",15),e.TgZ(7,"p",16),e.TgZ(8,"strong"),e._uU(9,"Cliente:"),e.qZA(),e._uU(10),e.qZA(),e.qZA(),e.TgZ(11,"div",15),e.TgZ(12,"p",16),e.TgZ(13,"strong"),e._uU(14,"Emisi\xf3n:"),e.qZA(),e._uU(15),e.ALo(16,"date"),e.qZA(),e.qZA(),e.TgZ(17,"div",15),e.TgZ(18,"p",16),e.TgZ(19,"strong"),e._uU(20,"Vencimiento:"),e.qZA(),e._uU(21),e.ALo(22,"date"),e.qZA(),e.qZA(),e.TgZ(23,"div",15),e.TgZ(24,"p",16),e.TgZ(25,"strong"),e._uU(26,"Estado:"),e.qZA(),e._uU(27),e.qZA(),e.qZA(),e.TgZ(28,"div",15),e.TgZ(29,"p",16),e.TgZ(30,"strong"),e._uU(31),e.qZA(),e._uU(32),e.ALo(33,"number"),e.qZA(),e.qZA(),e.TgZ(34,"div",15),e.TgZ(35,"p",16),e.TgZ(36,"strong"),e._uU(37),e.qZA(),e._uU(38),e.ALo(39,"number"),e.qZA(),e.qZA(),e.TgZ(40,"div",15),e.TgZ(41,"p",16),e.TgZ(42,"strong"),e._uU(43),e.qZA(),e._uU(44),e.ALo(45,"number"),e.qZA(),e.qZA(),e.TgZ(46,"div",15),e.TgZ(47,"p",16),e.TgZ(48,"strong"),e._uU(49,"Vendedor:"),e.qZA(),e._uU(50),e.qZA(),e.qZA(),e.qZA()),2&n){const t=e.oxw(2);e.xp6(5),e.AsE(" ",t.accountsReceivable.ticket.serie,"-",t.accountsReceivable.ticket.numero,""),e.xp6(5),e.hij(" ",t.accountsReceivable.ticket.denominacionReceptor,""),e.xp6(5),e.hij(" ",e.xi3(16,13,t.accountsReceivable.ticket.fechaEmisionDate,"dd/MM/yyyy"),""),e.xp6(6),e.hij(" ",e.xi3(22,16,t.accountsReceivable.fechaVencimiento,"dd/MM/yyyy"),""),e.xp6(6),e.hij(" ",t.accountsReceivable.estadoCredito,""),e.xp6(4),e.hij("Monto total (",t.accountsReceivable.ticket.codigoMoneda,"):"),e.xp6(1),e.hij(" ",e.xi3(33,19,t.accountsReceivable.ticket.totalVenta,"1.2-5"),""),e.xp6(5),e.hij("Monto pagado (",t.accountsReceivable.ticket.codigoMoneda,"):"),e.xp6(1),e.hij(" ",e.xi3(39,22,t.accountsReceivable.montoPagado,"1.2-5"),""),e.xp6(5),e.hij("Monto restante (",t.accountsReceivable.ticket.codigoMoneda,"):"),e.xp6(1),e.hij(" ",e.xi3(45,25,t.accountsReceivable.montoRestante,"1.2-5"),""),e.xp6(6),e.hij(" ",null==t.accountsReceivable||null==t.accountsReceivable.ticket||null==t.accountsReceivable.ticket.vendedor?null:t.accountsReceivable.ticket.vendedor.nombreCompleto,"")}}function ne(n,o){if(1&n&&(e.TgZ(0,"th"),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.hij(" ",t.header," ")}}function ie(n,o){if(1&n&&(e.TgZ(0,"tr"),e.YNc(1,ne,2,1,"th",17),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.Q6J("ngForOf",t)}}function ae(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"span",23),e._uU(2,"Descripci\xf3n"),e.qZA(),e._uU(3),e.BQk()),2&n){const t=e.oxw(3).$implicit;e.xp6(3),e.hij(" ",t.cashRegisterDetail.descripcion," ")}}function re(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"span",23),e._uU(2,"Monto"),e.qZA(),e._uU(3),e.ALo(4,"number"),e.BQk()),2&n){const t=e.oxw(3).$implicit;e.xp6(3),e.hij(" ",e.xi3(4,1,t.cashRegisterDetail.monto,"1.2-5")," ")}}function se(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"span",23),e._uU(2,"Moneda"),e.qZA(),e.TgZ(3,"span"),e._uU(4),e.qZA(),e.BQk()),2&n){const t=e.oxw(3).$implicit;e.xp6(4),e.hij("",null==t.cashRegisterDetail?null:t.cashRegisterDetail.monedaMovimientoCaja," ")}}function le(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"span",23),e._uU(2,"Fecha"),e.qZA(),e.TgZ(3,"span"),e._uU(4),e.ALo(5,"date"),e.qZA(),e.BQk()),2&n){const t=e.oxw(3).$implicit;e.xp6(4),e.hij("",e.xi3(5,1,null==t.cashRegisterDetail?null:t.cashRegisterDetail.fechaMovimiento,"dd/MM/yyyy hh:mm a")," ")}}function ce(n,o){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" (",t.numeroOperacion,")")}}function de(n,o){if(1&n&&(e.TgZ(0,"span",25),e._uU(1),e.ALo(2,"montoDinero"),e.YNc(3,ce,2,1,"span",0),e.qZA()),2&n){const t=o.$implicit,i=e.oxw(4).$implicit;e.xp6(1),e.AsE(" ",t.nombre,": ",e.xi3(2,3,t.monto,null==i.cashRegisterDetail?null:i.cashRegisterDetail.monedaMovimientoCaja)," "),e.xp6(2),e.Q6J("ngIf",t.numeroOperacion)}}function pe(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"span",23),e._uU(2,"Forma de Pago"),e.qZA(),e.YNc(3,de,4,6,"span",24),e.BQk()),2&n){const t=e.oxw(3).$implicit;e.xp6(3),e.Q6J("ngForOf",null==t.cashRegisterDetail?null:t.cashRegisterDetail.pagos)}}function ue(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"span",23),e._uU(2,"Usuario"),e.qZA(),e.TgZ(3,"span"),e._uU(4),e.qZA(),e.BQk()),2&n){const t=e.oxw(3).$implicit;e.xp6(4),e.hij("",null==t.cashRegisterDetail||null==t.cashRegisterDetail.usuario?null:t.cashRegisterDetail.usuario.nombreCompleto," ")}}function ge(n,o){if(1&n&&(e.ynx(0),e._uU(1),e.BQk()),2&n){const t=e.oxw(2).$implicit,i=e.oxw().$implicit;e.xp6(1),e.hij(" ",i[t.field]," ")}}function me(n,o){1&n&&(e.ynx(0),e.YNc(1,ae,4,1,"ng-container",21),e.YNc(2,re,5,4,"ng-container",21),e.YNc(3,se,5,1,"ng-container",21),e.YNc(4,le,6,4,"ng-container",21),e.YNc(5,pe,4,1,"ng-container",21),e.YNc(6,ue,5,1,"ng-container",21),e.YNc(7,ge,2,1,"ng-container",22),e.BQk()),2&n&&(e.xp6(1),e.Q6J("ngSwitchCase","descripcion"),e.xp6(1),e.Q6J("ngSwitchCase","monto"),e.xp6(1),e.Q6J("ngSwitchCase","monedaMovimientoCaja"),e.xp6(1),e.Q6J("ngSwitchCase","fechaMovimiento"),e.xp6(1),e.Q6J("ngSwitchCase","pagos"),e.xp6(1),e.Q6J("ngSwitchCase","usuario"))}function _e(n,o){if(1&n){const t=e.EpF();e.ynx(0,26),e.TgZ(1,"span",23),e._uU(2,"Acciones"),e.qZA(),e.TgZ(3,"i",27),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2).$implicit;return e.oxw(2).eliminarPago(a)}),e.qZA(),e.BQk()}}function Ze(n,o){if(1&n&&(e.TgZ(0,"td",19),e.YNc(1,me,8,6,"ng-container",0),e.YNc(2,_e,4,0,"ng-container",20),e.qZA()),2&n){const t=o.$implicit;e.Q6J("ngSwitch",t.field),e.xp6(1),e.Q6J("ngIf",!t.isActions),e.xp6(1),e.Q6J("ngIf",t.isActions)}}function he(n,o){if(1&n&&(e.TgZ(0,"tr"),e.YNc(1,Ze,3,3,"td",18),e.qZA()),2&n){const t=o.columns;e.xp6(1),e.Q6J("ngForOf",t)}}function fe(n,o){1&n&&e._UZ(0,"p-message",28)}const Ce=function(){return{width:"100%"}};function ve(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div"),e.TgZ(1,"div",2),e.TgZ(2,"div",3),e.TgZ(3,"p-fieldset",4),e.YNc(4,oe,51,28,"div",5),e.qZA(),e.qZA(),e.TgZ(5,"div",3),e.TgZ(6,"p-fieldset",6),e.TgZ(7,"div",2),e.TgZ(8,"div",3),e.TgZ(9,"p-table",7,8),e.YNc(11,ie,2,1,"ng-template",9),e.YNc(12,he,2,1,"ng-template",10),e.qZA(),e.TgZ(13,"div",11),e.YNc(14,fe,1,0,"p-message",12),e.qZA(),e.qZA(),e.TgZ(15,"div",3),e.TgZ(16,"div",13),e.TgZ(17,"p-button",14),e.NdJ("onClick",function(){return e.CHM(t),e.oxw().openDialogRegister()}),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&n){const t=e.oxw();e.xp6(4),e.Q6J("ngIf",t.accountsReceivable.ticket),e.xp6(5),e.Q6J("columns",t.cols)("value",t.accountsReceivableDetails)("responsive",!0)("autoLayout",!0),e.xp6(5),e.Q6J("ngIf",0===t.accountsReceivableDetails.length),e.xp6(3),e.Akn(e.DdM(9,Ce)),e.Q6J("disabled",!t.canChangeAccountReivable())}}function be(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div"),e.TgZ(1,"app-amortizar-dialog",29),e.NdJ("amortizacion",function(){return e.CHM(t),e.oxw().onAmortizacion()}),e.qZA(),e.qZA()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("accountsReceivable",t.accountsReceivable)}}const Ae=function(){return{width:"800px"}};class h{constructor(o,t,i,a,s){this.accountsReceivableService=o,this.ls=t,this.confirmationService=i,this.loginService=a,this.router=s,this.unsubscribe$=new V.xQ,this.accountsReceivableDetails=[],this.dialogRegister=!1,this.changeAccount=new e.vpe}ngOnInit(){console.log(this.accountsReceivable),this.loadData(),this.subscribeSession(),this.cols=[{field:"descripcion",header:"Descripci\xf3n"},{field:"monto",header:"Monto"},{field:"monedaMovimientoCaja",header:"Moneda"},{field:"fechaMovimiento",header:"Fecha"},{field:"pagos",header:"Forma de pago"},{field:"usuario",header:"Usuario"},{field:"acciones",header:"Acciones",isActions:!0}]}ngOnDestroy(){this.unsubscribe$.next(),this.unsubscribe$.complete()}onAmortizacion(){this.dialogRegister=!1,this.loadData()}loadData(){(0,M.D)([this.accountsReceivableService.findById(this.accountsReceivable.id),this.accountsReceivableService.findAllDetailByAccountReceivableId(this.accountsReceivable.id)]).subscribe(o=>{this.accountsReceivable=o[0],this.accountsReceivableDetails=o[1],this.changeAccount.emit()})}volver(){this.router.navigateByUrl("/cuentas-por-cobrar")}eliminarPago(o){this.confirmationService.confirm({message:`\xbfEst\xe1 seguro de eliminar el pago por la cantidad de (${o.cashRegisterDetail.monedaMovimientoCaja}) ${o.cashRegisterDetail.monto}?`,accept:()=>{this.accountsReceivableService.deleteDetail(o.id).subscribe(()=>{this.loadData()})},acceptLabel:"Si",rejectLabel:"No"})}subscribeSession(){this.puntoVenta$.pipe((0,T.R)(this.unsubscribe$)).subscribe(o=>{this.puntoVenta=o}),this.estacionVenta$.pipe((0,T.R)(this.unsubscribe$)).subscribe(o=>{this.estacionVenta=o})}canChangeAccountReivable(){return"PENDIENTE"===this.accountsReceivable.estadoCredito||"VENCIDO"===this.accountsReceivable.estadoCredito}openDialogRegister(){this.dialogRegister=!0}}h.\u0275fac=function(o){return new(o||h)(e.Y36(Z.b),e.Y36(F.E),e.Y36(l.YP),e.Y36(N.r),e.Y36(b.F0))},h.\u0275cmp=e.Xpm({type:h,selectors:[["app-amortizar"]],inputs:{accountsReceivable:"accountsReceivable"},outputs:{changeAccount:"changeAccount"},decls:4,vars:8,consts:[[4,"ngIf"],["header","Amortizar cuenta","appendTo","body",3,"visible","modal","responsive","visibleChange"],[1,"grid"],[1,"col-12"],["legend","Detalle de cuenta"],["class","grid",4,"ngIf"],["legend","Pagos"],["dataKey","id",3,"columns","value","responsive","autoLayout"],["dt",""],["pTemplate","header"],["pTemplate","body"],[2,"margin-top","1rem"],["severity","info","text","No existen pagos registrados.",4,"ngIf"],[1,"center"],["icon","fa fa-handshake-o","label","Registrar pago",3,"disabled","onClick"],[1,"col-6"],[1,"m-0"],[4,"ngFor","ngForOf"],[3,"ngSwitch",4,"ngFor","ngForOf"],[3,"ngSwitch"],["style","text-align: center",4,"ngIf"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"p-column-title"],["class","p-tag p-tag-rounded m-1",4,"ngFor","ngForOf"],[1,"p-tag","p-tag-rounded","m-1"],[2,"text-align","center"],["pTooltip","Eliminar",1,"fa","fa-ban",2,"margin-right","0.2em","margin-left","0.2em","cursor","pointer",3,"click"],["severity","info","text","No existen pagos registrados."],[3,"accountsReceivable","amortizacion"]],template:function(o,t){1&o&&(e.TgZ(0,"p-card"),e.YNc(1,ve,18,10,"div",0),e.qZA(),e.TgZ(2,"p-dialog",1),e.NdJ("visibleChange",function(a){return t.dialogRegister=a}),e.YNc(3,be,2,1,"div",0),e.qZA()),2&o&&(e.xp6(1),e.Q6J("ngIf",t.accountsReceivable),e.xp6(1),e.Akn(e.DdM(7,Ae)),e.Q6J("visible",t.dialogRegister)("modal",!0)("responsive",!0),e.xp6(1),e.Q6J("ngIf",t.dialogRegister&&t.accountsReceivable))},directives:[R.Z,d.O5,S.p,D.iA,l.jx,d.sg,d.RF,d.n9,d.ED,w.u,P.q,U.zx,I.V,m],pipes:[d.uU,d.JJ,$.Z],styles:[""]}),(0,u.gn)([(0,p.Ph)(g.Z.getOffice)],h.prototype,"puntoVenta$",void 0),(0,u.gn)([(0,p.Ph)(g.Z.getSaleStation)],h.prototype,"estacionVenta$",void 0);const Te=["dt"],_=function(){return{width:"100%"}};function xe(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",15),e.TgZ(1,"form",20),e.NdJ("submit",function(){return e.CHM(t),e.oxw().resetAndRefreshTable()}),e.TgZ(2,"div",21),e.TgZ(3,"div",22),e.TgZ(4,"p-fieldset",23),e.TgZ(5,"div",0),e.TgZ(6,"div",24),e.TgZ(7,"label",25),e._uU(8,"Desde"),e.qZA(),e.TgZ(9,"p-calendar",26),e.NdJ("onSelect",function(){return e.CHM(t),e.oxw().resetAndRefreshTable()})("ngModelChange",function(a){return e.CHM(t),e.oxw().filtroEmisionDesde=a}),e.qZA(),e.qZA(),e.TgZ(10,"div",24),e.TgZ(11,"label",25),e._uU(12,"Hasta"),e.qZA(),e.TgZ(13,"p-calendar",27),e.NdJ("onSelect",function(){return e.CHM(t),e.oxw().resetAndRefreshTable()})("ngModelChange",function(a){return e.CHM(t),e.oxw().filtroEmisionHasta=a}),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(14,"div",22),e.TgZ(15,"p-fieldset",28),e.TgZ(16,"div",0),e.TgZ(17,"div",24),e.TgZ(18,"label",25),e._uU(19,"Desde"),e.qZA(),e.TgZ(20,"p-calendar",29),e.NdJ("onSelect",function(){return e.CHM(t),e.oxw().resetAndRefreshTable()})("ngModelChange",function(a){return e.CHM(t),e.oxw().filtroVencimientoDesde=a}),e.qZA(),e.qZA(),e.TgZ(21,"div",24),e.TgZ(22,"label",25),e._uU(23,"Hasta"),e.qZA(),e.TgZ(24,"p-calendar",30),e.NdJ("onSelect",function(){return e.CHM(t),e.oxw().resetAndRefreshTable()})("ngModelChange",function(a){return e.CHM(t),e.oxw().filtroVencimientoHasta=a}),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(25,"div",31),e.TgZ(26,"label",25),e._uU(27,"Tipo comprobante"),e.qZA(),e.TgZ(28,"p-dropdown",32),e.NdJ("onChange",function(){return e.CHM(t),e.oxw().resetAndRefreshTable()})("ngModelChange",function(a){return e.CHM(t),e.oxw().filtroTipoComprobante=a}),e.qZA(),e.qZA(),e.TgZ(29,"div",33),e.TgZ(30,"label",25),e._uU(31,"Serie"),e.qZA(),e.TgZ(32,"input",34),e.NdJ("input",function(){return e.CHM(t),e.oxw().resetAndRefreshTable()})("ngModelChange",function(a){return e.CHM(t),e.oxw().filtroSerie=a}),e.qZA(),e.qZA(),e.TgZ(33,"div",33),e.TgZ(34,"label",25),e._uU(35,"N\xfamero"),e.qZA(),e.TgZ(36,"input",35),e.NdJ("input",function(){return e.CHM(t),e.oxw().resetAndRefreshTable()})("ngModelChange",function(a){return e.CHM(t),e.oxw().filtroNumero=a}),e.qZA(),e.qZA(),e.TgZ(37,"div",31),e.TgZ(38,"label",25),e._uU(39,"Cliente (Doc. o nombre)"),e.qZA(),e.TgZ(40,"input",36),e.NdJ("input",function(){return e.CHM(t),e.oxw().resetAndRefreshTable()})("ngModelChange",function(a){return e.CHM(t),e.oxw().filtroCliente=a}),e.qZA(),e.qZA(),e.TgZ(41,"div",33),e.TgZ(42,"label",25),e._uU(43,"D\xedas de cr\xe9dito"),e.qZA(),e.TgZ(44,"input",37),e.NdJ("input",function(){return e.CHM(t),e.oxw().resetAndRefreshTable()})("ngModelChange",function(a){return e.CHM(t),e.oxw().filtroDiasCredito=a}),e.qZA(),e.qZA(),e.TgZ(45,"div",38),e.TgZ(46,"label",25),e._uU(47,"Estado cr\xe9dito"),e.qZA(),e.TgZ(48,"p-dropdown",39),e.NdJ("onChange",function(){return e.CHM(t),e.oxw().resetAndRefreshTable()})("ngModelChange",function(a){return e.CHM(t),e.oxw().filtroEstadoCredito=a}),e.qZA(),e.qZA(),e.TgZ(49,"div",31),e.TgZ(50,"label",25),e._uU(51,"Punto de venta"),e.qZA(),e.TgZ(52,"p-dropdown",40),e.NdJ("onChange",function(){return e.CHM(t),e.oxw().resetAndRefreshTable()})("ngModelChange",function(a){return e.CHM(t),e.oxw().filtroPuntoVenta=a}),e.qZA(),e.qZA(),e.TgZ(53,"div",31),e.TgZ(54,"label",25),e._uU(55,"Vendedor"),e.qZA(),e.TgZ(56,"p-dropdown",41),e.NdJ("onChange",function(){return e.CHM(t),e.oxw().resetAndRefreshTable()})("ngModelChange",function(a){return e.CHM(t),e.oxw().filtroVendedor=a}),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&n){const t=e.oxw();e.xp6(9),e.Akn(e.DdM(39,_)),e.Q6J("ngModel",t.filtroEmisionDesde)("locale",t.ls.calendarEs),e.xp6(4),e.Akn(e.DdM(40,_)),e.Q6J("ngModel",t.filtroEmisionHasta)("locale",t.ls.calendarEs),e.xp6(7),e.Akn(e.DdM(41,_)),e.Q6J("ngModel",t.filtroVencimientoDesde)("locale",t.ls.calendarEs),e.xp6(4),e.Akn(e.DdM(42,_)),e.Q6J("ngModel",t.filtroVencimientoHasta)("locale",t.ls.calendarEs),e.xp6(4),e.Akn(e.DdM(43,_)),e.Q6J("ngModel",t.filtroTipoComprobante)("options",t.tiposComprobantes)("showClear",!0),e.xp6(4),e.Q6J("ngModel",t.filtroSerie),e.xp6(4),e.Q6J("ngModel",t.filtroNumero),e.xp6(4),e.Q6J("ngModel",t.filtroCliente),e.xp6(4),e.Q6J("ngModel",t.filtroDiasCredito),e.xp6(4),e.Akn(e.DdM(44,_)),e.Q6J("ngModel",t.filtroEstadoCredito)("options",t.estadosCredito)("showClear",!0),e.xp6(4),e.Akn(e.DdM(45,_)),e.Q6J("ngModel",t.filtroPuntoVenta)("options",t.puntosVenta),e.xp6(4),e.Akn(e.DdM(46,_)),e.Q6J("showClear",!0)("ngModel",t.filtroVendedor)("options",t.vendedores)}}function qe(n,o){if(1&n&&(e.TgZ(0,"div",15),e.TgZ(1,"p-card"),e.TgZ(2,"div",42),e.TgZ(3,"div",43),e.TgZ(4,"h2",44),e._uU(5),e.ALo(6,"montoDinero"),e.qZA(),e.qZA(),e.TgZ(7,"div",45),e.TgZ(8,"div",46),e.TgZ(9,"div",47),e.TgZ(10,"h4",48),e._uU(11),e.ALo(12,"montoDinero"),e.qZA(),e.qZA(),e.TgZ(13,"div",47),e.TgZ(14,"h4",48),e._uU(15),e.ALo(16,"montoDinero"),e.qZA(),e.qZA(),e.TgZ(17,"div",47),e.TgZ(18,"h4",48),e._uU(19),e.ALo(20,"montoDinero"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&n){const t=o.$implicit;e.xp6(5),e.hij("Total por cobrar: ",e.xi3(6,4,t.totalPorPagar,t.codigoMoneda),""),e.xp6(6),e.hij("Total credito: ",e.xi3(12,7,t.totalCredito,t.codigoMoneda),""),e.xp6(4),e.hij("Total pagado: ",e.xi3(16,10,t.totalPagado,t.codigoMoneda),""),e.xp6(4),e.hij("Total por cobrar: ",e.xi3(20,13,t.totalPorPagar,t.codigoMoneda),"")}}function Me(n,o){1&n&&(e.TgZ(0,"tr"),e.TgZ(1,"th"),e._uU(2,"Documento"),e.qZA(),e.TgZ(3,"th"),e._uU(4,"Emisi\xf3n"),e.qZA(),e.TgZ(5,"th",49),e._uU(6,"Vencimiento "),e._UZ(7,"p-sortIcon",50),e.qZA(),e.TgZ(8,"th"),e._uU(9,"Cliente"),e.qZA(),e.TgZ(10,"th"),e._uU(11,"Estado"),e.qZA(),e.TgZ(12,"th"),e._uU(13,"Monto Total"),e.qZA(),e.TgZ(14,"th"),e._uU(15,"Monto pagado"),e.qZA(),e.TgZ(16,"th"),e._uU(17,"Saldo"),e.qZA(),e.TgZ(18,"th"),e._uU(19,"Vendedor"),e.qZA(),e.TgZ(20,"th"),e._uU(21,"Punto de venta"),e.qZA(),e.TgZ(22,"th"),e._uU(23,"D\xedas Cr\xe9dito"),e.qZA(),e.TgZ(24,"th"),e._uU(25,"Extendido"),e.qZA(),e.TgZ(26,"th"),e._uU(27,"D\xedas Ext."),e.qZA(),e.TgZ(28,"th"),e._uU(29,"Acciones"),e.qZA(),e.qZA())}function De(n,o){if(1&n&&(e.TgZ(0,"div",51),e._UZ(1,"app-actions",52),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("items",t.actionsExportData)}}function ye(n,o){1&n&&(e.TgZ(0,"span"),e._uU(1,"Si"),e.qZA())}function Re(n,o){1&n&&(e.TgZ(0,"span"),e._uU(1,"No"),e.qZA())}function Ue(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",59),e.NdJ("click",function(){e.CHM(t);const a=e.oxw().$implicit;return e.oxw().goAmortizar(a)}),e.qZA()}}function Pe(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",60),e.NdJ("click",function(){e.CHM(t);const a=e.oxw().$implicit;return e.oxw().confirmCancelar(a)}),e.qZA()}}function Ee(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",61),e.NdJ("click",function(){e.CHM(t);const a=e.oxw().$implicit;return e.oxw().openDialogExtend(a)}),e.qZA()}}const Ne=function(n,o,t,i){return{"p-tag-success":n,"p-tag-danger":o,"p-tag-warning":t,"p-tag-info":i}};function Fe(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"tr"),e.TgZ(1,"td"),e.TgZ(2,"span",53),e._uU(3,"Documento"),e.qZA(),e._uU(4),e.qZA(),e.TgZ(5,"td"),e.TgZ(6,"span",53),e._uU(7,"Emisi\xf3n"),e.qZA(),e.TgZ(8,"span"),e._uU(9),e.ALo(10,"date"),e.qZA(),e.qZA(),e.TgZ(11,"td"),e.TgZ(12,"span",53),e._uU(13,"Vencimiento"),e.qZA(),e.TgZ(14,"span"),e._uU(15),e.ALo(16,"date"),e.qZA(),e.qZA(),e.TgZ(17,"td"),e.TgZ(18,"span",53),e._uU(19,"Cliente"),e.qZA(),e.TgZ(20,"span"),e._uU(21),e.qZA(),e.qZA(),e.TgZ(22,"td"),e.TgZ(23,"span",53),e._uU(24,"Estado Credito"),e.qZA(),e.TgZ(25,"span",54),e._uU(26),e.qZA(),e.qZA(),e.TgZ(27,"td"),e.TgZ(28,"span",53),e._uU(29,"Monto total"),e.qZA(),e.TgZ(30,"span"),e._uU(31),e.ALo(32,"montoDinero"),e.qZA(),e.qZA(),e.TgZ(33,"td"),e.TgZ(34,"span",53),e._uU(35,"Monto Pagado"),e.qZA(),e.TgZ(36,"span"),e._uU(37),e.ALo(38,"montoDinero"),e.qZA(),e.qZA(),e.TgZ(39,"td"),e.TgZ(40,"span",53),e._uU(41,"Saldo"),e.qZA(),e.TgZ(42,"span"),e._uU(43),e.ALo(44,"montoDinero"),e.qZA(),e.qZA(),e.TgZ(45,"td"),e.TgZ(46,"span",53),e._uU(47,"Vendedor"),e.qZA(),e._uU(48),e.qZA(),e.TgZ(49,"td"),e.TgZ(50,"span",53),e._uU(51,"Punto de Venta"),e.qZA(),e._uU(52),e.qZA(),e.TgZ(53,"td"),e.TgZ(54,"span",53),e._uU(55,"Dias Credito"),e.qZA(),e.TgZ(56,"span"),e._uU(57),e.qZA(),e.qZA(),e.TgZ(58,"td"),e.TgZ(59,"span",53),e._uU(60,"Extendido"),e.qZA(),e.YNc(61,ye,2,0,"span",10),e.YNc(62,Re,2,0,"span",10),e.qZA(),e.TgZ(63,"td"),e.TgZ(64,"span",53),e._uU(65,"Dias Extendidos"),e.qZA(),e.TgZ(66,"span"),e._uU(67),e.qZA(),e.qZA(),e.TgZ(68,"td"),e.TgZ(69,"span",53),e._uU(70,"Acciones"),e.qZA(),e.YNc(71,Ue,1,0,"button",55),e.YNc(72,Pe,1,0,"button",56),e.YNc(73,Ee,1,0,"button",57),e.TgZ(74,"button",58),e.NdJ("click",function(){const s=e.CHM(t).$implicit;return e.oxw().openDialogViewPays(s)}),e.qZA(),e.qZA(),e.qZA()}if(2&n){const t=o.$implicit,i=e.oxw();e.xp6(4),e.AsE(" ",null==t.ticket?null:t.ticket.serie,"-",null==t.ticket?null:t.ticket.numero," "),e.xp6(5),e.hij("",e.xi3(10,19,null==t.ticket?null:t.ticket.fechaEmisionDate,"dd/MM/yyyy")," "),e.xp6(6),e.hij("",e.xi3(16,22,t.fechaVencimiento,"dd/MM/yyyy")," "),e.xp6(6),e.hij("",null==t.ticket?null:t.ticket.denominacionReceptor," "),e.xp6(4),e.Q6J("ngClass",e.l5B(34,Ne,"PAGADO"===t.estadoCredito,"VENCIDO"===t.estadoCredito,"PENDIENTE"===t.estadoCredito,"ANULADO"===t.estadoCredito)),e.xp6(1),e.Oqu(t.estadoCredito),e.xp6(5),e.hij("",e.xi3(32,25,null==t.ticket?null:t.ticket.totalVenta,null==t.ticket?null:t.ticket.codigoMoneda)," "),e.xp6(6),e.hij("",e.xi3(38,28,null==t?null:t.montoPagado,null==t.ticket?null:t.ticket.codigoMoneda)," "),e.xp6(6),e.hij("",e.xi3(44,31,null==t?null:t.montoRestante,null==t.ticket?null:t.ticket.codigoMoneda)," "),e.xp6(5),e.hij(" ",null==t.ticket.vendedor?null:t.ticket.vendedor.nombreCompleto," "),e.xp6(4),e.hij(" ",null==t.ticket.puntoVenta?null:t.ticket.puntoVenta.nombre," "),e.xp6(5),e.hij("",t.diasCredito," "),e.xp6(4),e.Q6J("ngIf",t.extendido),e.xp6(1),e.Q6J("ngIf",!t.extendido),e.xp6(5),e.hij("",t.diasExtendidos," "),e.xp6(4),e.Q6J("ngIf",i.canChangeAccountReivable(t.estadoCredito)),e.xp6(1),e.Q6J("ngIf",i.canChangeAccountReivable(t.estadoCredito)),e.xp6(1),e.Q6J("ngIf",i.canChangeAccountReivable(t.estadoCredito))}}function Se(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div"),e.TgZ(1,"app-amortizar",62),e.NdJ("changeAccount",function(){return e.CHM(t),e.oxw().resetAndRefreshTable()}),e.qZA(),e.qZA()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("accountsReceivable",t.accountsReceivableSelected)}}function Je(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div"),e.TgZ(1,"div",21),e.TgZ(2,"div",15),e.TgZ(3,"label",25),e._uU(4,"Ingrese d\xedas a extender"),e.qZA(),e.TgZ(5,"input",63),e.NdJ("ngModelChange",function(a){return e.CHM(t),e.oxw().diasExtender=a}),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&n){const t=e.oxw();e.xp6(5),e.Q6J("ngModel",t.diasExtender)}}function we(n,o){1&n&&(e.TgZ(0,"tr"),e.TgZ(1,"th"),e._uU(2,"Descripci\xf3n"),e.qZA(),e.TgZ(3,"th"),e._uU(4,"Monto"),e.qZA(),e.TgZ(5,"th"),e._uU(6,"Moneda"),e.qZA(),e.TgZ(7,"th"),e._uU(8,"Fecha"),e.qZA(),e.TgZ(9,"th"),e._uU(10,"Forma de pago"),e.qZA(),e.TgZ(11,"th"),e._uU(12,"Usuario"),e.qZA(),e.qZA())}function Ie(n,o){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" (",t.numeroOperacion,")")}}function Ve(n,o){if(1&n&&(e.TgZ(0,"span",65),e._uU(1),e.ALo(2,"montoDinero"),e.YNc(3,Ie,2,1,"span",10),e.qZA()),2&n){const t=o.$implicit,i=e.oxw().$implicit;e.xp6(1),e.AsE(" ",t.nombre,": ",e.xi3(2,3,t.monto,null==i.cashRegisterDetail?null:i.cashRegisterDetail.monedaMovimientoCaja)," "),e.xp6(2),e.Q6J("ngIf",t.numeroOperacion)}}function $e(n,o){if(1&n&&(e.TgZ(0,"tr"),e.TgZ(1,"td"),e.TgZ(2,"span",53),e._uU(3,"Descripci\xf3n"),e.qZA(),e._uU(4),e.qZA(),e.TgZ(5,"td"),e.TgZ(6,"span",53),e._uU(7,"Monto"),e.qZA(),e._uU(8),e.qZA(),e.TgZ(9,"td"),e.TgZ(10,"span",53),e._uU(11,"Moneda"),e.qZA(),e.TgZ(12,"span"),e._uU(13),e.qZA(),e.qZA(),e.TgZ(14,"td"),e.TgZ(15,"span",53),e._uU(16,"Fecha"),e.qZA(),e.TgZ(17,"span"),e._uU(18),e.ALo(19,"date"),e.qZA(),e.qZA(),e.TgZ(20,"td"),e.TgZ(21,"span",53),e._uU(22,"Forma de Pago"),e.qZA(),e.YNc(23,Ve,4,6,"span",64),e.qZA(),e.TgZ(24,"td"),e.TgZ(25,"span",53),e._uU(26,"Usuario"),e.qZA(),e.TgZ(27,"span"),e._uU(28),e.qZA(),e.qZA(),e.qZA()),2&n){const t=o.$implicit;e.xp6(4),e.hij(" ",t.cashRegisterDetail.descripcion," "),e.xp6(4),e.hij(" ",t.cashRegisterDetail.monto," "),e.xp6(5),e.hij("",null==t.cashRegisterDetail?null:t.cashRegisterDetail.monedaMovimientoCaja," "),e.xp6(5),e.hij("",e.xi3(19,6,null==t.cashRegisterDetail?null:t.cashRegisterDetail.fechaMovimiento,"dd/MM/yyyy hh:mm a")," "),e.xp6(5),e.Q6J("ngForOf",null==t.cashRegisterDetail?null:t.cashRegisterDetail.pagos),e.xp6(5),e.hij("",null==t.cashRegisterDetail||null==t.cashRegisterDetail.usuario?null:t.cashRegisterDetail.usuario.nombreCompleto," ")}}function ze(n,o){1&n&&e._UZ(0,"p-message",66)}const z=function(){return{width:"800px"}},Qe=function(){return{width:"800px",minWidth:"100px"}};class C{constructor(o,t,i,a,s,v,je,ke,Ye,He,Oe,Le){this.route=o,this.router=t,this.datePipe=i,this.messageService=a,this.tdPipe=s,this.confirmationService=v,this.accountsReceivableService=je,this.loginService=ke,this.userService=Ye,this.ls=He,this.currencyService=Oe,this.breadcrumbService=Le,this.accountsReceivable=[],this.perPage=10,this.tiposComprobantes=[],this.puntosVenta=[],this.vendedores=[],this.estadosCredito=[],this.visibleExtender=!1,this.visibleDetallePagos=!1,this.visibleAmortizar=!1,this.accountsReceivableDetailsSelected=[],this.actionsExportData=[],this.totales=[]}ngOnInit(){this.externalFilters||this.breadcrumbService.setItems((0,f.kn)(this.route)),this.loadData(),this.validarPuntoVenta(),this.tiposComprobantes=[{codigo:"01",nombre:"Factura"},{codigo:"03",nombre:"Boleta"},{codigo:"07",nombre:"Nota de cr\xe9dito"},{codigo:"08",nombre:"Nota de d\xe9bito"}],this.estadosCredito=[{label:"PENDIENTE",value:"PENDIENTE"},{label:"ANULADO",value:"ANULADO"},{label:"VENCIDO",value:"VENCIDO"},{label:"PAGADO",value:"PAGADO"}]}get titleDialogDetailPay(){return this.accountsReceivableSelected?`Detalle de pagos (${this.accountsReceivableSelected.ticket.serie}-${this.accountsReceivableSelected.ticket.numero})`:"Detalle de pagos"}resetAndRefreshTable(){this.tabla.reset()}loadData(){this.puntosVenta=this.loginService.getPuntosVentaUsuario(),setTimeout(()=>this.userService.findAll(null,!1).pipe((0,q.U)(o=>{const t=[];return o.forEach(i=>{t.push({label:`${i.nombres} ${i.apellidos}`,value:i.id})}),t})).subscribe(o=>this.vendedores=o))}loadLazy(o){this.lastLazyLoadEvent=o;let i=["pageNumber="+o.first/this.perPage,`perPage=${o.rows}`];this.externalFilters?i=i.concat(this.externalFilters):(this.filtroEmisionDesde&&i.push(`filtroEmisionDesde=${this.datePipe.transform(this.filtroEmisionDesde,"dd-MM-yyyy")}`),this.filtroEmisionHasta&&i.push(`filtroEmisionHasta=${this.datePipe.transform(this.filtroEmisionHasta,"dd-MM-yyyy")}`),this.filtroVencimientoDesde&&i.push(`filtroVencimientoDesde=${this.datePipe.transform(this.filtroVencimientoDesde,"dd-MM-yyyy")}`),this.filtroVencimientoHasta&&i.push(`filtroVencimientoHasta=${this.datePipe.transform(this.filtroVencimientoHasta,"dd-MM-yyyy")}`),this.filtroTipoComprobante&&i.push(`tipoComprobante=${this.filtroTipoComprobante}`),this.filtroCliente&&i.push(`cliente=${this.filtroCliente}`),this.filtroSerie&&i.push(`serie=${this.filtroSerie}`),this.filtroNumero&&i.push(`numero=${this.filtroNumero}`),this.filtroPuntoVenta&&i.push(`idPuntoVenta=${this.filtroPuntoVenta.id}`),this.filtroVendedor&&i.push(`idVendedor=${this.filtroVendedor}`),this.filtroEstadoCredito&&i.push(`estadoCredito=${this.filtroEstadoCredito}`)),o.sortOrder&&i.push(`sortOrder=${o.sortOrder}`),o.sortField&&i.push(`sortField=${o.sortField}`),this.loadTotales(i),this.setUrlsExport(i.join("&")),setTimeout(()=>this.accountsReceivableService.findAllPage(i.join("&")).subscribe(a=>{this.totalRecords=a.totalElements,this.accountsReceivable=a.content}))}loadTotales(o){this.currencyService.findAll().subscribe(t=>{const i=t.map(a=>{const s=[...o,`codigoMoneda=${a.codigoMoneda}`];return this.accountsReceivableService.totales(s.join("&")).pipe((0,q.U)(v=>Object.assign(Object.assign({},v),{totalPorPagar:v.totalCredito-v.totalPagado})))});(0,M.D)(i).subscribe(a=>{this.totales=a.filter(s=>s.codigoMoneda)})})}canChangeAccountReivable(o){return"PENDIENTE"===o||"VENCIDO"===o}confirmCancelar(o){this.confirmationService.confirm({message:`Estas seguro de anular la cuenta de ${o.ticket.denominacionReceptor} por ${o.ticket.codigoMoneda} ${o.ticket.totalVenta}?`,accept:()=>{this.accountsReceivableService.cancel(o.id).subscribe(()=>{this.messageService.clear(),this.messageService.add({severity:"success",summary:"Mensaje",detail:"Cuenta anulada correctamente"}),this.resetAndRefreshTable()})},acceptLabel:"Si",rejectLabel:"No"})}openDialogExtend(o){this.accountsReceivableSelected=o,this.visibleExtender=!0}openDialogViewPays(o){this.visibleDetallePagos=!0,this.accountsReceivableSelected=o,this.accountsReceivableService.findAllDetailByAccountReceivableId(o.id).subscribe(t=>{this.accountsReceivableDetailsSelected=t})}confirmExtend(){this.confirmationService.confirm({message:`Estas seguro de extender el plazo de la cuenta de ${this.accountsReceivableSelected.ticket.denominacionReceptor} en ${this.diasExtender} d\xedas?`,accept:()=>{this.accountsReceivableService.extend(this.accountsReceivableSelected.id,this.diasExtender).subscribe(()=>{this.messageService.clear(),this.messageService.add({severity:"success",summary:"Mensaje",detail:"Plazo de cuenta extendido correctamente"}),this.visibleExtender=!1,this.resetAndRefreshTable()})},acceptLabel:"Si",rejectLabel:"No"})}goAmortizar(o){this.accountsReceivableSelected=o,this.visibleAmortizar=!0}validarPuntoVenta(){this.puntoVenta$.subscribe(o=>{this.filtroPuntoVenta=o,this.resetAndRefreshTable()})}setUrlsExport(o){const t=this.loginService.getUser().empresa.uuid,i=`${y.N.endpointApi}/public/export-data/${t}/accountsReceivable`;this.actionsExportData=[{icon:"fa fa-file-excel-o",label:"Exportar a excel",url:`${i}.xlsx?${o}`},{icon:"fa fa-file-pdf-o",label:"Exportar a pdf",url:`${i}.pdf?${o}`}]}clearSelected(){this.accountsReceivableDetailsSelected=void 0}}C.\u0275fac=function(o){return new(o||C)(e.Y36(b.gz),e.Y36(b.F0),e.Y36(d.uU),e.Y36(l.ez),e.Y36(A.B),e.Y36(l.YP),e.Y36(Z.b),e.Y36(N.r),e.Y36(j.i),e.Y36(F.E),e.Y36(k.i),e.Y36(Y.p))},C.\u0275cmp=e.Xpm({type:C,selectors:[["app-cuentas-por-cobrar"]],viewQuery:function(o,t){if(1&o&&e.Gf(Te,7),2&o){let i;e.iGM(i=e.CRH())&&(t.tabla=i.first)}},inputs:{externalFilters:"externalFilters"},decls:29,vars:36,consts:[[1,"grid"],["class","col-12",4,"ngIf"],["class","col-12",4,"ngFor","ngForOf"],[1,"col-12",2,"padding-top","1.5rem"],["dataKey","id",3,"value","lazy","paginator","rows","totalRecords","responsive","autoLayout","onLazyLoad"],["dt",""],["pTemplate","header"],["pTemplate","summary"],["pTemplate","body"],["header","Amortizaci\xf3n",3,"visible","modal","responsive","onHide","visibleChange"],[4,"ngIf"],["header","Extender plazo",3,"visible","modal","responsive","visibleChange"],["pButton","","type","button","label","Cancelar",1,"p-button-secondary",3,"click"],["pButton","","type","button","label","Extender plazo",3,"disabled","click"],[3,"header","visible","modal","responsive","minY","visibleChange"],[1,"col-12"],["dataKey","id",3,"value","responsive","autoLayout"],[2,"margin-top","1rem"],["severity","info","text","No existen pagos registrados.",4,"ngIf"],["pButton","","type","button","label","Cerrar",1,"p-button-secondary",3,"click"],[3,"submit"],[1,"grid","p-fluid"],[1,"col-12","md:col-6"],["legend","Fecha de emisi\xf3n"],[1,"col-6"],[1,"label-form"],["showButtonBar","true","name","filtroEmisionDesde","dateFormat","dd/mm/yy",3,"ngModel","locale","onSelect","ngModelChange"],["name","filtroEmisionHasta","dateFormat","dd/mm/yy",3,"ngModel","locale","onSelect","ngModelChange"],["legend","Fecha vencimiento"],["name","filtroVencimientoDesde","dateFormat","dd/mm/yy",3,"ngModel","locale","onSelect","ngModelChange"],["name","filtroVencimientoHasta","dateFormat","dd/mm/yy",3,"ngModel","locale","onSelect","ngModelChange"],[1,"col-6","md:col-3","lg:col-2"],["placeholder","Seleccione...","optionLabel","nombre","name","tipoDocumento",3,"ngModel","options","showClear","onChange","ngModelChange"],[1,"col-4","md:col-2","lg:col-1"],["name","serie","type","text","pInputText","",2,"width","100%",3,"ngModel","input","ngModelChange"],["name","numero","type","text","pInputText","",2,"width","100%",3,"ngModel","input","ngModelChange"],["name","filtroCliente","type","text","pInputText","",2,"width","100%",3,"ngModel","input","ngModelChange"],["name","filtroDiasCredito","type","text","pInputText","",2,"width","100%",3,"ngModel","input","ngModelChange"],[1,"col-6","md:col-3","lg:col-1"],["dataKey","id","placeholder","Seleccione...","name","filtroEstadoCredito",3,"ngModel","options","showClear","onChange","ngModelChange"],["dataKey","id","placeholder","Seleccione...","optionLabel","nombre","name","puntoVenta",3,"ngModel","options","onChange","ngModelChange"],["filter","true","name","vendedor","placeholder","Seleccione vendedor",3,"showClear","ngModel","options","onChange","ngModelChange"],[1,"grid","p-nogutter"],[1,"col-fixed",2,"width","200px"],[1,"m-0"],[1,"col"],[1,"grid","p-nogutter","p-jc-end"],[1,"col-fixed"],[1,"mt-2","mb-2","ml-4","mr-4"],["pSortableColumn","fechaVencimiento"],["field","fechaVencimiento"],[2,"text-align","left"],[3,"items"],[1,"p-column-title"],[1,"p-tag","p-tag-rounded",3,"ngClass"],["class","m-1","pTooltip","Amortizar","type","button","pButton","","icon","fa fa-money",3,"click",4,"ngIf"],["pTooltip","Anular","type","button","pButton","","icon","fa fa-ban","class","p-button-danger m-1",3,"click",4,"ngIf"],["pTooltip","Extender","type","button","pButton","","icon","fa fa-arrow-up","class","p-button-success m-1",3,"click",4,"ngIf"],["pTooltip","Ver pagos","type","button","pButton","","icon","fa fa-list-ol",1,"m-1",3,"click"],["pTooltip","Amortizar","type","button","pButton","","icon","fa fa-money",1,"m-1",3,"click"],["pTooltip","Anular","type","button","pButton","","icon","fa fa-ban",1,"p-button-danger","m-1",3,"click"],["pTooltip","Extender","type","button","pButton","","icon","fa fa-arrow-up",1,"p-button-success","m-1",3,"click"],[3,"accountsReceivable","changeAccount"],["type","text","placeholder","D\xedas a extender","pInputText","",2,"width","100%",3,"ngModel","ngModelChange"],["class","p-tag p-tag-rounded m-1",4,"ngFor","ngForOf"],[1,"p-tag","p-tag-rounded","m-1"],["severity","info","text","No existen pagos registrados."]],template:function(o,t){1&o&&(e.TgZ(0,"p-card"),e.TgZ(1,"div",0),e.YNc(2,xe,57,47,"div",1),e.YNc(3,qe,21,16,"div",2),e.TgZ(4,"div",3),e.TgZ(5,"p-table",4,5),e.NdJ("onLazyLoad",function(a){return t.loadLazy(a)}),e.YNc(7,Me,30,0,"ng-template",6),e.YNc(8,De,2,1,"ng-template",7),e.YNc(9,Fe,75,39,"ng-template",8),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(10,"p-dialog",9),e.NdJ("onHide",function(){return t.clearSelected()})("visibleChange",function(a){return t.visibleAmortizar=a}),e.YNc(11,Se,2,1,"div",10),e.qZA(),e.TgZ(12,"p-dialog",11),e.NdJ("visibleChange",function(a){return t.visibleExtender=a}),e.YNc(13,Je,6,1,"div",10),e.TgZ(14,"p-footer"),e.TgZ(15,"button",12),e.NdJ("click",function(){return t.visibleExtender=!1}),e.qZA(),e.TgZ(16,"button",13),e.NdJ("click",function(){return t.confirmExtend()}),e.qZA(),e.qZA(),e.qZA(),e.TgZ(17,"p-dialog",14),e.NdJ("visibleChange",function(a){return t.visibleDetallePagos=a}),e.TgZ(18,"div",0),e._UZ(19,"div",15),e.TgZ(20,"div",15),e.TgZ(21,"p-table",16,5),e.YNc(23,we,13,0,"ng-template",6),e.YNc(24,$e,29,9,"ng-template",8),e.qZA(),e.TgZ(25,"div",17),e.YNc(26,ze,1,0,"p-message",18),e.qZA(),e.qZA(),e.qZA(),e.TgZ(27,"p-footer",15),e.TgZ(28,"button",19),e.NdJ("click",function(){return t.visibleDetallePagos=!1}),e.qZA(),e.qZA(),e.qZA()),2&o&&(e.xp6(2),e.Q6J("ngIf",!t.externalFilters),e.xp6(1),e.Q6J("ngForOf",t.totales),e.xp6(2),e.Q6J("value",t.accountsReceivable)("lazy",!0)("paginator",!0)("rows",t.perPage)("totalRecords",t.totalRecords)("responsive",!0)("autoLayout",!0),e.xp6(5),e.Akn(e.DdM(33,z)),e.Q6J("visible",t.visibleAmortizar)("modal",!0)("responsive",!0),e.xp6(1),e.Q6J("ngIf",t.accountsReceivableSelected),e.xp6(1),e.Akn(e.DdM(34,z)),e.Q6J("visible",t.visibleExtender)("modal",!0)("responsive",!0),e.xp6(1),e.Q6J("ngIf",t.accountsReceivableSelected),e.xp6(3),e.Q6J("disabled",!t.diasExtender),e.xp6(1),e.Akn(e.DdM(35,Qe)),e.Q6J("header",t.titleDialogDetailPay)("visible",t.visibleDetallePagos)("modal",!0)("responsive",!0)("minY",70),e.xp6(4),e.Q6J("value",t.accountsReceivableDetailsSelected)("responsive",!0)("autoLayout",!0),e.xp6(5),e.Q6J("ngIf",t.accountsReceivableDetailsSelected&&0===t.accountsReceivableDetailsSelected.length))},directives:[R.Z,d.O5,c._Y,c.JL,c.F,S.p,H.f,c.JJ,c.On,O.Lt,c.Fj,J.o,d.sg,D.iA,l.jx,D.lQ,D.fz,L.h,d.mk,w.u,U.Hq,I.V,h,l.$_,P.q],pipes:[$.Z,d.uU],styles:[""]}),(0,u.gn)([(0,p.Ph)(g.Z.getOffice)],C.prototype,"puntoVenta$",void 0)},14354:(Q,x,r)=>{r.r(x),r.d(x,{CuentasPorCobrarModule:()=>d});var u=r(74202),q=r(54578),f=r(47903),p=r(5e3);const g=[{path:"",component:f.U,canActivate:[q.P],data:{breadcrumb:[{label:"Operaciones"},{label:"Cuentas por cobrar"}]}}];let M=(()=>{class l{}return l.\u0275fac=function(Z){return new(Z||l)},l.\u0275mod=p.oAB({type:l}),l.\u0275inj=p.cJS({imports:[[u.Bz.forChild(g)],u.Bz]}),l})();var y=r(20958),e=r(45330),b=r(27429);let d=(()=>{class l{}return l.\u0275fac=function(Z){return new(Z||l)},l.\u0275mod=p.oAB({type:l}),l.\u0275inj=p.cJS({providers:[e.xA],imports:[[M,y.m,b.N]]}),l})()}}]);