"use strict";(self.webpackChunkmirage=self.webpackChunkmirage||[]).push([[8872],{5766:(Z,C,o)=>{o.d(C,{h:()=>v});var d=o(5e3),i=o(45351);let v=(()=>{class p{constructor(){}get items(){return this._items}set items(l){this._items=l,this.loadActions()}get defaultActionLabel(){return this.items?this.items[0].label:""}get defaultActionIcon(){return this.items?this.items[0].icon:""}ngOnInit(){}defaultAction(){if(this.items&&this.items.length>0){const l=this.items[0].url;l&&window.open(l,"_blank")}}loadActions(){if(this.options=[],this.items){let l=0;this.items.forEach(f=>{if(l>0){const u=f.url;this.options.push({label:f.label,icon:f.icon,command:()=>{u&&window.open(u,"_blank")}})}l++})}}}return p.\u0275fac=function(l){return new(l||p)},p.\u0275cmp=d.Xpm({type:p,selectors:[["app-actions"]],inputs:{items:"items"},decls:1,vars:3,consts:[["appendTo","body","styleClass","p-button-secondary",3,"label","icon","model","onClick"]],template:function(l,f){1&l&&(d.TgZ(0,"p-splitButton",0),d.NdJ("onClick",function(){return f.defaultAction()}),d.qZA()),2&l&&d.Q6J("label",f.defaultActionLabel)("icon",f.defaultActionIcon)("model",f.options)},directives:[i.a],styles:[""]}),p})()},51420:(Z,C,o)=>{o.d(C,{Z:()=>T});var d=o(82817),i=o(5e3),v=o(45330),p=o(96039),t=o(69808),l=o(40845);function f(m,h){if(1&m){const c=i.EpF();i.TgZ(0,"div",3),i.TgZ(1,"div",0),i.TgZ(2,"div",3),i._UZ(3,"a",4),i.TgZ(4,"button",5),i.NdJ("click",function(){const A=i.CHM(c).$implicit;return i.oxw().print(A)}),i.qZA(),i.qZA(),i.TgZ(5,"div",3),i._UZ(6,"iframe",6),i.qZA(),i.qZA(),i.qZA()}if(2&m){const c=h.$implicit,g=i.oxw();i.xp6(3),i.Q6J("href",null==c.pdfPrint?null:c.pdfPrint.urlSafe,i.LSH),i.xp6(3),i.Q6J("src",g.isMobileDevice?null==c.pdfPrint?null:c.pdfPrint.urlViewer:null==c.pdfPrint?null:c.pdfPrint.urlSafe,i.uOi)}}function u(m,h){if(1&m){const c=i.EpF();i.TgZ(0,"button",9),i.NdJ("click",function(){return i.CHM(c).$implicit.method()}),i.qZA()}if(2&m){const c=h.$implicit;i.Q6J("icon",c.icon)("label",c.name)}}function x(m,h){if(1&m&&(i.TgZ(0,"div",3),i.TgZ(1,"div",7),i.YNc(2,u,1,2,"button",8),i.qZA(),i.qZA()),2&m){const c=i.oxw();i.xp6(2),i.Q6J("ngForOf",c.actions)}}let T=(()=>{class m{constructor(c,g){this.config=c,this.qzTrayService=g,this.statusQz=!1}ngOnInit(){this.ordersPrint=this.config.data.ordersPrint,this.actions=this.config.data.actions}get isMobileDevice(){return(0,d.s2)()}ngAfterViewInit(){this.statusQz=this.qzTrayService.getStatus()}print(c){this.statusQz&&c.fnPrintQz?c.fnPrintQz():(0,d.TW)(c.pdfPrint.url)}}return m.\u0275fac=function(c){return new(c||m)(i.Y36(v.S),i.Y36(p.k))},m.\u0275cmp=i.Xpm({type:m,selectors:[["app-modal-pdf"]],decls:3,vars:2,consts:[[1,"grid"],["class","col-12",4,"ngFor","ngForOf"],["class","col-12",4,"ngIf"],[1,"col-12"],["target","_blank","pButton","","icon","pi pi-clone","label","Abrir en navegador",1,"p-button-sm","mr-2",3,"href"],["pButton","","icon","pi pi-print","label","Imprimir",1,"p-button-sm","mr-2",3,"click"],["name","PDF.pdf","title","MyPdf","id","pdftoprint","type","application/pdf","width","100%","height","400px",3,"src"],[1,"flex","justify-content-end"],["class","p-button-sm mr-2 p-button-success m-1","pButton","",3,"icon","label","click",4,"ngFor","ngForOf"],["pButton","",1,"p-button-sm","mr-2","p-button-success","m-1",3,"icon","label","click"]],template:function(c,g){1&c&&(i.TgZ(0,"div",0),i.YNc(1,f,7,2,"div",1),i.YNc(2,x,3,1,"div",2),i.qZA()),2&c&&(i.xp6(1),i.Q6J("ngForOf",g.ordersPrint),i.xp6(1),i.Q6J("ngIf",g.actions))},directives:[t.sg,l.Hq,t.O5],styles:[""]}),m})()},89400:(Z,C,o)=>{o.d(C,{z:()=>v});var d=o(20958),i=o(5e3);let v=(()=>{class p{}return p.\u0275fac=function(l){return new(l||p)},p.\u0275mod=i.oAB({type:p}),p.\u0275inj=i.cJS({imports:[[d.m]]}),p})()},58872:(Z,C,o)=>{o.r(C),o.d(C,{ComunicacionBajaModule:()=>V});var d=o(74202),i=o(82817),v=o(92340),p=o(51420),t=o(5e3),l=o(1203),f=o(20207),u=o(69808),x=o(24876),T=o(59783),m=o(2314),h=o(24394),c=o(47745),g=o(45330),y=o(74297),A=o(75652),M=o(93075),P=o(98952),S=o(5766),j=o(4119),E=o(92676);const D=["dt"];function b(e,r){if(1&e&&(t.TgZ(0,"th"),t._uU(1),t.qZA()),2&e){const n=r.$implicit;t.xp6(1),t.hij(" ",n.header," ")}}function F(e,r){if(1&e&&(t.TgZ(0,"tr"),t.YNc(1,b,2,1,"th",13),t.qZA()),2&e){const n=r.$implicit;t.xp6(1),t.Q6J("ngForOf",n)}}function w(e,r){if(1&e&&(t.TgZ(0,"div",14),t._UZ(1,"app-actions",15),t.qZA()),2&e){const n=t.oxw();t.xp6(1),t.Q6J("items",n.actionsExportData)}}function O(e,r){if(1&e&&(t.ynx(0),t._uU(1),t.ALo(2,"date"),t.BQk()),2&e){const n=t.oxw(2).$implicit,a=t.oxw().$implicit;t.xp6(1),t.hij(" ",t.xi3(2,1,a[n.field],"yyyy-MM-dd hh:mm a")," ")}}function J(e,r){if(1&e&&(t.ynx(0),t._uU(1),t.ALo(2,"estadoSummary"),t.BQk()),2&e){const n=t.oxw(2).$implicit,a=t.oxw().$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,a[n.field])," ")}}function L(e,r){if(1&e&&(t.ynx(0),t._uU(1),t.BQk()),2&e){const n=t.oxw(3).$implicit,a=t.oxw();t.xp6(1),t.hij(" ",a.getVoidedDetails(n.voidedDetails)," ")}}function Q(e,r){if(1&e&&(t.ynx(0),t._uU(1),t.BQk()),2&e){const n=t.oxw(2).$implicit,a=t.oxw().$implicit;t.xp6(1),t.hij(" ",a[n.field]," ")}}function I(e,r){1&e&&(t.ynx(0),t.YNc(1,O,3,4,"ng-container",21),t.YNc(2,J,3,3,"ng-container",21),t.YNc(3,L,2,1,"ng-container",21),t.YNc(4,Q,2,1,"ng-container",22),t.BQk()),2&e&&(t.xp6(1),t.Q6J("ngSwitchCase","fechaGeneracionResumen"),t.xp6(1),t.Q6J("ngSwitchCase","estado"),t.xp6(1),t.Q6J("ngSwitchCase","comprobantesResumen"))}function N(e,r){if(1&e){const n=t.EpF();t.ynx(0,23),t.TgZ(1,"span",24),t._uU(2,"Imprimir"),t.qZA(),t.TgZ(3,"span",25),t.NdJ("click",function(){t.CHM(n);const s=t.oxw(2).$implicit;return t.oxw().openPdf(s.id)}),t.qZA(),t.BQk()}}function Y(e,r){if(1&e){const n=t.EpF();t.TgZ(0,"span",30),t.NdJ("click",function(){t.CHM(n);const s=t.oxw(3).$implicit;return t.oxw().getStatus(s.ticketSunat)}),t.qZA()}}function $(e,r){if(1&e){const n=t.EpF();t.TgZ(0,"span",31),t.NdJ("click",function(){t.CHM(n);const s=t.oxw(3).$implicit;return t.oxw().downloadFileStorage(s.cdrActivo)}),t.qZA()}}function R(e,r){if(1&e){const n=t.EpF();t.ynx(0,23),t.TgZ(1,"span",24),t._uU(2,"Acciones"),t.qZA(),t.YNc(3,Y,1,0,"span",26),t.TgZ(4,"span",27),t.NdJ("click",function(){t.CHM(n);const s=t.oxw(2).$implicit;return t.oxw().downloadFileStorage(s.xmlActivo)}),t.qZA(),t.YNc(5,$,1,0,"span",28),t.TgZ(6,"span",29),t.NdJ("click",function(){t.CHM(n);const s=t.oxw(2).$implicit;return t.oxw().enviarSunat(s.id)}),t.qZA(),t.BQk()}if(2&e){const n=t.oxw(2).$implicit;t.xp6(3),t.Q6J("ngIf","98"===n.estado),t.xp6(2),t.Q6J("ngIf","0"===n.estado)}}function k(e,r){if(1&e&&(t.TgZ(0,"td",17),t.YNc(1,I,5,3,"ng-container",18),t.YNc(2,N,4,0,"ng-container",19),t.YNc(3,R,7,2,"ng-container",20),t.qZA()),2&e){const n=r.$implicit;t.Q6J("ngSwitch",n.field),t.xp6(1),t.Q6J("ngIf",!n.isActions),t.xp6(1),t.Q6J("ngSwitchCase","imprimir"),t.xp6(1),t.Q6J("ngIf",n.isActions)}}function U(e,r){if(1&e&&(t.TgZ(0,"tr"),t.YNc(1,k,4,4,"td",16),t.qZA()),2&e){const n=r.columns;t.xp6(1),t.Q6J("ngForOf",n)}}const B=function(){return{width:"100%"}},z=[{path:"ver-comunicaciones-baja",component:(()=>{class e{constructor(n,a,s,_,q,G,X,tt,nt,et,it,ot){this.route=n,this.router=a,this.ticketService=s,this.loginService=_,this.datePipe=q,this.storageService=G,this.messageService=X,this.tdPipe=tt,this.confirmationService=nt,this.ls=et,this.breadcrumbService=it,this.dialogService=ot,this.dataList=[],this.perPage=10,this.actionsExportData=[]}ngOnInit(){this.breadcrumbService.setItems((0,i.kn)(this.route)),this.cols=[{field:"identificador",header:"Id"},{field:"fechaEmision",header:"Fecha"},{field:"comprobantesResumen",header:"Comprobantes"},{field:"estado",header:"Estado"},{field:"fechaGeneracionResumen",header:"Fecha generaci\xf3n"},{field:"ticketSunat",header:"Ticket sunat"},{field:"imprimir",header:"Imprimir"},{field:"acciones",header:"Acciones",isActions:!0,width:"160px"}]}getVoidedDetails(n){return n.map(a=>`${a.serieDocumento}-${a.numeroDocumento}`).join(", ")}resetAndRefreshTable(){this.tabla.reset(),this.refreshTable()}refreshTable(){this.lastLazyLoadEvent&&this.loadLazy(this.lastLazyLoadEvent)}loadLazy(n){this.lastLazyLoadEvent=n;const s=["pageNumber="+n.first/this.perPage,`perPage=${n.rows}`];this.filtroDesde&&s.push(`filtroDesde=${this.datePipe.transform(this.filtroDesde,"dd-MM-yyyy")}`),this.filtroHasta&&s.push(`filtroHasta=${this.datePipe.transform(this.filtroHasta,"dd-MM-yyyy")}`),n.sortOrder&&s.push(`sortOrder=${n.sortOrder}`),n.sortField&&s.push(`sortField=${n.sortField}`),this.setUrlsExport(),this.ticketService.findAllSearchVoided(s.join("&")).subscribe(_=>{this.totalRecords=_.totalElements,this.dataList=_.content,this.loading=!1})}getStatus(n){this.ticketService.getStatusVoided(n).subscribe(a=>{this.messageService.add({severity:"success",summary:"Mensaje",detail:a.mensaje}),this.refreshTable()})}setUrlsExport(){const n=this.loginService.getUser().empresa.uuid,a=`${v.N.endpointApi}/public/export-data/${n}/voided`;this.actionsExportData=[{icon:"fa fa-file-excel-o",label:"Exportar a excel",url:`${a}.xls`},{icon:"fa fa-file-pdf-o",label:"Exportar a pdf",url:`${a}.pdf`}]}downloadFileStorage(n){this.storageService.downloadFile(n)}openPdf(n){this.ticketService.openPdfVoided(n).then(a=>{this.dialogService.open(p.Z,{data:{ordersPrint:[{pdfPrint:a}]},header:"Comunicaci\xf3n de baja",width:"800px"})})}enviarSunat(n){this.ticketService.sendSunatVoided(n).subscribe(()=>{})}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(d.gz),t.Y36(d.F0),t.Y36(l.w),t.Y36(f.r),t.Y36(u.uU),t.Y36(x.V),t.Y36(T.ez),t.Y36(m.B),t.Y36(T.YP),t.Y36(h.E),t.Y36(c.p),t.Y36(g.xA))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-comunicacion-baja"]],viewQuery:function(n,a){if(1&n&&t.Gf(D,7),2&n){let s;t.iGM(s=t.CRH())&&(a.tabla=s.first)}},decls:19,vars:18,consts:[[1,"grid"],[1,"col-12"],[1,"grid","p-fluid"],[1,"col-12","md:col-3"],[1,"label-form"],["name","fechaInicio","dateFormat","dd/mm/yy",3,"ngModel","locale","onSelect","ngModelChange"],["name","fechaFin","dateFormat","dd/mm/yy",3,"ngModel","locale","onSelect","ngModelChange"],[1,"col-12",2,"padding-top","1.5rem"],["dataKey","id",3,"columns","value","lazy","paginator","rows","totalRecords","responsive","autoLayout","onLazyLoad"],["dt",""],["pTemplate","header"],["pTemplate","summary"],["pTemplate","body"],[4,"ngFor","ngForOf"],[2,"text-align","left"],[3,"items"],[3,"ngSwitch",4,"ngFor","ngForOf"],[3,"ngSwitch"],[4,"ngIf"],["style","text-align: center",4,"ngSwitchCase"],["style","text-align: center",4,"ngIf"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[2,"text-align","center"],[1,"p-column-title"],["pTooltip","Imprimir A4",1,"fa","fa-file-pdf-o",2,"margin-right","0.2em","margin-left","0.2em","cursor","pointer",3,"click"],["style","margin-right: 0.2em; margin-left: 0.2em; cursor: pointer;","pTooltip","Consulta estado en Sunat","class","fa fa-external-link",3,"click",4,"ngIf"],["pTooltip","XML",1,"fa","fa-code",2,"margin-right","0.2em","margin-left","0.2em","cursor","pointer",3,"click"],["style","margin-right: 0.2em; margin-left: 0.2em; cursor: pointer;","pTooltip","CDR","class","pi pi-check",3,"click",4,"ngIf"],["pTooltip","Enviar baja a sunat",1,"fa","fa-paper-plane-o",2,"margin-right","0.2em","margin-left","0.2em","cursor","pointer",3,"click"],["pTooltip","Consulta estado en Sunat",1,"fa","fa-external-link",2,"margin-right","0.2em","margin-left","0.2em","cursor","pointer",3,"click"],["pTooltip","CDR",1,"pi","pi-check",2,"margin-right","0.2em","margin-left","0.2em","cursor","pointer",3,"click"]],template:function(n,a){1&n&&(t.TgZ(0,"p-card"),t.TgZ(1,"div",0),t.TgZ(2,"div",1),t.TgZ(3,"div",2),t.TgZ(4,"div",3),t.TgZ(5,"label",4),t._uU(6,"Desde"),t.qZA(),t.TgZ(7,"p-calendar",5),t.NdJ("onSelect",function(){return a.resetAndRefreshTable()})("ngModelChange",function(_){return a.filtroDesde=_}),t.qZA(),t.qZA(),t.TgZ(8,"div",3),t.TgZ(9,"label",4),t._uU(10,"Hasta"),t.qZA(),t.TgZ(11,"p-calendar",6),t.NdJ("onSelect",function(){return a.resetAndRefreshTable()})("ngModelChange",function(_){return a.filtroHasta=_}),t.qZA(),t.qZA(),t.qZA(),t.TgZ(12,"div",0),t.TgZ(13,"div",7),t.TgZ(14,"p-table",8,9),t.NdJ("onLazyLoad",function(_){return a.loadLazy(_)}),t.YNc(16,F,2,1,"ng-template",10),t.YNc(17,w,2,1,"ng-template",11),t.YNc(18,U,2,1,"ng-template",12),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA()),2&n&&(t.xp6(7),t.Akn(t.DdM(16,B)),t.Q6J("ngModel",a.filtroDesde)("locale",a.ls.calendarEs),t.xp6(4),t.Akn(t.DdM(17,B)),t.Q6J("ngModel",a.filtroHasta)("locale",a.ls.calendarEs),t.xp6(3),t.Q6J("columns",a.cols)("value",a.dataList)("lazy",!0)("paginator",!0)("rows",a.perPage)("totalRecords",a.totalRecords)("responsive",!0)("autoLayout",!0))},directives:[y.Z,A.f,M.JJ,M.On,P.iA,T.jx,u.sg,S.h,u.RF,u.O5,u.n9,u.ED,j.u],pipes:[u.uU,E._],styles:[""]}),e})(),data:{breadcrumb:[{label:"Operaciones"},{label:"Facturaci\xf3n electr\xf3nica"},{label:"Comunicaci\xf3n de baja"}]}}];let H=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[d.Bz.forChild(z)],d.Bz]}),e})();var K=o(20958),W=o(89400);let V=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({providers:[g.xA],imports:[[K.m,H,W.z]]}),e})()}}]);