(self.webpackChunkmirage=self.webpackChunkmirage||[]).push([[4476],{74476:(je,me,b)=>{"use strict";b.r(me),b.d(me,{RestauranteModule:()=>nr});var D=b(74202),E=b(54578),l=b(82817),e=b(5e3),u=b(40332),Z=b(47745),T=b(74297),O=b(31424),A=b(98952),h=b(59783),v=b(69808),a=b(40845),r=b(4119);function c(o,n){if(1&o&&e._UZ(0,"p-sortIcon",11),2&o){const t=e.oxw().$implicit;e.Q6J("field",t.field)}}function p(o,n){if(1&o&&(e.TgZ(0,"th",9),e._uU(1),e.YNc(2,c,1,1,"p-sortIcon",10),e.qZA()),2&o){const t=n.$implicit;e.Q6J("pSortableColumn",t.field),e.xp6(1),e.hij(" ",t.header," "),e.xp6(1),e.Q6J("ngIf",!t.isActions)}}function g(o,n){if(1&o&&(e.TgZ(0,"tr"),e.YNc(1,p,3,3,"th",8),e.qZA()),2&o){const t=n.$implicit;e.xp6(1),e.Q6J("ngForOf",t)}}function _(o,n){if(1&o&&(e.ynx(0),e.TgZ(1,"span",18),e._uU(2,"Sal\xf3n"),e.qZA(),e._uU(3),e.BQk()),2&o){const t=e.oxw(2).$implicit,i=e.oxw().$implicit;e.xp6(3),e.AsE(" ",i[t.field].nombre," (",i[t.field].puntoVenta.nombre,") ")}}function m(o,n){if(1&o&&(e.ynx(0),e._uU(1),e.BQk()),2&o){const t=e.oxw(2).$implicit,i=e.oxw().$implicit;e.xp6(1),e.hij(" ",i[t.field]," ")}}function x(o,n){1&o&&(e.ynx(0),e.YNc(1,_,4,2,"ng-container",16),e.YNc(2,m,2,1,"ng-container",17),e.BQk()),2&o&&(e.xp6(1),e.Q6J("ngSwitchCase","salon"))}function I(o,n){if(1&o&&(e.ynx(0,19),e.TgZ(1,"span",18),e._uU(2,"Acciones"),e.qZA(),e._UZ(3,"button",20),e.BQk()),2&o){const t=e.oxw(2).$implicit,i=e.oxw();e.xp6(3),e.Q6J("routerLink",i.linkUpdate(t.id))}}function M(o,n){if(1&o&&(e.TgZ(0,"td",13),e.YNc(1,x,3,1,"ng-container",14),e.YNc(2,I,4,1,"ng-container",15),e.qZA()),2&o){const t=n.$implicit;e.Q6J("ngSwitch",t.field),e.xp6(1),e.Q6J("ngIf",!t.isActions),e.xp6(1),e.Q6J("ngIf",t.isActions)}}function U(o,n){if(1&o&&(e.TgZ(0,"tr"),e.YNc(1,M,3,3,"td",12),e.qZA()),2&o){const t=n.columns;e.xp6(1),e.Q6J("ngForOf",t)}}function K(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",21),e.TgZ(1,"button",22),e.NdJ("click",function(){return e.CHM(t),e.oxw().new()}),e.qZA(),e.qZA()}}let ge=(()=>{class o{constructor(t,i,s,d){this.route=t,this.router=i,this.restaurantService=s,this.breadcrumbService=d,this.perPage=10}ngOnInit(){this.breadcrumbService.setItems((0,l.kn)(this.route)),this.cols=[{field:"salon",header:"Sal\xf3n"},{field:"numero",header:"N\xfamero"},{header:"Acciones",isActions:!0}]}new(){this.router.navigateByUrl("/restaurante/mesas/nuevo")}loadLazy(t){const s=["pageNumber="+t.first/this.perPage,`perPage=${t.rows}`];t.sortOrder&&s.push(`sortOrder=${t.sortOrder}`),t.sortField&&s.push(`sortField=${t.sortField}`),t.filters.global&&s.push(`filterGlobal=${t.filters.global.value}`),this.restaurantService.findAllTables(s.join("&")).subscribe(d=>{this.totalRecords=d.totalElements,this.dataList=d.content})}linkUpdate(t){return`/restaurante/mesas/editar/${t}`}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(D.gz),e.Y36(D.F0),e.Y36(u.T),e.Y36(Z.p))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-mesas"]],decls:10,vars:8,consts:[[1,"grid"],[1,"col-12"],["type","text","pInputText","","size","32","placeholder","Buscar por Sal\xf3n o N\xfamero",1,"derecha",2,"width","auto",3,"input"],["dataKey","id",3,"columns","value","lazy","paginator","rows","totalRecords","responsive","autoLayout","onLazyLoad"],["dt",""],["pTemplate","header"],["pTemplate","body"],["pTemplate","summary"],[3,"pSortableColumn",4,"ngFor","ngForOf"],[3,"pSortableColumn"],["ariaLabel","Activa para ordenar","ariaLabelDesc","Activa para ordenar en orden descendente","ariaLabelAsc","Activa para ordenar en orden ascendente",3,"field",4,"ngIf"],["ariaLabel","Activa para ordenar","ariaLabelDesc","Activa para ordenar en orden descendente","ariaLabelAsc","Activa para ordenar en orden ascendente",3,"field"],[3,"ngSwitch",4,"ngFor","ngForOf"],[3,"ngSwitch"],[4,"ngIf"],["style","text-align: center",4,"ngIf"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"p-column-title"],[2,"text-align","center"],["pButton","","type","button","icon","pi pi-pencil","pTooltip","Actualizar, Eliminar",1,"p-button-success",3,"routerLink"],[2,"text-align","left"],["type","button","pButton","","icon","fa fa-plus","label","Nuevo",2,"margin-right","0.2rem",3,"click"]],template:function(t,i){if(1&t){const s=e.EpF();e.TgZ(0,"p-card"),e.TgZ(1,"div",0),e.TgZ(2,"div",1),e.TgZ(3,"input",2),e.NdJ("input",function(C){return e.CHM(s),e.MAs(6).filterGlobal(C.target.value,"contains")}),e.qZA(),e.qZA(),e.TgZ(4,"div",1),e.TgZ(5,"p-table",3,4),e.NdJ("onLazyLoad",function(C){return i.loadLazy(C)}),e.YNc(7,g,2,1,"ng-template",5),e.YNc(8,U,2,1,"ng-template",6),e.YNc(9,K,2,0,"ng-template",7),e.qZA(),e.qZA(),e.qZA(),e.qZA()}2&t&&(e.xp6(5),e.Q6J("columns",i.cols)("value",i.dataList)("lazy",!0)("paginator",!0)("rows",i.perPage)("totalRecords",i.totalRecords)("responsive",!0)("autoLayout",!0))},directives:[T.Z,O.o,A.iA,h.jx,v.sg,A.lQ,v.O5,A.fz,v.RF,v.n9,v.ED,a.Hq,r.u,D.rH],styles:[".derecha[_ngcontent-%COMP%]{float:right}"]}),o})();function ye(o,n){if(1&o&&e._UZ(0,"p-sortIcon",11),2&o){const t=e.oxw().$implicit;e.Q6J("field",t.field)}}function S(o,n){if(1&o&&(e.TgZ(0,"th",9),e._uU(1),e.YNc(2,ye,1,1,"p-sortIcon",10),e.qZA()),2&o){const t=n.$implicit;e.Q6J("pSortableColumn",t.field),e.xp6(1),e.hij(" ",t.header," "),e.xp6(1),e.Q6J("ngIf",!t.isActions)}}function De(o,n){if(1&o&&(e.TgZ(0,"tr"),e.YNc(1,S,3,3,"th",8),e.qZA()),2&o){const t=n.$implicit;e.xp6(1),e.Q6J("ngForOf",t)}}function we(o,n){if(1&o&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&o){const t=e.oxw(3).$implicit,i=e.oxw().$implicit;e.xp6(1),e.Oqu(i[t.field].nombre)}}function Me(o,n){if(1&o&&(e.ynx(0),e.TgZ(1,"span",18),e._uU(2,"Punto de Venta"),e.qZA(),e.YNc(3,we,2,1,"span",14),e.BQk()),2&o){const t=e.oxw(2).$implicit,i=e.oxw().$implicit;e.xp6(3),e.Q6J("ngIf",i[t.field])}}function qe(o,n){if(1&o&&(e.ynx(0),e._uU(1),e.BQk()),2&o){const t=e.oxw(2).$implicit,i=e.oxw().$implicit;e.xp6(1),e.hij(" ",i[t.field]," ")}}function ee(o,n){1&o&&(e.ynx(0),e.YNc(1,Me,4,1,"ng-container",16),e.YNc(2,qe,2,1,"ng-container",17),e.BQk()),2&o&&(e.xp6(1),e.Q6J("ngSwitchCase","puntoVenta"))}function Le(o,n){if(1&o&&(e.ynx(0,19),e.TgZ(1,"span",18),e._uU(2,"Acciones"),e.qZA(),e._UZ(3,"button",20),e.BQk()),2&o){const t=e.oxw(2).$implicit,i=e.oxw();e.xp6(3),e.Q6J("routerLink",i.linkUpdate(t.id))}}function ft(o,n){if(1&o&&(e.TgZ(0,"td",13),e.YNc(1,ee,3,1,"ng-container",14),e.YNc(2,Le,4,1,"ng-container",15),e.qZA()),2&o){const t=n.$implicit;e.Q6J("ngSwitch",t.field),e.xp6(1),e.Q6J("ngIf",!t.isActions),e.xp6(1),e.Q6J("ngIf",t.isActions)}}function ht(o,n){if(1&o&&(e.TgZ(0,"tr"),e.YNc(1,ft,3,3,"td",12),e.qZA()),2&o){const t=n.columns;e.xp6(1),e.Q6J("ngForOf",t)}}function vt(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",21),e.TgZ(1,"button",22),e.NdJ("click",function(){return e.CHM(t),e.oxw().new()}),e.qZA(),e.qZA()}}let bt=(()=>{class o{constructor(t,i,s,d){this.route=t,this.router=i,this.restaurantService=s,this.breadcrumbService=d,this.perPage=10}ngOnInit(){this.breadcrumbService.setItems((0,l.kn)(this.route)),this.cols=[{field:"puntoVenta",header:"Punto de venta"},{field:"nombre",header:"Nombre"},{header:"Acciones",isActions:!0}]}new(){this.router.navigateByUrl("/restaurante/salones/nuevo")}loadLazy(t){const s=["pageNumber="+t.first/this.perPage,`perPage=${t.rows}`];t.sortOrder&&s.push(`sortOrder=${t.sortOrder}`),t.sortField&&s.push(`sortField=${t.sortField}`),t.filters.global&&s.push(`filterGlobal=${t.filters.global.value}`),this.restaurantService.findAllLounges(s.join("&")).subscribe(d=>{this.totalRecords=d.totalElements,this.dataList=d.content})}linkUpdate(t){return`/restaurante/salones/editar/${t}`}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(D.gz),e.Y36(D.F0),e.Y36(u.T),e.Y36(Z.p))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-salones"]],decls:10,vars:8,consts:[[1,"grid"],[1,"col-12"],["type","text","pInputText","","size","32","placeholder","Buscar por Punto de Venta o Nombre",1,"derecha",2,"width","auto",3,"input"],["dataKey","id",3,"columns","value","lazy","paginator","rows","totalRecords","responsive","autoLayout","onLazyLoad"],["dt",""],["pTemplate","header"],["pTemplate","body"],["pTemplate","summary"],[3,"pSortableColumn",4,"ngFor","ngForOf"],[3,"pSortableColumn"],["ariaLabel","Activa para ordenar","ariaLabelDesc","Activa para ordenar en orden descendente","ariaLabelAsc","Activa para ordenar en orden ascendente",3,"field",4,"ngIf"],["ariaLabel","Activa para ordenar","ariaLabelDesc","Activa para ordenar en orden descendente","ariaLabelAsc","Activa para ordenar en orden ascendente",3,"field"],[3,"ngSwitch",4,"ngFor","ngForOf"],[3,"ngSwitch"],[4,"ngIf"],["style","text-align: center",4,"ngIf"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"p-column-title"],[2,"text-align","center"],["pButton","","type","button","icon","pi pi-pencil","pTooltip","Actualizar, Eliminar",1,"p-button-success",3,"routerLink"],[2,"text-align","left"],["type","button","pButton","","icon","fa fa-plus","label","Nuevo",2,"margin-right","0.2rem",3,"click"]],template:function(t,i){if(1&t){const s=e.EpF();e.TgZ(0,"p-card"),e.TgZ(1,"div",0),e.TgZ(2,"div",1),e.TgZ(3,"input",2),e.NdJ("input",function(C){return e.CHM(s),e.MAs(6).filterGlobal(C.target.value,"contains")}),e.qZA(),e.qZA(),e.TgZ(4,"div",1),e.TgZ(5,"p-table",3,4),e.NdJ("onLazyLoad",function(C){return i.loadLazy(C)}),e.YNc(7,De,2,1,"ng-template",5),e.YNc(8,ht,2,1,"ng-template",6),e.YNc(9,vt,2,0,"ng-template",7),e.qZA(),e.qZA(),e.qZA(),e.qZA()}2&t&&(e.xp6(5),e.Q6J("columns",i.cols)("value",i.dataList)("lazy",!0)("paginator",!0)("rows",i.perPage)("totalRecords",i.totalRecords)("responsive",!0)("autoLayout",!0))},directives:[T.Z,O.o,A.iA,h.jx,v.sg,A.lQ,v.O5,A.fz,v.RF,v.n9,v.ED,a.Hq,r.u,D.rH],styles:[".derecha[_ngcontent-%COMP%]{float:right}"]}),o})();var f=b(93075),Re=b(30567),Je=b(96310),ze=b(6969),_e=b(20207),Ue=b(14036),Y=b(43724);function Ct(o,n){1&o&&e._UZ(0,"p-message",14)}function Tt(o,n){1&o&&e._UZ(0,"p-message",15)}function Zt(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",16),e.NdJ("click",function(){return e.CHM(t),e.oxw().confirmDelete()}),e.qZA()}}const At=function(){return{width:"100%"}};let Ge=(()=>{class o{constructor(t,i,s,d,C,w,F,N,J,xe){this.route=t,this.router=i,this.restaurantService=s,this.companyService=d,this.puntoVentaService=C,this.messageService=w,this.loginService=F,this.confirmationService=N,this.fb=J,this.breadcrumbService=xe,this.puntosVenta=[]}ngOnInit(){this.breadcrumbService.setItems((0,l.kn)(this.route)),this.builderForm(),this.loadData(),this.loadModel()}builderForm(){this.mf=this.fb.group({puntoVenta:[null,[f.kI.required]],nombre:["",[f.kI.required]]})}submitForm(){let t,i;this.formToModel(),this.isEdit?(t=this.restaurantService.updateLounge(this.model),i="Sal\xf3n actualizado correctamente."):(t=this.restaurantService.saveLounge(this.model),i="Sal\xf3n registrado correctamente."),t.subscribe(s=>{this.messageService.add({severity:"success",summary:"Mensaje",detail:i}),this.router.navigateByUrl(this.linkVolver)})}formToModel(){this.model||(this.model={}),this.model.puntoVenta=this.mf.value.puntoVenta,this.model.nombre=this.mf.value.nombre}modelToForm(t){this.mf.patchValue({puntoVenta:t.puntoVenta,nombre:t.nombre})}get textButtonAction(){return this.isEdit?"Actualizar":"Guardar"}get nameModulo(){return this.route.snapshot.data.title}loadModel(){this.isEdit=this.route.snapshot.data.isEdit,this.isEdit&&this.route.params.subscribe(t=>{this.restaurantService.findLoungeById(t.id).subscribe(s=>{s&&(this.model=s,this.modelToForm(s))})})}confirmDelete(){this.confirmationService.confirm({message:"Estas seguro de eliminar este registro?",accept:()=>{this.restaurantService.deleteLoungeById(this.model.id).subscribe(()=>{this.messageService.clear(),this.messageService.add({severity:"success",summary:"Mensaje",detail:"Registro eliminado correctamente"}),this.router.navigateByUrl(this.linkVolver)})},acceptLabel:"Si",rejectLabel:"No"})}loadData(){const t=[this.puntoVentaService.findAll("",this.loginService.getUser().empresa.id,!1)];(0,Re.D)(t).subscribe(i=>{this.puntosVenta=i[0]})}get linkVolver(){return"/restaurante/salones"}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(D.gz),e.Y36(D.F0),e.Y36(u.T),e.Y36(Je.J),e.Y36(ze.l),e.Y36(h.ez),e.Y36(_e.r),e.Y36(h.YP),e.Y36(f.qu),e.Y36(Z.p))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-salon"]],decls:19,vars:12,consts:[[1,"grid"],[1,"col-12"],["novalidate","",3,"formGroup","ngSubmit"],[1,"grid","form-group"],[1,"col-12","md:col-6"],[1,"label-form"],["formControlName","puntoVenta","placeholder","Seleccione...","optionLabel","nombre","id","puntoVenta",3,"options","showClear"],["severity","error","text","Seleccione un punto de venta",4,"ngIf"],["formControlName","nombre","id","nombre","type","text","pInputText","",2,"width","100%","margin-bottom","0.2em"],["severity","error","text","Ingrese nombre",4,"ngIf"],[1,"col-12",2,"text-align","center"],["pButton","","type","submit",2,"margin-right","0.4rem",3,"disabled","label"],["style","margin-right: 0.4rem","pButton","","type","button","label","Eliminar","class","p-button-danger",3,"click",4,"ngIf"],["pButton","","type","button","label","Volver",1,"p-button-secondary",2,"margin-right","0.4rem",3,"routerLink"],["severity","error","text","Seleccione un punto de venta"],["severity","error","text","Ingrese nombre"],["pButton","","type","button","label","Eliminar",1,"p-button-danger",2,"margin-right","0.4rem",3,"click"]],template:function(t,i){1&t&&(e.TgZ(0,"p-card"),e.TgZ(1,"div",0),e.TgZ(2,"div",1),e.TgZ(3,"form",2),e.NdJ("ngSubmit",function(){return i.submitForm()}),e.TgZ(4,"div",3),e.TgZ(5,"div",4),e.TgZ(6,"label",5),e._uU(7,"Punto de venta (*)"),e.qZA(),e._UZ(8,"p-dropdown",6),e.YNc(9,Ct,1,0,"p-message",7),e.qZA(),e.TgZ(10,"div",4),e.TgZ(11,"label",5),e._uU(12,"Nombre (*)"),e.qZA(),e._UZ(13,"input",8),e.YNc(14,Tt,1,0,"p-message",9),e.qZA(),e.TgZ(15,"div",10),e._UZ(16,"button",11),e.YNc(17,Zt,1,0,"button",12),e._UZ(18,"button",13),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(3),e.Q6J("formGroup",i.mf),e.xp6(5),e.Akn(e.DdM(11,At)),e.Q6J("options",i.puntosVenta)("showClear",!0),e.xp6(1),e.Q6J("ngIf",i.mf.get("puntoVenta").touched&&(null==i.mf.get("puntoVenta").errors?null:i.mf.get("puntoVenta").errors.required)),e.xp6(5),e.Q6J("ngIf",i.mf.get("nombre").touched&&(null==i.mf.get("nombre").errors?null:i.mf.get("nombre").errors.required)),e.xp6(2),e.Q6J("disabled",!i.mf.valid)("label",i.textButtonAction),e.xp6(1),e.Q6J("ngIf",i.isEdit),e.xp6(1),e.Q6J("routerLink",i.linkVolver))},directives:[T.Z,f._Y,f.JL,f.sg,Ue.Lt,f.JJ,f.u,v.O5,Y.q,f.Fj,O.o,a.Hq,D.rH],styles:[""]}),o})();function xt(o,n){1&o&&e._UZ(0,"p-message",14)}function yt(o,n){1&o&&e._UZ(0,"p-message",15)}function Pt(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",16),e.NdJ("click",function(){return e.CHM(t),e.oxw().confirmDelete()}),e.qZA()}}const Dt=function(){return{width:"100%"}};let Xe=(()=>{class o{constructor(t,i,s,d,C,w,F,N,J,xe){this.route=t,this.router=i,this.restaurantService=s,this.companyService=d,this.puntoVentaService=C,this.messageService=w,this.loginService=F,this.confirmationService=N,this.fb=J,this.breadcrumbService=xe,this.salones=[]}ngOnInit(){this.breadcrumbService.setItems((0,l.kn)(this.route)),this.builderForm(),this.loadData(),this.loadModel()}builderForm(){this.mf=this.fb.group({salon:[null,[f.kI.required]],numero:["",[f.kI.required]]})}submitForm(){let t,i;this.formToModel(),this.isEdit?(t=this.restaurantService.updateTable(this.model),i="Sal\xf3n actualizado correctamente."):(t=this.restaurantService.saveTable(this.model),i="Sal\xf3n registrado correctamente."),t.subscribe(s=>{this.messageService.add({severity:"success",summary:"Mensaje",detail:i}),this.router.navigateByUrl(this.linkVolver)})}formToModel(){this.model||(this.model={}),this.model.salon=this.mf.value.salon,this.model.numero=this.mf.value.numero}modelToForm(t){this.mf.patchValue({salon:t.salon,numero:t.numero})}get textButtonAction(){return this.isEdit?"Actualizar":"Guardar"}get nameModulo(){return this.route.snapshot.data.title}loadModel(){this.isEdit=this.route.snapshot.data.isEdit,this.isEdit&&this.route.params.subscribe(t=>{this.restaurantService.findTableById(t.id).subscribe(s=>{s&&(this.model=s,this.modelToForm(s))})})}confirmDelete(){this.confirmationService.confirm({message:"Estas seguro de eliminar este registro?",accept:()=>{this.restaurantService.deleteTableById(this.model.id).subscribe(()=>{this.messageService.clear(),this.messageService.add({severity:"success",summary:"Mensaje",detail:"Registro eliminado correctamente"}),this.router.navigateByUrl(this.linkVolver)})},acceptLabel:"Si",rejectLabel:"No"})}loadData(){const t=[this.restaurantService.findAllLounges()];(0,Re.D)(t).subscribe(i=>{this.salones=i[0].map(s=>({label:`${s.nombre} (${s.puntoVenta.nombre})`,value:s}))})}get linkVolver(){return"/restaurante/mesas"}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(D.gz),e.Y36(D.F0),e.Y36(u.T),e.Y36(Je.J),e.Y36(ze.l),e.Y36(h.ez),e.Y36(_e.r),e.Y36(h.YP),e.Y36(f.qu),e.Y36(Z.p))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-mesa"]],decls:19,vars:12,consts:[[1,"grid"],[1,"col-12"],["novalidate","",3,"formGroup","ngSubmit"],[1,"grid","form-group"],[1,"col-12","md:col-6"],[1,"label-form"],["formControlName","salon","placeholder","Seleccione...","id","salon",3,"options","showClear"],["severity","error","text","Seleccione un sal\xf3n",4,"ngIf"],["formControlName","numero","id","numero","type","text","pInputText","",2,"width","100%","margin-bottom","0.2em"],["severity","error","text","Ingrese n\xfamero",4,"ngIf"],[1,"col-12",2,"text-align","center"],["pButton","","type","submit",2,"margin-right","0.4rem",3,"disabled","label"],["style","margin-right: 0.4rem","pButton","","type","button","label","Eliminar","class","p-button-danger",3,"click",4,"ngIf"],["pButton","","type","button","label","Volver",1,"p-button-secondary",2,"margin-right","0.4rem",3,"routerLink"],["severity","error","text","Seleccione un sal\xf3n"],["severity","error","text","Ingrese n\xfamero"],["pButton","","type","button","label","Eliminar",1,"p-button-danger",2,"margin-right","0.4rem",3,"click"]],template:function(t,i){1&t&&(e.TgZ(0,"p-card"),e.TgZ(1,"div",0),e.TgZ(2,"div",1),e.TgZ(3,"form",2),e.NdJ("ngSubmit",function(){return i.submitForm()}),e.TgZ(4,"div",3),e.TgZ(5,"div",4),e.TgZ(6,"label",5),e._uU(7,"Sal\xf3n (*)"),e.qZA(),e._UZ(8,"p-dropdown",6),e.YNc(9,xt,1,0,"p-message",7),e.qZA(),e.TgZ(10,"div",4),e.TgZ(11,"label",5),e._uU(12,"N\xfamero (*)"),e.qZA(),e._UZ(13,"input",8),e.YNc(14,yt,1,0,"p-message",9),e.qZA(),e.TgZ(15,"div",10),e._UZ(16,"button",11),e.YNc(17,Pt,1,0,"button",12),e._UZ(18,"button",13),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(3),e.Q6J("formGroup",i.mf),e.xp6(5),e.Akn(e.DdM(11,Dt)),e.Q6J("options",i.salones)("showClear",!0),e.xp6(1),e.Q6J("ngIf",i.mf.get("salon").touched&&(null==i.mf.get("salon").errors?null:i.mf.get("salon").errors.required)),e.xp6(5),e.Q6J("ngIf",i.mf.get("numero").touched&&(null==i.mf.get("numero").errors?null:i.mf.get("numero").errors.required)),e.xp6(2),e.Q6J("disabled",!i.mf.valid)("label",i.textButtonAction),e.xp6(1),e.Q6J("ngIf",i.isEdit),e.xp6(1),e.Q6J("routerLink",i.linkVolver))},directives:[T.Z,f._Y,f.JL,f.sg,Ue.Lt,f.JJ,f.u,v.O5,Y.q,f.Fj,O.o,a.Hq,D.rH],styles:[""]}),o})(),wt=(()=>{class o{constructor(){}ngOnInit(){}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-restaurante"]],decls:1,vars:0,template:function(t,i){1&t&&e._UZ(0,"router-outlet")},directives:[D.lC],styles:[""]}),o})();var q=b(70655),y=b(85932),R=b(81575),k=b(8929),P=b(7625),re=b(24850),We=b(2994),$=b(66226),Q=b(13666),$e=b(18563),H=b(42064),Qe=b(51536),fe=b(17102);const qt=function(o,n,t,i,s){return{"table-box-free":o,"table-box-order":n,"table-box-paying":t,"table-box-prepared":i,"table-box-selected":s}};let Ot=(()=>{class o{constructor(){}ngOnInit(){}get tableBoxFree(){return!this.order}get existItemsPrepared(){return this.order.comandas.map(i=>i.items).reduce((i,s)=>i.concat(s)).filter(i=>"PREPARADO"===i.estadoComandaDetalle).length}get tableBoxOrder(){return this.order&&"PENDIENTE"===this.order.estado&&!this.existItemsPrepared}get tableBoxPrepared(){return this.order&&"PENDIENTE"===this.order.estado&&this.existItemsPrepared}get tableBoxPaying(){return this.order&&"PRECUENTA"===this.order.estado}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-mesa-item"]],inputs:{table:"table",order:"order",selected:"selected"},decls:5,vars:8,consts:[[1,"col-fixed","table-box","cursor-pointer",3,"ngClass"],[1,"grid","flex","align-items-center","justify-content-center",2,"height","100%"],[1,"col"],[1,"text-table-number"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"div",2),e.TgZ(3,"span",3),e._uU(4),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.Q6J("ngClass",e.qbA(2,qt,i.tableBoxFree,i.tableBoxOrder,i.tableBoxPaying,i.tableBoxPrepared,i.selected)),e.xp6(4),e.Oqu(i.table.numero))},directives:[v.mk],styles:['.with-out-table[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex-wrap:nowrap;justify-content:center;align-content:stretch;align-items:center}.table-box[_ngcontent-%COMP%]{margin:15px;width:80px;height:80px;text-align:center;border-radius:6px;color:#fff;box-shadow:inset 2px 2px 2px #fff6,inset -2px -2px 3px #0000001a,2px 2px 10px #0000001a;padding:.2em;cursor:pointer;border:1px solid #d6d6d6;background:#f4f4f4}.table-box-free[_ngcontent-%COMP%]{background:#afafaf}.table-box-wait[_ngcontent-%COMP%]{background:#ac0101}.table-box-order[_ngcontent-%COMP%]{background:#0094ff}.table-box-prepared[_ngcontent-%COMP%]{background:#f5b500}.table-box-paying[_ngcontent-%COMP%]{background:#076f00}.table-box-reserved[_ngcontent-%COMP%]{background:#610087}.table-box-selected[_ngcontent-%COMP%]{border:3px solid #26cf4d;opacity:1!important}.table-box-joined[_ngcontent-%COMP%]{width:70px}.text-table-number[_ngcontent-%COMP%]{font-size:20px;font-weight:700;line-height:20px}.ui-button-lightblue[_ngcontent-%COMP%]{background-color:#00dae4}.ui-button-lightblue[_ngcontent-%COMP%]:hover{background-color:#21b0e4}.joined-table-box[_ngcontent-%COMP%]{margin:0 .25em;padding:.25em .5em;display:inline-block;vertical-align:top;background-color:#d9edf7;border:1px solid #d9edf7;color:#31708f;border-radius:5px;width:60px;display:flex;flex-direction:row;flex-wrap:nowrap;justify-content:space-between;align-content:stretch;-webkit-align-items:flex-start;-ms-flex-align:start}.badge[_ngcontent-%COMP%]{padding:1px 5px}.tachado[_ngcontent-%COMP%]{text-decoration:line-through}.text-check-title[_ngcontent-%COMP%]{font-size:1.5em;font-weight:700}.money-option[_ngcontent-%COMP%]{box-shadow:inset 2px 2px 2px #fff6,inset -2px -2px 3px #0000001a,2px 2px 10px #0000001a;background-color:#0d7a8b;width:70px;height:35px;color:#fafcfe;display:flex;flex-direction:row;flex-wrap:nowrap;justify-content:center;align-content:stretch;align-items:center;cursor:pointer}.money-option[_ngcontent-%COMP%]:active{width:69px;height:34px}.money-option-text[_ngcontent-%COMP%]{order:0;flex:0 1 auto}.container-money[_ngcontent-%COMP%]{width:80px;text-align:center}.img-product[_ngcontent-%COMP%]{width:50px;height:50px;object-fit:cover;object-position:100% 0;border-radius:6px}.des-product[_ngcontent-%COMP%]{width:calc(100% - 60px)}.card-product[_ngcontent-%COMP%]{padding:.5em;box-shadow:0 4px 7.5px #0000001a;border-radius:6px;cursor:pointer}.flex-center-y[_ngcontent-%COMP%]{display:flex;align-items:center}.flex-direction-column[_ngcontent-%COMP%]{flex-direction:column}.btn[_ngcontent-%COMP%]{display:inline-block;position:relative;text-decoration:none;color:#0d9c00;width:50px;height:50px;border-radius:50%;text-align:center;background:#f7f7f7;box-shadow:inset 0 0 4px #00000014}.btn[_ngcontent-%COMP%]   .fa[_ngcontent-%COMP%]{position:absolute;content:"";width:40px;height:40px;line-height:40px;vertical-align:middle;left:5px;top:4px;border-radius:50%;font-size:15px;background-image:linear-gradient(#e8e8e8 0%,#d6d6d6 100%);text-shadow:1px 1px 1px rgba(255,255,255,.66);box-shadow:inset 0 2px #ffffff80,0 2px 2px #00000030;border-bottom:solid 2px #b5b5b5}.btn[_ngcontent-%COMP%]   .fa[_ngcontent-%COMP%]:active{background-image:-webkit-linear-gradient(#efefef 0%,#d6d6d6 100%);box-shadow:inset 0 1px #ffffff80,0 2px 2px #00000030;border-bottom:solid 2px #d8d8d8}.categorySelected[_ngcontent-%COMP%]{font-weight:700}.linkCategory[_ngcontent-%COMP%]{cursor:pointer;margin:1em}']}),o})(),It=(()=>{class o{constructor(){}ngOnInit(){}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-leyenda-mesas"]],decls:19,vars:0,consts:[[1,"grid","flex","justify-content-center"],[1,"col-fixed",2,"width","85%"],[1,"col-12","xs:col-6","md:col-2"],[1,"leyend-box","leyend-box-free"],[1,"center","text-bold"],[1,"leyend-box","leyend-box-order"],[1,"leyend-box","leyend-box-prepared"],[1,"leyend-box","leyend-box-paying"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"div",0),e.TgZ(3,"div",2),e._UZ(4,"div",3),e.TgZ(5,"div",4),e._uU(6," LIBRE "),e.qZA(),e.qZA(),e.TgZ(7,"div",2),e._UZ(8,"div",5),e.TgZ(9,"div",4),e._uU(10," PEDIDO "),e.qZA(),e.qZA(),e.TgZ(11,"div",2),e._UZ(12,"div",6),e.TgZ(13,"div",4),e._uU(14," PREPARADO "),e.qZA(),e.qZA(),e.TgZ(15,"div",2),e._UZ(16,"div",7),e.TgZ(17,"div",4),e._uU(18," PAGANDO "),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA())},styles:[".leyend-box[_ngcontent-%COMP%]{height:15px;margin-left:10px;margin-right:10px;margin-bottom:2px}.leyend-box-free[_ngcontent-%COMP%]{background:#afafaf}.leyend-box-wait[_ngcontent-%COMP%]{background:#ac0101}.leyend-box-order[_ngcontent-%COMP%]{background:#0094ff}.leyend-box-prepared[_ngcontent-%COMP%]{background:#f5b500}.leyend-box-paying[_ngcontent-%COMP%]{background:#076f00}.leyend-box-reserved[_ngcontent-%COMP%]{background:#610087}.leyend-box-selected[_ngcontent-%COMP%]{border:3px solid #26cf4d;opacity:1!important}"]}),o})();function Et(o,n){1&o&&e._UZ(0,"p-message",10),2&o&&e.Q6J("text",n.$implicit)}function St(o,n){if(1&o&&(e.TgZ(0,"div",1),e.TgZ(1,"div",8),e.YNc(2,Et,1,1,"p-message",9),e.qZA(),e.qZA()),2&o){const t=e.oxw();e.xp6(2),e.Q6J("ngForOf",t.messagesWarn)}}function Nt(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"app-mesa-item",12),e.NdJ("click",function(){e.CHM(t);const s=e.oxw().$implicit;return e.oxw().selectTable(s)}),e.qZA()}if(2&o){const t=e.oxw().$implicit,i=e.oxw();e.Q6J("order",i.getOrderByTable(t))("selected",i.isTableSelected(t))("table",t)}}function kt(o,n){if(1&o&&(e.ynx(0),e.YNc(1,Nt,1,3,"app-mesa-item",11),e.BQk()),2&o){const t=n.$implicit,i=e.oxw();e.xp6(1),e.Q6J("ngIf",!i.isForChangeTable||!i.tableSelected||i.isForChangeTable&&i.tableSelected.id!==t.id)}}function Ft(o,n){1&o&&(e.TgZ(0,"div",4),e.TgZ(1,"div",13),e._UZ(2,"app-leyenda-mesas"),e.qZA(),e.qZA())}class j{constructor(n,t,i,s){this.restaurantService=n,this.store=t,this.eventBusService=i,this.socketIoService=s,this.unsubscribe$=new k.xQ,this.itemsLounges=[],this.tables=[],this.orders=[],this.messagesWarn=[]}ngOnInit(){this.puntoVenta$.pipe((0,P.R)(this.unsubscribe$)).subscribe(n=>{this.puntoVenta=n,this.loadLounges()}),this.tableTarget$.pipe((0,P.R)(this.unsubscribe$)).subscribe(n=>this.tableTargetSelected=n),this.table$.pipe((0,P.R)(this.unsubscribe$)).subscribe(n=>this.tableSelected=n),this.eventBusService.on("updateTables",()=>{this.loadTables()}),this.socketIoService.onEvent($e.T.COMMAND_RESTAURANT).pipe((0,P.R)(this.unsubscribe$)).subscribe(n=>{console.log("Evento comanda"),this.loadTables()})}ngOnDestroy(){this.unsubscribe$.next(),this.unsubscribe$.complete()}loadLounges(){this.restaurantService.findAllLounges(`idPuntoVenta=${this.puntoVenta.id}`).pipe((0,re.U)(n=>n.map(t=>({label:t.nombre,value:t.id}))),(0,We.b)(n=>this.itemLoungeSelected=n[0]?n[0].value:void 0)).subscribe(n=>{this.itemsLounges=n,this.loadTables()})}loadTables(){if(this.itemLoungeSelected){const t=[`idPuntoVenta=${this.puntoVenta.id}`,"tipo=LOCAL","estado=PENDIENTE","estado=PRECUENTA","estado=PREPARADO"];this.restaurantService.findAllTables([`idSalon=${this.itemLoungeSelected}`].join("&")).subscribe(i=>{i.forEach(s=>t.push(`idMesa=${s.id}`)),this.restaurantService.findAllOrder(t.join("&")).subscribe(s=>{this.orders=s,this.tables=i,this.messagesWarn=[];const d=(C,w)=>C.concat(w);this.orders.forEach(C=>{"PRECUENTA"===C.estado&&C.mesa&&C.comandas.map(w=>w.items).reduce(d,[]).find(w=>!w.cuenta)&&this.messagesWarn.push(`Advertencia: La mesa ${C.mesa.numero}, tiene pedidos sin pre cuenta y/o sin pagar.`),C.comandas.map(w=>w.items).reduce(d,[]).filter(w=>"CANCELADO"!==w.estadoComandaDetalle).length||this.messagesWarn.push(`Advertencia: Todos los pedidos de la mesa ${C.mesa.numero}, se encuentran anulados.`)})}),this.isForChangeTable?this.store.dispatch(new Q.iS(void 0)):(this.store.dispatch(new Q.m8(void 0)),this.store.dispatch(new Q.uh(void 0)))})}}getOrderByTable(n){return this.orders.find(t=>t.mesa.id===n.id)}selectTable(n){this.isForChangeTable?this.store.dispatch(new Q.iS(n)):(this.store.dispatch(new Q.m8(n)),this.store.dispatch(new Q.uh(this.getOrderByTable(n))))}isTableSelected(n){return this.isForChangeTable&&this.tableTargetSelected&&this.tableTargetSelected.id===n.id||!this.isForChangeTable&&this.tableSelected&&this.tableSelected.id===n.id}}j.\u0275fac=function(n){return new(n||j)(e.Y36(u.T),e.Y36(y.yh),e.Y36(H.Y),e.Y36(Qe.l))},j.\u0275cmp=e.Xpm({type:j,selectors:[["app-comandero-mesas"]],inputs:{isForChangeTable:"isForChangeTable"},decls:8,vars:5,consts:[[1,"grid"],[1,"col-12","flex","align-items-center","justify-content-center"],[3,"options","ngModel","onChange","ngModelChange"],["class","col-12 flex align-items-center justify-content-center",4,"ngIf"],[1,"col-12"],[1,"grid","flex","align-items-center","justify-content-center",2,"margin-top","1rem"],[4,"ngFor","ngForOf"],["class","col-12",4,"ngIf"],[1,"m-1"],["severity","warn",3,"text",4,"ngFor","ngForOf"],["severity","warn",3,"text"],[3,"order","selected","table","click",4,"ngIf"],[3,"order","selected","table","click"],[1,"m-t-30"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"p-selectButton",2),e.NdJ("onChange",function(){return t.loadTables()})("ngModelChange",function(s){return t.itemLoungeSelected=s}),e.qZA(),e.qZA(),e.YNc(3,St,3,1,"div",3),e.TgZ(4,"div",4),e.TgZ(5,"div",5),e.YNc(6,kt,2,1,"ng-container",6),e.qZA(),e.qZA(),e.YNc(7,Ft,3,0,"div",7),e.qZA()),2&n&&(e.xp6(2),e.Q6J("options",t.itemsLounges)("ngModel",t.itemLoungeSelected),e.xp6(1),e.Q6J("ngIf",t.messagesWarn.length),e.xp6(3),e.Q6J("ngForOf",t.tables),e.xp6(1),e.Q6J("ngIf",!t.isForChangeTable))},directives:[fe.UN,f.JJ,f.On,v.O5,v.sg,Y.q,Ot,It],styles:[""]}),(0,q.gn)([(0,y.Ph)(R.Z.getOffice)],j.prototype,"puntoVenta$",void 0),(0,q.gn)([(0,y.Ph)($.Q.table)],j.prototype,"table$",void 0),(0,q.gn)([(0,y.Ph)($.Q.tableTarget)],j.prototype,"tableTarget$",void 0);var Pe=b(61715),he=b(1059),Oe=b(30643),L=b(45330),Ke=b(93011),et=b(93036),te=b(77121);function Mt(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",31),e.TgZ(1,"button",32),e.NdJ("click",function(){e.CHM(t);const s=e.oxw().$implicit;return e.oxw().expandCommandDetail(s)}),e.qZA(),e.qZA()}}function Lt(o,n){if(1&o&&(e.TgZ(0,"span",33),e._uU(1),e.qZA()),2&o){const t=e.oxw().$implicit,i=e.oxw();e.xp6(1),e.hij("(",i.getPreparaciones(t),")")}}function Rt(o,n){if(1&o&&(e.TgZ(0,"p",34),e._uU(1),e.qZA()),2&o){const t=n.$implicit;e.xp6(1),e.lnq(" ",t.cantidad,"x ",t.nombreGrupo,": ",t.nombreOpcion," ")}}function Jt(o,n){1&o&&e._UZ(0,"p-message",35)}function Ut(o,n){1&o&&e._UZ(0,"p-message",36)}const tt=function(o){return{tachado:o}};function $t(o,n){if(1&o&&(e.TgZ(0,"div",14),e.TgZ(1,"div",22),e.TgZ(2,"div",9),e.TgZ(3,"h3",7),e._uU(4),e.qZA(),e.qZA(),e.TgZ(5,"div",10),e.TgZ(6,"div",2),e.TgZ(7,"div",23),e.TgZ(8,"div",0),e.YNc(9,Mt,2,0,"div",24),e.TgZ(10,"div",10),e.TgZ(11,"h3",7),e._uU(12),e.YNc(13,Lt,2,1,"span",25),e.qZA(),e.YNc(14,Rt,2,3,"p",26),e.qZA(),e.qZA(),e.qZA(),e.TgZ(15,"div",12),e.TgZ(16,"div",13),e.TgZ(17,"h3",27),e._uU(18),e.ALo(19,"montoDinero"),e.qZA(),e.TgZ(20,"div",28),e.YNc(21,Jt,1,0,"p-message",29),e.YNc(22,Ut,1,0,"p-message",30),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&o){const t=n.$implicit,i=e.oxw();e.xp6(1),e.Q6J("dropData",t),e.xp6(3),e.Oqu(null==t?null:t.cantidad),e.xp6(3),e.Q6J("ngClass",e.VKq(14,tt,i.commandDetailInCheck(t))),e.xp6(2),e.Q6J("ngIf",i.dividir&&(null==t?null:t.cantidad)>1),e.xp6(3),e.hij("",null==t||null==t.producto?null:t.producto.nombre," "),e.xp6(1),e.Q6J("ngIf",i.getPreparaciones(t).length),e.xp6(1),e.Q6J("ngForOf",t.grupoProductoOpciones),e.xp6(3),e.Q6J("ngClass",e.VKq(16,tt,i.commandDetailInCheck(t))),e.xp6(1),e.hij(" ",e.xi3(19,11,(null==t?null:t.precioVenta)*(null==t?null:t.cantidad),null==t||null==t.producto?null:t.producto.moneda)," "),e.xp6(3),e.Q6J("ngIf",(null==t?null:t.cuenta)&&(null==t||null==t.cuenta?null:t.cuenta.pagado)),e.xp6(1),e.Q6J("ngIf",(null==t?null:t.cuenta)&&!(null!=t&&null!=t.cuenta&&t.cuenta.pagado))}}function Qt(o,n){1&o&&(e.TgZ(0,"h3",7),e._uU(1,"TOTAL CUENTA:"),e.qZA())}function Yt(o,n){1&o&&(e.TgZ(0,"h3",7),e._uU(1,"TOTAL NUEVA CUENTA:"),e.qZA())}function Bt(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div"),e.TgZ(1,"p-button",45),e.NdJ("click",function(){e.CHM(t);const s=e.oxw().index;return e.oxw(2).removeCheck(s)}),e.qZA(),e.qZA()}}function Vt(o,n){1&o&&(e.TgZ(0,"tr"),e.TgZ(1,"th"),e._uU(2,"Cantidad"),e.qZA(),e.TgZ(3,"th"),e._uU(4,"Producto"),e.qZA(),e.TgZ(5,"th"),e._uU(6,"Total"),e.qZA(),e.TgZ(7,"th"),e._uU(8,"Quitar"),e.qZA(),e.qZA())}function Ht(o,n){if(1&o&&(e.TgZ(0,"span",33),e._uU(1),e.qZA()),2&o){const t=e.oxw().$implicit,i=e.oxw(3);e.xp6(1),e.hij("(",i.getPreparaciones(t),")")}}function jt(o,n){if(1&o&&(e.TgZ(0,"p",34),e._uU(1),e.qZA()),2&o){const t=n.$implicit;e.xp6(1),e.lnq(" ",t.cantidad,"x ",t.nombreGrupo,": ",t.nombreOpcion," ")}}function zt(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"tr"),e.TgZ(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e.TgZ(4,"h3",7),e._uU(5),e.YNc(6,Ht,2,1,"span",25),e.qZA(),e.YNc(7,jt,2,3,"p",26),e.qZA(),e.TgZ(8,"td"),e._uU(9),e.ALo(10,"montoDinero"),e.qZA(),e.TgZ(11,"td"),e.TgZ(12,"button",46),e.NdJ("click",function(){const d=e.CHM(t).$implicit,C=e.oxw().$implicit;return e.oxw(2).removeCommandDetail(d,C)}),e.qZA(),e.qZA(),e.qZA()}if(2&o){const t=n.$implicit,i=e.oxw(3);e.xp6(2),e.Oqu(null==t?null:t.cantidad),e.xp6(3),e.hij("",null==t||null==t.producto?null:t.producto.nombre," "),e.xp6(1),e.Q6J("ngIf",i.getPreparaciones(t).length),e.xp6(1),e.Q6J("ngForOf",t.grupoProductoOpciones),e.xp6(2),e.hij(" ",e.xi3(10,5,i.getTotalImporteItem(t),null==t||null==t.producto?null:t.producto.moneda)," ")}}function Gt(o,n){1&o&&(e.TgZ(0,"tr"),e.TgZ(1,"td"),e._UZ(2,"p-message",47),e.qZA(),e.qZA())}function Xt(o,n){if(1&o&&(e.TgZ(0,"div",2),e.TgZ(1,"div",9),e.TgZ(2,"h3",7),e._uU(3,"TOTAL:"),e.qZA(),e.qZA(),e.TgZ(4,"div",17),e.TgZ(5,"h3",13),e._uU(6),e.ALo(7,"montoDinero"),e.qZA(),e.qZA(),e.qZA()),2&o){const t=e.oxw().$implicit,i=e.oxw(2);e.xp6(6),e.Oqu(e.xi3(7,1,i.getTotal(t.items),"PEN"))}}function Wt(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",14),e.TgZ(1,"p-card"),e.TgZ(2,"div",37),e.NdJ("drop",function(s){const C=e.CHM(t).$implicit;return e.oxw(2).dropp(s.dropData,C)}),e.TgZ(3,"div",38),e.TgZ(4,"div"),e.TgZ(5,"h2"),e._uU(6),e.qZA(),e.qZA(),e.YNc(7,Bt,2,0,"div",39),e.qZA(),e.TgZ(8,"p-table",40),e.YNc(9,Vt,9,0,"ng-template",41),e.YNc(10,zt,13,8,"ng-template",42),e.YNc(11,Gt,3,0,"ng-template",43),e.YNc(12,Xt,8,4,"ng-template",44),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&o){const t=n.$implicit,i=n.index;e.xp6(6),e.hij("Cuenta ",i+1,""),e.xp6(1),e.Q6J("ngIf",i>1),e.xp6(1),e.Q6J("value",t.items)}}const ot=function(o,n){return{"col-12":o,"col-6":n}};function Kt(o,n){if(1&o&&(e.TgZ(0,"div",1),e.TgZ(1,"div",0),e.YNc(2,Wt,13,3,"div",15),e.qZA(),e.qZA()),2&o){const t=e.oxw();e.Q6J("ngClass",e.WLB(2,ot,!t.dividir,t.dividir)),e.xp6(2),e.Q6J("ngForOf",t.checks)}}const Ie=function(o,n){return{"col-4":o,"col-6":n}};function eo(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",20),e.TgZ(1,"button",48),e.NdJ("click",function(){return e.CHM(t),e.oxw().initChecks()}),e.qZA(),e.qZA()}if(2&o){const t=e.oxw();e.Q6J("ngClass",e.WLB(1,Ie,t.hasPermissionDeleteCheck,!t.hasPermissionDeleteCheck))}}function to(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",20),e.TgZ(1,"button",49),e.NdJ("click",function(){return e.CHM(t),e.oxw().addCheck()}),e.qZA(),e.qZA()}if(2&o){const t=e.oxw();e.Q6J("ngClass",e.WLB(1,Ie,t.hasPermissionDeleteCheck,!t.hasPermissionDeleteCheck))}}function oo(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",51),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).deleteCheckOrder()}),e.qZA()}}function no(o,n){if(1&o&&(e.TgZ(0,"div",20),e.YNc(1,oo,1,0,"button",50),e.qZA()),2&o){const t=e.oxw();e.Q6J("ngClass",e.WLB(2,Ie,t.hasPermissionDeleteCheck,!t.hasPermissionDeleteCheck)),e.xp6(1),e.Q6J("appPermission","RESTAURANTE_CUENTA_ELIMINAR")}}class z{constructor(n,t,i,s,d,C,w,F,N){this.restaurantService=n,this.store=t,this.checkService=i,this.ref=s,this.dialogConfig=d,this.confirmationService=C,this.eventBusService=w,this.messageService=F,this.loginService=N,this.unsubscribe$=new k.xQ,this.checks=[],this.configCompany={}}ngOnInit(){this.configCompany$.pipe((0,P.R)(this.unsubscribe$)).subscribe(n=>{this.configCompany=n}),this.table$.pipe((0,P.R)(this.unsubscribe$)).subscribe(n=>this.tableSelected=n),this.order$.pipe((0,P.R)(this.unsubscribe$)).subscribe(n=>this.orderSelected=n),this.estacionVenta$.pipe((0,P.R)(this.unsubscribe$)).subscribe(n=>{this.estacionVenta=n}),this.dividir=this.dialogConfig.data.dividir,this.dividir&&this.initChecks()}initChecks(){this.dividir=!0,this.checks=[{cliente:this.orderSelected.cliente,items:[]},{cliente:this.orderSelected.cliente,items:[]}]}dropp(n,t){this.commandDetailInCheck(n)||t.items.push(n)}addCheck(){this.checks.push({cliente:this.orderSelected.cliente,items:[]})}removeCommandDetail(n,t){const i=t.items.findIndex(s=>s.id===n.id);t.items.splice(i,1)}removeCheck(n){this.checks.splice(n,1)}ngOnDestroy(){this.unsubscribe$.next(),this.unsubscribe$.complete()}commandDetailInCheck(n){return!!this.checks.map(i=>i.items).reduce((i,s)=>i.concat(s),[]).find(i=>i.id===n.id)||n.cuenta}get hasPermissionDeleteCheck(){return this.loginService.hasPermission("RESTAURANTE_CUENTA_ELIMINAR")}get total(){return this.commandDetails.filter(n=>!n.cuenta).map(n=>{let t=n.precioVenta;return n.producto.recargoConsumo&&(t+=t/(this.configCompany.igv+1)*n.producto.recargoConsumo/100),t*n.cantidad}).reduce(l.IH,0)}get existAnyCheck(){return this.commandDetails.find(n=>n.cuenta)}getTotal(n){return n.map(t=>{let i=t.precioVenta;return t.producto.recargoConsumo&&(i+=i/(this.configCompany.igv+1)*t.producto.recargoConsumo/100),i*t.cantidad}).reduce(l.IH,0)}getTotalImporteItem(n){let t=n.precioVenta;return n.producto.recargoConsumo&&(t+=t/(this.configCompany.igv+1)*n.producto.recargoConsumo/100),t*n.cantidad}get commandDetails(){return this.orderSelected.comandas.map(t=>t.items.filter(i=>"CANCELADO"!==i.estadoComandaDetalle)).reduce((t,i)=>t.concat(i))}getPreparaciones(n){return n.preparacionProductoOpciones.map(t=>`${t.nombrePreparacion}: ${t.nombreOpcion}`).join(", ")}generateCheck(){this.confirmationService.confirm({message:"\xbfEst\xe1 seguro de finalizar la cuenta?",accept:()=>{let n=this.checks.filter(t=>t.items.length);this.dividir||(n=[{cliente:this.orderSelected.cliente,items:[]}]),this.restaurantService.saveChecks(this.orderSelected.id,n).subscribe(t=>{this.ref.close(t)})},acceptLabel:"Si",rejectLabel:"No"})}deleteCheckOrder(){this.confirmationService.confirm({message:"Est\xe1 seguro de eliminar las pre cuentas generadas?",accept:()=>{this.restaurantService.deleteOrderCheck(this.orderSelected.id).subscribe(()=>{this.eventBusService.emit({name:"updateTables",value:!0}),this.ref.close()})},acceptLabel:"Si",rejectLabel:"No"})}expandCommandDetail(n){this.confirmationService.confirm({message:`\xbfEst\xe1 seguro de separar este item en ${n.cantidad} items?`,accept:()=>{this.restaurantService.expandCommandDetail(n.id).subscribe(()=>{this.restaurantService.findOrderById(this.orderSelected.id).subscribe(t=>this.store.dispatch(new Q.uh(t)))})},acceptLabel:"Si",rejectLabel:"No"})}}z.\u0275fac=function(n){return new(n||z)(e.Y36(u.T),e.Y36(y.yh),e.Y36(Oe._),e.Y36(L.E7),e.Y36(L.S),e.Y36(h.YP),e.Y36(H.Y),e.Y36(h.ez),e.Y36(_e.r))},z.\u0275cmp=e.Xpm({type:z,selectors:[["app-comandero-cerrar-cuenta"]],decls:42,vars:20,consts:[[1,"grid"],[3,"ngClass"],[1,"grid","p-nogutter"],[1,"col-12","cabecera-comanda-registro",2,"padding","10px"],[1,"col-fixed",2,"width","25px"],["src","assets/resources/images/desk.svg","alt","",2,"width","100%"],[1,"col",2,"padding-left","10px"],[2,"margin","0"],[1,"col-12","cabecera-comanda-registro-definicion"],[1,"col-fixed",2,"width","70px","padding","10px"],[1,"col"],[1,"col-8",2,"padding","10px"],[1,"col-4",2,"padding","10px"],[2,"margin","0","text-align","right"],[1,"col-12"],["class","col-12",4,"ngFor","ngForOf"],["style","margin: 0;",4,"ngIf"],[1,"col",2,"padding","10px"],[3,"ngClass",4,"ngIf"],["class","p-fluid",3,"ngClass",4,"ngIf"],[1,"p-fluid",3,"ngClass"],["type","button","pButton","","label","Finalizar",1,"p-button-success",3,"click"],["mwlDraggable","",1,"grid","p-nogutter","detalle-comanda-registro","cursor-pointer",3,"dropData"],[1,"col-8",2,"padding","10px",3,"ngClass"],["class","col-fixed","style","width: 45px;",4,"ngIf"],["style","color: #bababa",4,"ngIf"],["class","mt-0 mb-0",4,"ngFor","ngForOf"],[1,"m-0",3,"ngClass"],[1,"mt-1"],["severity","success","text","Pagado",4,"ngIf"],["severity","warn","text","Por pagar",4,"ngIf"],[1,"col-fixed",2,"width","45px"],["pButton","","type","button","icon","pi pi-angle-double-down","pTooltip","Separar items",1,"m-1",3,"click"],[2,"color","#bababa"],[1,"mt-0","mb-0"],["severity","success","text","Pagado"],["severity","warn","text","Por pagar"],["mwlDroppable","","dragOverClass","flash",3,"drop"],[1,"flex","justify-content-between"],[4,"ngIf"],[3,"value"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["pTemplate","summary"],["label","Eliminar cuenta","styleClass","p-button-link",3,"click"],["pButton","","type","button","icon","pi pi-trash","pTooltip","Quitar",1,"p-button-danger","ml-1","mr-1",3,"click"],["severity","info","text","Arrastre aqu\xed."],["type","button","pButton","","label","Dividir",3,"click"],["type","button","pButton","","label","Agregar cuenta",3,"click"],["type","button","pButton","","label","Eliminar pre cuentas","class","p-button-warning",3,"click",4,"appPermission"],["type","button","pButton","","label","Eliminar pre cuentas",1,"p-button-warning",3,"click"]],template:function(n,t){1&n&&(e.TgZ(0,"p-card"),e.TgZ(1,"div",0),e.TgZ(2,"div",1),e.TgZ(3,"div",2),e.TgZ(4,"div",3),e.TgZ(5,"div",2),e.TgZ(6,"div",4),e._UZ(7,"img",5),e.qZA(),e.TgZ(8,"div",6),e.TgZ(9,"h1",7),e._uU(10),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(11,"div",8),e.TgZ(12,"div",2),e.TgZ(13,"div",9),e.TgZ(14,"h3",7),e._uU(15,"CANT."),e.qZA(),e.qZA(),e.TgZ(16,"div",10),e.TgZ(17,"div",2),e.TgZ(18,"div",11),e.TgZ(19,"h3",7),e._uU(20,"DESCRIPCI\xd3N."),e.qZA(),e.qZA(),e.TgZ(21,"div",12),e.TgZ(22,"h3",13),e._uU(23,"IMPORTE"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(24,"div",14),e.TgZ(25,"div",2),e.YNc(26,$t,23,18,"div",15),e.qZA(),e.qZA(),e.TgZ(27,"div",8),e.TgZ(28,"div",2),e.TgZ(29,"div",9),e.YNc(30,Qt,2,0,"h3",16),e.YNc(31,Yt,2,0,"h3",16),e.qZA(),e.TgZ(32,"div",17),e.TgZ(33,"h3",13),e._uU(34),e.ALo(35,"montoDinero"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.YNc(36,Kt,3,5,"div",18),e.YNc(37,eo,2,4,"div",19),e.YNc(38,to,2,4,"div",19),e.TgZ(39,"div",20),e.TgZ(40,"button",21),e.NdJ("click",function(){return t.generateCheck()}),e.qZA(),e.qZA(),e.YNc(41,no,2,5,"div",19),e.qZA(),e.qZA()),2&n&&(e.xp6(2),e.Q6J("ngClass",e.WLB(14,ot,!t.dividir,t.dividir)),e.xp6(8),e.hij("MESA: ",null==t.tableSelected?null:t.tableSelected.numero,""),e.xp6(16),e.Q6J("ngForOf",t.commandDetails),e.xp6(4),e.Q6J("ngIf",!t.existAnyCheck),e.xp6(1),e.Q6J("ngIf",t.existAnyCheck),e.xp6(3),e.Oqu(e.xi3(35,11,t.total,"PEN")),e.xp6(2),e.Q6J("ngIf",t.dividir),e.xp6(1),e.Q6J("ngIf",!t.dividir),e.xp6(1),e.Q6J("ngIf",t.dividir),e.xp6(1),e.Q6J("ngClass",e.WLB(17,Ie,t.hasPermissionDeleteCheck,!t.hasPermissionDeleteCheck)),e.xp6(2),e.Q6J("ngIf","PRECUENTA"===t.orderSelected.estado))},directives:[T.Z,v.mk,v.sg,Ke.pD,v.O5,a.Hq,r.u,Y.q,Ke.D5,a.zx,A.iA,h.jx,et.l],pipes:[te.Z],styles:[".cabecera-comanda-registro[_ngcontent-%COMP%]{background-color:#616161;color:#ececec;border:1px solid #d7d7d7}.cabecera-comanda-registro-definicion[_ngcontent-%COMP%]{background-color:#616161;color:#ececec;border-bottom:1px solid #d7d7d7;border-left:1px solid #d7d7d7;border-right:1px solid #d7d7d7}.detalle-comanda-registro[_ngcontent-%COMP%]{border-bottom:1px solid #d7d7d7;border-left:1px solid #d7d7d7;border-right:1px solid #d7d7d7}.tachado[_ngcontent-%COMP%]{text-decoration:line-through}.flash[_ngcontent-%COMP%]{animation-name:flash;animation-duration:1s;animation-fill-mode:both}@keyframes flash{0%,50%,to{opacity:1}25%,75%{opacity:0}}"]}),(0,q.gn)([(0,y.Ph)($.Q.table)],z.prototype,"table$",void 0),(0,q.gn)([(0,y.Ph)($.Q.order)],z.prototype,"order$",void 0),(0,q.gn)([(0,y.Ph)(R.Z.getSaleStation)],z.prototype,"estacionVenta$",void 0),(0,q.gn)([(0,y.Ph)(R.Z.getConfig)],z.prototype,"configCompany$",void 0);var io=b(51420),ve=b(20657);const ao=["quantityInput"];function ro(o,n){1&o&&(e.ynx(0),e._uU(1,"anular"),e.BQk())}function so(o,n){1&o&&e._uU(0,"servir")}let lo=(()=>{class o{constructor(t,i){this.config=t,this.ref=i}ngOnInit(){this.quantity=this.originalQuantity,this.selectInput()}get typeOperationStatus(){return this.config.data.status}get originalQuantity(){return this.config.data.quantity}selectInput(){setTimeout(()=>{const t=this.inputOne.nativeElement;t.focus(),t.select()},30)}changeQuantity(t){"sum"===t?this.quantity++:this.quantity--}save(){this.ref.close(this.quantity)}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(L.S),e.Y36(L.E7))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-modal-anular-pedido-item"]],viewQuery:function(t,i){if(1&t&&e.Gf(ao,5),2&t){let s;e.iGM(s=e.CRH())&&(i.inputOne=s.first)}},decls:14,vars:5,consts:[[1,"p-grid"],[1,"col"],[4,"ngIf","ngIfElse"],["servir",""],[1,"p-inputgroup"],["type","button","pButton","","icon","pi pi-minus",3,"disabled","click"],["pKeyFilter","num","type","text","pInputText","",2,"width","100%",3,"ngModel","ngModelChange"],["quantityInput",""],["type","button","pButton","","icon","pi pi-plus",3,"disabled","click"],[1,"col","right"],["type","button","pButton","","icon","pi pi-check","label","Aceptar",3,"click"]],template:function(t,i){if(1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"p"),e._uU(3,"Platillos a "),e.YNc(4,ro,2,0,"ng-container",2),e.YNc(5,so,1,0,"ng-template",null,3,e.W1O),e.qZA(),e.TgZ(7,"div",4),e.TgZ(8,"button",5),e.NdJ("click",function(){return i.changeQuantity("subs")}),e.qZA(),e.TgZ(9,"input",6,7),e.NdJ("ngModelChange",function(d){return i.quantity=d}),e.qZA(),e.TgZ(11,"button",8),e.NdJ("click",function(){return i.changeQuantity("sum")}),e.qZA(),e.qZA(),e.qZA(),e.TgZ(12,"div",9),e.TgZ(13,"button",10),e.NdJ("click",function(){return i.save()}),e.qZA(),e.qZA(),e.qZA()),2&t){const s=e.MAs(6);e.xp6(4),e.Q6J("ngIf","CANCELADO"===i.typeOperationStatus)("ngIfElse",s),e.xp6(4),e.Q6J("disabled",1===i.quantity),e.xp6(1),e.Q6J("ngModel",i.quantity),e.xp6(2),e.Q6J("disabled",i.originalQuantity===i.quantity)}},directives:[v.O5,a.Hq,f.Fj,ve.Fr,O.o,f.JJ,f.On],styles:[""]}),o})();const co=["addresstext"],po=["map"];let uo=(()=>{class o{constructor(){this.marker$=new k.xQ,this.showInput=!0,this.setAddress=new e.vpe,this.changeDirection=new e.vpe,this.onChange=t=>{},this.onTouched=t=>{}}ngOnInit(){}ngAfterViewInit(){this.getPlaceAutocomplete()}ngOnChanges(t){this.marker$.next(t.initalMarker.currentValue)}ngOnDestroy(){this.marker$.unsubscribe()}getPlaceAutocomplete(){const t={center:new google.maps.LatLng(-12.048981,-77.042691),zoom:13,mapTypeId:google.maps.MapTypeId.ROADMAP};this.map=new google.maps.Map(this.mapElement.nativeElement,t);const i=new google.maps.places.Autocomplete(this.addresstext.nativeElement,{componentRestrictions:{country:"PE"},types:[this.adressType]});i.bindTo("bounds",this.map);const s=new google.maps.Marker({map:this.map,anchorPoint:new google.maps.Point(0,-29)});this.marker$.subscribe(d=>{s.setPosition(d),this.map.setCenter(d),this.map.setZoom(17),s.setVisible(!0)}),google.maps.event.addListener(i,"place_changed",()=>{const d=i.getPlace();s.setVisible(!1),d.geometry.viewport?this.map.fitBounds(d.geometry.viewport):(this.map.setCenter(d.geometry.location),this.map.setZoom(17)),s.setPosition(d.geometry.location),s.setVisible(!0),this.autocompleteInput=d.formatted_address,this.invokeEvent(d),this.propagateChange()}),this.initalMarker&&this.marker$.next(this.initalMarker)}invokeEvent(t){this.setAddress.emit(t)}propagateChange(){this.onChange(this.autocompleteInput),this.changeDirection.emit(this.autocompleteInput)}registerOnChange(t){this.onChange=t}registerOnTouched(t){this.onTouched=t}writeValue(t){this.autocompleteInput=t,this.onChange(t)}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-google-autocomplete-place"]],viewQuery:function(t,i){if(1&t&&(e.Gf(co,7),e.Gf(po,7)),2&t){let s;e.iGM(s=e.CRH())&&(i.addresstext=s.first),e.iGM(s=e.CRH())&&(i.mapElement=s.first)}},inputs:{adressType:"adressType",initalMarker:"initalMarker",showInput:"showInput"},outputs:{setAddress:"setAddress",changeDirection:"changeDirection"},features:[e._Bn([{provide:f.JU,useExisting:(0,e.Gpc)(()=>o),multi:!0}]),e.TTD],decls:4,vars:2,consts:[["name","autocompletePlace","type","text","pInputText","",2,"width","100%",3,"hidden","ngModel","input","ngModelChange"],["addresstext",""],[2,"width","100%","height","150px","margin-top","10px"],["map",""]],template:function(t,i){1&t&&(e.TgZ(0,"input",0,1),e.NdJ("input",function(){return i.propagateChange()})("ngModelChange",function(d){return i.autocompleteInput=d}),e.qZA(),e._UZ(2,"div",2,3)),2&t&&e.Q6J("hidden",!i.showInput)("ngModel",i.autocompleteInput)},directives:[f.Fj,O.o,f.JJ,f.On],styles:[""]}),o})();var Ee=b(15315);let se=(()=>{class o{transform(t,i){return t?(i||(i=8),t.toString().padStart(i,"000")):""}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275pipe=e.Yjl({name:"completarCeros",type:o,pure:!0}),o})(),nt=(()=>{class o{transform(t,i){return"LOCAL"===t?"Local":"PEDIDO_LOCAL"===t?"Para llevar":"PEDIDO_FORANEO"===t?"Delivery":"PEDIDO_ONLINE"===t?"Pedido online":""}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275pipe=e.Yjl({name:"tipoPedido",type:o,pure:!0}),o})(),it=(()=>{class o{transform(t,i){return"PENDIENTE_ACEPTACION"===t?"Pendiente de aceptaci\xf3n":"CANCELADO"===t?"Cancelado":"RECHAZADO"===t?"Rechazado":"ACEPTADO"===t?"Aceptado":""}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275pipe=e.Yjl({name:"estadoPedidoOnline",type:o,pure:!0}),o})(),Se=(()=>{class o{transform(t,i){return"PENDIENTE"===t?"Pendiente":"CANCELADO"===t?"Cancelado":"PRECUENTA"===t?"Pre cuenta":"PREPARADO"===t?"Preparado":"FINALIZADO"===t?"Finalizado":""}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275pipe=e.Yjl({name:"estadoPedidoRestaurante",type:o,pure:!0}),o})();function mo(o,n){if(1&o&&(e.TgZ(0,"div",12),e.TgZ(1,"p",22),e._uU(2,"Mesa: "),e.TgZ(3,"span",30),e._uU(4),e.qZA(),e.qZA(),e.qZA()),2&o){const t=e.oxw(2);e.xp6(4),e.Oqu(t.order.mesa.numero)}}function go(o,n){if(1&o&&(e.TgZ(0,"div",12),e.TgZ(1,"p",22),e._uU(2,"Nombre: "),e.TgZ(3,"span",30),e._uU(4),e.qZA(),e.qZA(),e.qZA()),2&o){const t=e.oxw(2);e.xp6(4),e.Oqu(t.order.cliente.razonSocial)}}function _o(o,n){if(1&o&&(e.TgZ(0,"div",12),e.TgZ(1,"p",22),e._uU(2,"Tel\xe9fono: "),e.TgZ(3,"span",30),e._uU(4),e.qZA(),e.qZA(),e.qZA()),2&o){const t=e.oxw(2);e.xp6(4),e.Oqu(t.order.cliente.telefono)}}function fo(o,n){if(1&o&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&o){const t=e.oxw(3);e.xp6(1),e.hij(" - Dpto. ",t.order.numeroDepartamento,"")}}function ho(o,n){if(1&o&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&o){const t=e.oxw(3);e.xp6(1),e.hij(" - (",t.order.referencia,")")}}function vo(o,n){if(1&o&&(e.TgZ(0,"div",27),e.TgZ(1,"p",22),e._uU(2,"Direcci\xf3n: "),e.TgZ(3,"span",30),e._uU(4),e.YNc(5,fo,2,1,"span",32),e.YNc(6,ho,2,1,"span",32),e.qZA(),e.qZA(),e.qZA()),2&o){const t=e.oxw(2);e.xp6(4),e.AsE("",t.order.direccionCompleta," #",t.order.numero," "),e.xp6(1),e.Q6J("ngIf",t.order.numeroDepartamento),e.xp6(1),e.Q6J("ngIf",t.order.referencia)}}function bo(o,n){if(1&o&&(e.TgZ(0,"div",12),e.TgZ(1,"p",22),e._uU(2,"Estado online: "),e.TgZ(3,"span",24),e._uU(4),e.ALo(5,"estadoPedidoOnline"),e.qZA(),e.qZA(),e.qZA()),2&o){const t=e.oxw(2);e.xp6(3),e.Q6J("ngClass",t.classBadgeStatusOrderOnline),e.xp6(1),e.hij(" ",e.lcZ(5,2,t.order.estadoOnline)," ")}}function Co(o,n){if(1&o&&(e.TgZ(0,"div",12),e.TgZ(1,"p",22),e._uU(2,"Forma de pago: "),e.TgZ(3,"span",23),e._uU(4),e.TgZ(5,"span"),e._uU(6),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&o){const t=e.oxw(2);e.xp6(4),e.hij(" ",t.order.formaPago," "),e.xp6(2),e.hij("(",t.order.nombreFormaPago,")")}}function To(o,n){if(1&o&&(e.TgZ(0,"div",33),e._UZ(1,"app-google-autocomplete-place",34),e.qZA()),2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("initalMarker",t.markerDirection)("showInput",!1)("ngModel",t.order.direccionCompleta)}}function Zo(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",35),e.TgZ(1,"button",36),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).openDialogAcceptOrder()}),e.qZA(),e.TgZ(2,"button",37),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).openDialogRejectOrder()}),e.qZA(),e.qZA()}}function Ao(o,n){if(1&o&&(e.TgZ(0,"span",56),e._uU(1),e.qZA()),2&o){const t=e.oxw().$implicit,i=e.oxw(3);e.xp6(1),e.hij("(",i.getPreparaciones(t),")")}}function xo(o,n){if(1&o&&(e.TgZ(0,"p",14),e._uU(1),e.qZA()),2&o){const t=n.$implicit;e.xp6(1),e.lnq(" ",t.cantidad,"x ",t.nombreGrupo,": ",t.nombreOpcion," ")}}function yo(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",57),e.TgZ(1,"img",58),e.NdJ("click",function(){e.CHM(t);const s=e.oxw().$implicit,d=e.oxw().$implicit;return e.oxw(2).changeStatusItem(d,s,"DESPACHADO")}),e.qZA(),e.qZA()}}function Po(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",57),e.TgZ(1,"img",59),e.NdJ("click",function(){e.CHM(t);const s=e.oxw(2).$implicit,d=e.oxw().$implicit;return e.oxw(2).changeStatusItem(d,s,"CANCELADO")}),e.qZA(),e.qZA()}}function Do(o,n){if(1&o&&(e.TgZ(0,"div"),e.YNc(1,Po,2,0,"div",49),e.qZA()),2&o){const t=e.oxw().$implicit,i=e.oxw(3);e.xp6(1),e.Q6J("ngIf","CANCELADO"!==t.estadoComandaDetalle&&!i.interfazEnvios)}}function wo(o,n){1&o&&e._UZ(0,"p-message",60)}function qo(o,n){1&o&&e._UZ(0,"p-message",61)}const Oo=function(o,n,t,i){return{"command-detail-prepared":o,"command-detail-preparation":n,"command-detail-dispatched":t,"command-detail-canceled":i}};function Io(o,n){if(1&o&&(e.TgZ(0,"div",27),e.TgZ(1,"div",45),e.TgZ(2,"div",40),e.TgZ(3,"h3",42),e._uU(4),e.qZA(),e.qZA(),e.TgZ(5,"div",3),e.TgZ(6,"div",38),e.TgZ(7,"div",46),e.TgZ(8,"div",38),e.TgZ(9,"div",3),e.TgZ(10,"h3",42),e._uU(11),e.YNc(12,Ao,2,1,"span",47),e.qZA(),e.YNc(13,xo,2,3,"p",48),e.qZA(),e.YNc(14,yo,2,0,"div",49),e.YNc(15,Do,2,1,"div",50),e.qZA(),e.qZA(),e.TgZ(16,"div",51),e.TgZ(17,"div",44),e.TgZ(18,"h3",52),e._uU(19),e.ALo(20,"montoDinero"),e.qZA(),e.TgZ(21,"div",53),e.YNc(22,wo,1,0,"p-message",54),e.YNc(23,qo,1,0,"p-message",55),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&o){const t=n.$implicit,i=e.oxw(3);e.xp6(1),e.Q6J("ngClass",e.l5B(13,Oo,i.estadoPreparadoItem(t),i.estadoPreparacionItem(t),i.estadoDespachadoItem(t),i.estadoCanceladoItem(t))),e.xp6(3),e.hij("",null==t?null:t.cantidad,"x"),e.xp6(7),e.hij("",null==t||null==t.producto?null:t.producto.nombre," "),e.xp6(1),e.Q6J("ngIf",i.getPreparaciones(t).length),e.xp6(1),e.Q6J("ngForOf",t.grupoProductoOpciones),e.xp6(1),e.Q6J("ngIf","PREPARADO"===t.estadoComandaDetalle&&"LOCAL"===i.order.tipo),e.xp6(1),e.Q6J("appPermission","RESTAURANTE_PEDIDOS_CANCELAR_PLATILLO"),e.xp6(4),e.hij(" ",e.xi3(20,10,(null==t?null:t.precioVenta)*(null==t?null:t.cantidad),null==t||null==t.producto?null:t.producto.moneda)," "),e.xp6(3),e.Q6J("ngIf",(null==t?null:t.cuenta)&&(null==t||null==t.cuenta?null:t.cuenta.pagado)),e.xp6(1),e.Q6J("ngIf",(null==t?null:t.cuenta)&&!(null!=t&&null!=t.cuenta&&t.cuenta.pagado))}}function Eo(o,n){if(1&o&&(e.TgZ(0,"div",27),e.TgZ(1,"p-card"),e.TgZ(2,"div",11),e.TgZ(3,"div",12),e.TgZ(4,"p",22),e._uU(5,"Comanda: "),e.TgZ(6,"span",30),e._uU(7),e.qZA(),e.qZA(),e.qZA(),e.TgZ(8,"div",12),e.TgZ(9,"p",22),e._uU(10,"Fecha: "),e.TgZ(11,"span",30),e._uU(12),e.ALo(13,"date"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(14,"div",27),e.TgZ(15,"div",38),e.TgZ(16,"div",39),e.TgZ(17,"div",38),e._UZ(18,"div",40),e.TgZ(19,"div",3),e.TgZ(20,"div",38),e.TgZ(21,"div",41),e.TgZ(22,"h3",42),e._uU(23,"DESCRIPCI\xd3N."),e.qZA(),e.qZA(),e.TgZ(24,"div",43),e.TgZ(25,"h3",44),e._uU(26,"IMPORTE"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(27,"div",27),e.TgZ(28,"div",38),e.YNc(29,Io,24,18,"div",29),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&o){const t=n.$implicit;e.xp6(7),e.hij("#",t.orden,""),e.xp6(5),e.Oqu(e.xi3(13,3,t.fecha,"dd/MM/yyyy hh:mm a")),e.xp6(17),e.Q6J("ngForOf",t.items)}}function So(o,n){if(1&o&&(e.TgZ(0,"div",12),e.TgZ(1,"p",22),e._uU(2,"Monto delivery: "),e.TgZ(3,"span",30),e._uU(4),e.ALo(5,"montoDinero"),e.qZA(),e.qZA(),e.qZA()),2&o){const t=e.oxw(2);e.xp6(4),e.Oqu(e.xi3(5,1,t.order.montoDelivery,"PEN"))}}function No(o,n){1&o&&e._UZ(0,"img",70)}function ko(o,n){1&o&&e._UZ(0,"img",71)}function Fo(o,n){1&o&&e._UZ(0,"img",72)}function Mo(o,n){if(1&o&&(e.TgZ(0,"div",62),e.TgZ(1,"div",63),e.TgZ(2,"div",64),e._UZ(3,"img",65),e.qZA(),e.TgZ(4,"div",66),e.YNc(5,No,1,0,"img",67),e.YNc(6,ko,1,0,"img",68),e.YNc(7,Fo,1,0,"img",69),e.qZA(),e.qZA(),e.qZA()),2&o){const t=e.oxw(2);e.xp6(4),e.Q6J("pTooltip",t.descripcionEnvio),e.xp6(1),e.Q6J("ngIf","PENDIENTE"===t.order.envio.estado),e.xp6(1),e.Q6J("ngIf","ENVIADO"===t.order.envio.estado),e.xp6(1),e.Q6J("ngIf","ENTREGADO"===t.order.envio.estado)}}function Lo(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",77),e.NdJ("click",function(){return e.CHM(t),e.oxw(4).cancelOrder()}),e.qZA()}}function Ro(o,n){1&o&&(e.ynx(0),e.YNc(1,Lo,1,0,"button",76),e.BQk()),2&o&&(e.xp6(1),e.Q6J("appPermission","RESTAURANTE_PEDIDOS_ANULAR"))}function Jo(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",79),e.NdJ("click",function(){return e.CHM(t),e.oxw(4).deleteCheckOrder()}),e.qZA()}}function Uo(o,n){1&o&&e.YNc(0,Jo,1,0,"button",78),2&o&&e.Q6J("appPermission","RESTAURANTE_CUENTA_ELIMINAR")}function $o(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",80),e.NdJ("click",function(){return e.CHM(t),e.oxw(3).generateTicket()}),e.qZA()}}function Qo(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",81),e.NdJ("click",function(){return e.CHM(t),e.oxw(3).markReadyFor()}),e.qZA()}}function Yo(o,n){if(1&o&&(e.TgZ(0,"div",35),e.YNc(1,Ro,2,1,"ng-container",32),e.YNc(2,Uo,1,1,"ng-template",73),e.YNc(3,$o,1,0,"button",74),e.YNc(4,Qo,1,0,"button",75),e.qZA()),2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf","CANCELADO"!=t.order.estado),e.xp6(1),e.Q6J("ngIf","PRECUENTA"===t.order.estado),e.xp6(1),e.Q6J("ngIf",t.flagShowButtonGenerateTicket),e.xp6(1),e.Q6J("ngIf",t.flagShowButtonReadyFor)}}const Bo=function(o,n){return{"col-8":o,"col-12":n}};function Vo(o,n){if(1&o&&(e.TgZ(0,"div",11),e.TgZ(1,"div",12),e.TgZ(2,"div",13),e.TgZ(3,"div"),e.TgZ(4,"h3",14),e._uU(5),e.ALo(6,"completarCeros"),e._UZ(7,"span",15),e._UZ(8,"span",16),e.qZA(),e.qZA(),e.TgZ(9,"div"),e._uU(10),e.ALo(11,"date"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(12,"div",17),e._UZ(13,"span",18),e._uU(14),e.ALo(15,"async"),e.qZA(),e.TgZ(16,"div",19),e.TgZ(17,"div",11),e.YNc(18,mo,5,1,"div",20),e.YNc(19,go,5,1,"div",20),e.YNc(20,_o,5,1,"div",20),e.YNc(21,vo,7,4,"div",21),e.TgZ(22,"div",12),e.TgZ(23,"p",22),e._uU(24,"Tipo: "),e.TgZ(25,"span",23),e._uU(26),e.ALo(27,"tipoPedido"),e.qZA(),e.qZA(),e.qZA(),e.YNc(28,bo,6,4,"div",20),e.TgZ(29,"div",12),e.TgZ(30,"p",22),e._uU(31,"Estado en restaurante: "),e.TgZ(32,"span",24),e._uU(33),e.ALo(34,"estadoPedidoRestaurante"),e.qZA(),e.qZA(),e.qZA(),e.YNc(35,Co,7,2,"div",20),e.qZA(),e.qZA(),e.YNc(36,To,2,3,"div",25),e.YNc(37,Zo,3,0,"div",26),e.TgZ(38,"div",27),e.TgZ(39,"div",28),e.YNc(40,Eo,30,6,"div",29),e.qZA(),e.qZA(),e.TgZ(41,"div",12),e.TgZ(42,"p",22),e._uU(43,"Monto pedido: "),e.TgZ(44,"span",30),e._uU(45),e.ALo(46,"montoDinero"),e.qZA(),e.qZA(),e.qZA(),e.YNc(47,So,6,4,"div",20),e.TgZ(48,"div",27),e.YNc(49,Mo,8,4,"div",31),e.qZA(),e.YNc(50,Yo,5,4,"div",26),e.qZA()),2&o){const t=e.oxw();e.xp6(5),e.hij("Orden #",e.xi3(6,24,t.order.id,8)," "),e.xp6(2),e.Q6J("pTooltip",t.textTooltipIcon)("ngClass",t.icon),e.xp6(1),e.Q6J("pTooltip",t.textTooltipIconPay)("ngClass",t.iconPay),e.xp6(2),e.Oqu(e.xi3(11,27,t.order.fecha,"dd/MM/yyyy hh:mm a")),e.xp6(4),e.hij(" ",e.lcZ(15,30,t.timer$)," "),e.xp6(2),e.Q6J("ngClass",e.WLB(39,Bo,t.isDeliveryOrder,!t.isDeliveryOrder)),e.xp6(2),e.Q6J("ngIf","LOCAL"===t.order.tipo),e.xp6(1),e.Q6J("ngIf","PEDIDO_ONLINE"===t.order.tipo||"PEDIDO_LOCAL"===t.order.tipo||"PEDIDO_FORANEO"===t.order.tipo),e.xp6(1),e.Q6J("ngIf","PEDIDO_ONLINE"===t.order.tipo||"PEDIDO_LOCAL"===t.order.tipo||"PEDIDO_FORANEO"===t.order.tipo),e.xp6(1),e.Q6J("ngIf","PEDIDO_FORANEO"===t.order.tipo||"PEDIDO_ONLINE"===t.order.tipo),e.xp6(5),e.hij(" ",e.lcZ(27,32,t.order.tipo)," "),e.xp6(2),e.Q6J("ngIf","PEDIDO_ONLINE"===t.order.tipo),e.xp6(4),e.Q6J("ngClass",t.classBadgeStatusOrder),e.xp6(1),e.hij(" ",e.lcZ(34,34,t.order.estado)," "),e.xp6(2),e.Q6J("ngIf","PEDIDO_ONLINE"===t.order.tipo),e.xp6(1),e.Q6J("ngIf",t.isDeliveryOrder),e.xp6(1),e.Q6J("ngIf","PEDIDO_ONLINE"===t.order.tipo&&"PENDIENTE_ACEPTACION"===t.order.estadoOnline),e.xp6(3),e.Q6J("ngForOf",t.order.comandas),e.xp6(5),e.Oqu(e.xi3(46,36,t.order.montoPedido,"PEN")),e.xp6(2),e.Q6J("ngIf",t.order.montoDelivery),e.xp6(2),e.Q6J("ngIf",t.order.envio),e.xp6(1),e.Q6J("ngIf",!t.interfazEnvios)}}const at=function(){return{width:"30vw"}};class oe{constructor(n,t,i,s,d,C,w,F){this.ref=n,this.config=t,this.dialogService=i,this.restaurantService=s,this.confirmationService=d,this.messageService=C,this.eventBusService=w,this.router=F,this.unsubscribe$=new k.xQ,this.displayModalAcceptOrder=!1,this.displayModalRejectOrder=!1,this.configCompany={}}get order(){return this.config.data.order}get interfazEnvios(){return this.config.data.interfazEnvios}get isDeliveryOrder(){return("PEDIDO_FORANEO"===this.order.tipo||"PEDIDO_ONLINE"===this.order.tipo)&&this.order.latitud&&this.order.longitud}get textTooltipIcon(){if("PENDIENTE"===this.order.estado)return"Pedido no preparado";if("PREPARADO"===this.order.estado){if("PEDIDO_LOCAL"===this.order.tipo)return"Pedido listo para cobrar";if("PEDIDO_FORANEO"===this.order.tipo||"PEDIDO_ONLINE"===this.order.tipo)return"Pedido listo para enviar"}return""}get textTooltipIconPay(){return this.order.pagado?"Pedido pagado":"Pedido pendiente de pago"}get icon(){return"PENDIENTE"===this.order.estado?"fa-circle color-warning":"PREPARADO"===this.order.estado?"fa-check-circle color-success":""}get iconPay(){return this.order.pagado?"fa-money color-success":"fa-money color-warning"}get timer$(){return this.config.data.timer$}get classBadgeStatusOrder(){return"PENDIENTE"===this.order.estado?"status-warning":"CANCELADO"===this.order.estado?"status-danger":"PRECUENTA"===this.order.estado?"status-renewal":"PREPARADO"===this.order.estado?"status-info":"FINALIZADO"===this.order.estado?"status-success":""}get classBadgeStatusOrderOnline(){return"PENDIENTE_ACEPTACION"===this.order.estadoOnline?"status-warning":"ACEPTADO"===this.order.estadoOnline?"status-success":"status-danger"}get flagShowButtonReadyFor(){return"PEDIDO_LOCAL"===this.order.tipo||"PEDIDO_FORANEO"===this.order.tipo||"PEDIDO_ONLINE"===this.order.tipo&&"ACEPTADO"===this.order.estadoOnline}get flagShowButtonGenerateTicket(){return("PEDIDO_LOCAL"===this.order.tipo||"PEDIDO_FORANEO"===this.order.tipo||"PEDIDO_ONLINE"===this.order.tipo&&"ACEPTADO"===this.order.estadoOnline)&&!this.order.pagado&&1===this.order.cuentas.length}get descripcionEnvio(){return`Estado del env\xedo: ${this.order.envio.estado}`}ngOnInit(){this.markerDirection=new google.maps.LatLng(Number(this.order.latitud),Number(this.order.longitud)),this.puntoVenta$.pipe((0,P.R)(this.unsubscribe$)).subscribe(n=>{this.puntoVenta=n}),this.configCompany$.pipe((0,P.R)(this.unsubscribe$)).subscribe(n=>{this.configCompany=n})}ngOnDestroy(){this.unsubscribe$.next(),this.unsubscribe$.complete()}openDialogAcceptOrder(){this.displayModalAcceptOrder=!0}openDialogRejectOrder(){this.displayModalRejectOrder=!0}acceptOrder(){this.confirmationService.confirm({message:"Est\xe1 seguro de aceptar este pedido?",accept:()=>{const n=["estado=ACEPTADO"];n.push(`tiempoEntrega=${this.tiempoEntrega}`),this.restaurantService.updateStatusOnline(this.order.id,n.join("&")).subscribe(()=>{this.messageService.add({severity:"success",summary:"Aceptar pedido",detail:"Pedido aceptado correctamente."}),this.displayModalAcceptOrder=!1,this.ref.close(!0)})},acceptLabel:"Si",rejectLabel:"No"})}rejectOrder(){this.confirmationService.confirm({message:"Est\xe1 seguro de rechazar este pedido?",accept:()=>{const n=["estado=RECHAZADO"];n.push(`comentario=${this.comentario}`),this.restaurantService.updateStatusOnline(this.order.id,n.join("&")).subscribe(()=>{this.messageService.add({severity:"success",summary:"Rechazar pedido",detail:"Pedido rechazado correctamente."}),this.displayModalRejectOrder=!1,this.ref.close(!0)})},acceptLabel:"Si",rejectLabel:"No"})}generateTicket(){this.ref.close(),this.router.navigateByUrl(`/restaurante/cobrador/cuentas/cobrar/${this.order.cuentas[0].id}`)}markReadyFor(){this.confirmationService.confirm({message:"Est\xe1s seguro de finalizar el pedido?",accept:()=>{const n=["estado=FINALIZADO"];n.push(`comentario=${this.comentario}`),this.restaurantService.updateStatus(this.order.id,n.join("&")).subscribe(()=>{this.messageService.add({severity:"success",summary:"Finalizar pedido",detail:"El pedido finaliz\xf3 correctamente."}),this.displayModalRejectOrder=!1,this.ref.close(!0)})},acceptLabel:"Si",rejectLabel:"No"})}cancelOrder(){console.log("Cancelando pedido"),this.confirmationService.confirm({message:"Est\xe1 seguro de anular el pedido?",icon:"pi pi-exclamation-triangle",accept:()=>{this.restaurantService.updateStatus(this.order.id,"estado=CANCELADO").subscribe(n=>{this.eventBusService.emit({name:"updateTables",value:!0}),this.ref.close(!0),n.forEach(t=>{t.items&&t.items.length&&this.restaurantService.processCommand(t.comanda,this.puntoVenta,!0,t.items.map(i=>i.id),this.configCompany.imprimeTicketsEscPos)})})},acceptLabel:"Si",rejectLabel:"No"})}deleteCheckOrder(){this.confirmationService.confirm({message:"Est\xe1 seguro de eliminar las pre cuentas generadas?",accept:()=>{this.restaurantService.deleteOrderCheck(this.order.id).subscribe(()=>{this.eventBusService.emit({name:"updateTables",value:!0}),this.ref.close()})},acceptLabel:"Si",rejectLabel:"No"})}estadoPreparacionItem(n){return"PREPARACION"===n.estadoComandaDetalle}estadoPreparadoItem(n){return"PREPARADO"===n.estadoComandaDetalle}estadoDespachadoItem(n){return"DESPACHADO"===n.estadoComandaDetalle}estadoCanceladoItem(n){return"CANCELADO"===n.estadoComandaDetalle}getPreparaciones(n){return n.preparacionProductoOpciones.map(t=>`${t.nombrePreparacion}: ${t.nombreOpcion}`).join(", ")}changeStatusItem(n,t,i){let s="",d="";"DESPACHADO"===i&&(s="Est\xe1 seguro de servir el platillo?",d="Servir platillo"),"CANCELADO"===i&&(s="Est\xe1 seguro de cancelar el platillo?",d="Anular platillo");const C=w=>{this.restaurantService.updateCommandDetail(n.id,t.id,{estadoComandaDetalle:i,cantidad:w}).subscribe(()=>{this.eventBusService.emit({name:"updateTables",value:!0}),this.restaurantService.findOrderById(this.order.id).subscribe(N=>this.config.data.order=N),"CANCELADO"===i&&this.restaurantService.processCommand(n,this.puntoVenta,!0,[t.id],this.configCompany.imprimeTicketsEscPos)})};1===t.cantidad?this.confirmationService.confirm({message:s,accept:()=>{C()},acceptLabel:"Si",rejectLabel:"No"}):this.dialogService.open(lo,{header:d,width:"400px%",data:{status:i,quantity:t.cantidad}}).onClose.subscribe(F=>{F&&C(F)})}}oe.\u0275fac=function(n){return new(n||oe)(e.Y36(L.E7),e.Y36(L.S),e.Y36(L.xA),e.Y36(u.T),e.Y36(h.YP),e.Y36(h.ez),e.Y36(H.Y),e.Y36(D.F0))},oe.\u0275cmp=e.Xpm({type:oe,selectors:[["app-pedido-detalle-dialog"]],decls:17,vars:19,consts:[["class","grid",4,"ngIf"],["appendTo","body","header","Aceptar pedido",3,"visible","modal","draggable","resizable","visibleChange"],[1,"p-grip"],[1,"col"],["for","tiempoEntrega",1,"label-form"],["id","tiempoEntrega","name","tiempoEntrega","type","text","pKeyFilter","num","pInputText","",2,"width","100%",3,"ngModel","ngModelChange"],["pButton","","type","button","label","Aceptar pedido",1,"p-button-rounded","p-button-success",3,"disabled","click"],["appendTo","body","header","Rechazar pedido",3,"visible","modal","draggable","resizable","visibleChange"],["for","comentario",1,"label-form"],["id","comentario","name","comentario","type","text","pInputText","",2,"width","100%",3,"ngModel","ngModelChange"],["pButton","","type","button","label","Rechazar pedido",1,"p-button-rounded","p-button-danger",3,"disabled","click"],[1,"grid"],[1,"col-6"],[2,"display","flex","flex-direction","column"],[1,"mt-0","mb-0"],["aria-hidden","true",1,"fa",3,"pTooltip","ngClass"],["aria-hidden","true",1,"fa","ml-2",3,"pTooltip","ngClass"],[1,"col-6",2,"display","flex","justify-content","flex-end","align-items","center"],["aria-hidden","true",1,"fa","fa-clock-o"],[3,"ngClass"],["class","col-6",4,"ngIf"],["class","col-12",4,"ngIf"],[1,"mt-0","mb-0","info-text"],[1,"custom-badge","status-info"],[1,"custom-badge",3,"ngClass"],["class","col-4",4,"ngIf"],["class","col-12 flex-center-x",4,"ngIf"],[1,"col-12"],[1,"grid",2,"margin","5px"],["class","col-12",4,"ngFor","ngForOf"],[1,"text-bold"],["class","mt-2",4,"ngIf"],[4,"ngIf"],[1,"col-4"],["adressType","geocode",3,"initalMarker","showInput","ngModel"],[1,"col-12","flex-center-x"],["pButton","","type","button","label","Aceptar pedido",1,"p-button-rounded","p-button-success",3,"click"],["pButton","","type","button","label","Rechazar pedido",1,"p-button-rounded","p-button-danger",3,"click"],[1,"grid","p-nogutter"],[1,"col-12","cabecera-comanda-registro-definicion"],[1,"col-fixed",2,"width","40px","padding","10px"],[1,"col-8",2,"padding","10px"],[2,"margin","0"],[1,"col-4",2,"padding","10px"],[2,"margin","0","text-align","right"],[1,"grid","p-nogutter","detalle-comanda-registro","cursor-pointer","align-content-center","flex","justify-content-center",3,"ngClass"],[1,"col-9",2,"padding","10px"],["style","color: #bababa",4,"ngIf"],["class","mt-0 mb-0",4,"ngFor","ngForOf"],["class","col-fixed","style","width: 40px; text-align: center;",4,"ngIf"],[4,"appPermission"],[1,"col-3",2,"padding","10px"],[1,"m-0"],[1,"mt-1"],["severity","success","text","Pagado",4,"ngIf"],["severity","warn","text","Por pagar",4,"ngIf"],[2,"color","#bababa"],[1,"col-fixed",2,"width","40px","text-align","center"],["pTooltip","Servir","src","assets/resources/images/camarero2.svg","alt","",1,"cursor-pointer","m-l-5",2,"width","25px",3,"click"],["pTooltip","Anular","src","assets/resources/images/cancelar.svg","alt","",1,"cursor-pointer","m-l-5",2,"width","25px",3,"click"],["severity","success","text","Pagado"],["severity","warn","text","Por pagar"],[1,"mt-2"],[1,"grid","p-nogutter","flex","justify-content-center"],[1,"col-fixed",2,"width","20px"],["src","assets/resources/images/food-delivery.svg","alt","",2,"width","100%"],["tooltipPosition","top",1,"col-fixed","m-l-5",2,"width","20px",3,"pTooltip"],["style","width: 100%;","src","assets/resources/images/check-default.svg","alt","",4,"ngIf"],["style","width: 100%;","src","assets/resources/images/check-info.svg","alt","",4,"ngIf"],["style","width: 100%;","src","assets/resources/images/check-success.svg","alt","",4,"ngIf"],["src","assets/resources/images/check-default.svg","alt","",2,"width","100%"],["src","assets/resources/images/check-info.svg","alt","",2,"width","100%"],["src","assets/resources/images/check-success.svg","alt","",2,"width","100%"],[3,"ngIf"],["pButton","","type","button","label","Generar comprobante","class","m-1",3,"click",4,"ngIf"],["pButton","","type","button","label","Finalizar pedido","class","p-button-success m-1",3,"click",4,"ngIf"],["type","button","pButton","","label","Anular pedido","class","p-button-danger m-1",3,"click",4,"appPermission"],["type","button","pButton","","label","Anular pedido",1,"p-button-danger","m-1",3,"click"],["type","button","pButton","","label","Eliminar pre cuentas","class","p-button-warning m-1",3,"click",4,"appPermission"],["type","button","pButton","","label","Eliminar pre cuentas",1,"p-button-warning","m-1",3,"click"],["pButton","","type","button","label","Generar comprobante",1,"m-1",3,"click"],["pButton","","type","button","label","Finalizar pedido",1,"p-button-success","m-1",3,"click"]],template:function(n,t){1&n&&(e.YNc(0,Vo,51,42,"div",0),e.TgZ(1,"p-dialog",1),e.NdJ("visibleChange",function(s){return t.displayModalAcceptOrder=s}),e.TgZ(2,"div",2),e.TgZ(3,"div",3),e.TgZ(4,"label",4),e._uU(5,"Tiempo de entrega en minutos (*)"),e.qZA(),e.TgZ(6,"input",5),e.NdJ("ngModelChange",function(s){return t.tiempoEntrega=s}),e.qZA(),e.qZA(),e.TgZ(7,"div",3),e.TgZ(8,"button",6),e.NdJ("click",function(){return t.acceptOrder()}),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(9,"p-dialog",7),e.NdJ("visibleChange",function(s){return t.displayModalRejectOrder=s}),e.TgZ(10,"div",2),e.TgZ(11,"div",3),e.TgZ(12,"label",8),e._uU(13,"Comentario de rechazo (*)"),e.qZA(),e.TgZ(14,"input",9),e.NdJ("ngModelChange",function(s){return t.comentario=s}),e.qZA(),e.qZA(),e.TgZ(15,"div",3),e.TgZ(16,"button",10),e.NdJ("click",function(){return t.rejectOrder()}),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&n&&(e.Q6J("ngIf",t.order),e.xp6(1),e.Akn(e.DdM(17,at)),e.Q6J("visible",t.displayModalAcceptOrder)("modal",!0)("draggable",!1)("resizable",!1),e.xp6(5),e.Q6J("ngModel",t.tiempoEntrega),e.xp6(2),e.Q6J("disabled",!t.tiempoEntrega),e.xp6(1),e.Akn(e.DdM(18,at)),e.Q6J("visible",t.displayModalRejectOrder)("modal",!0)("draggable",!1)("resizable",!1),e.xp6(5),e.Q6J("ngModel",t.comentario),e.xp6(2),e.Q6J("disabled",!t.comentario))},directives:[v.O5,r.u,v.mk,uo,f.JJ,f.On,a.Hq,v.sg,T.Z,et.l,Y.q,Ee.V,f.Fj,ve.Fr,O.o],pipes:[se,v.uU,v.Ov,nt,it,Se,te.Z],styles:[".cabecera-comanda-registro[_ngcontent-%COMP%]{background-color:#616161;color:#ececec;border:1px solid #d7d7d7}.cabecera-comanda-registro-definicion[_ngcontent-%COMP%]{background-color:#616161;color:#ececec;border-bottom:1px solid #d7d7d7;border-left:1px solid #d7d7d7;border-right:1px solid #d7d7d7}.detalle-comanda-registro[_ngcontent-%COMP%]{border-bottom:1px solid #d7d7d7;border-left:1px solid #d7d7d7;border-right:1px solid #d7d7d7}.command-detail-prepared[_ngcontent-%COMP%]{background-color:#e6ffeb}.command-detail-preparation[_ngcontent-%COMP%]{background-color:#ffe3a3}.command-detail-dispatched[_ngcontent-%COMP%]{background-color:#e4eaff}.command-detail-canceled[_ngcontent-%COMP%]{background-color:#ffe5e5;text-decoration:line-through}"]}),(0,q.gn)([(0,y.Ph)(R.Z.getOffice)],oe.prototype,"puntoVenta$",void 0),(0,q.gn)([(0,y.Ph)(R.Z.getConfig)],oe.prototype,"configCompany$",void 0);class ne{constructor(n,t,i,s,d){this.restaurantService=n,this.ref=t,this.confirmationService=i,this.messageService=s,this.eventBusService=d,this.unsubscribe$=new k.xQ}ngOnInit(){this.tableTarget$.pipe((0,P.R)(this.unsubscribe$)).subscribe(n=>this.tableTargetSelected=n),this.table$.pipe((0,P.R)(this.unsubscribe$)).subscribe(n=>this.tableSelected=n),this.order$.pipe((0,P.R)(this.unsubscribe$)).subscribe(n=>this.orderSelected=n)}changeTable(){this.confirmationService.confirm({message:`\xbfEst\xe1 seguro de cambiar la mesa ${this.tableSelected.numero} por la ${this.tableTargetSelected.numero}?`,accept:()=>{this.restaurantService.changeTable(this.orderSelected.id,{idOrigin:this.tableSelected.id,idTarget:this.tableTargetSelected.id}).subscribe(()=>{this.messageService.add({severity:"success",summary:"Mensaje",detail:"Mesa cambiada correctamente"}),this.eventBusService.emit({name:"updateTables",value:!0}),this.ref.close()})},acceptLabel:"Si",rejectLabel:"No"})}}ne.\u0275fac=function(n){return new(n||ne)(e.Y36(u.T),e.Y36(L.E7),e.Y36(h.YP),e.Y36(h.ez),e.Y36(H.Y))},ne.\u0275cmp=e.Xpm({type:ne,selectors:[["app-comandero-cambiar-mesa"]],decls:5,vars:2,consts:[[1,"grid","p-jc-center"],[1,"col-12"],[3,"isForChangeTable"],[1,"col-12","center"],["label","Cambiar mesa","pButton","","type","button",1,"p-button-success",3,"disabled","click"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e._UZ(2,"app-comandero-mesas",2),e.qZA(),e.TgZ(3,"div",3),e.TgZ(4,"button",4),e.NdJ("click",function(){return t.changeTable()}),e.qZA(),e.qZA(),e.qZA()),2&n&&(e.xp6(2),e.Q6J("isForChangeTable",!0),e.xp6(2),e.Q6J("disabled",!t.tableTargetSelected))},directives:[j,a.Hq],styles:[""]}),(0,q.gn)([(0,y.Ph)($.Q.tableTarget)],ne.prototype,"tableTarget$",void 0),(0,q.gn)([(0,y.Ph)($.Q.table)],ne.prototype,"table$",void 0),(0,q.gn)([(0,y.Ph)($.Q.order)],ne.prototype,"order$",void 0);var be=b(67300),Ne=b(65735),rt=b(46461),Ye=b(24394),Ce=b(28061),Ho=b(15439);function jo(o,n){1&o&&(e.TgZ(0,"div"),e._UZ(1,"img",23),e.qZA())}function zo(o,n){if(1&o&&(e.TgZ(0,"span",24),e.TgZ(1,"span",25),e._UZ(2,"span",26),e._uU(3),e.qZA(),e.qZA()),2&o){const t=e.oxw();e.xp6(3),e.hij(" ",t.order.mesa.numero,"")}}function Go(o,n){if(1&o&&(e.TgZ(0,"span",27),e._uU(1),e.ALo(2,"estadoPedidoOnline"),e.qZA()),2&o){const t=e.oxw();e.Q6J("ngClass","ACEPTADO"===t.order.estadoOnline?"status-success":"status-warning"),e.xp6(1),e.hij(" ",e.lcZ(2,2,t.order.estadoOnline)," ")}}function Xo(o,n){if(1&o&&(e.TgZ(0,"div",28),e.TgZ(1,"span",29),e._uU(2),e.qZA(),e.qZA()),2&o){const t=e.oxw();e.xp6(2),e.hij(" Platillos cancelados: ",t.comandsCancel," ")}}function Wo(o,n){if(1&o&&(e.TgZ(0,"div",1),e._UZ(1,"span",30),e._uU(2),e.qZA()),2&o){const t=e.oxw();e.xp6(2),e.hij(" ",null==t.order||null==t.order.cliente?null:t.order.cliente.razonSocial," ")}}function Ko(o,n){if(1&o&&(e.TgZ(0,"div",1),e._UZ(1,"span",31),e._uU(2),e.qZA()),2&o){const t=e.oxw();e.xp6(2),e.hij(" ",null==t.order?null:t.order.direccionCompleta," ")}}function en(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",32),e.TgZ(1,"button",33),e.NdJ("click",function(){return e.CHM(t),e.oxw().addOrderToDelivery()}),e.qZA(),e.qZA()}}function tn(o,n){1&o&&e._UZ(0,"img",41)}function on(o,n){1&o&&e._UZ(0,"img",42)}function nn(o,n){1&o&&e._UZ(0,"img",43)}function an(o,n){if(1&o&&(e.TgZ(0,"div",28),e.TgZ(1,"div",34),e.TgZ(2,"div",35),e._UZ(3,"img",36),e.qZA(),e.TgZ(4,"div",37),e.YNc(5,tn,1,0,"img",38),e.YNc(6,on,1,0,"img",39),e.YNc(7,nn,1,0,"img",40),e.qZA(),e.qZA(),e.qZA()),2&o){const t=e.oxw();e.xp6(4),e.Q6J("pTooltip",t.descripcionEnvio),e.xp6(1),e.Q6J("ngIf","PENDIENTE"===t.order.envio.estado),e.xp6(1),e.Q6J("ngIf","ENVIADO"===t.order.envio.estado),e.xp6(1),e.Q6J("ngIf","ENTREGADO"===t.order.envio.estado)}}let rn=(()=>{class o{constructor(t,i,s){this.store=t,this.messageService=i,this.datePipe=s,this.interfazEnvios=!1,this.unsubscribeTimer$=new k.xQ,this.unsubscribe$=new k.xQ,this.isNew=!1,this.onClick=new e.vpe,this.selectOrder=new e.vpe}ngOnInit(){const t=(0,Pe.F)(1e3);this.timer$=t.pipe((0,re.U)(i=>(0,l.t6)(this.order.fecha)),(0,We.b)(i=>{const s=Ho.duration((new Date).getTime()-this.order.fecha,"milliseconds");this.isNew=s.asMinutes()<=10}),(0,P.R)(this.unsubscribeTimer$),(0,he.O)((0,l.t6)(this.order.fecha)))}ngOnDestroy(){this.unsubscribe$.next(),this.unsubscribe$.complete(),this.unsubscribeTimer$.next(),this.unsubscribeTimer$.complete()}get fechaPedido(){return this.datePipe.transform(this.order.fecha,"dd/MM/yyyy hh:mm a")}get descripcionEnvio(){return`Estado del env\xedo: ${this.order.envio.estado}`}get textTooltipIcon(){if("PENDIENTE"===this.order.estado)return"Pedido no preparado";if("PREPARADO"===this.order.estado){if("PEDIDO_LOCAL"===this.order.tipo)return"Pedido listo para cobrar";if("PEDIDO_FORANEO"===this.order.tipo||"PEDIDO_ONLINE"===this.order.tipo)return"Pedido listo para enviar"}return""}get textTooltipIconPay(){return this.order.pagado?"Pedido pagado":"Pedido pendiente de pago"}get icon(){return"PENDIENTE"===this.order.estado?"fa-circle color-warning":"PREPARADO"===this.order.estado?"fa-check-circle color-success":""}get iconPay(){return this.order.pagado?"fa-money color-success":"fa-money color-warning"}get showButtonDeliveryAdd(){return("PEDIDO_FORANEO"===this.order.tipo||"PEDIDO_ONLINE"===this.order.tipo&&"ACEPTADO"===this.order.estadoOnline)&&"FINALIZADO"!==this.order.estado&&"CANCELADO"!==this.order.estado&&!this.order.envio}get classBadgeStatusOrder(){return"PENDIENTE"===this.order.estado?"status-warning":"CANCELADO"===this.order.estado?"status-danger":"PRECUENTA"===this.order.estado?"status-renewal":"PREPARADO"===this.order.estado?"status-info":"FINALIZADO"===this.order.estado?"status-success":""}addOrderToDelivery(){this.selectOrder.emit(this.order)}get comandsCancel(){return this.order.comandas.map(i=>i.items).reduce((i,s)=>i.concat(s)).filter(i=>"CANCELADO"===i.estadoComandaDetalle).map(i=>i.cantidad).reduce(l.IH,0)}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(y.yh),e.Y36(h.ez),e.Y36(v.uU))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-pedido-item"]],inputs:{order:"order",interfazEnvios:"interfazEnvios"},outputs:{onClick:"onClick",selectOrder:"selectOrder"},decls:39,vars:27,consts:[[1,"grid","cursor-pointer",3,"click"],[1,"col-6"],[2,"display","flex","flex-direction","column"],[1,"mt-0","mb-0"],["aria-hidden","true",1,"fa",3,"pTooltip","ngClass"],["aria-hidden","true",1,"fa","ml-2",3,"pTooltip","ngClass"],[1,"col-6",2,"display","flex","justify-content","flex-end","align-items","center"],[4,"ngIf"],[3,"pTooltip"],["aria-hidden","true",1,"fa","fa-clock-o"],[1,"col-12",2,"margin-top","0","padding-top","0"],[1,"grid","p-nogutter"],[1,"col"],[1,"custom-badge","status-info"],["class","ml-1",4,"ngIf"],["class","custom-badge ml-1",3,"ngClass",4,"ngIf"],[1,"col","text-right"],[1,"custom-badge",3,"ngClass"],["class","mt-2",4,"ngIf"],[1,"col-12"],[1,"grid","mt-1"],["class","col-6",4,"ngIf"],["class","mt-2 flex-center-x",4,"ngIf"],["src","assets/resources/images/new.png","alt","",2,"width","40px"],[1,"ml-1"],[2,"font-weight","bold","font-size","15px"],[1,"fa","fa-medium"],[1,"custom-badge","ml-1",3,"ngClass"],[1,"mt-2"],[1,"custom-badge","status-danger"],[1,"fa","fa-user"],[1,"fa","fa-map-marker"],[1,"mt-2","flex-center-x"],["pTooltip","Agregar al env\xedo","pButton","","type","button","icon","fa fa-motorcycle",3,"click"],[1,"grid","p-nogutter","flex","justify-content-center"],[1,"col-fixed",2,"width","20px"],["src","assets/resources/images/food-delivery.svg","alt","",2,"width","100%"],["tooltipPosition","top",1,"col-fixed","ml-2",2,"width","20px",3,"pTooltip"],["style","width: 100%;","src","assets/resources/images/check-default.svg","alt","",4,"ngIf"],["style","width: 100%;","src","assets/resources/images/check-info.svg","alt","",4,"ngIf"],["style","width: 100%;","src","assets/resources/images/check-success.svg","alt","",4,"ngIf"],["src","assets/resources/images/check-default.svg","alt","",2,"width","100%"],["src","assets/resources/images/check-info.svg","alt","",2,"width","100%"],["src","assets/resources/images/check-success.svg","alt","",2,"width","100%"]],template:function(t,i){1&t&&(e.TgZ(0,"p-card"),e.TgZ(1,"div",0),e.NdJ("click",function(){return i.onClick.emit()}),e.TgZ(2,"div",1),e.TgZ(3,"div",2),e.TgZ(4,"div"),e.TgZ(5,"h3",3),e._uU(6),e.ALo(7,"completarCeros"),e._UZ(8,"span",4),e._UZ(9,"span",5),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(10,"div",6),e.TgZ(11,"div"),e.YNc(12,jo,2,0,"div",7),e.TgZ(13,"div"),e.TgZ(14,"span",8),e._UZ(15,"span",9),e._uU(16),e.ALo(17,"async"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(18,"div",10),e.TgZ(19,"div",11),e.TgZ(20,"div",12),e.TgZ(21,"span",13),e._uU(22),e.ALo(23,"tipoPedido"),e.qZA(),e.YNc(24,zo,4,1,"span",14),e.YNc(25,Go,3,4,"span",15),e.qZA(),e.TgZ(26,"div",16),e.TgZ(27,"div"),e.TgZ(28,"div"),e.TgZ(29,"span",17),e._uU(30),e.ALo(31,"estadoPedidoRestaurante"),e.qZA(),e.qZA(),e.YNc(32,Xo,3,1,"div",18),e.qZA(),e.qZA(),e.TgZ(33,"div",19),e.TgZ(34,"div",20),e.YNc(35,Wo,3,1,"div",21),e.YNc(36,Ko,3,1,"div",21),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.YNc(37,en,2,0,"div",22),e.YNc(38,an,8,4,"div",18),e.qZA()),2&t&&(e.xp6(6),e.hij("#",e.xi3(7,18,i.order.id,8)," "),e.xp6(2),e.Q6J("pTooltip",i.textTooltipIcon)("ngClass",i.icon),e.xp6(1),e.Q6J("pTooltip",i.textTooltipIconPay)("ngClass",i.iconPay),e.xp6(3),e.Q6J("ngIf",i.isNew),e.xp6(2),e.Q6J("pTooltip",i.fechaPedido),e.xp6(2),e.hij(" ",e.lcZ(17,21,i.timer$),""),e.xp6(6),e.hij(" ",e.lcZ(23,23,i.order.tipo)," "),e.xp6(2),e.Q6J("ngIf",i.order.mesa),e.xp6(1),e.Q6J("ngIf","PEDIDO_ONLINE"===i.order.tipo),e.xp6(4),e.Q6J("ngClass",i.classBadgeStatusOrder),e.xp6(1),e.hij(" ",e.lcZ(31,25,i.order.estado)," "),e.xp6(2),e.Q6J("ngIf",i.comandsCancel),e.xp6(3),e.Q6J("ngIf","LOCAL"!==i.order.tipo),e.xp6(1),e.Q6J("ngIf","PEDIDO_ONLINE"===i.order.tipo||"PEDIDO_FORANEO"===i.order.tipo),e.xp6(1),e.Q6J("ngIf",i.showButtonDeliveryAdd&&i.interfazEnvios),e.xp6(1),e.Q6J("ngIf",i.order.envio))},directives:[T.Z,r.u,v.mk,v.O5,a.Hq],pipes:[se,v.Ov,nt,it,Se],styles:[".color-success[_ngcontent-%COMP%]{color:#7fc145}.color-warning[_ngcontent-%COMP%]{color:#d2a956}"]}),o})();var ke=b(84132),Be=b(75652),st=b(86526);function sn(o,n){if(1&o){const t=e.EpF();e._uU(0," Clic para filtrar "),e.TgZ(1,"p-button",18),e.NdJ("onClick",function(){return e.CHM(t),e.oxw().displayBusquedaPedidos=!0}),e.qZA()}}function ln(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",19),e.TgZ(1,"app-pedido-item",20),e.NdJ("selectOrder",function(s){return e.CHM(t),e.oxw().selectOrder.emit(s)})("onClick",function(){const d=e.CHM(t).$implicit;return e.oxw().openOrderDetail(d)}),e.qZA(),e.qZA()}if(2&o){const t=n.$implicit,i=e.oxw();e.xp6(1),e.Q6J("interfazEnvios",i.interfazEnvios)("order",t)}}const cn=function(){return{width:"30vw"}},lt=function(){return{width:"100%"}};class B{constructor(n,t,i,s,d,C){this.restaurantService=n,this.dialogService=t,this.listasService=i,this.datePipe=s,this.store=d,this.socketIoService=C,this.interfazEnvios=!1,this.cancelOrders=!1,this.titlePanel="Pedidos",this.unsubscribe$=new k.xQ,this.unsubscribeTimer$=new k.xQ,this.perPage=10,this.totalRecords=0,this.pageNumber=0,this.orders=[],this.estadosPedidos=[],this.displayBusquedaPedidos=!1,this.selectOrder=new e.vpe}ngOnInit(){this.resetBusqueda(),this.estadosPedidos=[{label:"Pendiente",value:"PENDIENTE"},{label:"Preparado",value:"PREPARADO"},{label:"Cuenta",value:"PRECUENTA"},{label:"Finalizado",value:"FINALIZADO"},{label:"Cancelado",value:"CANCELADO"}],this.filtroTiposPedidos$.pipe((0,P.R)(this.unsubscribe$)).subscribe(n=>{this.filtroTiposPedidos=n,this.loadPedidos()}),this.busquedaPedidos$.pipe((0,P.R)(this.unsubscribe$)).subscribe(n=>{this.estadosPedidosSeleccionados=n.estadosPedidosSeleccionados,this.cliente=n.cliente,this.loadPedidos()}),this.puntoVenta$.pipe((0,P.R)(this.unsubscribe$)).subscribe(n=>{this.filtroPuntoVenta=n,this.loadPedidos()}),this.socketIoService.onEvent($e.T.ORDER_RESTAURANT).pipe((0,P.R)(this.unsubscribe$)).subscribe(n=>{console.log(n),this.notifyOrder()})}ngOnDestroy(){this.unsubscribe$.next(),this.unsubscribe$.complete(),this.unsubscribeTimer$.next(),this.unsubscribeTimer$.complete()}notifyOrder(){this.loadPedidos(),new rt.Howl({src:["assets/resources/sounds/swiftly.mp3"]}).play()}changeBusquedaPedido(){this.store.dispatch(new Ne.IC({estadosPedidosSeleccionados:this.estadosPedidosSeleccionados,desde:this.desde,hasta:this.hasta,cliente:this.cliente}))}resetBusqueda(){this.store.dispatch(new Ne.IC({estadosPedidosSeleccionados:this.cancelOrders?["CANCELADO"]:["PENDIENTE","PREPARADO","PRECUENTA"],desde:new Date,hasta:new Date,cliente:void 0})),this.displayBusquedaPedidos=!1,this.cancelOrders&&(this.desde=new Date,this.hasta=new Date)}loadPedidos(){if(void 0!==this.filtroTiposPedidos&&void 0!==this.filtroPuntoVenta&&void 0!==this.estadosPedidosSeleccionados){const n=[`idPuntoVenta=${this.filtroPuntoVenta.id}`,`pageNumber=${this.pageNumber}`,`perPage=${this.perPage}`,"sortField=fecha","sortOrder=-1"];this.desde&&n.push(`desde=${this.datePipe.transform(this.desde,"dd-MM-yyyy")}`),this.hasta&&n.push(`hasta=${this.datePipe.transform(this.hasta,"dd-MM-yyyy")}`),this.cliente&&n.push(`nombreCliente=${this.cliente}`),this.estadosPedidosSeleccionados.forEach(t=>n.push(`estado=${t}`)),this.filtroTiposPedidosInput?this.filtroTiposPedidosInput.forEach(t=>n.push(`tipo=${t}`)):this.filtroTiposPedidos.forEach(t=>n.push(`tipo=${t}`)),this.interfazEnvios&&n.push("envioAsignado=false"),this.restaurantService.findAllOrder(n.join("&")).subscribe(t=>{this.totalRecords=t.totalElements,this.orders=t.content})}}pageChanged(n){this.pageNumber=n.page,this.loadPedidos()}openOrderDetail(n){const t=(0,Pe.F)(1e3);this.dialogService.open(oe,{header:"Detalle del pedido",width:"50%",data:{order:n,timer$:t.pipe((0,re.U)(s=>(0,l.t6)(n.fecha)),(0,P.R)(this.unsubscribeTimer$),(0,he.O)((0,l.t6)(n.fecha))),interfazEnvios:this.interfazEnvios}}).onClose.subscribe(s=>{s&&(this.unsubscribeTimer$.next(),this.loadPedidos())})}}B.\u0275fac=function(n){return new(n||B)(e.Y36(u.T),e.Y36(L.xA),e.Y36(Ye.E),e.Y36(v.uU),e.Y36(y.yh),e.Y36(Qe.l))},B.\u0275cmp=e.Xpm({type:B,selectors:[["app-lista-pedidos"]],inputs:{filtroTiposPedidosInput:"filtroTiposPedidosInput",interfazEnvios:"interfazEnvios",cancelOrders:"cancelOrders",titlePanel:"titlePanel"},outputs:{selectOrder:"selectOrder"},decls:35,vars:28,consts:[[3,"header"],["pTemplate","icons"],[1,"grid"],[1,"col-12"],[1,"col-6","text-bold"],[1,"col-6","flex-right-x","text-bold"],["placeholder","Buscar","type","text","pInputText","",2,"width","100%",3,"ngModel","input","ngModelChange"],["class","mb-2 mt-2",4,"ngFor","ngForOf"],[3,"rows","totalRecords","onPageChange"],["appendTo","body","header","B\xfasqueda avanzada de pedidos",3,"visible","modal","draggable","visibleChange"],[1,"grid","p-fluid"],[1,"col-6"],[1,"label-form"],["appendTo","body","name","fechaInicio","dateFormat","dd/mm/yy",3,"ngModel","touchUI","readonlyInput","locale","onSelect","ngModelChange"],["appendTo","body","defaultLabel","Seleccione estado pedido","maxSelectedLabels","5",3,"options","ngModel","onChange","ngModelChange"],["type","text","pInputText","",2,"width","100%",3,"ngModel","input","ngModelChange"],[1,"col-12","mt-2"],["type","button","icon","fa fa-reply","label","Restablecer filtros",3,"onClick"],["type","submit","icon","fa fa-search",1,"p-panel-header-icon","p-link",3,"onClick"],[1,"mb-2","mt-2"],[3,"interfazEnvios","order","selectOrder","onClick"]],template:function(n,t){1&n&&(e.TgZ(0,"p-panel",0),e.YNc(1,sn,2,0,"ng-template",1),e.TgZ(2,"div",2),e.TgZ(3,"div",3),e.TgZ(4,"div",2),e.TgZ(5,"div",4),e._uU(6," N. Pedido "),e.qZA(),e.TgZ(7,"div",5),e._uU(8," Tiempo "),e.qZA(),e.TgZ(9,"div",3),e.TgZ(10,"input",6),e.NdJ("input",function(){return t.changeBusquedaPedido()})("ngModelChange",function(s){return t.cliente=s}),e.qZA(),e.qZA(),e.qZA(),e.YNc(11,ln,2,2,"div",7),e.qZA(),e.TgZ(12,"div",3),e.TgZ(13,"p-paginator",8),e.NdJ("onPageChange",function(s){return t.pageChanged(s)}),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(14,"p-dialog",9),e.NdJ("visibleChange",function(s){return t.displayBusquedaPedidos=s}),e.TgZ(15,"div",10),e.TgZ(16,"div",11),e.TgZ(17,"label",12),e._uU(18,"Desde"),e.qZA(),e.TgZ(19,"p-calendar",13),e.NdJ("onSelect",function(){return t.changeBusquedaPedido()})("ngModelChange",function(s){return t.desde=s}),e.qZA(),e.qZA(),e.TgZ(20,"div",11),e.TgZ(21,"label",12),e._uU(22,"Hasta"),e.qZA(),e.TgZ(23,"p-calendar",13),e.NdJ("onSelect",function(){return t.changeBusquedaPedido()})("ngModelChange",function(s){return t.hasta=s}),e.qZA(),e.qZA(),e.TgZ(24,"div",3),e.TgZ(25,"label",12),e._uU(26,"Estado"),e.qZA(),e.TgZ(27,"div"),e.TgZ(28,"p-multiSelect",14),e.NdJ("onChange",function(){return t.changeBusquedaPedido()})("ngModelChange",function(s){return t.estadosPedidosSeleccionados=s}),e.qZA(),e.qZA(),e.qZA(),e.TgZ(29,"div",3),e.TgZ(30,"label",12),e._uU(31,"Cliente"),e.qZA(),e.TgZ(32,"input",15),e.NdJ("input",function(){return t.changeBusquedaPedido()})("ngModelChange",function(s){return t.cliente=s}),e.qZA(),e.qZA(),e.TgZ(33,"div",16),e.TgZ(34,"p-button",17),e.NdJ("onClick",function(){return t.resetBusqueda()}),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&n&&(e.Q6J("header",t.titlePanel),e.xp6(10),e.Q6J("ngModel",t.cliente),e.xp6(1),e.Q6J("ngForOf",t.orders),e.xp6(2),e.Q6J("rows",t.perPage)("totalRecords",t.totalRecords),e.xp6(1),e.Akn(e.DdM(25,cn)),e.Q6J("visible",t.displayBusquedaPedidos)("modal",!0)("draggable",!1),e.xp6(5),e.Akn(e.DdM(26,lt)),e.Q6J("ngModel",t.desde)("touchUI",!0)("readonlyInput",!0)("locale",t.listasService.calendarEs),e.xp6(4),e.Akn(e.DdM(27,lt)),e.Q6J("ngModel",t.hasta)("touchUI",!0)("readonlyInput",!0)("locale",t.listasService.calendarEs),e.xp6(5),e.Q6J("options",t.estadosPedidos)("ngModel",t.estadosPedidosSeleccionados),e.xp6(4),e.Q6J("ngModel",t.cliente))},directives:[Ce.s,h.jx,a.zx,f.Fj,O.o,f.JJ,f.On,v.sg,rn,ke.D,Ee.V,Be.f,st.NU],styles:[""]}),(0,q.gn)([(0,y.Ph)(be.d.filtroTiposPedidos)],B.prototype,"filtroTiposPedidos$",void 0),(0,q.gn)([(0,y.Ph)(R.Z.getOffice)],B.prototype,"puntoVenta$",void 0),(0,q.gn)([(0,y.Ph)(be.d.busquedaPedidos)],B.prototype,"busquedaPedidos$",void 0);let dn=(()=>{class o{constructor(){this.filtroTiposPedidosInput=[]}ngOnInit(){}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-modal-lista-pedidos"]],decls:1,vars:1,consts:[["titlePanel","Lista de pedidos",3,"cancelOrders"]],template:function(t,i){1&t&&e._UZ(0,"app-lista-pedidos",0),2&t&&e.Q6J("cancelOrders",!0)},directives:[B],styles:[""]}),o})(),pn=(()=>{class o{constructor(){this.clickCard=new e.vpe}ngOnInit(){}clickItem(){}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-button-menu"]],inputs:{icon:"icon",label:"label"},outputs:{clickCard:"clickCard"},decls:4,vars:3,consts:[[1,"cursor-pointer",3,"click"],[2,"width","5em",3,"src","alt"],[1,"text-bold","p-mt-2","p-mb-2"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.NdJ("click",function(){return i.clickCard.emit()}),e._UZ(1,"img",1),e.TgZ(2,"p",2),e._uU(3),e.qZA(),e.qZA()),2&t&&(e.xp6(1),e.Q6J("src",i.icon,e.LSH)("alt",i.label),e.xp6(2),e.Oqu(i.label))},styles:[""]}),o})();function un(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",3),e.TgZ(1,"app-button-menu",13),e.NdJ("clickCard",function(){return e.CHM(t),e.oxw().router.navigateByUrl("/restaurante/cobrador")}),e.qZA(),e.qZA()}}class G{constructor(n,t,i,s,d,C,w,F){this.messageService=n,this.loginService=t,this.router=i,this.dialogService=s,this.eventBusService=d,this.checkService=C,this.store=w,this.confirmationService=F,this.unsubscribe$=new k.xQ,this.unsubscribeTimer$=new k.xQ,this.configCompany={},this.createCommand=()=>{this.tableSelected?this.orderSelected&&"PRECUENTA"===this.orderSelected.estado?this.confirmationService.confirm({message:"Esta mesa ya ha generado pre cuentas. Est\xe1 seguro de agregar mas pedidos?",accept:()=>{this.router.navigateByUrl("/restaurante/comanda")},acceptLabel:"Si",rejectLabel:"No"}):this.router.navigateByUrl("/restaurante/comanda"):this.messageService.add({severity:"error",summary:"Error",detail:"Seleccione una mesa libre."})},this.openDialogCloseCheck=N=>{this.tableSelected&&this.orderSelected?this.dialogService.open(z,{data:{dividir:N},header:N?"Dividir cuenta":"Cerrar cuenta",width:"85%"}).onClose.subscribe(ir=>{this.openPdfCheck(ir,!0),this.eventBusService.emit({name:"updateTables",value:!0})}):this.messageService.add({severity:"error",summary:"Error",detail:"Seleccione una mesa con pedido."})},this.openDialogViewOrder=()=>{const N=(0,Pe.F)(1e3);this.tableSelected&&this.orderSelected?this.dialogService.open(oe,{header:`Pedido M${this.orderSelected.mesa.numero}`,width:"800px",data:{order:this.orderSelected,timer$:N.pipe((0,re.U)(J=>(0,l.t6)(this.orderSelected.fecha)),(0,P.R)(this.unsubscribeTimer$),(0,he.O)((0,l.t6)(this.orderSelected.fecha)))}}):this.messageService.add({severity:"error",summary:"Error",detail:"Seleccione una mesa con pedido."})},this.openDialogChangeTable=()=>{this.tableSelected&&this.orderSelected?this.dialogService.open(ne,{header:`Cambiar mesa de Pedido: M${this.orderSelected.mesa.numero}`,width:"800px"}):this.messageService.add({severity:"error",summary:"Error",detail:"Seleccione una mesa con pedido."})},this.openDialogCancelOrders=()=>{this.dialogService.open(dn,{header:"Pedidos cancelados",width:"80%"})},this.openDialogPrintCheck=()=>{this.tableSelected&&this.orderSelected&&"PRECUENTA"===this.orderSelected.estado?this.checkService.findAll([`idPedido=${this.orderSelected.id}`].join("&")).subscribe(J=>{this.openPdfCheck(J,!1)}):this.messageService.add({severity:"error",summary:"Error",detail:"Seleccione una mesa con pedido en pre-cuenta."})}}ngOnInit(){this.configCompany$.pipe((0,P.R)(this.unsubscribe$)).subscribe(n=>{this.configCompany=n}),this.table$.pipe((0,P.R)(this.unsubscribe$)).subscribe(n=>this.tableSelected=n),this.order$.pipe((0,P.R)(this.unsubscribe$)).subscribe(n=>this.orderSelected=n),this.estacionVenta$.pipe((0,P.R)(this.unsubscribe$)).subscribe(n=>this.estacionVenta=n)}ngOnDestroy(){this.unsubscribe$.next(),this.unsubscribe$.complete()}newOrder(){this.store.dispatch(new Q.m8(void 0)),this.store.dispatch(new Q.uh(void 0)),this.router.navigateByUrl("/restaurante/comanda/favoritos")}openPdfCheck(n,t){if(n){const i=this.estacionVenta.impresoraComprobante?this.estacionVenta.impresoraComprobante.anchoPapel:void 0,s=this.estacionVenta.impresoraComprobante?this.estacionVenta.impresoraComprobante.imprimirLogoTicket:void 0,d=n.map(C=>this.checkService.openPdf(C.id,{escPos:this.configCompany.imprimeTicketsEscPos,paperWidth:i,imprimirLogoTicket:s}));(0,Re.D)(d).subscribe(C=>{console.log("ordersPrint",C),this.dialogService.open(io.Z,{data:{ordersPrint:C.map(w=>({pdfPrint:w,fnPrintQz:()=>{this.checkService.printQz(this.configCompany.imprimeTicketsEscPos?w.escPos:w.base64,this.estacionVenta.impresoraComprobante,this.configCompany.imprimeTicketsEscPos)}}))},header:"Cierre de cuenta",width:"800px"}),t&&C.forEach(w=>{this.checkService.printQz(this.configCompany.imprimeTicketsEscPos?w.escPos:w.base64,this.estacionVenta.impresoraComprobante,this.configCompany.imprimeTicketsEscPos)})})}}}G.\u0275fac=function(n){return new(n||G)(e.Y36(h.ez),e.Y36(_e.r),e.Y36(D.F0),e.Y36(L.xA),e.Y36(H.Y),e.Y36(Oe._),e.Y36(y.yh),e.Y36(h.YP))},G.\u0275cmp=e.Xpm({type:G,selectors:[["app-comandero-menu"]],decls:20,vars:1,consts:[["header","Menu"],[2,"display","flex","align-content","center","justify-content","center"],[1,"grid"],[1,"col-4"],["icon","assets/resources/images/study.svg","label","Comanda",3,"clickCard"],["icon","assets/resources/images/take-away.svg","label","Pedido",3,"clickCard"],["icon","assets/resources/images/check.svg","label","Cerrar cuenta",3,"clickCard"],["icon","assets/resources/images/calculations.png","label","Dividir cuenta",3,"clickCard"],["class","col-4",4,"ngIf"],["icon","assets/resources/images/ver-pedido.svg","label","Ver pedido",3,"clickCard"],["icon","assets/resources/images/impresora.svg","label","Imprimir cuenta",3,"clickCard"],["icon","assets/resources/images/mesa-de-comedor.svg","label","Cambiar mesa",3,"clickCard"],["icon","assets/resources/images/plato_close.png","label","Pedidos anulados",3,"clickCard"],["icon","assets/resources/images/payment.svg","label","Cobrador",3,"clickCard"]],template:function(n,t){1&n&&(e.TgZ(0,"p-panel",0),e.TgZ(1,"div",1),e.TgZ(2,"div",2),e.TgZ(3,"div",3),e.TgZ(4,"app-button-menu",4),e.NdJ("clickCard",function(){return t.createCommand()}),e.qZA(),e.qZA(),e.TgZ(5,"div",3),e.TgZ(6,"app-button-menu",5),e.NdJ("clickCard",function(){return t.newOrder()}),e.qZA(),e.qZA(),e.TgZ(7,"div",3),e.TgZ(8,"app-button-menu",6),e.NdJ("clickCard",function(){return t.openDialogCloseCheck(!1)}),e.qZA(),e.qZA(),e.TgZ(9,"div",3),e.TgZ(10,"app-button-menu",7),e.NdJ("clickCard",function(){return t.openDialogCloseCheck(!0)}),e.qZA(),e.qZA(),e.YNc(11,un,2,0,"div",8),e.TgZ(12,"div",3),e.TgZ(13,"app-button-menu",9),e.NdJ("clickCard",function(){return t.openDialogViewOrder()}),e.qZA(),e.qZA(),e.TgZ(14,"div",3),e.TgZ(15,"app-button-menu",10),e.NdJ("clickCard",function(){return t.openDialogPrintCheck()}),e.qZA(),e.qZA(),e.TgZ(16,"div",3),e.TgZ(17,"app-button-menu",11),e.NdJ("clickCard",function(){return t.openDialogChangeTable()}),e.qZA(),e.qZA(),e.TgZ(18,"div",3),e.TgZ(19,"app-button-menu",12),e.NdJ("clickCard",function(){return t.openDialogCancelOrders()}),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&n&&(e.xp6(11),e.Q6J("ngIf",t.loginService.hasPermission("RESTAURANTE_COBRADOR_VER")))},directives:[Ce.s,pn,v.O5],styles:[""]}),(0,q.gn)([(0,y.Ph)($.Q.table)],G.prototype,"table$",void 0),(0,q.gn)([(0,y.Ph)($.Q.order)],G.prototype,"order$",void 0),(0,q.gn)([(0,y.Ph)(R.Z.getSaleStation)],G.prototype,"estacionVenta$",void 0),(0,q.gn)([(0,y.Ph)(R.Z.getConfig)],G.prototype,"configCompany$",void 0);let mn=(()=>{class o{constructor(t,i,s){this.route=t,this.router=i,this.breadcrumbService=s}ngOnInit(){this.breadcrumbService.setItems((0,l.kn)(this.route))}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(D.gz),e.Y36(D.F0),e.Y36(Z.p))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-comandero"]],decls:6,vars:1,consts:[[1,"grid","p-nogutter"],[1,"col"],[3,"isForChangeTable"],[1,"col-fixed",2,"width","25em"]],template:function(t,i){1&t&&(e.TgZ(0,"p-card"),e.TgZ(1,"div",0),e.TgZ(2,"div",1),e._UZ(3,"app-comandero-mesas",2),e.qZA(),e.TgZ(4,"div",3),e._UZ(5,"app-comandero-menu"),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(3),e.Q6J("isForChangeTable",!1))},directives:[T.Z,j,G],styles:[""]}),o})();class le{constructor(n,t){this.router=n,this.store=t,this.unsubscribe$=new k.xQ,this.tipoPedido=null,this.estadoDelivery=null,this.clickNuevoPedido=new e.vpe,this.clickNuevoEnvio=new e.vpe,this.clickActualizar=new e.vpe}ngOnInit(){this.tiposPedidos=[{label:"Todo",value:["LOCAL","PEDIDO_LOCAL","PEDIDO_FORANEO","PEDIDO_ONLINE"]},{label:"Mesa",value:["LOCAL"]},{label:"Para llevar",value:["PEDIDO_LOCAL"]},{label:"Delivery",value:["PEDIDO_FORANEO"]},{label:"Pedido online",value:["PEDIDO_ONLINE"]}],this.estadosDelivery=[{label:"Todo",value:null},{label:"Pendiente",value:["PENDIENTE"]},{label:"Enviado",value:["ENVIADO"]},{label:"Entregado",value:["ENTREGADO"]},{label:"Cancelado",value:["CANCELADO"]}],this.filtroTiposPedidos$.pipe((0,P.R)(this.unsubscribe$)).subscribe(n=>this.tipoPedido=n),this.filtroEstadoDelivery$.pipe((0,P.R)(this.unsubscribe$)).subscribe(n=>this.estadoDelivery=n)}ngOnDestroy(){this.unsubscribe$.next(),this.unsubscribe$.complete()}volver(){this.router.navigateByUrl("/restaurante/comandero")}changeTipoPedido(){this.store.dispatch(new Ne.NX(this.tipoPedido))}changeEstadoDelivery(){this.store.dispatch(new Ne.Kk(this.estadoDelivery))}}le.\u0275fac=function(n){return new(n||le)(e.Y36(D.F0),e.Y36(y.yh))},le.\u0275cmp=e.Xpm({type:le,selectors:[["app-top-bar"]],outputs:{clickNuevoPedido:"clickNuevoPedido",clickNuevoEnvio:"clickNuevoEnvio",clickActualizar:"clickActualizar"},decls:13,vars:4,consts:[[1,"grid"],[1,"col-fixed"],["pButton","","type","button","label","Regresar","icon","pi pi-angle-left",1,"p-button-danger",3,"click"],["pButton","","type","button","label","Pedido","icon","pi pi-plus",1,"p-button-success",3,"click"],[3,"options","ngModel","onChange","ngModelChange"],["pButton","","type","button","label","Env\xedo","icon","pi pi-plus",1,"p-button-success",3,"click"],["pButton","","type","button","label","Actualizar","icon","pi pi-replay",3,"click"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"button",2),e.NdJ("click",function(){return t.volver()}),e.qZA(),e.qZA(),e.TgZ(3,"div",1),e.TgZ(4,"button",3),e.NdJ("click",function(){return t.clickNuevoPedido.emit()}),e.qZA(),e.qZA(),e.TgZ(5,"div",1),e.TgZ(6,"p-selectButton",4),e.NdJ("onChange",function(){return t.changeTipoPedido()})("ngModelChange",function(s){return t.tipoPedido=s}),e.qZA(),e.qZA(),e.TgZ(7,"div",1),e.TgZ(8,"button",5),e.NdJ("click",function(){return t.clickNuevoEnvio.emit()}),e.qZA(),e.qZA(),e.TgZ(9,"div",1),e.TgZ(10,"p-selectButton",4),e.NdJ("onChange",function(){return t.changeEstadoDelivery()})("ngModelChange",function(s){return t.estadoDelivery=s}),e.qZA(),e.qZA(),e.TgZ(11,"div",1),e.TgZ(12,"button",6),e.NdJ("click",function(){return t.clickActualizar.emit()}),e.qZA(),e.qZA(),e.qZA()),2&n&&(e.xp6(6),e.Q6J("options",t.tiposPedidos)("ngModel",t.tipoPedido),e.xp6(4),e.Q6J("options",t.estadosDelivery)("ngModel",t.estadoDelivery))},directives:[a.Hq,fe.UN,f.JJ,f.On],styles:[""]}),(0,q.gn)([(0,y.Ph)(be.d.filtroTiposPedidos)],le.prototype,"filtroTiposPedidos$",void 0),(0,q.gn)([(0,y.Ph)(be.d.filtroEstadoDelivery)],le.prototype,"filtroEstadoDelivery$",void 0);var Fe=b(9448);function gn(o,n){if(1&o&&(e.TgZ(0,"div",2),e.TgZ(1,"p",6),e._uU(2,"Fecha de env\xedo: "),e.TgZ(3,"span",7),e._uU(4),e.ALo(5,"date"),e.qZA(),e.qZA(),e.qZA()),2&o){const t=e.oxw(2);e.xp6(4),e.hij("",e.xi3(5,1,t.delivery.fechaEnvio,"dd/MM/yyyy hh:mm a")," ")}}function _n(o,n){if(1&o&&(e.TgZ(0,"div",2),e.TgZ(1,"p",6),e._uU(2,"Fecha de entrega: "),e.TgZ(3,"span",7),e._uU(4),e.ALo(5,"date"),e.qZA(),e.qZA(),e.qZA()),2&o){const t=e.oxw(2);e.xp6(4),e.hij("",e.xi3(5,1,t.delivery.fechaEntrega,"dd/MM/yyyy hh:mm a")," ")}}function fn(o,n){if(1&o&&(e.TgZ(0,"div",2),e.TgZ(1,"p",6),e._uU(2,"Cambio: "),e.TgZ(3,"span",16),e._uU(4),e.ALo(5,"montoDinero"),e.qZA(),e.qZA(),e.qZA()),2&o){const t=e.oxw(2);e.xp6(4),e.hij(" ",e.xi3(5,1,t.delivery.montoCambio,"PEN")," ")}}function hn(o,n){1&o&&(e.TgZ(0,"tr"),e.TgZ(1,"th"),e._uU(2,"Pedido"),e.qZA(),e.TgZ(3,"th"),e._uU(4,"Domicilio"),e.qZA(),e.TgZ(5,"th"),e._uU(6,"Forma de pago"),e.qZA(),e.TgZ(7,"th"),e._uU(8,"Nombre"),e.qZA(),e.TgZ(9,"th"),e._uU(10,"Fecha"),e.qZA(),e.TgZ(11,"th"),e._uU(12,"Estado"),e.qZA(),e.TgZ(13,"th"),e._uU(14,"Total"),e.qZA(),e.qZA())}function vn(o,n){if(1&o&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&o){const t=e.oxw().$implicit;e.xp6(1),e.hij(" - Dpto. ",t.ordenRestaurante.numeroDepartamento,"")}}function bn(o,n){if(1&o&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&o){const t=e.oxw().$implicit;e.xp6(1),e.hij(" - (",t.ordenRestaurante.referencia,")")}}function Cn(o,n){if(1&o&&(e.TgZ(0,"tr"),e.TgZ(1,"td"),e._uU(2),e.ALo(3,"completarCeros"),e.qZA(),e.TgZ(4,"td"),e.TgZ(5,"span",7),e._uU(6),e.YNc(7,vn,2,1,"span",17),e.YNc(8,bn,2,1,"span",17),e.qZA(),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.qZA(),e.TgZ(11,"td"),e._uU(12),e.qZA(),e.TgZ(13,"td"),e._uU(14),e.ALo(15,"date"),e.qZA(),e.TgZ(16,"td"),e._uU(17),e.ALo(18,"estadoPedidoRestaurante"),e.qZA(),e.TgZ(19,"td"),e._uU(20),e.qZA(),e.qZA()),2&o){const t=n.$implicit;e.xp6(2),e.Oqu(e.xi3(3,10,t.ordenRestaurante.id,8)),e.xp6(4),e.AsE("",t.ordenRestaurante.direccion," #",t.ordenRestaurante.numero," "),e.xp6(1),e.Q6J("ngIf",t.ordenRestaurante.numeroDepartamento),e.xp6(1),e.Q6J("ngIf",t.ordenRestaurante.referencia),e.xp6(2),e.Oqu(t.ordenRestaurante.nombreFormaPago),e.xp6(2),e.Oqu(t.ordenRestaurante.cliente.razonSocial),e.xp6(2),e.Oqu(e.xi3(15,13,t.ordenRestaurante.fecha,"dd/MM/yyyy hh:mm a")),e.xp6(3),e.Oqu(e.lcZ(18,16,t.ordenRestaurante.estado)),e.xp6(3),e.Oqu(t.ordenRestaurante.montoPedido+t.ordenRestaurante.montoDelivery)}}function Tn(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",21),e.TgZ(1,"p-selectButton",22),e.NdJ("onChange",function(){return e.CHM(t),e.oxw(3).changeEstadoDelivery()})("ngModelChange",function(s){return e.CHM(t),e.oxw(3).delivery.estado=s}),e.qZA(),e.qZA()}if(2&o){const t=e.oxw(3);e.xp6(1),e.Q6J("disabled","CANCELADO"===t.delivery.estado)("options",t.estadosDelivery)("ngModel",t.delivery.estado)}}function Zn(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",1),e.YNc(1,Tn,2,3,"div",18),e.TgZ(2,"div",19),e.TgZ(3,"button",20),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).cancelDelivery()}),e.qZA(),e.qZA(),e.qZA()}if(2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.delivery),e.xp6(2),e.Q6J("disabled","ENVIADO"===t.delivery.estado||"ENTREGADO"===t.delivery.estado||"CANCELADO"===t.delivery.estado)}}function An(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",1),e.TgZ(1,"div",21),e.TgZ(2,"button",23),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).entregaDelivery("ENTREGADO")}),e.qZA(),e.qZA(),e.qZA()}}function xn(o,n){if(1&o&&(e.TgZ(0,"div",1),e.TgZ(1,"div",2),e.TgZ(2,"div",3),e.TgZ(3,"div"),e.TgZ(4,"h3",4),e._uU(5),e.ALo(6,"completarCeros"),e.qZA(),e.qZA(),e.TgZ(7,"div"),e._uU(8),e.ALo(9,"date"),e.qZA(),e.qZA(),e.qZA(),e._UZ(10,"div",5),e.TgZ(11,"div",2),e.TgZ(12,"p",6),e._uU(13,"Repartidor: "),e.TgZ(14,"span",7),e._uU(15),e.qZA(),e.qZA(),e.qZA(),e.TgZ(16,"div",2),e.TgZ(17,"p",6),e._uU(18,"Estado: "),e.TgZ(19,"span",7),e._uU(20),e.qZA(),e.qZA(),e.qZA(),e.YNc(21,gn,6,4,"div",8),e.YNc(22,_n,6,4,"div",8),e.YNc(23,fn,6,4,"div",8),e.TgZ(24,"div",9),e.TgZ(25,"h3",10),e._uU(26,"Pedidos"),e.qZA(),e.TgZ(27,"p-table",11),e.YNc(28,hn,15,0,"ng-template",12),e.YNc(29,Cn,21,18,"ng-template",13),e.qZA(),e.qZA(),e.TgZ(30,"div",9),e.TgZ(31,"label",14),e._uU(32,"Total"),e.qZA(),e.TgZ(33,"p",15),e._uU(34),e.ALo(35,"montoDinero"),e.qZA(),e.qZA(),e.TgZ(36,"div",9),e.YNc(37,Zn,4,2,"div",0),e.YNc(38,An,3,0,"div",0),e.qZA(),e.qZA()),2&o){const t=e.oxw();e.xp6(5),e.hij("Env\xedo #",e.xi3(6,11,t.delivery.id,8),""),e.xp6(3),e.Oqu(e.xi3(9,14,t.delivery.fechaCreacion,"dd/MM/yyyy hh:mm a")),e.xp6(7),e.Oqu(t.delivery.repartidor.nombreCompleto),e.xp6(5),e.Oqu(t.delivery.estado),e.xp6(1),e.Q6J("ngIf",t.delivery.fechaEnvio),e.xp6(1),e.Q6J("ngIf",t.delivery.fechaEntrega),e.xp6(1),e.Q6J("ngIf",t.delivery.montoCambio),e.xp6(4),e.Q6J("value",t.delivery.items),e.xp6(7),e.Oqu(e.xi3(35,17,t.totalEnvio,"PEN")),e.xp6(3),e.Q6J("ngIf",t.modoAdmin),e.xp6(1),e.Q6J("ngIf",t.modoReparto&&"ENVIADO"==t.delivery.estado)}}let yn=(()=>{class o{constructor(t,i,s,d,C,w,F,N){this.deliveryService=t,this.ref=i,this.config=s,this.confirmationService=d,this.restaurantService=C,this.store=w,this.router=F,this.checkService=N}ngOnInit(){this.estadoAnterior=this.delivery.estado,this.estadosDelivery=[{label:"Pendiente",value:"PENDIENTE",disabled:"ENVIADO"===this.delivery.estado||"ENTREGADO"===this.delivery.estado},{label:"Enviado",value:"ENVIADO",disabled:"PENDIENTE"!==this.delivery.estado},{label:"Entregado",value:"ENTREGADO",disabled:"ENVIADO"!==this.delivery.estado}]}get delivery(){return this.config.data.delivery}get modoAdmin(){return this.config.data.modoAdmin}get modoReparto(){return this.config.data.modoReparto}get totalEnvio(){return this.delivery.items.map(t=>t.ordenRestaurante.montoPedido+t.ordenRestaurante.montoDelivery).reduce(l.IH,0)}changeEstadoDelivery(){this.delivery.estado!==this.estadoAnterior&&this.deliveryService.updateStatus(this.delivery.id,this.delivery.estado).subscribe(()=>{this.ref.close(this.delivery.estado)},t=>this.delivery.estado=this.estadoAnterior)}entregaDelivery(t){this.delivery.estado=t,console.log(this.delivery.estado),this.deliveryService.updateStatus(this.delivery.id,this.delivery.estado).subscribe(()=>{this.ref.close(this.delivery.estado)},i=>this.delivery.estado=this.estadoAnterior)}cancelDelivery(){this.confirmationService.confirm({message:"\xbfEst\xe1 seguro de cancelar el env\xedo actual?",accept:()=>{const t="CANCELADO";this.deliveryService.updateStatus(this.delivery.id,t).subscribe(()=>{this.ref.close(t)},i=>this.delivery.estado=this.estadoAnterior)},acceptLabel:"Si",rejectLabel:"No"})}generateCheckOrders(){this.delivery.items.filter(i=>!i.ordenRestaurante.pagado&&"PRECUENTA"!==i.ordenRestaurante.estado),this.ref.close()}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(Fe.p),e.Y36(L.E7),e.Y36(L.S),e.Y36(h.YP),e.Y36(u.T),e.Y36(y.yh),e.Y36(D.F0),e.Y36(Oe._))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-envio-detalle-dialog"]],decls:1,vars:1,consts:[["class","grid",4,"ngIf"],[1,"grid"],[1,"col-6"],[2,"display","flex","flex-direction","column"],[1,"mt-0","mb-0"],[1,"col-6",2,"display","flex","justify-content","flex-end","align-items","center"],[1,"mt-0","mb-0","info-text"],[1,"text-bold"],["class","col-6",4,"ngIf"],[1,"col-12"],[1,"first"],["scrollHeight","200px",3,"value"],["pTemplate","header"],["pTemplate","body"],[1,"label-form"],[1,"mt-0","text-bold"],[1,"custom-badge","status-info"],[4,"ngIf"],["class","col-12 flex-center-x",4,"ngIf"],[1,"col-12","flex-center-x","mt-3"],["pButton","","type","button","label","Cancelar env\xedo",1,"p-button-rounded","p-button-danger","m-1",3,"disabled","click"],[1,"col-12","flex-center-x"],[1,"m-l-10","m-r-10","mt-2",3,"disabled","options","ngModel","onChange","ngModelChange"],["pButton","","type","button","label","Confirmar entrega",1,"p-button-rounded","p-button-success","m-l-5",3,"click"]],template:function(t,i){1&t&&e.YNc(0,xn,39,20,"div",0),2&t&&e.Q6J("ngIf",i.delivery)},directives:[v.O5,A.iA,h.jx,fe.UN,f.JJ,f.On,a.Hq],pipes:[se,v.uU,te.Z,Se],styles:[""]}),o})(),ct=(()=>{class o{constructor(t){this.dialogService=t,this.unsubscribeTimer$=new k.xQ,this.changeStatus=new e.vpe,this.onClick=new e.vpe}get imgCheck(){return"PENDIENTE"===this.delivery.estado?"assets/resources/images/check-default.svg":"ENVIADO"===this.delivery.estado?"assets/resources/images/check-info.svg":"ENTREGADO"===this.delivery.estado?"assets/resources/images/check-success.svg":"assets/resources/images/check-danger.svg"}ngOnInit(){const t=(0,Pe.F)(1e3),i=this.delivery.fechaEnvio?(0,l.t6)(this.delivery.fechaEnvio):"00:00";this.timer$=t.pipe((0,re.U)(s=>i),(0,P.R)(this.unsubscribeTimer$),(0,he.O)(i))}ngOnDestroy(){this.unsubscribeTimer$.next(),this.unsubscribeTimer$.complete()}openDialogDetail(){this.dialogService.open(yn,{header:"Detalle de env\xedo",width:"80%",data:{modoAdmin:this.modoAdmin,modoReparto:this.modoReparto,delivery:Object.assign({},this.delivery)}}).onClose.subscribe(i=>{i&&this.changeStatus.emit(i)})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(L.xA))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-envio-item"]],inputs:{delivery:"delivery",modoAdmin:"modoAdmin",modoReparto:"modoReparto"},outputs:{changeStatus:"changeStatus",onClick:"onClick"},decls:19,vars:12,consts:[[1,"grid","align-content-center","cursor-pointer",3,"click"],["tooltipPosition","top",1,"col-fixed",2,"width","60px",3,"pTooltip"],["alt","",2,"width","60%",3,"src"],[1,"col"],[1,"grid","align-content-center"],[1,"col-2"],[1,"mt-0","mb-0"],[1,"col-4"]],template:function(t,i){1&t&&(e.TgZ(0,"p-card"),e.TgZ(1,"div",0),e.NdJ("click",function(){return i.openDialogDetail()}),e.TgZ(2,"div",1),e._UZ(3,"img",2),e.qZA(),e.TgZ(4,"div",3),e.TgZ(5,"div",4),e.TgZ(6,"div",5),e.TgZ(7,"h3",6),e._uU(8),e.ALo(9,"completarCeros"),e.qZA(),e.qZA(),e.TgZ(10,"div",7),e._uU(11),e.qZA(),e.TgZ(12,"div",5),e._uU(13),e.qZA(),e.TgZ(14,"div",5),e._uU(15),e.qZA(),e.TgZ(16,"div",5),e._uU(17),e.ALo(18,"async"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(2),e.Q6J("pTooltip",i.delivery.estado),e.xp6(1),e.Q6J("src",i.imgCheck,e.LSH),e.xp6(5),e.hij("#",e.xi3(9,7,i.delivery.id,8),""),e.xp6(3),e.hij(" ",i.delivery.repartidor.nombreCompleto," "),e.xp6(2),e.hij(" ",i.delivery.items.length," "),e.xp6(2),e.hij(" ",i.delivery.montoCambio," "),e.xp6(2),e.hij(" ",e.lcZ(18,10,i.timer$)," "))},directives:[T.Z,r.u],pipes:[se,v.Ov],styles:[""]}),o})();function Pn(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",10),e.TgZ(1,"app-envio-item",11),e.NdJ("changeStatus",function(s){return e.CHM(t),e.oxw().changeStatus(s)}),e.qZA(),e.qZA()}if(2&o){const t=n.$implicit;e.xp6(1),e.Q6J("delivery",t)("modoAdmin",!0)}}class ce{constructor(n){this.deliveryService=n,this.unsubscribe$=new k.xQ,this.perPage=10,this.totalRecords=0,this.pageNumber=0,this.deliveries=[],this.cancelDelivery=new e.vpe}ngOnInit(){this.filtroEstadoDelivery$.pipe((0,P.R)(this.unsubscribe$)).subscribe(n=>{this.filtroEstadoDelivery=n,this.loadDeliveries()}),this.puntoVenta$.pipe((0,P.R)(this.unsubscribe$)).subscribe(n=>{this.filtroPuntoVenta=n,this.loadDeliveries()})}ngOnDestroy(){this.unsubscribe$.next(),this.unsubscribe$.complete()}loadDeliveries(){if(void 0!==this.filtroEstadoDelivery&&void 0!==this.filtroPuntoVenta){const n=[`idPuntoVenta=${this.filtroPuntoVenta.id}`,`pageNumber=${this.pageNumber}`,`perPage=${this.perPage}`,"sortField=fechaCreacion","sortOrder=-1"];this.filtroEstadoDelivery&&this.filtroEstadoDelivery.forEach(t=>n.push(`estado=${t}`)),this.deliveryService.findAll(n.join("&")).subscribe(t=>{this.totalRecords=t.totalElements,this.deliveries=t.content})}}pageChanged(n){this.pageNumber=n.page,this.loadDeliveries()}changeStatus(n){this.loadDeliveries(),this.cancelDelivery.emit()}openDeliveryDetail(n){}}ce.\u0275fac=function(n){return new(n||ce)(e.Y36(Fe.p))},ce.\u0275cmp=e.Xpm({type:ce,selectors:[["app-lista-envios"]],outputs:{cancelDelivery:"cancelDelivery"},decls:20,vars:3,consts:[["header","Env\xedos"],[1,"grid"],[1,"col-12"],[1,"grid","text-bold",2,"padding-right","12px","padding-left","12px"],[1,"col-fixed",2,"width","60px"],[1,"col"],[1,"col-2"],[1,"col-4"],["class","mb-2",4,"ngFor","ngForOf"],[3,"rows","totalRecords","onPageChange"],[1,"mb-2"],[3,"delivery","modoAdmin","changeStatus"]],template:function(n,t){1&n&&(e.TgZ(0,"p-panel",0),e.TgZ(1,"div",1),e.TgZ(2,"div",2),e.TgZ(3,"div",3),e._UZ(4,"div",4),e.TgZ(5,"div",5),e.TgZ(6,"div",1),e.TgZ(7,"div",6),e._uU(8," N. Env\xedo "),e.qZA(),e.TgZ(9,"div",7),e._uU(10," Repartidor "),e.qZA(),e.TgZ(11,"div",6),e._uU(12," N. Pedidos "),e.qZA(),e.TgZ(13,"div",6),e._uU(14," Cambio "),e.qZA(),e.TgZ(15,"div",6),e._uU(16," Tiempo "),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.YNc(17,Pn,2,2,"div",8),e.qZA(),e.TgZ(18,"div",2),e.TgZ(19,"p-paginator",9),e.NdJ("onPageChange",function(s){return t.pageChanged(s)}),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&n&&(e.xp6(17),e.Q6J("ngForOf",t.deliveries),e.xp6(2),e.Q6J("rows",t.perPage)("totalRecords",t.totalRecords))},directives:[Ce.s,v.sg,ct,ke.D],styles:[""]}),(0,q.gn)([(0,y.Ph)(be.d.filtroEstadoDelivery)],ce.prototype,"filtroEstadoDelivery$",void 0),(0,q.gn)([(0,y.Ph)(R.Z.getOffice)],ce.prototype,"puntoVenta$",void 0);const Dn=["listaPedidosComponent"],wn=["listaEnviosComponent"];let qn=(()=>{class o{constructor(t,i,s,d,C){this.route=t,this.router=i,this.breadcrumbService=s,this.dialogService=d,this.store=C}ngOnInit(){this.breadcrumbService.setItems((0,l.kn)(this.route))}newDelivery(){this.router.navigateByUrl("/restaurante/nuevo-envio")}newOrder(){this.store.dispatch(new Q.m8(void 0)),this.store.dispatch(new Q.uh(void 0)),this.router.navigateByUrl("/restaurante/comanda/favoritos")}refreshAll(){this.listaPedidosComponent.loadPedidos(),this.listaEnviosComponent.loadDeliveries()}refreshOrders(){this.listaPedidosComponent.loadPedidos()}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(D.gz),e.Y36(D.F0),e.Y36(Z.p),e.Y36(L.xA),e.Y36(y.yh))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-pedidos"]],viewQuery:function(t,i){if(1&t&&(e.Gf(Dn,7),e.Gf(wn,7)),2&t){let s;e.iGM(s=e.CRH())&&(i.listaPedidosComponent=s.first),e.iGM(s=e.CRH())&&(i.listaEnviosComponent=s.first)}},decls:10,vars:0,consts:[[1,"grid","p-align-stretch","vertical-container"],[1,"col-12"],[3,"clickNuevoPedido","clickNuevoEnvio","clickActualizar"],[1,"col-12","md:col-4","lg:col-3"],["listaPedidosComponent",""],[1,"col-12","md:col-8","lg:col-9"],[3,"cancelDelivery"],["listaEnviosComponent",""]],template:function(t,i){1&t&&(e.TgZ(0,"p-card"),e.TgZ(1,"div",0),e.TgZ(2,"div",1),e.TgZ(3,"app-top-bar",2),e.NdJ("clickNuevoPedido",function(){return i.newOrder()})("clickNuevoEnvio",function(){return i.newDelivery()})("clickActualizar",function(){return i.refreshAll()}),e.qZA(),e.qZA(),e.TgZ(4,"div",3),e._UZ(5,"app-lista-pedidos",null,4),e.qZA(),e.TgZ(7,"div",5),e.TgZ(8,"app-lista-envios",6,7),e.NdJ("cancelDelivery",function(){return i.refreshOrders()}),e.qZA(),e.qZA(),e.qZA(),e.qZA())},directives:[T.Z,le,B,ce],styles:[""]}),o})(),On=(()=>{class o{constructor(t,i,s,d){this.route=t,this.router=i,this.breadcrumbService=s,this.dialogService=d}ngOnInit(){this.breadcrumbService.setItems((0,l.kn)(this.route))}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(D.gz),e.Y36(D.F0),e.Y36(Z.p),e.Y36(L.xA))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-cobrador"]],decls:4,vars:0,consts:[[1,"grid"],[1,"col-12"]],template:function(t,i){1&t&&(e.TgZ(0,"p-card"),e.TgZ(1,"div",0),e.TgZ(2,"div",1),e._UZ(3,"router-outlet"),e.qZA(),e.qZA(),e.qZA())},directives:[T.Z,D.lC],styles:[""]}),o})();var ie=b(24183),Te=b(52446);function In(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",1),e.TgZ(1,"button",5),e.NdJ("click",function(){return e.CHM(t),e.oxw().mostrarCuentas()}),e.qZA(),e.qZA()}}function En(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",1),e.TgZ(1,"p-selectButton",6),e.NdJ("onChange",function(){return e.CHM(t),e.oxw().changeTipoCuenta()})("ngModelChange",function(s){return e.CHM(t),e.oxw().tipoCuenta=s}),e.qZA(),e.qZA()}if(2&o){const t=e.oxw();e.xp6(1),e.Q6J("options",t.tiposCuentas)("ngModel",t.tipoCuenta)}}function Sn(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",1),e.TgZ(1,"p-selectButton",6),e.NdJ("onChange",function(){return e.CHM(t),e.oxw().changeEstadoPago()})("ngModelChange",function(s){return e.CHM(t),e.oxw().estadoPago=s}),e.qZA(),e.qZA()}if(2&o){const t=e.oxw();e.xp6(1),e.Q6J("options",t.estadosPago)("ngModel",t.estadoPago)}}function Nn(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",1),e.TgZ(1,"p-calendar",7),e.NdJ("onSelect",function(){return e.CHM(t),e.oxw().changeFecha()})("ngModelChange",function(s){return e.CHM(t),e.oxw().fecha=s}),e.qZA(),e.qZA()}if(2&o){const t=e.oxw();e.xp6(1),e.Q6J("readonlyInput",!0)("ngModel",t.fecha)("locale",t.ls.calendarEs)}}class X{constructor(n,t,i,s){this.router=n,this.store=t,this.route=i,this.ls=s,this.unsubscribe$=new k.xQ,this.clickActualizar=new e.vpe}ngOnInit(){this.fecha=new Date,this.changeFecha(),this.tiposCuentas=[{label:"Todo",value:["LOCAL","PEDIDO_LOCAL","PEDIDO_FORANEO","PEDIDO_ONLINE"]},{label:"Mesas",value:["LOCAL"]},{label:"Pedidos",value:["PEDIDO_LOCAL"]},{label:"Envios",value:["PEDIDO_FORANEO","PEDIDO_ONLINE"]}],this.estadosPago=[{label:"Pagado",value:!0},{label:"Pendiente pago",value:!1}],this.filtroTipoCuentaPorCobrar$.pipe((0,P.R)(this.unsubscribe$)).subscribe(n=>this.tipoCuenta=n),this.filtroEstadoPagoCuentaPorCobrar$.pipe((0,P.R)(this.unsubscribe$)).subscribe(n=>this.estadoPago=n)}volver(){this.router.navigateByUrl("/restaurante/comandero")}mostrarCuentas(){this.router.navigateByUrl("/restaurante/cobrador/cuentas")}changeTipoCuenta(){this.store.dispatch(new Te.bD(this.tipoCuenta))}changeEstadoPago(){this.store.dispatch(new Te.F1(this.estadoPago))}changeFecha(){this.store.dispatch(new Te.ep(this.fecha.getTime()))}}X.\u0275fac=function(n){return new(n||X)(e.Y36(D.F0),e.Y36(y.yh),e.Y36(D.gz),e.Y36(Ye.E))},X.\u0275cmp=e.Xpm({type:X,selectors:[["app-top-bar-cobrador"]],inputs:{showFilters:"showFilters",showButtonCuentas:"showButtonCuentas"},outputs:{clickActualizar:"clickActualizar"},decls:9,vars:4,consts:[[1,"grid"],[1,"col-fixed"],["pButton","","type","button","label","Regresar","icon","pi pi-angle-left",1,"p-button-danger",3,"click"],["class","col-fixed",4,"ngIf"],["pTooltip","Actualizar","pButton","","type","button","icon","pi pi-replay",3,"click"],["pButton","","type","button","label","Mostrar cuentas","icon","fa fa-file-text-o",3,"click"],[3,"options","ngModel","onChange","ngModelChange"],["dateFormat","dd/mm/yy",3,"readonlyInput","ngModel","locale","onSelect","ngModelChange"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"button",2),e.NdJ("click",function(){return t.volver()}),e.qZA(),e.qZA(),e.YNc(3,In,2,0,"div",3),e.YNc(4,En,2,2,"div",3),e.YNc(5,Sn,2,2,"div",3),e.TgZ(6,"div",1),e.TgZ(7,"button",4),e.NdJ("click",function(){return t.clickActualizar.emit()}),e.qZA(),e.qZA(),e.YNc(8,Nn,2,3,"div",3),e.qZA()),2&n&&(e.xp6(3),e.Q6J("ngIf",t.showButtonCuentas),e.xp6(1),e.Q6J("ngIf",t.showFilters),e.xp6(1),e.Q6J("ngIf",t.showFilters),e.xp6(3),e.Q6J("ngIf",t.showFilters))},directives:[a.Hq,v.O5,fe.UN,f.JJ,f.On,r.u,Be.f],styles:[""]}),(0,q.gn)([(0,y.Ph)(ie.X.filtroTipoCuentaPorCobrar)],X.prototype,"filtroTipoCuentaPorCobrar$",void 0),(0,q.gn)([(0,y.Ph)(ie.X.filtroEstadoPagoCuentaPorCobrar)],X.prototype,"filtroEstadoPagoCuentaPorCobrar$",void 0),(0,q.gn)([(0,y.Ph)(ie.X.filtroFechaCuentaPorCobrar)],X.prototype,"filtroFechaCuentaPorCobrar$",void 0);var dt=b(42939),pt=b(66239);function kn(o,n){1&o&&e._UZ(0,"img",15)}function Fn(o,n){1&o&&e._UZ(0,"img",16)}function Mn(o,n){1&o&&e._UZ(0,"img",17)}function Ln(o,n){if(1&o&&(e.TgZ(0,"p",18),e._uU(1),e.qZA()),2&o){const t=e.oxw(2);e.xp6(1),e.AsE("M",null==t.cuenta||null==t.cuenta.pedido||null==t.cuenta.pedido.mesa?null:t.cuenta.pedido.mesa.numero," (",null==t.cuenta||null==t.cuenta.pedido||null==t.cuenta.pedido.mesa||null==t.cuenta.pedido.mesa.salon?null:t.cuenta.pedido.mesa.salon.nombre,")")}}function Rn(o,n){if(1&o&&(e.TgZ(0,"p",18),e._uU(1),e.ALo(2,"completarCeros"),e.qZA()),2&o){const t=e.oxw(2);e.xp6(1),e.hij("Pedido #",e.xi3(2,1,t.cuenta.pedido.id,8),"")}}function Jn(o,n){if(1&o&&(e.TgZ(0,"p",18),e._uU(1),e.ALo(2,"completarCeros"),e.qZA()),2&o){const t=e.oxw(2);e.xp6(1),e.hij("Pedido #",e.xi3(2,1,t.cuenta.pedido.id,8),"")}}function Un(o,n){if(1&o&&(e.TgZ(0,"span",22),e._UZ(1,"span",23),e._uU(2),e.qZA()),2&o){const t=e.oxw(3);e.xp6(2),e.hij(" ",null==t.cuenta||null==t.cuenta.pedido?null:t.cuenta.pedido.direccionCompleta,"")}}function $n(o,n){if(1&o&&(e.TgZ(0,"div",19),e.TgZ(1,"span"),e._UZ(2,"span",20),e._uU(3),e.qZA(),e.YNc(4,Un,3,1,"span",21),e.qZA()),2&o){const t=e.oxw(2);e.xp6(3),e.hij(" ",null==t.cuenta||null==t.cuenta.cliente?null:t.cuenta.cliente.razonSocial,""),e.xp6(1),e.Q6J("ngIf","PEDIDO_FORANEO"===t.cuenta.pedido.tipo||"PEDIDO_ONLINE"===t.cuenta.pedido.tipo)}}function Qn(o,n){1&o&&(e.TgZ(0,"span",24),e._uU(1,"Pagado"),e.qZA())}function Yn(o,n){1&o&&(e.TgZ(0,"span",25),e._uU(1,"Pendiente pago"),e.qZA())}function Bn(o,n){if(1&o&&(e.TgZ(0,"div",1),e.TgZ(1,"div",2),e.YNc(2,kn,1,0,"img",3),e.YNc(3,Fn,1,0,"img",4),e.YNc(4,Mn,1,0,"img",5),e.qZA(),e.TgZ(5,"div",6),e.TgZ(6,"div",7),e.TgZ(7,"div",8),e.YNc(8,Ln,2,2,"p",9),e.YNc(9,Rn,3,4,"p",9),e.YNc(10,Jn,3,4,"p",9),e.YNc(11,$n,5,2,"div",10),e.qZA(),e.TgZ(12,"div",8),e.TgZ(13,"p",11),e.YNc(14,Qn,2,0,"span",12),e.YNc(15,Yn,2,0,"span",13),e.TgZ(16,"span",14),e._uU(17),e.ALo(18,"montoDinero"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&o){const t=e.oxw();e.xp6(2),e.Q6J("ngIf","LOCAL"===t.cuenta.pedido.tipo),e.xp6(1),e.Q6J("ngIf","PEDIDO_FORANEO"===t.cuenta.pedido.tipo||"PEDIDO_ONLINE"===t.cuenta.pedido.tipo),e.xp6(1),e.Q6J("ngIf","PEDIDO_LOCAL"===t.cuenta.pedido.tipo),e.xp6(4),e.Q6J("ngIf","LOCAL"===t.cuenta.pedido.tipo),e.xp6(1),e.Q6J("ngIf","PEDIDO_FORANEO"===t.cuenta.pedido.tipo||"PEDIDO_ONLINE"===t.cuenta.pedido.tipo),e.xp6(1),e.Q6J("ngIf","PEDIDO_LOCAL"===t.cuenta.pedido.tipo),e.xp6(1),e.Q6J("ngIf","PEDIDO_FORANEO"===t.cuenta.pedido.tipo||"PEDIDO_ONLINE"===t.cuenta.pedido.tipo||"PEDIDO_LOCAL"===t.cuenta.pedido.tipo),e.xp6(3),e.Q6J("ngIf",t.cuenta.pagado),e.xp6(1),e.Q6J("ngIf",!t.cuenta.pagado),e.xp6(2),e.Oqu(e.xi3(18,10,t.total,"PEN"))}}class de{constructor(){this.configCompany={},this.unsubscribe$=new k.xQ}ngOnInit(){this.configCompany$.pipe((0,pt.Rs)(this.unsubscribe$)).subscribe(n=>{this.configCompany=n})}get total(){return this.cuenta.items.filter(n=>"CANCELADO"!==n.estadoComandaDetalle).map(n=>{let t=n.precioVenta;return n.producto&&n.producto.recargoConsumo&&(t+=t/(this.configCompany.igv+1)*(n.producto.recargoConsumo/100)),t*n.cantidad}).reduce(l.IH,0)+(void 0!==this.cuenta.pedido.montoDelivery?this.cuenta.pedido.montoDelivery:0)}}function Hn(o,n){if(1&o&&(e.TgZ(0,"span",7),e._uU(1),e.ALo(2,"completarCeros"),e.qZA()),2&o){const t=n.$implicit;e.xp6(1),e.hij(" ",e.xi3(2,1,t,8)," ")}}function jn(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",8),e.NdJ("click",function(){const d=e.CHM(t).$implicit;return e.oxw().openCheckToPay(d)}),e.TgZ(1,"p-card"),e._UZ(2,"app-detalle-item-cuenta",9),e.qZA(),e.qZA()}if(2&o){const t=n.$implicit;e.Q6J("ngClass",t.pagado?"":"cursor-pointer"),e.xp6(2),e.Q6J("cuenta",t)}}de.\u0275fac=function(n){return new(n||de)},de.\u0275cmp=e.Xpm({type:de,selectors:[["app-detalle-item-cuenta"]],inputs:{cuenta:"cuenta"},ngContentSelectors:["*"],decls:2,vars:1,consts:[["class","grid p-nogutter",4,"ngIf"],[1,"grid","p-nogutter"],[1,"col-fixed",2,"width","20px"],["style","width: 100%;","src","assets/resources/images/desk.svg","alt","",4,"ngIf"],["style","width: 100%;","src","assets/resources/images/food-delivery.svg","alt","",4,"ngIf"],["style","width: 100%;","src","assets/resources/images/lunch.svg","alt","",4,"ngIf"],[1,"col"],[1,"grid","p-nogutter","ml-2"],[1,"col-6"],["class","mt-0 mb-0 text-bold",4,"ngIf"],["class","mt-0 mb-0",4,"ngIf"],[1,"mt-1","mb-0","text-bold",2,"text-align","right"],["class","custom-badge status-success",4,"ngIf"],["class","custom-badge status-warning",4,"ngIf"],[1,"ml-2"],["src","assets/resources/images/desk.svg","alt","",2,"width","100%"],["src","assets/resources/images/food-delivery.svg","alt","",2,"width","100%"],["src","assets/resources/images/lunch.svg","alt","",2,"width","100%"],[1,"mt-0","mb-0","text-bold"],[1,"mt-0","mb-0"],[1,"fa","fa-user"],["class","ml-4",4,"ngIf"],[1,"ml-4"],[1,"fa","fa-map-marker"],[1,"custom-badge","status-success"],[1,"custom-badge","status-warning"]],template:function(n,t){1&n&&(e.F$t(),e.YNc(0,Bn,19,13,"div",0),e.Hsn(1)),2&n&&e.Q6J("ngIf",t.cuenta)},directives:[v.O5],pipes:[se,te.Z],styles:[""]}),(0,q.gn)([(0,y.Ph)(R.Z.getConfig)],de.prototype,"configCompany$",void 0);class V{constructor(n,t,i,s,d,C,w){this.route=n,this.router=t,this.breadcrumbService=i,this.dialogService=s,this.checkService=d,this.store=C,this.datePipe=w,this.unsubscribe$=new k.xQ}ngOnInit(){this.breadcrumbService.setItems((0,l.kn)(this.route)),this.filtroTipoCuentaPorCobrar$.pipe((0,P.R)(this.unsubscribe$)).subscribe(n=>{this.filtroTipoCuentaPorCobrar=n,this.loadChecks()}),this.filtroEstadoPagoCuentaPorCobrar$.pipe((0,P.R)(this.unsubscribe$)).subscribe(n=>{this.filtroEstadoPagoCuentaPorCobrar=n,this.loadChecks()}),this.filtroFechaCuentaPorCobrar$.pipe((0,P.R)(this.unsubscribe$)).subscribe(n=>{this.filtroFechaCuentaPorCobrar=n?new Date(n):new Date,this.loadChecks()}),this.puntoVenta$.pipe((0,P.R)(this.unsubscribe$)).subscribe(n=>{this.puntoVenta=n,this.loadChecks()}),this.filtroIdPedido$.pipe((0,P.R)(this.unsubscribe$)).subscribe(n=>{this.filtroIdPedido=n,this.loadChecks()})}onAddIdPedido(n){this.store.dispatch(new Te.ef(n.value))}onRemoveIdPedido(n){this.store.dispatch(new Te.a1(n.value))}ngOnDestroy(){this.unsubscribe$.next(),this.unsubscribe$.complete()}loadChecks(){if(this.puntoVenta&&void 0!==this.filtroTipoCuentaPorCobrar&&void 0!==this.filtroEstadoPagoCuentaPorCobrar&&void 0!==this.filtroIdPedido&&void 0!==this.filtroFechaCuentaPorCobrar){const n=[`pagado=${this.filtroEstadoPagoCuentaPorCobrar}`,`idPuntoVenta=${this.puntoVenta.id}`,`fecha=${this.datePipe.transform(this.filtroFechaCuentaPorCobrar,"dd-MM-yyyy")}`];this.filtroTipoCuentaPorCobrar&&this.filtroTipoCuentaPorCobrar.forEach(i=>n.push(`tipoPedido=${i}`)),this.filtroIdPedido&&this.filtroIdPedido.forEach(i=>n.push(`idPedido=${i}`));const t=i=>{this.cuentas=i,i.map(s=>s.pedido).filter(s=>s.pagado).forEach(s=>this.onRemoveIdPedido(s.id))};this.checkService.findAll(n.join("&")).subscribe(t)}}openCheckToPay(n){n.pagado||this.router.navigateByUrl(`/restaurante/cobrador/cuentas/cobrar/${n.id}`)}}V.\u0275fac=function(n){return new(n||V)(e.Y36(D.gz),e.Y36(D.F0),e.Y36(Z.p),e.Y36(L.xA),e.Y36(Oe._),e.Y36(y.yh),e.Y36(v.uU))},V.\u0275cmp=e.Xpm({type:V,selectors:[["app-lista-cuentas-por-cobrar"]],decls:9,vars:4,consts:[[1,"grid"],[1,"col-12"],[3,"showButtonCuentas","showFilters","clickActualizar"],[1,"col-12","p-fluid"],["pKeyFilter","num","placeholder","# pedido.",3,"ngModel","onRemove","onAdd","ngModelChange"],["pTemplate","item"],["class","col-12",3,"ngClass","click",4,"ngFor","ngForOf"],[2,"margin-right","1.3em"],[1,"col-12",3,"ngClass","click"],[3,"cuenta"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"app-top-bar-cobrador",2),e.NdJ("clickActualizar",function(){return t.loadChecks()}),e.qZA(),e.qZA(),e.TgZ(3,"div",3),e.TgZ(4,"p-chips",4),e.NdJ("onRemove",function(s){return t.onRemoveIdPedido(s)})("onAdd",function(s){return t.onAddIdPedido(s)})("ngModelChange",function(s){return t.filtroIdPedido=s}),e.YNc(5,Hn,3,4,"ng-template",5),e.qZA(),e.qZA(),e.TgZ(6,"div",1),e.TgZ(7,"div",0),e.YNc(8,jn,3,2,"div",6),e.qZA(),e.qZA(),e.qZA()),2&n&&(e.xp6(2),e.Q6J("showButtonCuentas",!1)("showFilters",!0),e.xp6(2),e.Q6J("ngModel",t.filtroIdPedido),e.xp6(4),e.Q6J("ngForOf",t.cuentas))},directives:[X,dt.cL,ve.Fr,f.JJ,f.On,h.jx,v.sg,v.mk,T.Z,de],pipes:[se],styles:[""]}),(0,q.gn)([(0,y.Ph)(ie.X.filtroTipoCuentaPorCobrar)],V.prototype,"filtroTipoCuentaPorCobrar$",void 0),(0,q.gn)([(0,y.Ph)(ie.X.filtroEstadoPagoCuentaPorCobrar)],V.prototype,"filtroEstadoPagoCuentaPorCobrar$",void 0),(0,q.gn)([(0,y.Ph)(ie.X.filtroFechaCuentaPorCobrar)],V.prototype,"filtroFechaCuentaPorCobrar$",void 0),(0,q.gn)([(0,y.Ph)(ie.X.filtroIdPedido)],V.prototype,"filtroIdPedido$",void 0),(0,q.gn)([(0,y.Ph)(R.Z.getOffice)],V.prototype,"puntoVenta$",void 0);var zn=b(57446);class Ze{constructor(n){this.store=n,this.unsubscribe$=new k.xQ}ngOnInit(){this.cuentaPorCobrar$.pipe((0,P.R)(this.unsubscribe$)).subscribe(n=>{this.cuenta=n})}ngOnDestroy(){this.unsubscribe$.next(),this.unsubscribe$.complete(),this.store.dispatch(new Te.N(void 0))}}function Gn(o,n){if(1&o&&(e.TgZ(0,"div",4),e.TgZ(1,"div",5),e._UZ(2,"img",6),e.qZA(),e.TgZ(3,"div",7),e._uU(4),e.qZA(),e.qZA()),2&o){const t=n.$implicit;e.Q6J("routerLink",t.routerLink),e.xp6(2),e.Q6J("src",t.icon,e.LSH),e.xp6(2),e.hij(" ",t.label," ")}}Ze.\u0275fac=function(n){return new(n||Ze)(e.Y36(y.yh))},Ze.\u0275cmp=e.Xpm({type:Ze,selectors:[["app-cuenta-por-cobrar"]],decls:7,vars:4,consts:[[1,"grid"],[1,"col-12","md:col-8"],[3,"showButtonCuentas","showFilters"],[1,"col-12","md:col-4"],[3,"cuenta"],[1,"col-12"],[3,"liteInterface"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e._UZ(2,"app-top-bar-cobrador",2),e.qZA(),e.TgZ(3,"div",3),e._UZ(4,"app-detalle-item-cuenta",4),e.qZA(),e.TgZ(5,"div",5),e._UZ(6,"app-emitir-comprobante",6),e.qZA(),e.qZA()),2&n&&(e.xp6(2),e.Q6J("showButtonCuentas",!0)("showFilters",!1),e.xp6(2),e.Q6J("cuenta",t.cuenta),e.xp6(2),e.Q6J("liteInterface",!0))},directives:[X,de,zn.f],styles:[""]}),(0,q.gn)([(0,y.Ph)(ie.X.cuentaPorCobrar)],Ze.prototype,"cuentaPorCobrar$",void 0);let Xn=(()=>{class o{constructor(){this.menuItems=[]}ngOnInit(){this.menuItems=[{label:"Buscar",icon:"/assets/resources/images/search.svg",routerLink:"/restaurante/comanda/buscar-productos"},{label:"Favoritos",icon:"/assets/resources/images/star.svg",routerLink:"/restaurante/comanda/favoritos"},{label:"Categor\xedas",icon:"/assets/resources/images/fast-food.svg",routerLink:"/restaurante/comanda/categorias"}]}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-comanda-productos"]],decls:5,vars:1,consts:[[1,"grid"],["routerLinkActive","item-menu-products-active","class","col item-menu-products cursor-pointer",3,"routerLink",4,"ngFor","ngForOf"],[1,"col-12"],[1,"mt-2"],["routerLinkActive","item-menu-products-active",1,"col","item-menu-products","cursor-pointer",3,"routerLink"],[1,"flex-center-x"],["alt","",2,"width","40px",3,"src"],[1,"center","text-bold"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.YNc(1,Gn,5,3,"div",1),e.TgZ(2,"div",2),e.TgZ(3,"div",3),e._UZ(4,"router-outlet"),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(1),e.Q6J("ngForOf",i.menuItems))},directives:[v.sg,D.Od,D.rH,D.lC],styles:[".item-menu-products[_ngcontent-%COMP%]:hover{background:#dddddd}.item-menu-products[_ngcontent-%COMP%]:focus{outline:0}.item-menu-products-active[_ngcontent-%COMP%]{background:#477fca;color:#fff}"]}),o})();var Wn=b(29729),Kn=b(73407),ut=b(10930);function ei(o,n){if(1&o&&(e.TgZ(0,"div",8),e.TgZ(1,"h4",9),e._uU(2),e.ALo(3,"montoDinero"),e.qZA(),e.TgZ(4,"p",10),e._uU(5,"Precio"),e.qZA(),e.qZA()),2&o){const t=e.oxw().$implicit;e.xp6(2),e.Oqu(e.xi3(3,1,t.precio,t.producto.moneda))}}function ti(o,n){1&o&&(e.TgZ(0,"h4",9),e._uU(1,"Sin costo"),e.qZA())}function oi(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",2),e.TgZ(1,"div",3),e.TgZ(2,"div",4),e._uU(3),e.qZA(),e.TgZ(4,"div",5),e.YNc(5,ei,6,4,"div",6),e.YNc(6,ti,2,0,"ng-template",null,7,e.W1O),e.qZA(),e.TgZ(8,"div",5),e.TgZ(9,"div",8),e.TgZ(10,"h4",9),e._uU(11),e.ALo(12,"montoDinero"),e.qZA(),e.TgZ(13,"p",10),e._uU(14,"Importe"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(15,"div",11),e.TgZ(16,"div",12),e.TgZ(17,"div",13),e.TgZ(18,"p-button",14),e.NdJ("click",function(){const d=e.CHM(t).$implicit;return e.oxw().removeOption(d)}),e.qZA(),e.qZA(),e.TgZ(19,"div",15),e.TgZ(20,"h3",9),e._uU(21),e.qZA(),e.qZA(),e.TgZ(22,"div",13),e.TgZ(23,"button",16),e.NdJ("click",function(){const d=e.CHM(t).$implicit;return e.oxw().addOption(d)}),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&o){const t=n.$implicit,i=e.MAs(7),s=e.oxw();e.xp6(3),e.hij(" ",t.nombreOpcion," "),e.xp6(2),e.Q6J("ngIf",t.precio>0)("ngIfElse",i),e.xp6(6),e.Oqu(e.xi3(12,7,t.precio*t.cantidad,t.producto.moneda)),e.xp6(7),e.Q6J("disabled",0===(null==t?null:t.cantidad)),e.xp6(3),e.Oqu(null==t?null:t.cantidad),e.xp6(2),e.Q6J("disabled",1===(null==t?null:t.cantidad)&&!s.group.permitirCantidad)}}let ni=(()=>{class o{constructor(){this.commandDetailGroupOptions=[],this.onChange=t=>{},this.onTouched=t=>{}}ngOnInit(){this.group.opciones.forEach(t=>{this.commandDetailGroupOptions.push({idGrupo:this.group.id,idOpcion:t.id,porcion:t.porcion,precio:t.precio,nombreGrupo:this.group.nombre,nombreOpcion:t.nombre,cantidad:0,producto:t.producto})})}addOption(t){t.cantidad=t.cantidad+1,this.propagateChange()}removeOption(t){t.cantidad=t.cantidad-1,this.propagateChange()}propagateChange(){const t=this.commandDetailGroupOptions.filter(i=>i.cantidad>0);this.onChange(t),this.onTouched(t)}registerOnChange(t){this.onChange=t}registerOnTouched(t){this.onTouched=t}writeValue(t){t&&(t.forEach(i=>{const s=this.commandDetailGroupOptions.find(d=>d.idGrupo===i.idGrupo&&d.idOpcion===i.idOpcion);s&&(s.cantidad=i.cantidad)}),this.propagateChange())}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-comanda-registro-detalle-selector-opciones-grupo"]],inputs:{group:"group"},features:[e._Bn([{provide:f.JU,useExisting:(0,e.Gpc)(()=>o),multi:!0}])],decls:2,vars:1,consts:[[1,"grid"],["class","col-12",4,"ngFor","ngForOf"],[1,"col-12"],[1,"grid","p-nogutter"],[1,"col-12","md:col-5",2,"display","flex","flex-direction","row","flex-wrap","nowrap","justify-content","flex-start","align-content","stretch","align-items","center"],[1,"col-12","md:col-2","flex-center-x-y"],["style","text-align: center",4,"ngIf","ngIfElse"],["free",""],[2,"text-align","center"],[1,"mt-0","mb-0"],[1,"mt-0","mb-0",2,"font-size","10px"],[1,"col-12","md:col-3","flex-center-x-y"],[1,"grid","p-nogutter","flex","justify-content-center"],[1,"col-fixed","flex-center-x"],["icon","fa fa-minus",3,"disabled","click"],[1,"col-fixed","flex-center-x-y"],["pButton","","type","button","icon","fa fa-plus",3,"disabled","click"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.YNc(1,oi,24,10,"div",1),e.qZA()),2&t&&(e.xp6(1),e.Q6J("ngForOf",i.commandDetailGroupOptions))},directives:[v.sg,v.O5,a.zx,a.Hq],pipes:[te.Z],styles:[""]}),o})();function ii(o,n){if(1&o&&(e.TgZ(0,"span",40),e._uU(1),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.hij("(",t.preparaciones,")")}}function ai(o,n){if(1&o&&(e.TgZ(0,"p",41),e._uU(1),e.qZA()),2&o){const t=n.$implicit;e.xp6(1),e.lnq(" ",t.cantidad,"x ",t.nombreGrupo,": ",t.nombreOpcion," ")}}function ri(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"input",42),e.NdJ("input",function(){return e.CHM(t),e.oxw().calculatePrecioVentaFromPrecioVentaRc()}),e.qZA()}}function si(o,n){1&o&&e._UZ(0,"p-message",43)}function li(o,n){1&o&&e._UZ(0,"p-message",44)}function ci(o,n){if(1&o&&(e.TgZ(0,"div",45),e._UZ(1,"input",52),e.TgZ(2,"label",53),e._uU(3),e.qZA(),e.qZA()),2&o){const t=n.$implicit,i=e.oxw().$implicit;e.xp6(1),e.s9C("id",t.id),e.s9C("value",t.id),e.s9C("name","prep"+i.preparacion.id),e.s9C("formControlName","prep"+i.preparacion.id),e.xp6(1),e.s9C("for",t.id),e.xp6(1),e.Oqu(t.opcion)}}function di(o,n){if(1&o&&e._UZ(0,"p-message",54),2&o){const t=e.oxw().$implicit;e.Q6J("text",t.preparacion.nombre+": Debe seleccionar una opci\xf3n")}}function pi(o,n){if(1&o&&(e.TgZ(0,"div",48),e.TgZ(1,"label",49),e._uU(2),e.qZA(),e.TgZ(3,"p-card"),e.TgZ(4,"div",12),e.YNc(5,ci,4,6,"div",50),e.qZA(),e.qZA(),e.YNc(6,di,1,1,"p-message",51),e.qZA()),2&o){const t=n.$implicit,i=e.oxw(2);e.xp6(2),e.Oqu(t.preparacion.nombre),e.xp6(3),e.Q6J("ngForOf",t.preparacion.opciones),e.xp6(1),e.Q6J("ngIf",i.form.get("prep"+t.preparacion.id).touched&&(null==i.form.get("prep"+t.preparacion.id).errors?null:i.form.get("prep"+t.preparacion.id).errors.required))}}function ui(o,n){if(1&o&&(e.TgZ(0,"div",45),e.TgZ(1,"h3",46),e._uU(2,"Preparaciones"),e.qZA(),e.TgZ(3,"div",12),e.YNc(4,pi,7,3,"div",47),e.qZA(),e.qZA()),2&o){const t=e.oxw();e.xp6(4),e.Q6J("ngForOf",null==t.commandDetail.producto?null:t.commandDetail.producto.preparaciones)}}function mi(o,n){if(1&o&&e._UZ(0,"p-message",54),2&o){const t=e.oxw().$implicit,i=e.oxw(2);e.Q6J("text",null==i.form.get("grup"+t.id).errors?null:i.form.get("grup"+t.id).errors.groupValidation.message)}}function gi(o,n){if(1&o&&(e.TgZ(0,"div",45),e.TgZ(1,"label",49),e._uU(2),e.qZA(),e.TgZ(3,"p-card"),e._UZ(4,"app-comanda-registro-detalle-selector-opciones-grupo",55),e.qZA(),e.YNc(5,mi,1,1,"p-message",51),e.qZA()),2&o){const t=n.$implicit,i=e.oxw(2);e.xp6(2),e.Oqu(t.nombre),e.xp6(2),e.s9C("formControlName","grup"+t.id),e.Q6J("group",t),e.xp6(1),e.Q6J("ngIf",i.form.get("grup"+t.id).touched&&(null==i.form.get("grup"+t.id).errors?null:i.form.get("grup"+t.id).errors.groupValidation))}}function _i(o,n){if(1&o&&(e.TgZ(0,"div",45),e.TgZ(1,"h3",46),e._uU(2,"Adicionales"),e.qZA(),e.TgZ(3,"form",11),e.TgZ(4,"div",12),e.YNc(5,gi,6,4,"div",50),e.qZA(),e.qZA(),e.qZA()),2&o){const t=e.oxw();e.xp6(3),e.Q6J("formGroup",t.form),e.xp6(2),e.Q6J("ngForOf",null==t.commandDetail||null==t.commandDetail.producto?null:t.commandDetail.producto.grupos)}}const fi=function(){return{width:"85%"}};class ae{constructor(n){this.fb=n,this.displayFormModal=!1,this.configCompany={},this.delete=new e.vpe,this.unsubscribe$=new k.xQ,this.onChange=t=>{},this.onTouched=t=>{}}get commandDetail(){return{producto:this.form.getRawValue().producto,cantidad:this.form.getRawValue().cantidad,precioVenta:this.form.getRawValue().precioVenta,precioVentaRc:this.form.getRawValue().precioVentaRc,nota:this.form.getRawValue().nota,paraLlevar:this.form.getRawValue().paraLlevar,grupoProductoOpciones:this.commandDetailGroupOptions,preparacionProductoOpciones:this.commandDetailPreparationOptions}}get total(){let n=this.commandDetail.precioVenta;if(this.commandDetail.producto.recargoConsumo){const i=Number(this.configCompany.igv);n=n/(1+i)*(1+i+this.commandDetail.producto.recargoConsumo/100)}return n*this.commandDetail.cantidad}get commandDetailGroupOptions(){const n=[];return this.form.getRawValue().producto.grupos.forEach(t=>{const i=this.form.get(`grup${t.id}`).value;i&&i.forEach(s=>n.push(s))}),n}get commandDetailPreparationOptions(){const n=[];return this.form.getRawValue().producto.preparaciones.forEach(t=>{const i=this.form.get(`prep${t.preparacion.id}`).value;i&&n.push({idPreparacion:t.preparacion.id,idOpcion:i,nombrePreparacion:t.preparacion.nombre,nombreOpcion:t.preparacion.opciones.find(s=>Number(s.id)===Number(i)).opcion})}),n}get preparaciones(){return this.commandDetailPreparationOptions.map(n=>`${n.nombrePreparacion}: ${n.nombreOpcion}`).join(", ")}ngOnInit(){this.configCompany$.pipe((0,P.R)(this.unsubscribe$)).subscribe(n=>{this.configCompany=n}),this.builderForm(),this.displayFormModal=!0,this.puntoVenta$.pipe((0,P.R)(this.unsubscribe$)).subscribe(n=>{this.puntoVenta=n})}ngOnDestroy(){this.unsubscribe$.next(),this.unsubscribe$.complete()}calculatePrecioVentaFromPrecioVentaRc(){let n=this.commandDetail.precioVentaRc;const t=Number(this.configCompany.igv);n=n/(1+t+this.commandDetail.producto.recargoConsumo/100)*(1+t),this.form.patchValue({precioVenta:n}),this.originalPrice=n}builderForm(){this.form=this.fb.group({cantidad:[1,[f.kI.required]],precioVenta:[void 0,[f.kI.required]],precioVentaRc:[void 0,[]],producto:[void 0,[f.kI.required]],nota:[void 0,[]],paraLlevar:[void 0,[]]})}selectNewPrice(n){this.form.patchValue({precioVenta:n,precioVentaRc:n}),this.commandDetail.producto.recargoConsumo&&this.calculatePrecioVentaFromPrecioVentaRc()}changeQty(n){let t;"+"===n?(t=this.form.get("cantidad").value+1,this.form.patchValue({cantidad:t})):(t=this.form.get("cantidad").value-1,0===t&&this.delete.emit(),this.form.patchValue({cantidad:t})),this.form.patchValue({precioVenta:Number((0,l.KL)(this.form.get("producto").value,this.puntoVenta,{qty:t,igv:this.configCompany.igv})),precioVentaRc:Number((0,l.KL)(this.form.get("producto").value,this.puntoVenta,{qty:t,absolute:!0,igv:this.configCompany.igv}))}),this.propagateChange()}confirm(){(0,l.c2)(this.form),this.form.valid&&(this.displayFormModal=!1,this.propagateChange())}propagateChange(){this.onChange(this.commandDetail),this.onTouched(this.commandDetail)}registerOnChange(n){this.onChange=n}registerOnTouched(n){this.onTouched=n}writeValue(n){n&&(this.initializeForm(n),this.calculatePrice())}initializeForm(n){this.originalPrice=n.precioVenta,this.originalPriceRc=n.precioVentaRc,this.form.patchValue(n),this.form.getRawValue().producto.preparaciones.forEach(t=>{this.form.addControl(`prep${t.preparacion.id}`,this.fb.control(void 0,t.requerido?f.kI.required:void 0))}),this.form.getRawValue().producto.grupos.forEach(t=>{const i=n.grupoProductoOpciones.filter(s=>s.idGrupo===t.id);this.form.addControl(`grup${t.id}`,this.fb.control(i,(0,l.sS)(t))),this.form.get(`grup${t.id}`).valueChanges.pipe((0,P.R)(this.unsubscribe$)).subscribe(()=>this.calculatePrice())})}calculatePrice(){const n=this.commandDetailGroupOptions.filter(d=>d.cantidad).map(d=>d.precio*d.cantidad).reduce(l.IH,0),t=Number(this.configCompany.igv);let i=this.originalPrice,s=this.originalPriceRc;if(n){let d=0;d=this.commandDetail.producto.recargoConsumo?n/(1+t+this.commandDetail.producto.recargoConsumo/100)*(1+t):n,i+=d,s+=n}this.form.patchValue({precioVenta:i,precioVentaRc:s}),this.propagateChange()}}ae.\u0275fac=function(n){return new(n||ae)(e.Y36(f.qu))},ae.\u0275cmp=e.Xpm({type:ae,selectors:[["app-comanda-registro-detalle"]],outputs:{delete:"delete"},features:[e._Bn([{provide:f.JU,useExisting:(0,e.Gpc)(()=>ae),multi:!0}])],decls:61,vars:31,consts:[[1,"grid","p-nogutter","detalle-comanda-registro","cursor-pointer",3,"click"],[1,"col-fixed",2,"width","70px","padding","10px"],[2,"margin","0"],[1,"col"],[1,"grid","p-nogutter"],[1,"col-8",2,"padding","10px"],["style","color: #bababa",4,"ngIf"],["class","mt-0 mb-0",4,"ngFor","ngForOf"],[1,"col-4",2,"padding","10px"],[2,"margin","0","text-align","right"],["appendTo","body",3,"closeOnEscape","closable","modal","header","visible","visibleChange"],[3,"formGroup"],[1,"grid"],[1,"col-12","sm:col-5","md:col-7"],[1,"col-fixed",2,"width","100px"],["alt","",2,"width","100%",3,"src"],[1,"ml-2","mt-0","mb-2"],[1,"ml-2","mt-0"],[1,"col-6","sm:col-2"],["formControlName","precioVentaRc","type","text","pInputText","","placeholder","Precio","pKeyFilter","num","style","width: 100%",3,"input",4,"ngIf"],["formControlName","precioVenta","type","text","pInputText","","placeholder","Precio","pKeyFilter","num",2,"width","100%",3,"hidden"],["severity","error","text","Ingrese precio",4,"ngIf"],[1,"col-fixed"],[3,"idProduct","selectPrice"],[1,"col-6","sm:col-4","md:col-3"],[1,"grid","p-nogutter","flex","justify-content-center"],[1,"col-fixed","flex-center-x",2,"width","33%"],["pButton","","type","button","icon","fa fa-minus",3,"click"],["formControlName","cantidad","type","text","pInputText","","placeholder","Cantidad","pKeyFilter","num",2,"width","100%"],["pButton","","type","button","icon","fa fa-plus",3,"click"],["severity","error","text","Ingrese cantidad",4,"ngIf"],[1,"col-8","md:col-9"],["for","nota",1,"label-form"],["id","nota","formControlName","nota","rows","2","pInputTextarea","",2,"width","100%"],[1,"col-4","md:col-3",2,"text-align","right"],["for","paraLlevar",1,"label-form"],["id","paraLlevar","formControlName","paraLlevar"],["class","col-12",4,"ngIf"],["type","button","pButton","","label","Eliminar",1,"p-button-danger",3,"click"],["type","button","pButton","","label","Aceptar",3,"click"],[2,"color","#bababa"],[1,"mt-0","mb-0"],["formControlName","precioVentaRc","type","text","pInputText","","placeholder","Precio","pKeyFilter","num",2,"width","100%",3,"input"],["severity","error","text","Ingrese precio"],["severity","error","text","Ingrese cantidad"],[1,"col-12"],[1,"mt-0","mb-2"],["class","col-12  md:col-6 lg:col-4",4,"ngFor","ngForOf"],[1,"col-12","md:col-6","lg:col-4"],[1,"label-form"],["class","col-12",4,"ngFor","ngForOf"],["severity","error",3,"text",4,"ngIf"],["type","radio",3,"id","value","name","formControlName"],[3,"for"],["severity","error",3,"text"],[3,"group","formControlName"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0),e.NdJ("click",function(){return t.displayFormModal=!0}),e.TgZ(1,"div",1),e.TgZ(2,"h3",2),e._uU(3),e.qZA(),e.qZA(),e.TgZ(4,"div",3),e.TgZ(5,"div",4),e.TgZ(6,"div",5),e.TgZ(7,"h3",2),e._uU(8),e.YNc(9,ii,2,1,"span",6),e.qZA(),e.YNc(10,ai,2,3,"p",7),e.qZA(),e.TgZ(11,"div",8),e.TgZ(12,"h3",9),e._uU(13),e.ALo(14,"montoDinero"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(15,"p-dialog",10),e.NdJ("visibleChange",function(s){return t.displayFormModal=s}),e.TgZ(16,"form",11),e.TgZ(17,"div",12),e.TgZ(18,"div",13),e.TgZ(19,"div",4),e.TgZ(20,"div",14),e._UZ(21,"img",15),e.qZA(),e.TgZ(22,"div",3),e.TgZ(23,"h3",16),e._uU(24),e.qZA(),e.TgZ(25,"h4",16),e._uU(26),e.qZA(),e.TgZ(27,"p",17),e._uU(28),e.ALo(29,"montoDinero"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(30,"div",18),e.TgZ(31,"div",4),e.TgZ(32,"div",3),e.YNc(33,ri,1,0,"input",19),e._UZ(34,"input",20),e.YNc(35,si,1,0,"p-message",21),e.qZA(),e.TgZ(36,"div",22),e.TgZ(37,"app-detalle-producto-item",23),e.NdJ("selectPrice",function(s){return t.selectNewPrice(s)}),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(38,"div",24),e.TgZ(39,"div",25),e.TgZ(40,"div",26),e.TgZ(41,"button",27),e.NdJ("click",function(){return t.changeQty("-")}),e.qZA(),e.qZA(),e.TgZ(42,"div",26),e._UZ(43,"input",28),e.qZA(),e.TgZ(44,"div",26),e.TgZ(45,"button",29),e.NdJ("click",function(){return t.changeQty("+")}),e.qZA(),e.qZA(),e.qZA(),e.YNc(46,li,1,0,"p-message",30),e.qZA(),e.TgZ(47,"div",31),e.TgZ(48,"label",32),e._uU(49,"Nota"),e.qZA(),e._UZ(50,"textarea",33),e.qZA(),e.TgZ(51,"div",34),e.TgZ(52,"label",35),e._uU(53,"Llevar"),e.qZA(),e.TgZ(54,"div"),e._UZ(55,"p-inputSwitch",36),e.qZA(),e.qZA(),e.YNc(56,ui,5,1,"div",37),e.YNc(57,_i,6,2,"div",37),e.qZA(),e.qZA(),e.TgZ(58,"p-footer"),e.TgZ(59,"button",38),e.NdJ("click",function(){return t.delete.emit()}),e.qZA(),e.TgZ(60,"button",39),e.NdJ("click",function(){return t.confirm()}),e.qZA(),e.qZA(),e.qZA()),2&n&&(e.xp6(3),e.Oqu(null==t.commandDetail?null:t.commandDetail.cantidad),e.xp6(5),e.hij("",null==t.commandDetail||null==t.commandDetail.producto?null:t.commandDetail.producto.nombre," "),e.xp6(1),e.Q6J("ngIf",t.preparaciones),e.xp6(1),e.Q6J("ngForOf",t.commandDetailGroupOptions),e.xp6(3),e.Oqu(e.xi3(14,24,t.total,null==t.commandDetail||null==t.commandDetail.producto?null:t.commandDetail.producto.moneda)),e.xp6(2),e.Akn(e.DdM(30,fi)),e.Q6J("closeOnEscape",!1)("closable",!1)("modal",!0)("header",null==t.commandDetail||null==t.commandDetail.producto?null:t.commandDetail.producto.nombre)("visible",t.displayFormModal),e.xp6(1),e.Q6J("formGroup",t.form),e.xp6(5),e.Q6J("src",null==t.commandDetail||null==t.commandDetail.producto?null:t.commandDetail.producto.imagenUrl,e.LSH),e.xp6(3),e.Oqu(null==t.commandDetail||null==t.commandDetail.producto?null:t.commandDetail.producto.nombre),e.xp6(2),e.Oqu(null==t.commandDetail||null==t.commandDetail.producto?null:t.commandDetail.producto.detalle),e.xp6(2),e.hij("Total: ",e.xi3(29,27,t.total,null==t.commandDetail||null==t.commandDetail.producto?null:t.commandDetail.producto.moneda),""),e.xp6(5),e.Q6J("ngIf",null==t.commandDetail||null==t.commandDetail.producto?null:t.commandDetail.producto.recargoConsumo),e.xp6(1),e.Q6J("hidden",null==t.commandDetail||null==t.commandDetail.producto?null:t.commandDetail.producto.recargoConsumo),e.xp6(1),e.Q6J("ngIf",t.form.get("precioVenta").touched&&(null==t.form.get("precioVenta").errors?null:t.form.get("precioVenta").errors.required)),e.xp6(2),e.Q6J("idProduct",null==t.commandDetail||null==t.commandDetail.producto?null:t.commandDetail.producto.id),e.xp6(9),e.Q6J("ngIf",t.form.get("cantidad").touched&&(null==t.form.get("cantidad").errors?null:t.form.get("cantidad").errors.required)),e.xp6(10),e.Q6J("ngIf",(null==t.commandDetail||null==t.commandDetail.producto?null:t.commandDetail.producto.preparaciones)&&(null==t.commandDetail||null==t.commandDetail.producto||null==t.commandDetail.producto.preparaciones?null:t.commandDetail.producto.preparaciones.length)),e.xp6(1),e.Q6J("ngIf",(null==t.commandDetail||null==t.commandDetail.producto?null:t.commandDetail.producto.grupos)&&(null==t.commandDetail||null==t.commandDetail.producto||null==t.commandDetail.producto.grupos?null:t.commandDetail.producto.grupos.length)))},directives:[v.O5,v.sg,Ee.V,f._Y,f.JL,f.sg,f.Fj,f.JJ,f.u,O.o,ve.Fr,Y.q,Wn.v,a.Hq,Kn.g,ut.Ql,T.Z,f._,ni,h.$_],pipes:[te.Z],styles:[".detalle-comanda-registro[_ngcontent-%COMP%]{border-bottom:1px solid #d7d7d7;border-left:1px solid #d7d7d7;border-right:1px solid #d7d7d7}"]}),(0,q.gn)([(0,y.Ph)(R.Z.getOffice)],ae.prototype,"puntoVenta$",void 0),(0,q.gn)([(0,y.Ph)(R.Z.getConfig)],ae.prototype,"configCompany$",void 0);var mt=b(80422),hi=b(84);function vi(o,n){if(1&o&&(e.TgZ(0,"h2",22),e._uU(1),e.qZA()),2&o){const t=e.oxw(2);e.xp6(1),e.hij("MESA: ",null==t.tableSelected?null:t.tableSelected.numero,"")}}function bi(o,n){1&o&&(e.TgZ(0,"h2",22),e._uU(1,"REGISTRO DE PEDIDO"),e.qZA())}function Ci(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",32),e.TgZ(1,"div",33),e.TgZ(2,"app-comanda-registro-detalle",34),e.NdJ("delete",function(){const d=e.CHM(t).index;return e.oxw(2).deleteGrupoForm(d)}),e.qZA(),e.qZA(),e.qZA()}if(2&o){const t=n.index;e.xp6(1),e.Q6J("formGroupName",t)}}function Ti(o,n){1&o&&(e.TgZ(0,"div",4),e._UZ(1,"p-message",35),e.qZA())}function Zi(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"form",15),e.TgZ(1,"div",16),e.TgZ(2,"div",17),e.YNc(3,vi,2,1,"h2",18),e.YNc(4,bi,2,0,"ng-template",null,19,e.W1O),e.qZA(),e.TgZ(6,"div",20),e.TgZ(7,"div",16),e.TgZ(8,"div",21),e.TgZ(9,"h3",22),e._uU(10,"CANT."),e.qZA(),e.qZA(),e.TgZ(11,"div",23),e.TgZ(12,"div",16),e.TgZ(13,"div",24),e.TgZ(14,"h3",22),e._uU(15,"DESCRIPCI\xd3N."),e.qZA(),e.qZA(),e.TgZ(16,"div",25),e.TgZ(17,"h3",26),e._uU(18,"IMPORTE"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.YNc(19,Ci,3,1,"div",27),e.TgZ(20,"div",20),e.TgZ(21,"div",16),e.TgZ(22,"div",21),e.TgZ(23,"h3",22),e._uU(24,"TOTAL:"),e.qZA(),e.qZA(),e.TgZ(25,"div",28),e.TgZ(26,"h3",26),e._uU(27),e.ALo(28,"montoDinero"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.YNc(29,Ti,2,0,"div",12),e.TgZ(30,"div",4),e.TgZ(31,"div",29),e.TgZ(32,"div",6),e.TgZ(33,"button",30),e.NdJ("click",function(){return e.CHM(t),e.oxw().exitCommand()}),e.qZA(),e.qZA(),e.TgZ(34,"div",6),e.TgZ(35,"button",31),e.NdJ("click",function(){return e.CHM(t),e.oxw().goRegisterCommand()}),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&o){const t=e.MAs(5),i=e.oxw();e.Q6J("formGroup",i.modelForm),e.xp6(3),e.Q6J("ngIf",i.tableSelected)("ngIfElse",t),e.xp6(16),e.Q6J("ngForOf",i.modelFormItems.controls),e.xp6(8),e.Oqu(e.xi3(28,6,i.total,"PEN")),e.xp6(2),e.Q6J("ngIf",i.modelForm.get("items").touched&&(null==i.modelForm.get("items").errors?null:i.modelForm.get("items").errors.minLengthArray))}}function Ai(o,n){1&o&&e._UZ(0,"p-message",42)}function xi(o,n){1&o&&e._UZ(0,"p-message",47)}function yi(o,n){if(1&o&&(e.TgZ(0,"div",43),e.TgZ(1,"label",44),e._uU(2,"Monto delivery"),e.qZA(),e._UZ(3,"input",45),e.YNc(4,xi,1,0,"p-message",46),e.qZA()),2&o){const t=e.oxw(2);e.xp6(4),e.Q6J("ngIf",t.modelForm.get("montoDelivery").touched&&(null==t.modelForm.get("montoDelivery").errors?null:t.modelForm.get("montoDelivery").errors.required))}}function Pi(o,n){if(1&o&&(e.TgZ(0,"div",4),e.TgZ(1,"p-fieldset",36),e.TgZ(2,"div",3),e.TgZ(3,"div",37),e.TgZ(4,"label",38),e._uU(5,"Direcci\xf3n (*)"),e.qZA(),e._UZ(6,"input",39),e.YNc(7,Ai,1,0,"p-message",40),e.qZA(),e.YNc(8,yi,5,1,"div",41),e.qZA(),e.qZA(),e.qZA()),2&o){const t=e.oxw();e.xp6(7),e.Q6J("ngIf",t.modelForm.get("direccionCompleta").touched&&(null==t.modelForm.get("direccionCompleta").errors?null:t.modelForm.get("direccionCompleta").errors.required)),e.xp6(1),e.Q6J("ngIf","PEDIDO_FORANEO"===t.modelForm.value.tipo)}}const Di=function(){return{width:"90vw"}};class W{constructor(n,t,i,s,d,C){this.eventBusService=n,this.fb=t,this.restaurantService=i,this.confirmationService=s,this.messageService=d,this.router=C,this.unsubscribe$=new k.xQ,this.dialogRegisterOrder=!1,this.configCompany={}}ngOnInit(){this.configCompany$.pipe((0,P.R)(this.unsubscribe$)).subscribe(n=>{this.configCompany=n}),this.orderTypes=[{value:"PEDIDO_LOCAL",label:"Para llevar"},{value:"PEDIDO_FORANEO",label:"Delivery"}],this.builderForm(),this.puntoVenta$.pipe((0,P.R)(this.unsubscribe$)).subscribe(n=>{this.puntoVenta=n}),this.table$.pipe((0,P.R)(this.unsubscribe$)).subscribe(n=>{this.tableSelected=n,n&&this.modelForm.patchValue({tipo:"LOCAL"})}),this.order$.pipe((0,P.R)(this.unsubscribe$)).subscribe(n=>this.orderSelected=n),this.eventBusService.on("selectProductToCommand",n=>{const t=[];n.grupos.forEach(i=>{i.opciones.filter(s=>s.porDefecto).forEach(s=>{t.push({producto:s.producto,cantidad:1,idGrupo:i.id,idOpcion:s.id,nombreGrupo:i.nombre,nombreOpcion:s.nombre,precio:s.precio,porcion:s.porcion})})}),this.addItemForm({producto:n,cantidad:1,precioVenta:(0,l.KL)(n,this.puntoVenta,{igv:this.configCompany.igv}),precioVentaRc:(0,l.KL)(n,this.puntoVenta,{absolute:!0,igv:this.configCompany.igv}),paraLlevar:!1,grupoProductoOpciones:t,preparacionProductoOpciones:[]})})}ngOnDestroy(){this.unsubscribe$.next(),this.unsubscribe$.complete()}get total(){return this.modelForm.getRawValue().items.map(n=>n.commandDetail.precioVentaRc*n.commandDetail.cantidad).reduce(l.IH,0)}builderForm(){this.modelForm=this.fb.group({items:this.fb.array([],(0,l.eK)(1)),cliente:this.fb.group({id:[void 0,[]],tipoDocumento:["1",[]],numeroDocumento:[void 0,[]],razonSocial:[void 0,[]],email:[void 0,[f.kI.email]],telefono:[void 0,[]],tipoDireccion:["CASA",[]],direccionCompleta:[void 0,[]],direccion:["",[]],numero:["",[]],numeroDepartamento:["",[]],referencia:["",[]],departamento:[void 0,[]],codigoDepartamento:[void 0,[]],provincia:[void 0,[]],codigoProvincia:[void 0,[]],distrito:[void 0,[]],codigoDistrito:[void 0,[]],latitud:["",[]],longitud:["",[]],giro:[void 0,[]],genero:[void 0,[]],expediente:[void 0,[]],referido:[void 0,[]],fechaNacimiento:[void 0,[]]}),tipo:["PEDIDO_LOCAL",[f.kI.required]],tipoDireccion:["CASA",[]],direccionCompleta:["",[]],direccion:["",[]],numero:["",[]],numeroDepartamento:["",[]],referencia:["",[]],departamento:[void 0,[]],codigoDepartamento:[void 0,[]],provincia:[void 0,[]],codigoProvincia:[void 0,[]],distrito:[void 0,[]],codigoDistrito:[void 0,[]],latitud:["",[]],longitud:["",[]],montoDelivery:[void 0,[]],generarComprobante:[!0,[]]}),this.modelForm.get("cliente").valueChanges.pipe((0,P.R)(this.unsubscribe$)).subscribe(n=>{n&&n.direccionCompleta&&n.direccionCompleta.length>4&&this.modelForm.patchValue({direccionCompleta:n.direccionCompleta})})}get modelFormItems(){return this.modelForm.get("items")}get commandDetails(){return this.modelFormItems.value.map(n=>n.commandDetail)}addItemForm(n){this.modelFormItems.push(this.createItemForm(n))}deleteGrupoForm(n){this.modelFormItems.removeAt(n)}createItemForm(n){return this.fb.group({commandDetail:[n,[f.kI.required]]})}goRegisterCommand(){this.modelForm.controls.items.markAsTouched(),this.modelFormItems.length&&("LOCAL"===this.modelForm.get("tipo").value?this.registerCommand():this.dialogRegisterOrder=!0)}registerCommand(){if((0,l.c2)(this.modelForm),this.modelForm.valid){const n={items:this.commandDetails};if(this.orderSelected)this.restaurantService.saveCommand(this.orderSelected.id,n).subscribe(t=>{this.restaurantService.processCommand(t,this.puntoVenta,!1,[],this.configCompany.imprimeTicketsEscPos),this.messageService.add({severity:"success",summary:"Registro de comanda",detail:"Comanda registrada correctamente."}),this.router.navigateByUrl("/restaurante/comandero")});else{const t="LOCAL"!==this.modelForm.value.tipo?this.modelForm.value.cliente:void 0;this.restaurantService.saveOrder({comandas:[n],puntoVenta:this.puntoVenta,mesa:this.tableSelected,tipo:this.modelForm.value.tipo,cliente:t,tipoDocumentoReceptor:t?t.tipoDocumento:void 0,numeroDocumentoReceptor:t?t.numeroDocumento:void 0,denominacionReceptor:t?t.razonSocial:void 0,direccionReceptor:t?t.direccionCompleta:void 0,emailReceptor:t?t.email:void 0,telefonoReceptor:t?t.telefono:void 0,montoDelivery:this.modelForm.value.montoDelivery,tipoDireccion:this.modelForm.value.tipoDireccion,direccionCompleta:this.modelForm.value.direccionCompleta,direccion:this.modelForm.value.direccion?this.modelForm.value.direccion:this.modelForm.value.direccionCompleta,numero:this.modelForm.value.numero,numeroDepartamento:this.modelForm.value.numeroDepartamento,referencia:this.modelForm.value.referencia,codigoDepartamento:this.modelForm.value.codigoDepartamento,codigoProvincia:this.modelForm.value.codigoProvincia,codigoDistrito:this.modelForm.value.codigoDistrito,latitud:this.modelForm.value.latitud,longitud:this.modelForm.value.longitud}).subscribe(J=>{this.restaurantService.processCommand(J.comandas[0],this.puntoVenta,!1,[],this.configCompany.imprimeTicketsEscPos),this.messageService.add({severity:"success",summary:"Registro de comanda",detail:"Comanda registrada correctamente."}),this.router.navigateByUrl("LOCAL"===this.modelForm.value.tipo?"/restaurante/comandero":this.modelForm.value.generarComprobante?`/restaurante/cobrador/cuentas/cobrar/${J.cuentas[0].id}`:"/restaurante/pedidos")})}}}exitCommand(){this.confirmationService.confirm({message:"Est\xe1 seguro que desea salir?",accept:()=>{"LOCAL"===this.modelForm.get("tipo").value?this.router.navigateByUrl("/restaurante/comandero"):this.router.navigateByUrl("/restaurante/pedidos")},acceptLabel:"Si",rejectLabel:"No"})}changeTipo(){"PEDIDO_FORANEO"===this.modelForm.get("tipo").value?(this.modelForm.get("direccionCompleta").setValidators([f.kI.required]),this.modelForm.get("direccionCompleta").updateValueAndValidity()):(this.modelForm.get("direccionCompleta").clearValidators(),this.modelForm.get("direccionCompleta").updateValueAndValidity())}}W.\u0275fac=function(n){return new(n||W)(e.Y36(H.Y),e.Y36(f.qu),e.Y36(u.T),e.Y36(h.YP),e.Y36(h.ez),e.Y36(D.F0))},W.\u0275cmp=e.Xpm({type:W,selectors:[["app-comanda-registro"]],decls:22,vars:11,consts:[[3,"formGroup",4,"ngIf"],["appendTo","body","header","Informaci\xf3n de pedido",3,"modal","visible","visibleChange"],["novalidate","",3,"formGroup"],[1,"grid"],[1,"col-12"],["legend","Pedido"],[1,"col-6"],[1,"label-form"],["formControlName","tipo",3,"options","onChange"],["formControlName","generarComprobante"],["legend","Cliente"],["codigoTipoOperacion","0101","tipoComprobante","NV",3,"parentForm","permiteClientePorDefecto"],["class","col-12",4,"ngIf"],[1,"col-12","flex-center-x"],["pButton","","type","submit","label","Siguiente",1,"p-button-rounded","p-button-success",2,"width","auto","padding","8px 15px","font-size","20px",3,"click"],[3,"formGroup"],[1,"grid","p-nogutter"],[1,"col-12","cabecera-comanda-registro",2,"padding","10px"],["style","margin: 0;",4,"ngIf","ngIfElse"],["noTable",""],[1,"col-12","cabecera-comanda-registro-definicion"],[1,"col-fixed",2,"width","70px","padding","10px"],[2,"margin","0"],[1,"col"],[1,"col-8",2,"padding","10px"],[1,"col-4",2,"padding","10px"],[2,"margin","0","text-align","right"],["class","col-12","formArrayName","items",4,"ngFor","ngForOf"],[1,"col",2,"padding","10px"],[1,"grid","p-nogutter","p-fluid"],["type","button","pButton","","label","Salir",1,"p-button-secondary",3,"click"],["type","button","pButton","","label","Aceptar",3,"click"],["formArrayName","items",1,"col-12"],[3,"formGroupName"],["formControlName","commandDetail",3,"delete"],["severity","error","text","Agregue platillos"],["legend","Datos de env\xedo"],[1,"col-8","sm:col-8","md:col-10"],["for","direccion",1,"label-form"],["formControlName","direccionCompleta","id","direccion","type","text","pInputText","",2,"width","100%"],["severity","error","text","Ingrese direcci\xf3n",4,"ngIf"],["class","col-4 sm:col-4 md:col-2",4,"ngIf"],["severity","error","text","Ingrese direcci\xf3n"],[1,"col-4","sm:col-4","md:col-2"],["for","montoDelivery",1,"label-form"],["pKeyFilter","num","formControlName","montoDelivery","id","montoDelivery","type","text","pInputText","",2,"width","100%","margin-bottom","0.2em"],["severity","error","text","Ingrese monto de delivery",4,"ngIf"],["severity","error","text","Ingrese monto de delivery"]],template:function(n,t){1&n&&(e.YNc(0,Zi,36,9,"form",0),e.TgZ(1,"p-dialog",1),e.NdJ("visibleChange",function(s){return t.dialogRegisterOrder=s}),e.TgZ(2,"form",2),e.TgZ(3,"div",3),e.TgZ(4,"div",4),e.TgZ(5,"p-fieldset",5),e.TgZ(6,"div",3),e.TgZ(7,"div",6),e.TgZ(8,"label",7),e._uU(9,"Tipo"),e.qZA(),e.TgZ(10,"p-selectButton",8),e.NdJ("onChange",function(){return t.changeTipo()}),e.qZA(),e.qZA(),e.TgZ(11,"div",6),e.TgZ(12,"label",7),e._uU(13,"Generar comprobante"),e.qZA(),e.TgZ(14,"div"),e._UZ(15,"p-inputSwitch",9),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(16,"div",4),e.TgZ(17,"p-fieldset",10),e._UZ(18,"app-cliente-form",11),e.qZA(),e.qZA(),e.YNc(19,Pi,9,2,"div",12),e.TgZ(20,"div",13),e.TgZ(21,"button",14),e.NdJ("click",function(){return t.registerCommand()}),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&n&&(e.Q6J("ngIf",t.modelForm),e.xp6(1),e.Akn(e.DdM(10,Di)),e.Q6J("modal",!0)("visible",t.dialogRegisterOrder),e.xp6(1),e.Q6J("formGroup",t.modelForm),e.xp6(8),e.Q6J("options",t.orderTypes),e.xp6(8),e.Q6J("parentForm",t.modelForm)("permiteClientePorDefecto",!0),e.xp6(1),e.Q6J("ngIf","PEDIDO_FORANEO"===t.modelForm.value.tipo))},directives:[v.O5,f._Y,f.JL,f.sg,v.sg,f.CE,f.x0,ae,f.JJ,f.u,Y.q,a.Hq,Ee.V,mt.p,fe.UN,ut.Ql,hi.B,f.Fj,O.o,ve.Fr],pipes:[te.Z],styles:[".cabecera-comanda-registro[_ngcontent-%COMP%]{background-color:#616161;color:#ececec;border:1px solid #d7d7d7}.cabecera-comanda-registro-definicion[_ngcontent-%COMP%]{background-color:#616161;color:#ececec;border-bottom:1px solid #d7d7d7;border-left:1px solid #d7d7d7;border-right:1px solid #d7d7d7}"]}),(0,q.gn)([(0,y.Ph)($.Q.table)],W.prototype,"table$",void 0),(0,q.gn)([(0,y.Ph)($.Q.order)],W.prototype,"order$",void 0),(0,q.gn)([(0,y.Ph)(R.Z.getOffice)],W.prototype,"puntoVenta$",void 0),(0,q.gn)([(0,y.Ph)(R.Z.getConfig)],W.prototype,"configCompany$",void 0);let wi=(()=>{class o{constructor(){}ngOnInit(){}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-comanda"]],decls:7,vars:0,consts:[[1,"grid"],[1,"col"],[1,"col-fixed",2,"width","35em"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"p-card"),e._UZ(3,"app-comanda-productos"),e.qZA(),e.qZA(),e.TgZ(4,"div",2),e.TgZ(5,"p-card"),e._UZ(6,"app-comanda-registro"),e.qZA(),e.qZA(),e.qZA())},directives:[T.Z,Xn,W],styles:[""]}),o})();var Ve=b(12216);const qi=function(o){return{background:o,"background-size":"cover"}};let He=(()=>{class o{constructor(){this.clickProduct=new e.vpe}ngOnInit(){}get image(){return(this.product&&this.product.imagenUrl?this.product.imagenUrl:"assets/resources/images/food.svg").replace(" ","%20")}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-comanda-producto-item"]],inputs:{product:"product"},outputs:{clickProduct:"clickProduct"},decls:3,vars:4,consts:[[1,"cs-item",3,"ngStyle","click"],[1,"cs-title"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.NdJ("click",function(){return i.clickProduct.emit()}),e.TgZ(1,"div",1),e._uU(2),e.qZA(),e.qZA()),2&t&&(e.Q6J("ngStyle",e.VKq(2,qi,"linear-gradient(0deg, rgba(0, 0, 0, 0.95) 0%, rgba(0, 0, 0, 0.11) 36%, rgba(0, 0, 0, 0) 46%), url("+i.image+") no-repeat center")),e.xp6(2),e.Oqu(null==i.product?null:i.product.nombre))},directives:[v.PC],styles:[".cs-item[_ngcontent-%COMP%]{height:140px;width:140px;display:flex;flex-direction:column;flex-wrap:nowrap;justify-content:flex-end;align-items:stretch;align-content:stretch;border:1px solid #e0e0e0;cursor:pointer}p[_ngcontent-%COMP%]{font-weight:700;line-height:35px;margin:0 auto;padding-left:44px;text-align:left}.cs-title[_ngcontent-%COMP%]{text-align:center;margin:5px;color:#fff;font-size:12px;font-weight:700;text-transform:uppercase}"]}),o})();const Oi=["inputKeySearch"];function Ii(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",8),e.TgZ(1,"app-comanda-producto-item",9),e.NdJ("clickProduct",function(){const d=e.CHM(t).$implicit;return e.oxw().selectProductToCommand(d)}),e.qZA(),e.qZA()}if(2&o){const t=n.$implicit;e.xp6(1),e.Q6J("product",t)}}let Ei=(()=>{class o{constructor(t,i,s,d){this.productService=t,this.route=i,this.breadcrumbService=s,this.eventBusService=d,this.products=[]}ngOnInit(){this.breadcrumbService.setItems((0,l.kn)(this.route)),this.searchProducts(),this.focusKeySearch()}searchProducts(){const t=["paginacion=false","limit=30","mostrarEnRestaurante=true"];this.keySearch&&t.push(`filterGlobal=${this.keySearch.replace("&","%26")}`),this.productService.findAllList(t.join("&")).subscribe(i=>{this.products=i})}focusKeySearch(){setTimeout(()=>this.inputKeySearch.nativeElement.focus(),30)}selectProductToCommand(t){this.eventBusService.emit({name:"selectProductToCommand",value:t})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(Ve.M),e.Y36(D.gz),e.Y36(Z.p),e.Y36(H.Y))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-comanda-productos-buscador"]],viewQuery:function(t,i){if(1&t&&e.Gf(Oi,5),2&t){let s;e.iGM(s=e.CRH())&&(i.inputKeySearch=s.first)}},decls:8,vars:2,consts:[[1,"grid","p-fluid","flex","justify-content-center"],[1,"col-12"],[1,"p-inputgroup"],[1,"p-inputgroup-addon"],[1,"pi","pi-search",2,"line-height","1.25"],["type","text","pInputText","","placeholder","Buscar platillo | combo | producto | insumo",3,"ngModel","input","ngModelChange"],["inputKeySearch",""],["class","col-fixed","style","width: 150px",4,"ngFor","ngForOf"],[1,"col-fixed",2,"width","150px"],[3,"product","clickProduct"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"div",2),e.TgZ(3,"span",3),e._UZ(4,"i",4),e.qZA(),e.TgZ(5,"input",5,6),e.NdJ("input",function(){return i.searchProducts()})("ngModelChange",function(d){return i.keySearch=d}),e.qZA(),e.qZA(),e.qZA(),e.YNc(7,Ii,2,1,"div",7),e.qZA()),2&t&&(e.xp6(5),e.Q6J("ngModel",i.keySearch),e.xp6(2),e.Q6J("ngForOf",i.products))},directives:[f.Fj,O.o,f.JJ,f.On,v.sg,He],styles:[""]}),o})();function Si(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",2),e.TgZ(1,"app-comanda-producto-item",3),e.NdJ("clickProduct",function(){const d=e.CHM(t).$implicit;return e.oxw().selectProductToCommand(d)}),e.qZA(),e.qZA()}if(2&o){const t=n.$implicit;e.xp6(1),e.Q6J("product",t)}}let Ni=(()=>{class o{constructor(t,i,s,d){this.productService=t,this.route=i,this.breadcrumbService=s,this.eventBusService=d}ngOnInit(){this.breadcrumbService.setItems((0,l.kn)(this.route)),this.searchProducts()}searchProducts(){this.productService.findAllList(["paginacion=false","favorito=true","mostrarEnRestaurante=true"].join("&")).subscribe(i=>{this.products=i})}selectProductToCommand(t){this.eventBusService.emit({name:"selectProductToCommand",value:t})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(Ve.M),e.Y36(D.gz),e.Y36(Z.p),e.Y36(H.Y))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-comanda-productos-favoritos"]],decls:2,vars:1,consts:[[1,"grid","p-fluid","flex","justify-content-center"],["class","col-fixed","style","width: 150px",4,"ngFor","ngForOf"],[1,"col-fixed",2,"width","150px"],[3,"product","clickProduct"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.YNc(1,Si,2,1,"div",1),e.qZA()),2&t&&(e.xp6(1),e.Q6J("ngForOf",i.products))},directives:[v.sg,He],styles:[""]}),o})();var ki=b(47728);const Fi=function(o){return{background:o,"background-size":"cover"}};let Mi=(()=>{class o{constructor(){this.onClick=new e.vpe}ngOnInit(){}get image(){return this.category&&this.category.imagenUrl?this.category.imagenUrl:"assets/resources/images/dinner.svg"}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-comanda-categoria-item"]],inputs:{category:"category"},outputs:{onClick:"onClick"},decls:3,vars:4,consts:[[1,"cs-item",3,"ngStyle","click"],[1,"cs-title"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.NdJ("click",function(){return i.onClick.emit()}),e.TgZ(1,"div",1),e._uU(2),e.qZA(),e.qZA()),2&t&&(e.Q6J("ngStyle",e.VKq(2,Fi,"linear-gradient(to bottom, rgba(199,199,199,0.8) 0%, rgba(0,0,0,0.85) 50%, rgba(194,194,194,0.7) 100%), url("+i.image+") no-repeat center")),e.xp6(2),e.Oqu(null==i.category?null:i.category.nombre))},directives:[v.PC],styles:[".cs-item[_ngcontent-%COMP%]{height:140px;width:140px;display:flex;flex-direction:column;flex-wrap:nowrap;justify-content:center;align-items:center;align-content:stretch;border:1px solid #e0e0e0;cursor:pointer}p[_ngcontent-%COMP%]{font-weight:700;line-height:35px;margin:0 auto;padding-left:44px;text-align:left}.cs-title[_ngcontent-%COMP%]{margin:3px;color:#fff;font-size:12px;font-weight:700;text-transform:uppercase;text-align:center}"]}),o})();function Li(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",4),e.TgZ(1,"app-comanda-categoria-item",5),e.NdJ("onClick",function(){const d=e.CHM(t).$implicit;return e.oxw().loadCategoriasByPadre(d)}),e.qZA(),e.qZA()}if(2&o){const t=n.$implicit;e.xp6(1),e.Q6J("category",t)}}function Ri(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",4),e.TgZ(1,"app-comanda-producto-item",8),e.NdJ("clickProduct",function(){const d=e.CHM(t).$implicit;return e.oxw(2).selectProductToCommand(d)}),e.qZA(),e.qZA()}if(2&o){const t=n.$implicit;e.xp6(1),e.Q6J("product",t)}}function Ji(o,n){if(1&o&&(e.TgZ(0,"div",6),e.TgZ(1,"p-card",7),e.TgZ(2,"div",0),e.YNc(3,Ri,2,1,"div",2),e.qZA(),e.qZA(),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("header",null==t.categoriaPadre?null:t.categoriaPadre.nombre),e.xp6(2),e.Q6J("ngForOf",t.products)}}let Ui=(()=>{class o{constructor(t,i,s,d,C){this.categoryService=t,this.productService=i,this.route=s,this.breadcrumbService=d,this.eventBusService=C,this.items=[],this.products=[],this.collapsed=!1}ngOnInit(){this.breadcrumbService.setItems((0,l.kn)(this.route)),this.home={icon:"pi pi-home",command:()=>this.loadCategoriasByPadre()},this.loadCategoriaPadre(),this.loadCategories()}loadCategoriaPadre(){this.categoriaPadre?this.categoryService.findById(this.categoriaPadre.id).subscribe(t=>{this.categoriaPadre=t,this.items=[],this.readCategoria(t)}):this.items=[]}readCategoria(t){t.categoriaPadre&&this.readCategoria(t.categoriaPadre),this.items.push({id:t.id,label:t.nombre,command:()=>this.loadCategoriasByPadre(t)})}loadCategories(){this.categoryService.findAllList([`idCategoria=${this.categoriaPadre?this.categoriaPadre.id:"0"}`,"paginacion=false"].join("&")).subscribe(s=>{s.length&&(this.categories=s)})}loadCategoriasByPadre(t){this.categoriaPadre=t,this.loadCategoriaPadre(),this.loadCategories(),this.searchProducts()}searchProducts(){this.productService.findAllList(["paginacion=false",`idCategoria=${this.categoriaPadre.id}`,"mostrarEnRestaurante=true"].join("&")).subscribe(i=>{this.products=i,this.products.length>0&&(this.collapsed=!0)})}selectProductToCommand(t){this.eventBusService.emit({name:"selectProductToCommand",value:t})}minimizarPanel(t){this.collapsed=!1}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(ki.H),e.Y36(Ve.M),e.Y36(D.gz),e.Y36(Z.p),e.Y36(H.Y))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-comanda-productos-categorias"]],decls:5,vars:4,consts:[[1,"grid","p-fluid","flex","justify-content-center"],["header","Categor\xedas",1,"col-12",3,"toggleable","collapsed","onBeforeToggle"],["class","col-fixed","style","width: 150px",4,"ngFor","ngForOf"],["class","col-12",4,"ngIf"],[1,"col-fixed",2,"width","150px"],[3,"category","onClick"],[1,"col-12"],[3,"header"],[3,"product","clickProduct"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"p-panel",1),e.NdJ("onBeforeToggle",function(d){return i.minimizarPanel(d)}),e.TgZ(2,"div",0),e.YNc(3,Li,2,1,"div",2),e.qZA(),e.qZA(),e.YNc(4,Ji,4,2,"div",3),e.qZA()),2&t&&(e.xp6(1),e.Q6J("toggleable",!0)("collapsed",i.collapsed),e.xp6(2),e.Q6J("ngForOf",i.categories),e.xp6(1),e.Q6J("ngIf",i.categoriaPadre&&i.products.length))},directives:[Ce.s,v.sg,Mi,v.O5,T.Z,He],styles:[""]}),o})();var $i=b(38190),Qi=b(45028);function Yi(o,n){if(1&o&&(e.TgZ(0,"span"),e._UZ(1,"img",11),e.TgZ(2,"div",12),e.TgZ(3,"h3",5),e._uU(4),e.TgZ(5,"span",13),e._uU(6),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&o){const t=e.oxw();e.xp6(4),e.hij("M",null==t.command||null==t.command.pedido||null==t.command.pedido.mesa?null:t.command.pedido.mesa.numero," "),e.xp6(2),e.hij("(",null==t.command||null==t.command.pedido||null==t.command.pedido.mesa||null==t.command.pedido.mesa.salon?null:t.command.pedido.mesa.salon.nombre,")")}}function Bi(o,n){1&o&&e._UZ(0,"img",14)}function Vi(o,n){if(1&o&&(e.TgZ(0,"p",31),e._uU(1),e.qZA()),2&o){const t=e.oxw(2).$implicit;e.xp6(1),e.Oqu(null==t||null==t.producto?null:t.producto.detalle)}}function Hi(o,n){1&o&&e._UZ(0,"img",32)}function ji(o,n){1&o&&e._UZ(0,"img",33)}function zi(o,n){if(1&o&&(e.TgZ(0,"div",23),e.TgZ(1,"div",24),e.TgZ(2,"div",25),e.TgZ(3,"h2"),e._uU(4),e.qZA(),e.qZA(),e.TgZ(5,"div",19),e.TgZ(6,"h3",26),e._uU(7),e.qZA(),e.YNc(8,Vi,2,1,"p",27),e.qZA(),e.TgZ(9,"div",28),e.YNc(10,Hi,1,0,"img",29),e.YNc(11,ji,1,0,"ng-template",null,30,e.W1O),e.qZA(),e.qZA(),e.qZA()),2&o){const t=e.MAs(12),i=e.oxw().$implicit;e.xp6(4),e.hij("",null==i?null:i.cantidad,"x"),e.xp6(3),e.Oqu(null==i||null==i.producto?null:i.producto.nombre),e.xp6(1),e.Q6J("ngIf",null==i||null==i.producto?null:i.producto.detalle),e.xp6(2),e.Q6J("ngIf",i.paraLlevar)("ngIfElse",t)}}function Gi(o,n){if(1&o&&(e.TgZ(0,"p",36),e._uU(1),e.qZA()),2&o){const t=n.$implicit;e.xp6(1),e.AsE(" ",t.nombrePreparacion,": ",t.nombreOpcion," ")}}function Xi(o,n){if(1&o&&(e.TgZ(0,"div",23),e.TgZ(1,"p-fieldset",34),e.YNc(2,Gi,2,2,"p",35),e.qZA(),e.qZA()),2&o){const t=e.oxw().$implicit;e.xp6(2),e.Q6J("ngForOf",t.preparacionProductoOpciones)}}function Wi(o,n){if(1&o&&(e.TgZ(0,"p",36),e.TgZ(1,"span",38),e._uU(2),e.qZA(),e._uU(3),e.qZA()),2&o){const t=n.$implicit;e.xp6(2),e.hij("",t.cantidad,"x"),e.xp6(1),e.AsE(" ",t.nombreGrupo," : ",t.nombreOpcion," ")}}function Ki(o,n){if(1&o&&(e.TgZ(0,"div",23),e.TgZ(1,"p-fieldset",37),e.YNc(2,Wi,4,3,"p",35),e.qZA(),e.qZA()),2&o){const t=e.oxw().$implicit,i=e.oxw(2);e.xp6(2),e.Q6J("ngForOf",i.filterItemsGroup(t.grupoProductoOpciones))}}function ea(o,n){if(1&o&&(e.TgZ(0,"div",39),e._UZ(1,"p-message",40),e.qZA()),2&o){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("text",t.nota)}}function ta(o,n){1&o&&(e.TgZ(0,"div",39),e._UZ(1,"p-message",41),e.qZA())}const oa=function(o,n,t){return{"command-detail-preparation":o,"command-detail-prepared":n,"command-detail-dispatched":t}};function na(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",16),e.TgZ(1,"div",17),e.NdJ("click",function(){const d=e.CHM(t).$implicit;return e.oxw(2).changeStatusItem(d)}),e.TgZ(2,"div",18),e.TgZ(3,"div",19),e.TgZ(4,"div",20),e.YNc(5,zi,13,5,"div",21),e.YNc(6,Xi,3,1,"div",21),e.YNc(7,Ki,3,1,"div",21),e.qZA(),e.qZA(),e.qZA(),e.YNc(8,ea,2,1,"div",22),e.YNc(9,ta,2,0,"div",22),e.qZA(),e.qZA()}if(2&o){const t=n.$implicit,i=e.oxw(2);e.xp6(1),e.Q6J("ngClass",e.kEZ(6,oa,"PREPARACION"===t.estadoComandaDetalle,"PREPARADO"===t.estadoComandaDetalle,"DESPACHADO"===t.estadoComandaDetalle)),e.xp6(4),e.Q6J("ngIf",i.showPrincipal(null==t?null:t.producto)),e.xp6(1),e.Q6J("ngIf",t.preparacionProductoOpciones.length&&i.showPrincipal(null==t?null:t.producto)),e.xp6(1),e.Q6J("ngIf",i.filterItemsGroup(t.grupoProductoOpciones).length),e.xp6(1),e.Q6J("ngIf",t.nota),e.xp6(1),e.Q6J("ngIf",i.withOutProductionZone(t))}}function ia(o,n){if(1&o&&(e.TgZ(0,"div",3),e.YNc(1,na,10,10,"div",15),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.filterItems(t.command.items))}}const aa=function(o,n){return{"command-time-max":o,"command-ready":n}};let ra=(()=>{class o{constructor(t,i,s){this.restaurantService=t,this.confirmationService=i,this.messageService=s,this.updatedStatusItem=new e.vpe,this.unsubscribeTimer$=new k.xQ}get superaTiempo(){return this.timeElapsed>this.tiempoPreparacion&&"PENDIENTE"===this.command.estadoComanda&&"C"===this.apartado}get preparado(){return"PREPARADO"===this.command.estadoComanda}ngOnInit(){const t=(0,Pe.F)(1e3);this.timer$=t.pipe((0,re.U)(d=>(0,l.t6)(this.command.fecha)),(0,P.R)(this.unsubscribeTimer$),(0,he.O)((0,l.t6)(this.command.fecha)));const i=d=>((new Date).getTime()-d.getTime())/1e3/60;t.pipe((0,re.U)(d=>i(new Date(this.command.fecha))),(0,P.R)(this.unsubscribeTimer$),(0,he.O)(i(new Date(this.command.fecha)))).subscribe(d=>this.timeElapsed=d)}ngOnDestroy(){this.unsubscribeTimer$.next(),this.unsubscribeTimer$.complete()}changeStatusItem(t){if("PENDIENTE"===t.estadoComandaDetalle||"PREPARACION"===t.estadoComandaDetalle){const i={};"PENDIENTE"===t.estadoComandaDetalle&&(i.estadoComandaDetalle="PREPARACION"),"PREPARACION"===t.estadoComandaDetalle&&(i.estadoComandaDetalle="PREPARADO"),this.restaurantService.updateCommandDetail(this.command.id,t.id,i).subscribe(()=>this.updatedStatusItem.emit())}"PREPARADO"===t.estadoComandaDetalle&&"M"===this.apartado&&this.dispatchItem(t)}dispatchItem(t){this.confirmationService.confirm({message:"Est\xe1 seguro de servir el platillo?",accept:()=>{this.restaurantService.updateCommandDetail(this.command.id,t.id,{estadoComandaDetalle:"DESPACHADO"}).subscribe(()=>{this.messageService.add({severity:"success",summary:"Mensaje",detail:`Platillo (${t.producto.nombre}) servido!`}),this.updatedStatusItem.emit()})},acceptLabel:"Si",rejectLabel:"No"})}filterItems(t){return t.filter(i=>(!this.estadoComandaDetalle||i.estadoComandaDetalle===this.estadoComandaDetalle||"PENDIENTE"===this.estadoComandaDetalle&&"PREPARACION"===i.estadoComandaDetalle)&&(!this.areasProduccion||!this.areasProduccion.length||!i.producto.categoria||!i.producto.categoria.areaProduccion||this.areasProduccion.find(s=>s===i.producto.categoria.areaProduccion.id)||this.areasProduccion.find(s=>i.grupoProductoOpciones.find(d=>d.producto&&d.producto.categoria&&d.producto.categoria.areaProduccion&&d.producto.categoria.areaProduccion.id===s))))}filterItemsGroup(t){return t.filter(i=>!this.areasProduccion||!this.areasProduccion.length||!i.producto.categoria||!i.producto.categoria.areaProduccion||this.areasProduccion.find(s=>s===i.producto.categoria.areaProduccion.id))}showPrincipal(t){return!this.areasProduccion||!this.areasProduccion.length||!t.categoria||!t.categoria.areaProduccion||this.areasProduccion.find(i=>i===t.categoria.areaProduccion.id)}withOutProductionZone(t){return this.areasProduccion&&this.areasProduccion.length&&(!t.producto.categoria||!t.producto.categoria.areaProduccion)}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(u.T),e.Y36(h.YP),e.Y36(h.ez))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-orden-cocina"]],inputs:{command:"command",tiempoPreparacion:"tiempoPreparacion",apartado:"apartado",estadoComandaDetalle:"estadoComandaDetalle",areasProduccion:"areasProduccion"},outputs:{updatedStatusItem:"updatedStatusItem"},decls:20,vars:12,consts:[[3,"ngClass"],[1,"command"],[1,"command-header"],[1,"grid","p-nogutter"],[1,"col-6"],[1,"title-command"],[1,"col-6","text-right"],[4,"ngIf","ngIfElse"],["imagenPedido",""],[1,"command-body"],["class","grid p-nogutter",4,"ngIf"],["src","assets/resources/images/desk.svg","alt","",2,"width","12px"],[1,"ml-2",2,"display","inline-block"],[1,"label-lounge"],["src","assets/resources/images/lista.svg","alt","",2,"width","12px"],["class","col-12",4,"ngFor","ngForOf"],[1,"col-12"],[1,"command-detail","cursor-pointer","m-2","p-2",3,"ngClass","click"],[1,"grid","p-nogutter","align-content-center"],[1,"col"],[1,"grid"],["class","col-12 p-2",4,"ngIf"],["style","margin: 5px;",4,"ngIf"],[1,"col-12","p-2"],[1,"grid","p-nogutter","mt-2"],[1,"col-fixed",2,"width","30px"],[1,"m-0"],["style","font-size: 10px","class","mt-1 mb-1",4,"ngIf"],[1,"col-fixed",2,"width","25px"],["pTooltip","Para llevar","style","width: 14px;","src","assets/resources/images/para-llevar.svg","alt","",4,"ngIf","ngIfElse"],["imgAqui",""],[1,"mt-1","mb-1",2,"font-size","10px"],["pTooltip","Para llevar","src","assets/resources/images/para-llevar.svg","alt","",2,"width","14px"],["pTooltip","Para aqu\xed","src","assets/resources/images/camarero.svg","alt","",2,"width","14px"],["legend","Preparaciones"],["class","mt-0 mb-0",4,"ngFor","ngForOf"],[1,"mt-0","mb-0"],["legend","Complementos"],[1,"text-bold"],[2,"margin","5px"],["severity","info",3,"text"],["severity","warn","text","Sin zona de producci\xf3n"]],template:function(t,i){if(1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"div",2),e.TgZ(3,"div",3),e.TgZ(4,"div",4),e.TgZ(5,"h3",5),e._uU(6),e.qZA(),e.qZA(),e.TgZ(7,"div",6),e.YNc(8,Yi,7,2,"span",7),e.YNc(9,Bi,1,0,"ng-template",null,8,e.W1O),e.qZA(),e.TgZ(11,"div",4),e.TgZ(12,"h3",5),e._uU(13),e.qZA(),e.qZA(),e.TgZ(14,"div",6),e.TgZ(15,"h3",5),e._uU(16),e.ALo(17,"async"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(18,"div",9),e.YNc(19,ia,2,1,"div",10),e.qZA(),e.qZA(),e.qZA()),2&t){const s=e.MAs(10);e.Q6J("ngClass",e.WLB(9,aa,i.superaTiempo,i.preparado)),e.xp6(6),e.hij("Orden #",null==i.command||null==i.command.pedido?null:i.command.pedido.id,""),e.xp6(2),e.Q6J("ngIf","LOCAL"===(null==i.command?null:i.command.pedido.tipo))("ngIfElse",s),e.xp6(5),e.Oqu(null==i.command?null:i.command.orden),e.xp6(3),e.Oqu(e.lcZ(17,7,i.timer$)),e.xp6(3),e.Q6J("ngIf",null==i.command?null:i.command.items)}},directives:[v.mk,v.O5,v.sg,r.u,mt.p,Y.q],pipes:[v.Ov],styles:[".command[_ngcontent-%COMP%]{border:3px solid #e0e0e0}.command-time-max[_ngcontent-%COMP%]{border:1px solid #e70000}.command-ready[_ngcontent-%COMP%]{border:1px solid #009f07}.command[_ngcontent-%COMP%] > .command-header[_ngcontent-%COMP%]{padding:3px;background-color:#e0e0e0}.command[_ngcontent-%COMP%] > .command-body[_ngcontent-%COMP%]{padding:3px}.title-command[_ngcontent-%COMP%]{padding:0;margin:0}.command-detail[_ngcontent-%COMP%]{border-radius:9px;-moz-border-radius:9px 9px 9px 9px;-webkit-border-radius:9px 9px 9px 9px;border:2px solid #c9c9c9}.command-detail-prepared[_ngcontent-%COMP%]{background-color:#e6ffeb}.command-detail-preparation[_ngcontent-%COMP%]{background-color:#ffe3a3}.command-detail-dispatched[_ngcontent-%COMP%]{background-color:#e4eaff}.label-lounge[_ngcontent-%COMP%]{font-size:9px;color:#349bff;text-transform:uppercase}"]}),o})();const gt=function(){return{width:"100%"}};function sa(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",1),e.TgZ(1,"label",2),e._uU(2,"Desde"),e.qZA(),e.TgZ(3,"p-calendar",13),e.NdJ("onSelect",function(){return e.CHM(t),e.oxw().updateFilters()})("ngModelChange",function(s){return e.CHM(t),e.oxw().desde=s}),e.qZA(),e.qZA()}if(2&o){const t=e.oxw();e.xp6(3),e.Akn(e.DdM(6,gt)),e.Q6J("touchUI",!0)("readonlyInput",!0)("ngModel",t.desde)("locale",t.ls.calendarEs)}}function la(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",1),e.TgZ(1,"label",2),e._uU(2,"Hasta"),e.qZA(),e.TgZ(3,"p-calendar",13),e.NdJ("onSelect",function(){return e.CHM(t),e.oxw().updateFilters()})("ngModelChange",function(s){return e.CHM(t),e.oxw().hasta=s}),e.qZA(),e.qZA()}if(2&o){const t=e.oxw();e.xp6(3),e.Akn(e.DdM(6,gt)),e.Q6J("touchUI",!0)("readonlyInput",!0)("ngModel",t.hasta)("locale",t.ls.calendarEs)}}function ca(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",1),e.TgZ(1,"h4",8),e._uU(2,"Tiempo m\xe1ximo (min.)"),e.qZA(),e.TgZ(3,"input",14),e.NdJ("change",function(){return e.CHM(t),e.oxw().updateFilters()})("ngModelChange",function(s){return e.CHM(t),e.oxw().tiempoPreparacion=s}),e.qZA(),e.qZA()}if(2&o){const t=e.oxw();e.xp6(3),e.Q6J("ngModel",t.tiempoPreparacion)}}function da(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",15),e.TgZ(1,"app-orden-cocina",16),e.NdJ("updatedStatusItem",function(){return e.CHM(t),e.oxw().loadCommands()}),e.qZA(),e.qZA()}if(2&o){const t=n.$implicit,i=e.oxw();e.xp6(1),e.Q6J("apartado",i.apartado)("estadoComandaDetalle",i.estado)("areasProduccion",i.areasProduccionSelect)("tiempoPreparacion",i.tiempoPreparacion)("command",t)}}const pa=function(){return{"margin-top":"10px"}};class pe{constructor(n,t,i,s,d,C,w,F,N){this.route=n,this.router=t,this.store=i,this.breadcrumbService=s,this.dialogService=d,this.ls=C,this.restaurantService=w,this.datePipe=F,this.socketIoService=N,this.unsubscribe$=new k.xQ,this.comandas=[],this.areasProduccion=[],this.areasProduccionSelect=[],this.paraLlevarItems=[]}ngOnInit(){this.desde=new Date,this.hasta=new Date,this.loadData(),this.breadcrumbService.setItems((0,l.kn)(this.route)),this.puntoVenta$.pipe((0,P.R)(this.unsubscribe$)).subscribe(n=>{this.puntoVenta=n}),this.estados=[{label:"Pendiente",value:"PENDIENTE"},{label:"Preparado",value:"PREPARADO"},{label:"Despachado",value:"DESPACHADO"}],this.apartados=[{label:"Cocina",value:"C"},{label:"Meseros",value:"M"}],this.paraLlevarItems=[{label:"Todos",value:"all"},{label:"Para aqui",value:!1},{label:"Para llevar",value:!0}],this.filtros$.pipe((0,P.R)(this.unsubscribe$)).subscribe(n=>{this.paraLlevar=n.paraLlevar,this.estado=n.estado,this.apartado=n.apartado,this.tiempoPreparacion=n.tiempoPreparacion,this.areasProduccionSelect=n.areasProduccionSelect,this.loadCommands()}),this.socketIoService.onEvent($e.T.COMMAND_RESTAURANT).pipe((0,P.R)(this.unsubscribe$)).subscribe(n=>{this.notifyCommands()})}notifyCommands(){this.loadCommands(),new rt.Howl({src:["assets/resources/sounds/swiftly.mp3"]}).play()}changeApartado(){"M"===this.apartado?(this.estado="PREPARADO",this.estados=[{label:"Preparado",value:"PREPARADO"},{label:"Despachado",value:"DESPACHADO"}]):(this.estado="PENDIENTE",this.estados=[{label:"Pendiente",value:"PENDIENTE"},{label:"Preparado",value:"PREPARADO"},{label:"Despachado",value:"DESPACHADO"}]),this.areasProduccionSelect=[],this.updateFilters()}updateFilters(){this.store.dispatch(new Qi.B({paraLlevar:this.paraLlevar,estado:this.estado,apartado:this.apartado,tiempoPreparacion:this.tiempoPreparacion,areasProduccionSelect:this.areasProduccionSelect}))}ngOnDestroy(){this.unsubscribe$.next(),this.unsubscribe$.complete()}get titleMonitor(){return"C"===this.apartado?"Monitor de cocina":"Monitor de meseros"}loadCommands(){const i=[`desde=${this.datePipe.transform(this.desde,"dd-MM-yyyy")}`,`hasta=${this.datePipe.transform(this.hasta,"dd-MM-yyyy")}`,"estadoPedido=PENDIENTE",`estadoComandaDetalle=${this.estado}`,"estadoPedido=PREPARADO",`idPuntoVenta=${this.puntoVenta.id}`];"PENDIENTE"===this.estado&&i.push("estadoComandaDetalle=PREPARACION"),this.areasProduccionSelect.forEach(s=>i.push(`idAreaProduccion=${s}`)),"all"!==this.paraLlevar&&i.push(`paraLlevar=${this.paraLlevar}`),this.restaurantService.findAllCommands(i.join("&")).subscribe(s=>{this.comandas=s})}loadData(){this.restaurantService.findAllAreaProductions(["paginacion=false"].join("&")).subscribe(t=>{this.areasProduccion=t.map(i=>({label:i.nombre,value:i.id}))})}}function ua(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",9),e.TgZ(1,"app-envio-item",10),e.NdJ("changeStatus",function(s){return e.CHM(t),e.oxw().changeStatus(s)}),e.qZA(),e.qZA()}if(2&o){const t=n.$implicit;e.xp6(1),e.Q6J("delivery",t)("modoReparto",!0)}}pe.\u0275fac=function(n){return new(n||pe)(e.Y36(D.gz),e.Y36(D.F0),e.Y36(y.yh),e.Y36(Z.p),e.Y36(L.xA),e.Y36(Ye.E),e.Y36(u.T),e.Y36(v.uU),e.Y36(Qe.l))},pe.\u0275cmp=e.Xpm({type:pe,selectors:[["app-cocina"]],decls:25,vars:16,consts:[[1,"grid","p-fluid"],[1,"col-6","xl:col-2","md:col-3"],[1,"label-form"],[3,"options","ngModel","onChange","ngModelChange"],[1,"col-6","xl:col-3","md:col-4"],["class","col-6 xl:col-2 md:col-3",4,"ngIf"],[1,"col-6","xl:col-2","md:col-4"],["defaultLabel","Seleccione zona de producci\xf3n","maxSelectedLabels","5",3,"options","ngModel","onChange","ngModelChange"],[1,"mt-1","m-b-1"],[1,"col-12"],[3,"header"],[1,"grid"],["class","col-fixed","style","width: 300px;",4,"ngFor","ngForOf"],["name","filtroDesde","dateFormat","dd/mm/yy",3,"touchUI","readonlyInput","ngModel","locale","onSelect","ngModelChange"],["placeholder","Tiempo m\xe1ximo","type","text","pInputText","",3,"ngModel","change","ngModelChange"],[1,"col-fixed",2,"width","300px"],[3,"apartado","estadoComandaDetalle","areasProduccion","tiempoPreparacion","command","updatedStatusItem"]],template:function(n,t){1&n&&(e.TgZ(0,"p-card"),e.TgZ(1,"div",0),e.TgZ(2,"div",1),e.TgZ(3,"label",2),e._uU(4,"Apartado"),e.qZA(),e.TgZ(5,"p-selectButton",3),e.NdJ("onChange",function(){return t.changeApartado()})("ngModelChange",function(s){return t.apartado=s}),e.qZA(),e.qZA(),e.TgZ(6,"div",4),e.TgZ(7,"label",2),e._uU(8,"Estado"),e.qZA(),e.TgZ(9,"p-selectButton",3),e.NdJ("onChange",function(){return t.updateFilters()})("ngModelChange",function(s){return t.estado=s}),e.qZA(),e.qZA(),e.YNc(10,sa,4,7,"div",5),e.YNc(11,la,4,7,"div",5),e.TgZ(12,"div",6),e.TgZ(13,"label",2),e._uU(14,"Zona producci\xf3n"),e.qZA(),e.TgZ(15,"p-multiSelect",7),e.NdJ("onChange",function(){return t.updateFilters()})("ngModelChange",function(s){return t.areasProduccionSelect=s}),e.qZA(),e.qZA(),e.YNc(16,ca,4,1,"div",5),e.TgZ(17,"div",4),e.TgZ(18,"h4",8),e._uU(19,"Modalidad"),e.qZA(),e.TgZ(20,"p-selectButton",3),e.NdJ("onChange",function(){return t.updateFilters()})("ngModelChange",function(s){return t.paraLlevar=s}),e.qZA(),e.qZA(),e.TgZ(21,"div",9),e.TgZ(22,"p-panel",10),e.TgZ(23,"div",11),e.YNc(24,da,2,5,"div",12),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&n&&(e.xp6(5),e.Q6J("options",t.apartados)("ngModel",t.apartado),e.xp6(4),e.Q6J("options",t.estados)("ngModel",t.estado),e.xp6(1),e.Q6J("ngIf",t.desde),e.xp6(1),e.Q6J("ngIf",t.hasta),e.xp6(4),e.Q6J("options",t.areasProduccion)("ngModel",t.areasProduccionSelect),e.xp6(1),e.Q6J("ngIf","C"===t.apartado),e.xp6(4),e.Q6J("options",t.paraLlevarItems)("ngModel",t.paraLlevar),e.xp6(2),e.Akn(e.DdM(15,pa)),e.Q6J("header",t.titleMonitor),e.xp6(2),e.Q6J("ngForOf",t.comandas))},directives:[T.Z,fe.UN,f.JJ,f.On,v.O5,Be.f,st.NU,f.Fj,O.o,Ce.s,v.sg,ra],styles:[""]}),(0,q.gn)([(0,y.Ph)($i.I.filtros)],pe.prototype,"filtros$",void 0),(0,q.gn)([(0,y.Ph)(R.Z.getOffice)],pe.prototype,"puntoVenta$",void 0);class ue{constructor(n,t,i,s){this.deliveryService=n,this.loginService=t,this.breadcrumbService=i,this.route=s,this.unsubscribe$=new k.xQ,this.perPage=10,this.totalRecords=0,this.pageNumber=0,this.deliveries=[],this.cancelDelivery=new e.vpe}ngOnInit(){this.breadcrumbService.setItems((0,l.kn)(this.route)),this.filtroEstadoDelivery$.pipe((0,P.R)(this.unsubscribe$)).subscribe(n=>{this.filtroEstadoDelivery=n,this.loadDeliveries()}),this.puntoVenta$.pipe((0,P.R)(this.unsubscribe$)).subscribe(n=>{this.filtroPuntoVenta=n,this.loadDeliveries()})}ngOnDestroy(){this.unsubscribe$.next(),this.unsubscribe$.complete()}loadDeliveries(){if(void 0!==this.filtroEstadoDelivery&&void 0!==this.filtroPuntoVenta){const n=this.loginService.getUser().id,t=[`idPuntoVenta=${this.filtroPuntoVenta.id}`,`pageNumber=${this.pageNumber}`,`perPage=${this.perPage}`,"sortField=fechaCreacion","sortOrder=-1",`idRepartidor=${n}`];this.filtroEstadoDelivery&&this.filtroEstadoDelivery.forEach(i=>t.push(`estado=${i}`)),this.deliveryService.findAll(t.join("&")).subscribe(i=>{this.totalRecords=i.totalElements,this.deliveries=i.content,console.log(this.deliveries)})}}pageChanged(n){this.pageNumber=n.page,this.loadDeliveries()}changeStatus(n){this.loadDeliveries(),"CANCELADO"===n&&this.cancelDelivery.emit()}openDeliveryDetail(n){}}function ma(o,n){if(1&o&&e._UZ(0,"p-sortIcon",11),2&o){const t=e.oxw().$implicit;e.Q6J("field",t.field)}}function ga(o,n){if(1&o&&(e.TgZ(0,"th",9),e._uU(1),e.YNc(2,ma,1,1,"p-sortIcon",10),e.qZA()),2&o){const t=n.$implicit;e.Q6J("pSortableColumn",t.field),e.xp6(1),e.hij(" ",t.header," "),e.xp6(1),e.Q6J("ngIf",!t.isActions)}}function _a(o,n){if(1&o&&(e.TgZ(0,"tr"),e.YNc(1,ga,3,3,"th",8),e.qZA()),2&o){const t=n.$implicit;e.xp6(1),e.Q6J("ngForOf",t)}}function fa(o,n){if(1&o&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&o){const t=e.oxw(3).$implicit,i=e.oxw().$implicit;e.xp6(1),e.Oqu(i[t.field])}}function ha(o,n){if(1&o&&(e.ynx(0),e.TgZ(1,"span",18),e._uU(2,"Nombre"),e.qZA(),e.YNc(3,fa,2,1,"span",14),e.BQk()),2&o){const t=e.oxw(2).$implicit,i=e.oxw().$implicit;e.xp6(3),e.Q6J("ngIf",i[t.field])}}function va(o,n){if(1&o&&(e.ynx(0),e._uU(1),e.BQk()),2&o){const t=e.oxw(2).$implicit,i=e.oxw().$implicit;e.xp6(1),e.hij(" ",i[t.field]," ")}}function ba(o,n){1&o&&(e.ynx(0),e.YNc(1,ha,4,1,"ng-container",16),e.YNc(2,va,2,1,"ng-container",17),e.BQk()),2&o&&(e.xp6(1),e.Q6J("ngSwitchCase","nombre"))}function Ca(o,n){if(1&o&&(e.ynx(0,19),e.TgZ(1,"span",18),e._uU(2,"Acciones"),e.qZA(),e._UZ(3,"button",20),e.BQk()),2&o){const t=e.oxw(2).$implicit,i=e.oxw();e.xp6(3),e.Q6J("routerLink",i.linkUpdate(t.id))}}function Ta(o,n){if(1&o&&(e.TgZ(0,"td",13),e.YNc(1,ba,3,1,"ng-container",14),e.YNc(2,Ca,4,1,"ng-container",15),e.qZA()),2&o){const t=n.$implicit;e.Q6J("ngSwitch",t.field),e.xp6(1),e.Q6J("ngIf",!t.isActions),e.xp6(1),e.Q6J("ngIf",t.isActions)}}function Za(o,n){if(1&o&&(e.TgZ(0,"tr"),e.YNc(1,Ta,3,3,"td",12),e.qZA()),2&o){const t=n.columns;e.xp6(1),e.Q6J("ngForOf",t)}}function Aa(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",21),e.TgZ(1,"button",22),e.NdJ("click",function(){return e.CHM(t),e.oxw().new()}),e.qZA(),e.qZA()}}ue.\u0275fac=function(n){return new(n||ue)(e.Y36(Fe.p),e.Y36(_e.r),e.Y36(Z.p),e.Y36(D.gz))},ue.\u0275cmp=e.Xpm({type:ue,selectors:[["app-reparto"]],outputs:{cancelDelivery:"cancelDelivery"},decls:20,vars:3,consts:[[1,"grid"],[1,"col-12"],[1,"grid","text-bold",2,"padding-right","12px","padding-left","12px"],[1,"col-fixed",2,"width","60px"],[1,"col"],[1,"col-2"],[1,"col-4"],["class","mb-2",4,"ngFor","ngForOf"],[3,"rows","totalRecords","onPageChange"],[1,"mb-2"],[3,"delivery","modoReparto","changeStatus"]],template:function(n,t){1&n&&(e.TgZ(0,"p-card"),e.TgZ(1,"div",0),e.TgZ(2,"div",1),e.TgZ(3,"div",2),e._UZ(4,"div",3),e.TgZ(5,"div",4),e.TgZ(6,"div",0),e.TgZ(7,"div",5),e._uU(8," N. Env\xedo "),e.qZA(),e.TgZ(9,"div",6),e._uU(10," Repartidor "),e.qZA(),e.TgZ(11,"div",5),e._uU(12," N. Pedidos "),e.qZA(),e.TgZ(13,"div",5),e._uU(14," Cambio "),e.qZA(),e.TgZ(15,"div",5),e._uU(16," Tiempo "),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.YNc(17,ua,2,2,"div",7),e.qZA(),e.TgZ(18,"div",1),e.TgZ(19,"p-paginator",8),e.NdJ("onPageChange",function(s){return t.pageChanged(s)}),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&n&&(e.xp6(17),e.Q6J("ngForOf",t.deliveries),e.xp6(2),e.Q6J("rows",t.perPage)("totalRecords",t.totalRecords))},directives:[T.Z,v.sg,ct,ke.D],styles:[""]}),(0,q.gn)([(0,y.Ph)(be.d.filtroEstadoDelivery)],ue.prototype,"filtroEstadoDelivery$",void 0),(0,q.gn)([(0,y.Ph)(R.Z.getOffice)],ue.prototype,"puntoVenta$",void 0);let xa=(()=>{class o{constructor(t,i,s,d){this.route=t,this.router=i,this.restaurantService=s,this.breadcrumbService=d,this.perPage=10}ngOnInit(){this.breadcrumbService.setItems((0,l.kn)(this.route)),this.cols=[{field:"nombre",header:"Nombre"},{header:"Acciones",isActions:!0}]}new(){this.router.navigateByUrl("/restaurante/zonas-produccion/nuevo")}loadLazy(t){const s=["pageNumber="+t.first/this.perPage,`perPage=${t.rows}`,"paginacion=true"];t.sortOrder&&s.push(`sortOrder=${t.sortOrder}`),t.sortField&&s.push(`sortField=${t.sortField}`),t.filters.global&&s.push(`filterGlobal=${t.filters.global.value}`),this.restaurantService.findAllAreaProductions(s.join("&")).subscribe(d=>{this.totalRecords=d.totalElements,this.dataList=d.content})}linkUpdate(t){return`/restaurante/zonas-produccion/editar/${t}`}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(D.gz),e.Y36(D.F0),e.Y36(u.T),e.Y36(Z.p))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-zonas-produccion"]],decls:10,vars:8,consts:[[1,"grid"],[1,"col-12"],["type","text","pInputText","","size","32","placeholder","Buscar",1,"derecha",2,"width","auto",3,"input"],["dataKey","id",3,"columns","value","lazy","paginator","rows","totalRecords","responsive","autoLayout","onLazyLoad"],["dt",""],["pTemplate","header"],["pTemplate","body"],["pTemplate","summary"],[3,"pSortableColumn",4,"ngFor","ngForOf"],[3,"pSortableColumn"],["ariaLabel","Activa para ordenar","ariaLabelDesc","Activa para ordenar en orden descendente","ariaLabelAsc","Activa para ordenar en orden ascendente",3,"field",4,"ngIf"],["ariaLabel","Activa para ordenar","ariaLabelDesc","Activa para ordenar en orden descendente","ariaLabelAsc","Activa para ordenar en orden ascendente",3,"field"],[3,"ngSwitch",4,"ngFor","ngForOf"],[3,"ngSwitch"],[4,"ngIf"],["style","text-align: center",4,"ngIf"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"p-column-title"],[2,"text-align","center"],["pButton","","type","button","icon","pi pi-pencil","pTooltip","Actualizar, Eliminar",1,"p-button-success",3,"routerLink"],[2,"text-align","left"],["type","button","pButton","","icon","fa fa-plus","label","Nuevo",2,"margin-right","0.2rem",3,"click"]],template:function(t,i){if(1&t){const s=e.EpF();e.TgZ(0,"p-card"),e.TgZ(1,"div",0),e.TgZ(2,"div",1),e.TgZ(3,"input",2),e.NdJ("input",function(C){return e.CHM(s),e.MAs(6).filterGlobal(C.target.value,"contains")}),e.qZA(),e.qZA(),e.TgZ(4,"div",1),e.TgZ(5,"p-table",3,4),e.NdJ("onLazyLoad",function(C){return i.loadLazy(C)}),e.YNc(7,_a,2,1,"ng-template",5),e.YNc(8,Za,2,1,"ng-template",6),e.YNc(9,Aa,2,0,"ng-template",7),e.qZA(),e.qZA(),e.qZA(),e.qZA()}2&t&&(e.xp6(5),e.Q6J("columns",i.cols)("value",i.dataList)("lazy",!0)("paginator",!0)("rows",i.perPage)("totalRecords",i.totalRecords)("responsive",!0)("autoLayout",!0))},directives:[T.Z,O.o,A.iA,h.jx,v.sg,A.lQ,v.O5,A.fz,v.RF,v.n9,v.ED,a.Hq,r.u,D.rH],styles:[""]}),o})();var ya=b(22650);let Pa=(()=>{class o{constructor(t){this.ref=t}ngOnInit(){}selectPrinter(t){this.ref.close(t)}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(L.E7))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-modal-impresoras"]],decls:1,vars:1,consts:[[3,"isModal","selectPrinter"]],template:function(t,i){1&t&&(e.TgZ(0,"app-impresoras",0),e.NdJ("selectPrinter",function(d){return i.selectPrinter(d)}),e.qZA()),2&t&&e.Q6J("isModal",!0)},directives:[ya.B],styles:[""]}),o})();function Da(o,n){1&o&&e._UZ(0,"p-message",15)}function wa(o,n){1&o&&(e.TgZ(0,"tr"),e.TgZ(1,"th"),e._uU(2,"Impresora"),e.qZA(),e.TgZ(3,"th"),e._uU(4,"Punto venta"),e.qZA(),e.TgZ(5,"th"),e._uU(6,"Acciones"),e.qZA(),e.qZA())}function qa(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"tr",16),e.TgZ(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td",17),e.TgZ(6,"button",18),e.NdJ("click",function(){const d=e.CHM(t).rowIndex;return e.oxw().deletePrinterForm(d)}),e.qZA(),e.qZA(),e.qZA()}if(2&o){const i=n.$implicit;e.Q6J("formGroupName",n.rowIndex),e.xp6(2),e.Oqu(i.get("nombre").value),e.xp6(2),e.Oqu(null==i.get("puntoVenta").value?null:i.get("puntoVenta").value.nombre)}}function Oa(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",19),e.NdJ("click",function(){return e.CHM(t),e.oxw().confirmDelete()}),e.qZA()}}let _t=(()=>{class o{constructor(t,i,s,d,C,w,F,N,J,xe){this.route=t,this.router=i,this.restaurantService=s,this.companyService=d,this.messageService=C,this.loginService=w,this.confirmationService=F,this.fb=N,this.breadcrumbService=J,this.dialogService=xe}ngOnInit(){this.breadcrumbService.setItems((0,l.kn)(this.route)),this.builderForm(),this.loadModel()}builderForm(){this.mf=this.fb.group({nombre:["",[f.kI.required]],impresoras:this.fb.array([])})}submitForm(){let t,i;this.formToModel(),this.isEdit?(t=this.restaurantService.updateAreaProduction(this.model.id,this.model),i="Zona de producci\xf3n actualizado correctamente."):(t=this.restaurantService.saveAreaProduction(this.model),i="Zona de producci\xf3n registrado correctamente."),t.subscribe(s=>{this.messageService.add({severity:"success",summary:"Mensaje",detail:i}),this.router.navigateByUrl(this.linkVolver)})}formToModel(){this.model||(this.model={}),this.model.nombre=this.mf.value.nombre,this.model.impresoras=this.mf.value.impresoras}modelToForm(t){this.mf.patchValue({nombre:t.nombre}),t.impresoras.forEach(i=>this.addPrinterFormByPrinter(i))}get textButtonAction(){return this.isEdit?"Actualizar":"Guardar"}get nameModulo(){return this.route.snapshot.data.title}loadModel(){this.isEdit=this.route.snapshot.data.isEdit,this.isEdit&&this.route.params.subscribe(t=>{this.restaurantService.findAreaProductionById(t.id).subscribe(s=>{s&&(this.model=s,this.modelToForm(s))})})}confirmDelete(){this.confirmationService.confirm({message:"Estas seguro de eliminar este registro?",accept:()=>{this.restaurantService.deleteAreaProductionById(this.model.id).subscribe(()=>{this.messageService.clear(),this.messageService.add({severity:"success",summary:"Mensaje",detail:"Registro eliminado correctamente"}),this.router.navigateByUrl(this.linkVolver)})},acceptLabel:"Si",rejectLabel:"No"})}get linkVolver(){return"/restaurante/zonas-produccion"}get modelFormPrinters(){return this.mf.get("impresoras")}addPrinterFormByPrinter(t){this.modelFormPrinters.controls.find(i=>i.get("id").value===t.id)?this.messageService.add({severity:"warn",summary:"Mensaje",detail:`La impresora ${t.nombre} ya est\xe1 agregada.`}):this.modelFormPrinters.push(this.createPrinterForm(t))}deletePrinterForm(t){this.modelFormPrinters.removeAt(t)}createPrinterForm(t){return this.fb.group({id:[t.id,[f.kI.required]],nombre:[t.nombre,[]],puntoVenta:[t.puntoVenta,[]]})}openModalAddPrinter(){this.dialogService.open(Pa,{header:"Selecciona una impresora",width:"80%"}).onClose.subscribe(i=>{i&&this.addPrinterFormByPrinter(i)})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(D.gz),e.Y36(D.F0),e.Y36(u.T),e.Y36(Je.J),e.Y36(h.ez),e.Y36(_e.r),e.Y36(h.YP),e.Y36(f.qu),e.Y36(Z.p),e.Y36(L.xA))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-zona-produccion"]],decls:24,vars:9,consts:[[1,"grid"],[1,"col-12"],["novalidate","",3,"formGroup","ngSubmit"],[1,"grid","form-group"],[1,"label-form"],["formControlName","nombre","id","nombre","type","text","pInputText","",2,"width","100%","margin-bottom","0.2em"],["severity","error","text","Ingrese nombre",4,"ngIf"],["pButton","","type","button","icon","pi pi-plus","pTooltip","Agregar impresora",3,"click"],["formArrayName","impresoras",3,"value","rows","responsive"],["pTemplate","header"],["pTemplate","body"],[1,"col-12",2,"text-align","center"],["pButton","","type","submit",2,"margin-right","0.4rem",3,"disabled","label"],["style","margin-right: 0.4rem","pButton","","type","button","label","Eliminar","class","p-button-danger",3,"click",4,"ngIf"],["pButton","","type","button","label","Volver",1,"p-button-secondary",2,"margin-right","0.4rem",3,"routerLink"],["severity","error","text","Ingrese nombre"],[3,"formGroupName"],[2,"text-align","center"],["pTooltip","Eliminar","pButton","","type","button","icon","pi pi-trash",1,"p-button-danger","lrm-1",3,"click"],["pButton","","type","button","label","Eliminar",1,"p-button-danger",2,"margin-right","0.4rem",3,"click"]],template:function(t,i){1&t&&(e.TgZ(0,"p-card"),e.TgZ(1,"div",0),e.TgZ(2,"div",1),e.TgZ(3,"form",2),e.NdJ("ngSubmit",function(){return i.submitForm()}),e.TgZ(4,"div",3),e.TgZ(5,"div",1),e.TgZ(6,"label",4),e._uU(7,"Nombre (*)"),e.qZA(),e._UZ(8,"input",5),e.YNc(9,Da,1,0,"p-message",6),e.qZA(),e.TgZ(10,"div",1),e.TgZ(11,"label",4),e._uU(12,"Impresoras"),e.qZA(),e.TgZ(13,"div",0),e.TgZ(14,"div",1),e.TgZ(15,"button",7),e.NdJ("click",function(){return i.openModalAddPrinter()}),e.qZA(),e.qZA(),e.TgZ(16,"div",1),e.TgZ(17,"p-table",8),e.YNc(18,wa,7,0,"ng-template",9),e.YNc(19,qa,7,3,"ng-template",10),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(20,"div",11),e._UZ(21,"button",12),e.YNc(22,Oa,1,0,"button",13),e._UZ(23,"button",14),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(3),e.Q6J("formGroup",i.mf),e.xp6(6),e.Q6J("ngIf",i.mf.get("nombre").touched&&(null==i.mf.get("nombre").errors?null:i.mf.get("nombre").errors.required)),e.xp6(8),e.Q6J("value",i.modelFormPrinters.controls)("rows",10)("responsive",!0),e.xp6(4),e.Q6J("disabled",!i.mf.valid)("label",i.textButtonAction),e.xp6(1),e.Q6J("ngIf",i.isEdit),e.xp6(1),e.Q6J("routerLink",i.linkVolver))},directives:[T.Z,f._Y,f.JL,f.sg,f.Fj,f.JJ,f.u,O.o,v.O5,Y.q,a.Hq,r.u,A.iA,f.CE,h.jx,f.x0,D.rH],styles:[""]}),o})();var Ia=b(33379);function Ea(o,n){1&o&&e._UZ(0,"p-message",20)}function Sa(o,n){1&o&&(e.TgZ(0,"tr"),e.TgZ(1,"th"),e._uU(2,"Pedido"),e.qZA(),e.TgZ(3,"th"),e._uU(4,"Domicilio"),e.qZA(),e.TgZ(5,"th"),e._uU(6,"Nombre"),e.qZA(),e.TgZ(7,"th"),e._uU(8,"Fecha"),e.qZA(),e.TgZ(9,"th"),e._uU(10,"Estado"),e.qZA(),e.TgZ(11,"th"),e._uU(12,"Total"),e.qZA(),e.TgZ(13,"th",21),e._uU(14,"Acci\xf3n"),e.qZA(),e.qZA())}function Na(o,n){if(1&o&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&o){const t=e.oxw(2).$implicit;e.xp6(1),e.hij(" - Dpto. ",null==t.get("ordenRestaurante").value?null:t.get("ordenRestaurante").value.numeroDepartamento,"")}}function ka(o,n){if(1&o&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&o){const t=e.oxw(2).$implicit;e.xp6(1),e.hij(" - (",null==t.get("ordenRestaurante").value?null:t.get("ordenRestaurante").value.referencia,")")}}function Fa(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"tr",23),e.TgZ(1,"td"),e._uU(2),e.ALo(3,"completarCeros"),e.qZA(),e.TgZ(4,"td"),e.TgZ(5,"span",24),e._uU(6),e.YNc(7,Na,2,1,"span",25),e.YNc(8,ka,2,1,"span",25),e.qZA(),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.qZA(),e.TgZ(11,"td"),e._uU(12),e.ALo(13,"date"),e.qZA(),e.TgZ(14,"td"),e._uU(15),e.ALo(16,"estadoPedidoRestaurante"),e.qZA(),e.TgZ(17,"td"),e._uU(18),e.qZA(),e.TgZ(19,"td",26),e.TgZ(20,"button",27),e.NdJ("click",function(){e.CHM(t);const s=e.oxw().rowIndex;return e.oxw().deleteItemForm(s)}),e.qZA(),e.qZA(),e.qZA()}if(2&o){const t=e.oxw(),s=t.$implicit;e.Q6J("formGroupName",t.rowIndex),e.xp6(2),e.Oqu(e.xi3(3,10,null==s.get("ordenRestaurante").value?null:s.get("ordenRestaurante").value.id,8)),e.xp6(4),e.AsE("",null==s.get("ordenRestaurante").value?null:s.get("ordenRestaurante").value.direccion," #",null==s.get("ordenRestaurante").value?null:s.get("ordenRestaurante").value.numero," "),e.xp6(1),e.Q6J("ngIf",null==s.get("ordenRestaurante").value?null:s.get("ordenRestaurante").value.numeroDepartamento),e.xp6(1),e.Q6J("ngIf",null==s.get("ordenRestaurante").value?null:s.get("ordenRestaurante").value.referencia),e.xp6(2),e.Oqu(null==s.get("ordenRestaurante").value?null:s.get("ordenRestaurante").value.cliente.razonSocial),e.xp6(2),e.Oqu(e.xi3(13,13,null==s.get("ordenRestaurante").value?null:s.get("ordenRestaurante").value.fecha,"dd/MM/yyyy hh:mm a")),e.xp6(3),e.Oqu(e.lcZ(16,16,null==s.get("ordenRestaurante").value?null:s.get("ordenRestaurante").value.estado)),e.xp6(3),e.Oqu((null==s.get("ordenRestaurante").value?null:s.get("ordenRestaurante").value.montoPedido)+(null==s.get("ordenRestaurante").value?null:s.get("ordenRestaurante").value.montoDelivery))}}function Ma(o,n){1&o&&e.YNc(0,Fa,21,18,"tr",22),2&o&&e.Q6J("ngIf",!n.$implicit.value.eliminado)}function La(o,n){1&o&&e._UZ(0,"p-message",28)}const Ra=function(){return{width:"100%"}};class Ae{constructor(n,t,i,s,d,C,w,F,N,J){this.fb=n,this.messageService=t,this.confirmationService=i,this.userService=s,this.restaurantService=d,this.store=C,this.deliveryService=w,this.router=F,this.route=N,this.breadcrumbService=J,this.unsubscribe$=new k.xQ,this.usuarios=[],this.orders=[],this.filtroTiposPedidosInput=[]}ngOnInit(){this.breadcrumbService.setItems((0,l.kn)(this.route)),this.filtroTiposPedidosInput=["PEDIDO_FORANEO","PEDIDO_ONLINE"],this.builderForm(),this.loadUsers(),this.puntoVenta$.pipe((0,P.R)(this.unsubscribe$)).subscribe(n=>{this.puntoVenta=n})}ngOnDestroy(){this.unsubscribe$.next(),this.unsubscribe$.complete()}builderForm(){this.modelForm=this.fb.group({idRepartidor:["",[f.kI.required]],montoCambio:["",[]],items:this.fb.array([],(0,l.eK)(1))})}get modelFormItems(){return this.modelForm.get("items")}get totalEnvio(){return this.modelFormItems.getRawValue().map(n=>n.ordenRestaurante.montoPedido+n.ordenRestaurante.montoDelivery).reduce(l.IH,0)}addOrdenRestauranteForm(n){this.modelFormItems.controls.find(t=>t.get("ordenRestaurante").value.id===n.id)?this.messageService.add({severity:"warn",summary:"Mensaje",detail:`La orden ${n.id} ya est\xe1 agregada al env\xedo actual.`}):this.modelFormItems.push(this.createItemForm({ordenRestaurante:n}))}deleteItemForm(n){this.modelFormItems.removeAt(n)}createItemForm(n){return this.fb.group({id:[n.id,[]],ordenRestaurante:[n.ordenRestaurante,[f.kI.required]],eliminado:[!1,[]]})}loadUsers(){setTimeout(()=>this.userService.findAll(null,!1).pipe((0,pt.UI)(n=>n.map(t=>({label:`${t.nombres} ${t.apellidos}`,value:t.id})))).subscribe(n=>this.usuarios=n))}registerDelivery(){(0,l.c2)(this.modelForm),this.modelForm.valid?this.confirmationService.confirm({message:"\xbfEst\xe1 seguro de registrar el env\xedo actual?",accept:()=>{const n=Object.assign(Object.assign({},this.modelForm.getRawValue()),{repartidor:{id:this.modelForm.getRawValue().idRepartidor},puntoVenta:this.puntoVenta});this.deliveryService.save(n).subscribe(t=>{this.messageService.add({severity:"success",summary:"Registro de env\xedo",detail:"Env\xedo registrado correctamente."}),this.volver()})},acceptLabel:"Si",rejectLabel:"No"}):this.messageService.add({severity:"error",summary:"Error",detail:"Complete campos obligatorios (*)"})}volver(){this.router.navigateByUrl("/restaurante/pedidos")}addOrder(n){console.log(n),this.addOrdenRestauranteForm(n)}}Ae.\u0275fac=function(n){return new(n||Ae)(e.Y36(f.qu),e.Y36(h.ez),e.Y36(h.YP),e.Y36(Ia.i),e.Y36(u.T),e.Y36(y.yh),e.Y36(Fe.p),e.Y36(D.F0),e.Y36(D.gz),e.Y36(Z.p))},Ae.\u0275cmp=e.Xpm({type:Ae,selectors:[["app-nuevo-envio"]],decls:33,vars:16,consts:[[1,"grid"],[1,"col-12","md:col-4","lg:col-3"],["titlePanel","Pedidos por enviar",3,"interfazEnvios","filtroTiposPedidosInput","selectOrder"],[1,"col-12","md:col-8","lg:col-9"],["header","Registro de env\xedo"],["novalidate","",3,"formGroup"],[1,"col-6"],[1,"label-form"],["filter","true","formControlName","idRepartidor","placeholder","Seleccione repartidor",3,"options"],["severity","error","text","Seleccione repartidor",4,"ngIf"],["formControlName","montoCambio","pKeyFilter","num","type","text","pInputText","",2,"width","100%","margin-bottom","0.2em"],[1,"col-12"],["scrollHeight","200px;","formArrayName","items",3,"value","rows","responsive"],["pTemplate","header"],["pTemplate","body"],["severity","error","text","Agregue ordenes al env\xedo",4,"ngIf"],[1,"mt-0","text-bold"],[1,"col-12","flex-center-x"],["pButton","","type","button","label","Volver",1,"p-button-rounded","m-1",3,"click"],["pButton","","type","button","label","Registrar",1,"p-button-rounded","p-button-success","m-1",3,"click"],["severity","error","text","Seleccione repartidor"],[2,"width","60px"],[3,"formGroupName",4,"ngIf"],[3,"formGroupName"],[1,"text-bold"],[4,"ngIf"],[2,"text-align","center"],["pTooltip","Eliminar","pButton","","type","button","icon","pi pi-trash",1,"p-button-danger","lrm-1",3,"click"],["severity","error","text","Agregue ordenes al env\xedo"]],template:function(n,t){1&n&&(e.TgZ(0,"p-card"),e.TgZ(1,"div",0),e.TgZ(2,"div",1),e.TgZ(3,"app-lista-pedidos",2),e.NdJ("selectOrder",function(s){return t.addOrder(s)}),e.qZA(),e.qZA(),e.TgZ(4,"div",3),e.TgZ(5,"p-panel",4),e.TgZ(6,"form",5),e.TgZ(7,"div",0),e.TgZ(8,"div",6),e.TgZ(9,"label",7),e._uU(10,"Repartidor (*)"),e.qZA(),e._UZ(11,"p-dropdown",8),e.YNc(12,Ea,1,0,"p-message",9),e.qZA(),e.TgZ(13,"div",6),e.TgZ(14,"label",7),e._uU(15,"Cambio"),e.qZA(),e._UZ(16,"input",10),e.qZA(),e.TgZ(17,"div",11),e.TgZ(18,"label",7),e._uU(19,"Contenido del env\xedo (*)"),e.qZA(),e.TgZ(20,"p-table",12),e.YNc(21,Sa,15,0,"ng-template",13),e.YNc(22,Ma,1,1,"ng-template",14),e.qZA(),e.YNc(23,La,1,0,"p-message",15),e.qZA(),e.TgZ(24,"div",11),e.TgZ(25,"label",7),e._uU(26,"Total"),e.qZA(),e.TgZ(27,"p",16),e._uU(28),e.ALo(29,"montoDinero"),e.qZA(),e.qZA(),e.TgZ(30,"div",17),e.TgZ(31,"button",18),e.NdJ("click",function(){return t.volver()}),e.qZA(),e.TgZ(32,"button",19),e.NdJ("click",function(){return t.registerDelivery()}),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&n&&(e.xp6(3),e.Q6J("interfazEnvios",!0)("filtroTiposPedidosInput",t.filtroTiposPedidosInput),e.xp6(3),e.Q6J("formGroup",t.modelForm),e.xp6(5),e.Akn(e.DdM(15,Ra)),e.Q6J("options",t.usuarios),e.xp6(1),e.Q6J("ngIf",t.modelForm.get("idRepartidor").touched&&(null==t.modelForm.get("idRepartidor").errors?null:t.modelForm.get("idRepartidor").errors.required)),e.xp6(8),e.Q6J("value",t.modelFormItems.controls)("rows",10)("responsive",!0),e.xp6(3),e.Q6J("ngIf",t.modelForm.get("items").touched&&(null==t.modelForm.get("items").errors?null:t.modelForm.get("items").errors.minLengthArray)),e.xp6(5),e.Oqu(e.xi3(29,12,t.totalEnvio,"PEN")))},directives:[T.Z,B,Ce.s,f._Y,f.JL,f.sg,Ue.Lt,f.JJ,f.u,v.O5,Y.q,f.Fj,ve.Fr,O.o,A.iA,f.CE,h.jx,f.x0,r.u,a.Hq],pipes:[se,v.uU,Se,te.Z],styles:[""]}),(0,q.gn)([(0,y.Ph)(R.Z.getOffice)],Ae.prototype,"puntoVenta$",void 0);const Ja=[{path:"",component:wt,canActivate:[E.P],children:[{path:"",pathMatch:"full",redirectTo:"comandero"},{path:"comandero",component:mn,canActivate:[E.P],data:{breadcrumb:[{label:"Restaurante"},{label:"Comandero"}]}},{path:"nuevo-envio",component:Ae,canActivate:[E.P],data:{breadcrumb:[{label:"Restaurante"},{label:"Env\xedos"},{label:"Nuevo env\xedo"}]}},{path:"cocina",component:pe,canActivate:[E.P],data:{breadcrumb:[{label:"Restaurante"},{label:"Cocina"}]}},{path:"reparto",component:ue,canActivate:[E.P],data:{breadcrumb:[{label:"Restaurante"},{label:"Reparto"}]}},{path:"comanda",component:wi,canActivate:[E.P],data:{breadcrumb:[{label:"Restaurante"},{label:"Comanda"}]},children:[{path:"",pathMatch:"full",redirectTo:"favoritos"},{path:"buscar-productos",component:Ei,canActivate:[E.P],data:{breadcrumb:[{label:"Restaurante"},{label:"Comanda"},{label:"Buscar productos"}]}},{path:"favoritos",component:Ni,canActivate:[E.P],data:{breadcrumb:[{label:"Restaurante"},{label:"Comanda"},{label:"Productos favoritos"}]}},{path:"categorias",component:Ui,canActivate:[E.P],data:{breadcrumb:[{label:"Restaurante"},{label:"Comanda"},{label:"Categor\xedas"}]}}]},{path:"pedidos",component:qn,canActivate:[E.P],data:{breadcrumb:[{label:"Restaurante"},{label:"Pedidos"}]}},{path:"cobrador",component:On,canActivate:[E.P],data:{breadcrumb:[{label:"Restaurante"},{label:"Cobrador"}]},children:[{path:"",pathMatch:"full",redirectTo:"cuentas"},{path:"cuentas",component:V,canActivate:[E.P],data:{breadcrumb:[{label:"Restaurante"},{label:"Cobrador"},{label:"Cuentas"}]}},{path:"cuentas/cobrar/:idCuenta",component:Ze,canActivate:[E.P],data:{breadcrumb:[{label:"Restaurante"},{label:"Cobrador"},{label:"Cuentas"},{label:"Cobrar"}],isEdit:!1}}]}]},{path:"mesas",component:ge,canActivate:[E.P],data:{breadcrumb:[{label:"Restaurante"},{label:"Mesas"}]}},{path:"mesas/editar/:id",component:Xe,canActivate:[E.P],data:{isEdit:!0,title:"Editar mesa",breadcrumb:[{label:"Restaurante"},{label:"Editar mesa"}]}},{path:"mesas/nuevo",component:Xe,canActivate:[E.P],data:{isEdit:!1,title:"Nueva mesa",breadcrumb:[{label:"Restaurante"},{label:"Nueva mesa"}]}},{path:"salones",component:bt,canActivate:[E.P],data:{breadcrumb:[{label:"Restaurante"},{label:"Salones"}]}},{path:"salones/editar/:id",component:Ge,canActivate:[E.P],data:{isEdit:!0,title:"Editar sal\xf3n",breadcrumb:[{label:"Restaurante"},{label:"Editar sal\xf3n"}]}},{path:"salones/nuevo",component:Ge,canActivate:[E.P],data:{isEdit:!1,title:"Nuevo sal\xf3n",breadcrumb:[{label:"Restaurante"},{label:"Nuevo sal\xf3n"}]}},{path:"zonas-produccion",component:xa,canActivate:[E.P],data:{breadcrumb:[{label:"Restaurante"},{label:"Zonas de producci\xf3n"}]}},{path:"zonas-produccion/nuevo",component:_t,canActivate:[E.P],data:{isEdit:!1,title:"Nuevo zona de producci\xf3n",breadcrumb:[{label:"Restaurante"},{label:"Nuevo zona de producci\xf3n"}]}},{path:"zonas-produccion/editar/:id",component:_t,canActivate:[E.P],data:{isEdit:!0,title:"Editar zona de producci\xf3n",breadcrumb:[{label:"Restaurante"},{label:"Editar zona de producci\xf3n"}]}}];let Ua=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[[D.Bz.forChild(Ja)],D.Bz]}),o})();var $a=b(20958);let za=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[[v.ez,h.m8,ke.U],h.m8]}),o})();var Ga=b(19406),Xa=b(27429),Wa=b(55402),Ka=b(89400),er=b(36283),tr=b(38716),or=b(40019);let nr=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({providers:[L.xA],imports:[[Ua,$a.m,za,Ga.P,Xa.N,Wa.R,dt.Gg,Ka.z,er.VentasModule,tr.ImpresorasModule,or.f]]}),o})()},46461:(je,me)=>{var D;!function(){"use strict";var E=function(){this.init()};E.prototype={init:function(){var a=this||l;return a._counter=1e3,a._html5AudioPool=[],a.html5PoolSize=10,a._codecs={},a._howls=[],a._muted=!1,a._volume=1,a._canPlayEvent="canplaythrough",a._navigator="undefined"!=typeof window&&window.navigator?window.navigator:null,a.masterGain=null,a.noAudio=!1,a.usingWebAudio=!0,a.autoSuspend=!0,a.ctx=null,a.autoUnlock=!0,a._setup(),a},volume:function(a){var r=this||l;if(a=parseFloat(a),r.ctx||v(),void 0!==a&&a>=0&&a<=1){if(r._volume=a,r._muted)return r;r.usingWebAudio&&r.masterGain.gain.setValueAtTime(a,l.ctx.currentTime);for(var c=0;c<r._howls.length;c++)if(!r._howls[c]._webAudio)for(var p=r._howls[c]._getSoundIds(),g=0;g<p.length;g++){var _=r._howls[c]._soundById(p[g]);_&&_._node&&(_._node.volume=_._volume*a)}return r}return r._volume},mute:function(a){var r=this||l;r.ctx||v(),r._muted=a,r.usingWebAudio&&r.masterGain.gain.setValueAtTime(a?0:r._volume,l.ctx.currentTime);for(var c=0;c<r._howls.length;c++)if(!r._howls[c]._webAudio)for(var p=r._howls[c]._getSoundIds(),g=0;g<p.length;g++){var _=r._howls[c]._soundById(p[g]);_&&_._node&&(_._node.muted=!!a||_._muted)}return r},stop:function(){for(var a=this||l,r=0;r<a._howls.length;r++)a._howls[r].stop();return a},unload:function(){for(var a=this||l,r=a._howls.length-1;r>=0;r--)a._howls[r].unload();return a.usingWebAudio&&a.ctx&&void 0!==a.ctx.close&&(a.ctx.close(),a.ctx=null,v()),a},codecs:function(a){return(this||l)._codecs[a.replace(/^x-/,"")]},_setup:function(){var a=this||l;if(a.state=a.ctx&&a.ctx.state||"suspended",a._autoSuspend(),!a.usingWebAudio)if("undefined"!=typeof Audio)try{void 0===(new Audio).oncanplaythrough&&(a._canPlayEvent="canplay")}catch(c){a.noAudio=!0}else a.noAudio=!0;try{(new Audio).muted&&(a.noAudio=!0)}catch(c){}return a.noAudio||a._setupCodecs(),a},_setupCodecs:function(){var a=this||l,r=null;try{r="undefined"!=typeof Audio?new Audio:null}catch(M){return a}if(!r||"function"!=typeof r.canPlayType)return a;var c=r.canPlayType("audio/mpeg;").replace(/^no$/,""),p=a._navigator?a._navigator.userAgent:"",g=p.match(/OPR\/([0-6].)/g),_=g&&parseInt(g[0].split("/")[1],10)<33,m=-1!==p.indexOf("Safari")&&-1===p.indexOf("Chrome"),x=p.match(/Version\/(.*?) /),I=m&&x&&parseInt(x[1],10)<15;return a._codecs={mp3:!(_||!c&&!r.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!c,opus:!!r.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!r.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!r.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(r.canPlayType('audio/wav; codecs="1"')||r.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!r.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!r.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(r.canPlayType("audio/x-m4a;")||r.canPlayType("audio/m4a;")||r.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(r.canPlayType("audio/x-m4b;")||r.canPlayType("audio/m4b;")||r.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(r.canPlayType("audio/x-mp4;")||r.canPlayType("audio/mp4;")||r.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!(I||!r.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!(I||!r.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!r.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(r.canPlayType("audio/x-flac;")||r.canPlayType("audio/flac;")).replace(/^no$/,"")},a},_unlockAudio:function(){var a=this||l;if(!a._audioUnlocked&&a.ctx){a._audioUnlocked=!1,a.autoUnlock=!1,!a._mobileUnloaded&&44100!==a.ctx.sampleRate&&(a._mobileUnloaded=!0,a.unload()),a._scratchBuffer=a.ctx.createBuffer(1,1,22050);var r=function(c){for(;a._html5AudioPool.length<a.html5PoolSize;)try{var p=new Audio;p._unlocked=!0,a._releaseHtml5Audio(p)}catch(M){a.noAudio=!0;break}for(var g=0;g<a._howls.length;g++)if(!a._howls[g]._webAudio)for(var _=a._howls[g]._getSoundIds(),m=0;m<_.length;m++){var x=a._howls[g]._soundById(_[m]);x&&x._node&&!x._node._unlocked&&(x._node._unlocked=!0,x._node.load())}a._autoResume();var I=a.ctx.createBufferSource();I.buffer=a._scratchBuffer,I.connect(a.ctx.destination),void 0===I.start?I.noteOn(0):I.start(0),"function"==typeof a.ctx.resume&&a.ctx.resume(),I.onended=function(){I.disconnect(0),a._audioUnlocked=!0,document.removeEventListener("touchstart",r,!0),document.removeEventListener("touchend",r,!0),document.removeEventListener("click",r,!0),document.removeEventListener("keydown",r,!0);for(var M=0;M<a._howls.length;M++)a._howls[M]._emit("unlock")}};return document.addEventListener("touchstart",r,!0),document.addEventListener("touchend",r,!0),document.addEventListener("click",r,!0),document.addEventListener("keydown",r,!0),a}},_obtainHtml5Audio:function(){var a=this||l;if(a._html5AudioPool.length)return a._html5AudioPool.pop();var r=(new Audio).play();return r&&"undefined"!=typeof Promise&&(r instanceof Promise||"function"==typeof r.then)&&r.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(a){var r=this||l;return a._unlocked&&r._html5AudioPool.push(a),r},_autoSuspend:function(){var a=this;if(a.autoSuspend&&a.ctx&&void 0!==a.ctx.suspend&&l.usingWebAudio){for(var r=0;r<a._howls.length;r++)if(a._howls[r]._webAudio)for(var c=0;c<a._howls[r]._sounds.length;c++)if(!a._howls[r]._sounds[c]._paused)return a;return a._suspendTimer&&clearTimeout(a._suspendTimer),a._suspendTimer=setTimeout(function(){if(a.autoSuspend){a._suspendTimer=null,a.state="suspending";var p=function(){a.state="suspended",a._resumeAfterSuspend&&(delete a._resumeAfterSuspend,a._autoResume())};a.ctx.suspend().then(p,p)}},3e4),a}},_autoResume:function(){var a=this;if(a.ctx&&void 0!==a.ctx.resume&&l.usingWebAudio)return"running"===a.state&&"interrupted"!==a.ctx.state&&a._suspendTimer?(clearTimeout(a._suspendTimer),a._suspendTimer=null):"suspended"===a.state||"running"===a.state&&"interrupted"===a.ctx.state?(a.ctx.resume().then(function(){a.state="running";for(var r=0;r<a._howls.length;r++)a._howls[r]._emit("resume")}),a._suspendTimer&&(clearTimeout(a._suspendTimer),a._suspendTimer=null)):"suspending"===a.state&&(a._resumeAfterSuspend=!0),a}};var l=new E,e=function(a){a.src&&0!==a.src.length?this.init(a):console.error("An array of source files must be passed with any new Howl.")};e.prototype={init:function(a){var r=this;return l.ctx||v(),r._autoplay=a.autoplay||!1,r._format="string"!=typeof a.format?a.format:[a.format],r._html5=a.html5||!1,r._muted=a.mute||!1,r._loop=a.loop||!1,r._pool=a.pool||5,r._preload="boolean"!=typeof a.preload&&"metadata"!==a.preload||a.preload,r._rate=a.rate||1,r._sprite=a.sprite||{},r._src="string"!=typeof a.src?a.src:[a.src],r._volume=void 0!==a.volume?a.volume:1,r._xhr={method:a.xhr&&a.xhr.method?a.xhr.method:"GET",headers:a.xhr&&a.xhr.headers?a.xhr.headers:null,withCredentials:!(!a.xhr||!a.xhr.withCredentials)&&a.xhr.withCredentials},r._duration=0,r._state="unloaded",r._sounds=[],r._endTimers={},r._queue=[],r._playLock=!1,r._onend=a.onend?[{fn:a.onend}]:[],r._onfade=a.onfade?[{fn:a.onfade}]:[],r._onload=a.onload?[{fn:a.onload}]:[],r._onloaderror=a.onloaderror?[{fn:a.onloaderror}]:[],r._onplayerror=a.onplayerror?[{fn:a.onplayerror}]:[],r._onpause=a.onpause?[{fn:a.onpause}]:[],r._onplay=a.onplay?[{fn:a.onplay}]:[],r._onstop=a.onstop?[{fn:a.onstop}]:[],r._onmute=a.onmute?[{fn:a.onmute}]:[],r._onvolume=a.onvolume?[{fn:a.onvolume}]:[],r._onrate=a.onrate?[{fn:a.onrate}]:[],r._onseek=a.onseek?[{fn:a.onseek}]:[],r._onunlock=a.onunlock?[{fn:a.onunlock}]:[],r._onresume=[],r._webAudio=l.usingWebAudio&&!r._html5,void 0!==l.ctx&&l.ctx&&l.autoUnlock&&l._unlockAudio(),l._howls.push(r),r._autoplay&&r._queue.push({event:"play",action:function(){r.play()}}),r._preload&&"none"!==r._preload&&r.load(),r},load:function(){var a=this,r=null;if(l.noAudio)a._emit("loaderror",null,"No audio support.");else{"string"==typeof a._src&&(a._src=[a._src]);for(var c=0;c<a._src.length;c++){var p,g;if(a._format&&a._format[c])p=a._format[c];else{if("string"!=typeof(g=a._src[c])){a._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}(p=/^data:audio\/([^;,]+);/i.exec(g))||(p=/\.([^.]+)$/.exec(g.split("?",1)[0])),p&&(p=p[1].toLowerCase())}if(p||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),p&&l.codecs(p)){r=a._src[c];break}}if(r)return a._src=r,a._state="loading","https:"===window.location.protocol&&"http:"===r.slice(0,5)&&(a._html5=!0,a._webAudio=!1),new u(a),a._webAudio&&T(a),a;a._emit("loaderror",null,"No codec support for selected audio sources.")}},play:function(a,r){var c=this,p=null;if("number"==typeof a)p=a,a=null;else{if("string"==typeof a&&"loaded"===c._state&&!c._sprite[a])return null;if(void 0===a&&(a="__default",!c._playLock)){for(var g=0,_=0;_<c._sounds.length;_++)c._sounds[_]._paused&&!c._sounds[_]._ended&&(g++,p=c._sounds[_]._id);1===g?a=null:p=null}}var m=p?c._soundById(p):c._inactiveSound();if(!m)return null;if(p&&!a&&(a=m._sprite||"__default"),"loaded"!==c._state){m._sprite=a,m._ended=!1;var x=m._id;return c._queue.push({event:"play",action:function(){c.play(x)}}),x}if(p&&!m._paused)return r||c._loadQueue("play"),m._id;c._webAudio&&l._autoResume();var I=Math.max(0,m._seek>0?m._seek:c._sprite[a][0]/1e3),M=Math.max(0,(c._sprite[a][0]+c._sprite[a][1])/1e3-I),U=1e3*M/Math.abs(m._rate),K=c._sprite[a][0]/1e3,ge=(c._sprite[a][0]+c._sprite[a][1])/1e3;m._sprite=a,m._ended=!1;var ye=function(){m._paused=!1,m._seek=I,m._start=K,m._stop=ge,m._loop=!(!m._loop&&!c._sprite[a][2])};if(!(I>=ge)){var S=m._node;if(c._webAudio){var De=function(){c._playLock=!1,ye(),c._refreshBuffer(m),S.gain.setValueAtTime(m._muted||c._muted?0:m._volume,l.ctx.currentTime),m._playStart=l.ctx.currentTime,void 0===S.bufferSource.start?S.bufferSource.noteGrainOn(0,I,m._loop?86400:M):S.bufferSource.start(0,I,m._loop?86400:M),U!==1/0&&(c._endTimers[m._id]=setTimeout(c._ended.bind(c,m),U)),r||setTimeout(function(){c._emit("play",m._id),c._loadQueue()},0)};"running"===l.state&&"interrupted"!==l.ctx.state?De():(c._playLock=!0,c.once("resume",De),c._clearTimer(m._id))}else{var we=function(){S.currentTime=I,S.muted=m._muted||c._muted||l._muted||S.muted,S.volume=m._volume*l.volume(),S.playbackRate=m._rate;try{var ee=S.play();if(ee&&"undefined"!=typeof Promise&&(ee instanceof Promise||"function"==typeof ee.then)?(c._playLock=!0,ye(),ee.then(function(){c._playLock=!1,S._unlocked=!0,r?c._loadQueue():c._emit("play",m._id)}).catch(function(){c._playLock=!1,c._emit("playerror",m._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),m._ended=!0,m._paused=!0})):r||(c._playLock=!1,ye(),c._emit("play",m._id)),S.playbackRate=m._rate,S.paused)return void c._emit("playerror",m._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");"__default"!==a||m._loop?c._endTimers[m._id]=setTimeout(c._ended.bind(c,m),U):(c._endTimers[m._id]=function(){c._ended(m),S.removeEventListener("ended",c._endTimers[m._id],!1)},S.addEventListener("ended",c._endTimers[m._id],!1))}catch(Le){c._emit("playerror",m._id,Le)}};"data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"===S.src&&(S.src=c._src,S.load());var Me=window&&window.ejecta||!S.readyState&&l._navigator.isCocoonJS;if(S.readyState>=3||Me)we();else{c._playLock=!0,c._state="loading";var qe=function(){c._state="loaded",we(),S.removeEventListener(l._canPlayEvent,qe,!1)};S.addEventListener(l._canPlayEvent,qe,!1),c._clearTimer(m._id)}}return m._id}c._ended(m)},pause:function(a){var r=this;if("loaded"!==r._state||r._playLock)return r._queue.push({event:"pause",action:function(){r.pause(a)}}),r;for(var c=r._getSoundIds(a),p=0;p<c.length;p++){r._clearTimer(c[p]);var g=r._soundById(c[p]);if(g&&!g._paused&&(g._seek=r.seek(c[p]),g._rateSeek=0,g._paused=!0,r._stopFade(c[p]),g._node))if(r._webAudio){if(!g._node.bufferSource)continue;void 0===g._node.bufferSource.stop?g._node.bufferSource.noteOff(0):g._node.bufferSource.stop(0),r._cleanBuffer(g._node)}else(!isNaN(g._node.duration)||g._node.duration===1/0)&&g._node.pause();arguments[1]||r._emit("pause",g?g._id:null)}return r},stop:function(a,r){var c=this;if("loaded"!==c._state||c._playLock)return c._queue.push({event:"stop",action:function(){c.stop(a)}}),c;for(var p=c._getSoundIds(a),g=0;g<p.length;g++){c._clearTimer(p[g]);var _=c._soundById(p[g]);_&&(_._seek=_._start||0,_._rateSeek=0,_._paused=!0,_._ended=!0,c._stopFade(p[g]),_._node&&(c._webAudio?_._node.bufferSource&&(void 0===_._node.bufferSource.stop?_._node.bufferSource.noteOff(0):_._node.bufferSource.stop(0),c._cleanBuffer(_._node)):(!isNaN(_._node.duration)||_._node.duration===1/0)&&(_._node.currentTime=_._start||0,_._node.pause(),_._node.duration===1/0&&c._clearSound(_._node))),r||c._emit("stop",_._id))}return c},mute:function(a,r){var c=this;if("loaded"!==c._state||c._playLock)return c._queue.push({event:"mute",action:function(){c.mute(a,r)}}),c;if(void 0===r){if("boolean"!=typeof a)return c._muted;c._muted=a}for(var p=c._getSoundIds(r),g=0;g<p.length;g++){var _=c._soundById(p[g]);_&&(_._muted=a,_._interval&&c._stopFade(_._id),c._webAudio&&_._node?_._node.gain.setValueAtTime(a?0:_._volume,l.ctx.currentTime):_._node&&(_._node.muted=!!l._muted||a),c._emit("mute",_._id))}return c},volume:function(){var c,p,m,a=this,r=arguments;if(0===r.length)return a._volume;if(1===r.length||2===r.length&&void 0===r[1]){var g=a._getSoundIds(),_=g.indexOf(r[0]);_>=0?p=parseInt(r[0],10):c=parseFloat(r[0])}else r.length>=2&&(c=parseFloat(r[0]),p=parseInt(r[1],10));if(!(void 0!==c&&c>=0&&c<=1))return(m=p?a._soundById(p):a._sounds[0])?m._volume:0;if("loaded"!==a._state||a._playLock)return a._queue.push({event:"volume",action:function(){a.volume.apply(a,r)}}),a;void 0===p&&(a._volume=c),p=a._getSoundIds(p);for(var x=0;x<p.length;x++)(m=a._soundById(p[x]))&&(m._volume=c,r[2]||a._stopFade(p[x]),a._webAudio&&m._node&&!m._muted?m._node.gain.setValueAtTime(c,l.ctx.currentTime):m._node&&!m._muted&&(m._node.volume=c*l.volume()),a._emit("volume",m._id));return a},fade:function(a,r,c,p){var g=this;if("loaded"!==g._state||g._playLock)return g._queue.push({event:"fade",action:function(){g.fade(a,r,c,p)}}),g;a=Math.min(Math.max(0,parseFloat(a)),1),r=Math.min(Math.max(0,parseFloat(r)),1),c=parseFloat(c),g.volume(a,p);for(var _=g._getSoundIds(p),m=0;m<_.length;m++){var x=g._soundById(_[m]);if(x){if(p||g._stopFade(_[m]),g._webAudio&&!x._muted){var I=l.ctx.currentTime,M=I+c/1e3;x._volume=a,x._node.gain.setValueAtTime(a,I),x._node.gain.linearRampToValueAtTime(r,M)}g._startFadeInterval(x,a,r,c,_[m],void 0===p)}}return g},_startFadeInterval:function(a,r,c,p,g,_){var m=this,x=r,I=c-r,M=Math.abs(I/.01),U=Math.max(4,M>0?p/M:p),K=Date.now();a._fadeTo=c,a._interval=setInterval(function(){var ge=(Date.now()-K)/p;K=Date.now(),x+=I*ge,x=Math.round(100*x)/100,x=I<0?Math.max(c,x):Math.min(c,x),m._webAudio?a._volume=x:m.volume(x,a._id,!0),_&&(m._volume=x),(c<r&&x<=c||c>r&&x>=c)&&(clearInterval(a._interval),a._interval=null,a._fadeTo=null,m.volume(c,a._id),m._emit("fade",a._id))},U)},_stopFade:function(a){var r=this,c=r._soundById(a);return c&&c._interval&&(r._webAudio&&c._node.gain.cancelScheduledValues(l.ctx.currentTime),clearInterval(c._interval),c._interval=null,r.volume(c._fadeTo,a),c._fadeTo=null,r._emit("fade",a)),r},loop:function(){var c,p,g,a=this,r=arguments;if(0===r.length)return a._loop;if(1===r.length){if("boolean"!=typeof r[0])return!!(g=a._soundById(parseInt(r[0],10)))&&g._loop;a._loop=c=r[0]}else 2===r.length&&(c=r[0],p=parseInt(r[1],10));for(var _=a._getSoundIds(p),m=0;m<_.length;m++)(g=a._soundById(_[m]))&&(g._loop=c,a._webAudio&&g._node&&g._node.bufferSource&&(g._node.bufferSource.loop=c,c&&(g._node.bufferSource.loopStart=g._start||0,g._node.bufferSource.loopEnd=g._stop,a.playing(_[m])&&(a.pause(_[m],!0),a.play(_[m],!0)))));return a},rate:function(){var c,p,m,a=this,r=arguments;if(0===r.length)p=a._sounds[0]._id;else if(1===r.length){var g=a._getSoundIds(),_=g.indexOf(r[0]);_>=0?p=parseInt(r[0],10):c=parseFloat(r[0])}else 2===r.length&&(c=parseFloat(r[0]),p=parseInt(r[1],10));if("number"!=typeof c)return(m=a._soundById(p))?m._rate:a._rate;if("loaded"!==a._state||a._playLock)return a._queue.push({event:"rate",action:function(){a.rate.apply(a,r)}}),a;void 0===p&&(a._rate=c),p=a._getSoundIds(p);for(var x=0;x<p.length;x++)if(m=a._soundById(p[x])){a.playing(p[x])&&(m._rateSeek=a.seek(p[x]),m._playStart=a._webAudio?l.ctx.currentTime:m._playStart),m._rate=c,a._webAudio&&m._node&&m._node.bufferSource?m._node.bufferSource.playbackRate.setValueAtTime(c,l.ctx.currentTime):m._node&&(m._node.playbackRate=c);var I=a.seek(p[x]),M=(a._sprite[m._sprite][0]+a._sprite[m._sprite][1])/1e3-I,U=1e3*M/Math.abs(m._rate);(a._endTimers[p[x]]||!m._paused)&&(a._clearTimer(p[x]),a._endTimers[p[x]]=setTimeout(a._ended.bind(a,m),U)),a._emit("rate",m._id)}return a},seek:function(){var c,p,a=this,r=arguments;if(0===r.length)a._sounds.length&&(p=a._sounds[0]._id);else if(1===r.length){var g=a._getSoundIds(),_=g.indexOf(r[0]);_>=0?p=parseInt(r[0],10):a._sounds.length&&(p=a._sounds[0]._id,c=parseFloat(r[0]))}else 2===r.length&&(c=parseFloat(r[0]),p=parseInt(r[1],10));if(void 0===p)return 0;if("number"==typeof c&&("loaded"!==a._state||a._playLock))return a._queue.push({event:"seek",action:function(){a.seek.apply(a,r)}}),a;var m=a._soundById(p);if(m){if(!("number"==typeof c&&c>=0)){if(a._webAudio){var U=a.playing(p)?l.ctx.currentTime-m._playStart:0,K=m._rateSeek?m._rateSeek-m._seek:0;return m._seek+(K+U*Math.abs(m._rate))}return m._node.currentTime}var x=a.playing(p);x&&a.pause(p,!0),m._seek=c,m._ended=!1,a._clearTimer(p),!a._webAudio&&m._node&&!isNaN(m._node.duration)&&(m._node.currentTime=c);var I=function(){x&&a.play(p,!0),a._emit("seek",p)};if(x&&!a._webAudio){var M=function(){a._playLock?setTimeout(M,0):I()};setTimeout(M,0)}else I()}return a},playing:function(a){var r=this;if("number"==typeof a){var c=r._soundById(a);return!!c&&!c._paused}for(var p=0;p<r._sounds.length;p++)if(!r._sounds[p]._paused)return!0;return!1},duration:function(a){var r=this,c=r._duration,p=r._soundById(a);return p&&(c=r._sprite[p._sprite][1]/1e3),c},state:function(){return this._state},unload:function(){for(var a=this,r=a._sounds,c=0;c<r.length;c++)r[c]._paused||a.stop(r[c]._id),a._webAudio||(a._clearSound(r[c]._node),r[c]._node.removeEventListener("error",r[c]._errorFn,!1),r[c]._node.removeEventListener(l._canPlayEvent,r[c]._loadFn,!1),r[c]._node.removeEventListener("ended",r[c]._endFn,!1),l._releaseHtml5Audio(r[c]._node)),delete r[c]._node,a._clearTimer(r[c]._id);var p=l._howls.indexOf(a);p>=0&&l._howls.splice(p,1);var g=!0;for(c=0;c<l._howls.length;c++)if(l._howls[c]._src===a._src||a._src.indexOf(l._howls[c]._src)>=0){g=!1;break}return Z&&g&&delete Z[a._src],l.noAudio=!1,a._state="unloaded",a._sounds=[],a=null,null},on:function(a,r,c,p){return"function"==typeof r&&this["_on"+a].push(p?{id:c,fn:r,once:p}:{id:c,fn:r}),this},off:function(a,r,c){var p=this,g=p["_on"+a],_=0;if("number"==typeof r&&(c=r,r=null),r||c)for(_=0;_<g.length;_++){var m=c===g[_].id;if(r===g[_].fn&&m||!r&&m){g.splice(_,1);break}}else if(a)p["_on"+a]=[];else{var x=Object.keys(p);for(_=0;_<x.length;_++)0===x[_].indexOf("_on")&&Array.isArray(p[x[_]])&&(p[x[_]]=[])}return p},once:function(a,r,c){return this.on(a,r,c,1),this},_emit:function(a,r,c){for(var p=this,g=p["_on"+a],_=g.length-1;_>=0;_--)(!g[_].id||g[_].id===r||"load"===a)&&(setTimeout(function(m){m.call(this,r,c)}.bind(p,g[_].fn),0),g[_].once&&p.off(a,g[_].fn,g[_].id));return p._loadQueue(a),p},_loadQueue:function(a){var r=this;if(r._queue.length>0){var c=r._queue[0];c.event===a&&(r._queue.shift(),r._loadQueue()),a||c.action()}return r},_ended:function(a){var r=this,c=a._sprite;if(!r._webAudio&&a._node&&!a._node.paused&&!a._node.ended&&a._node.currentTime<a._stop)return setTimeout(r._ended.bind(r,a),100),r;var p=!(!a._loop&&!r._sprite[c][2]);if(r._emit("end",a._id),!r._webAudio&&p&&r.stop(a._id,!0).play(a._id),r._webAudio&&p){r._emit("play",a._id),a._seek=a._start||0,a._rateSeek=0,a._playStart=l.ctx.currentTime;var g=1e3*(a._stop-a._start)/Math.abs(a._rate);r._endTimers[a._id]=setTimeout(r._ended.bind(r,a),g)}return r._webAudio&&!p&&(a._paused=!0,a._ended=!0,a._seek=a._start||0,a._rateSeek=0,r._clearTimer(a._id),r._cleanBuffer(a._node),l._autoSuspend()),!r._webAudio&&!p&&r.stop(a._id,!0),r},_clearTimer:function(a){var r=this;if(r._endTimers[a]){if("function"!=typeof r._endTimers[a])clearTimeout(r._endTimers[a]);else{var c=r._soundById(a);c&&c._node&&c._node.removeEventListener("ended",r._endTimers[a],!1)}delete r._endTimers[a]}return r},_soundById:function(a){for(var r=this,c=0;c<r._sounds.length;c++)if(a===r._sounds[c]._id)return r._sounds[c];return null},_inactiveSound:function(){var a=this;a._drain();for(var r=0;r<a._sounds.length;r++)if(a._sounds[r]._ended)return a._sounds[r].reset();return new u(a)},_drain:function(){var a=this,r=a._pool,c=0,p=0;if(!(a._sounds.length<r)){for(p=0;p<a._sounds.length;p++)a._sounds[p]._ended&&c++;for(p=a._sounds.length-1;p>=0;p--){if(c<=r)return;a._sounds[p]._ended&&(a._webAudio&&a._sounds[p]._node&&a._sounds[p]._node.disconnect(0),a._sounds.splice(p,1),c--)}}},_getSoundIds:function(a){if(void 0===a){for(var c=[],p=0;p<this._sounds.length;p++)c.push(this._sounds[p]._id);return c}return[a]},_refreshBuffer:function(a){return a._node.bufferSource=l.ctx.createBufferSource(),a._node.bufferSource.buffer=Z[this._src],a._node.bufferSource.connect(a._panner?a._panner:a._node),a._node.bufferSource.loop=a._loop,a._loop&&(a._node.bufferSource.loopStart=a._start||0,a._node.bufferSource.loopEnd=a._stop||0),a._node.bufferSource.playbackRate.setValueAtTime(a._rate,l.ctx.currentTime),this},_cleanBuffer:function(a){var c=l._navigator&&l._navigator.vendor.indexOf("Apple")>=0;if(l._scratchBuffer&&a.bufferSource&&(a.bufferSource.onended=null,a.bufferSource.disconnect(0),c))try{a.bufferSource.buffer=l._scratchBuffer}catch(p){}return a.bufferSource=null,this},_clearSound:function(a){/MSIE |Trident\//.test(l._navigator&&l._navigator.userAgent)||(a.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var u=function(a){this._parent=a,this.init()};u.prototype={init:function(){var a=this,r=a._parent;return a._muted=r._muted,a._loop=r._loop,a._volume=r._volume,a._rate=r._rate,a._seek=0,a._paused=!0,a._ended=!0,a._sprite="__default",a._id=++l._counter,r._sounds.push(a),a.create(),a},create:function(){var a=this,r=a._parent,c=l._muted||a._muted||a._parent._muted?0:a._volume;return r._webAudio?(a._node=void 0===l.ctx.createGain?l.ctx.createGainNode():l.ctx.createGain(),a._node.gain.setValueAtTime(c,l.ctx.currentTime),a._node.paused=!0,a._node.connect(l.masterGain)):l.noAudio||(a._node=l._obtainHtml5Audio(),a._errorFn=a._errorListener.bind(a),a._node.addEventListener("error",a._errorFn,!1),a._loadFn=a._loadListener.bind(a),a._node.addEventListener(l._canPlayEvent,a._loadFn,!1),a._endFn=a._endListener.bind(a),a._node.addEventListener("ended",a._endFn,!1),a._node.src=r._src,a._node.preload=!0===r._preload?"auto":r._preload,a._node.volume=c*l.volume(),a._node.load()),a},reset:function(){var a=this,r=a._parent;return a._muted=r._muted,a._loop=r._loop,a._volume=r._volume,a._rate=r._rate,a._seek=0,a._rateSeek=0,a._paused=!0,a._ended=!0,a._sprite="__default",a._id=++l._counter,a},_errorListener:function(){var a=this;a._parent._emit("loaderror",a._id,a._node.error?a._node.error.code:0),a._node.removeEventListener("error",a._errorFn,!1)},_loadListener:function(){var a=this,r=a._parent;r._duration=Math.ceil(10*a._node.duration)/10,0===Object.keys(r._sprite).length&&(r._sprite={__default:[0,1e3*r._duration]}),"loaded"!==r._state&&(r._state="loaded",r._emit("load"),r._loadQueue()),a._node.removeEventListener(l._canPlayEvent,a._loadFn,!1)},_endListener:function(){var a=this,r=a._parent;r._duration===1/0&&(r._duration=Math.ceil(10*a._node.duration)/10,r._sprite.__default[1]===1/0&&(r._sprite.__default[1]=1e3*r._duration),r._ended(a)),a._node.removeEventListener("ended",a._endFn,!1)}};var Z={},T=function(a){var r=a._src;if(Z[r])return a._duration=Z[r].duration,void h(a);if(/^data:[^;]+;base64,/.test(r)){for(var c=atob(r.split(",")[1]),p=new Uint8Array(c.length),g=0;g<c.length;++g)p[g]=c.charCodeAt(g);A(p.buffer,a)}else{var _=new XMLHttpRequest;_.open(a._xhr.method,r,!0),_.withCredentials=a._xhr.withCredentials,_.responseType="arraybuffer",a._xhr.headers&&Object.keys(a._xhr.headers).forEach(function(m){_.setRequestHeader(m,a._xhr.headers[m])}),_.onload=function(){var m=(_.status+"")[0];"0"===m||"2"===m||"3"===m?A(_.response,a):a._emit("loaderror",null,"Failed loading audio file with status: "+_.status+".")},_.onerror=function(){a._webAudio&&(a._html5=!0,a._webAudio=!1,a._sounds=[],delete Z[r],a.load())},O(_)}},O=function(a){try{a.send()}catch(r){a.onerror()}},A=function(a,r){var c=function(){r._emit("loaderror",null,"Decoding audio data failed.")},p=function(g){g&&r._sounds.length>0?(Z[r._src]=g,h(r,g)):c()};"undefined"!=typeof Promise&&1===l.ctx.decodeAudioData.length?l.ctx.decodeAudioData(a).then(p).catch(c):l.ctx.decodeAudioData(a,p,c)},h=function(a,r){r&&!a._duration&&(a._duration=r.duration),0===Object.keys(a._sprite).length&&(a._sprite={__default:[0,1e3*a._duration]}),"loaded"!==a._state&&(a._state="loaded",a._emit("load"),a._loadQueue())},v=function(){if(l.usingWebAudio){try{"undefined"!=typeof AudioContext?l.ctx=new AudioContext:"undefined"!=typeof webkitAudioContext?l.ctx=new webkitAudioContext:l.usingWebAudio=!1}catch(g){l.usingWebAudio=!1}l.ctx||(l.usingWebAudio=!1);var a=/iP(hone|od|ad)/.test(l._navigator&&l._navigator.platform),r=l._navigator&&l._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),c=r?parseInt(r[1],10):null;if(a&&c&&c<9){var p=/safari/.test(l._navigator&&l._navigator.userAgent.toLowerCase());l._navigator&&!p&&(l.usingWebAudio=!1)}l.usingWebAudio&&(l.masterGain=void 0===l.ctx.createGain?l.ctx.createGainNode():l.ctx.createGain(),l.masterGain.gain.setValueAtTime(l._muted?0:l._volume,l.ctx.currentTime),l.masterGain.connect(l.ctx.destination)),l._setup()}};void 0!==(D=function(){return{Howler:l,Howl:e}}.apply(me,[]))&&(je.exports=D),me.Howler=l,me.Howl=e,"undefined"!=typeof global?(global.HowlerGlobal=E,global.Howler=l,global.Howl=e,global.Sound=u):"undefined"!=typeof window&&(window.HowlerGlobal=E,window.Howler=l,window.Howl=e,window.Sound=u)}(),function(){"use strict";var l;HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(l){var e=this;if(!e.ctx||!e.ctx.listener)return e;for(var u=e._howls.length-1;u>=0;u--)e._howls[u].stereo(l);return e},HowlerGlobal.prototype.pos=function(l,e,u){var Z=this;return Z.ctx&&Z.ctx.listener?"number"!=typeof l?Z._pos:(Z._pos=[l,e="number"!=typeof e?Z._pos[1]:e,u="number"!=typeof u?Z._pos[2]:u],void 0!==Z.ctx.listener.positionX?(Z.ctx.listener.positionX.setTargetAtTime(Z._pos[0],Howler.ctx.currentTime,.1),Z.ctx.listener.positionY.setTargetAtTime(Z._pos[1],Howler.ctx.currentTime,.1),Z.ctx.listener.positionZ.setTargetAtTime(Z._pos[2],Howler.ctx.currentTime,.1)):Z.ctx.listener.setPosition(Z._pos[0],Z._pos[1],Z._pos[2]),Z):Z},HowlerGlobal.prototype.orientation=function(l,e,u,Z,T,O){var A=this;if(!A.ctx||!A.ctx.listener)return A;var h=A._orientation;return"number"!=typeof l?h:(A._orientation=[l,e="number"!=typeof e?h[1]:e,u="number"!=typeof u?h[2]:u,Z="number"!=typeof Z?h[3]:Z,T="number"!=typeof T?h[4]:T,O="number"!=typeof O?h[5]:O],void 0!==A.ctx.listener.forwardX?(A.ctx.listener.forwardX.setTargetAtTime(l,Howler.ctx.currentTime,.1),A.ctx.listener.forwardY.setTargetAtTime(e,Howler.ctx.currentTime,.1),A.ctx.listener.forwardZ.setTargetAtTime(u,Howler.ctx.currentTime,.1),A.ctx.listener.upX.setTargetAtTime(Z,Howler.ctx.currentTime,.1),A.ctx.listener.upY.setTargetAtTime(T,Howler.ctx.currentTime,.1),A.ctx.listener.upZ.setTargetAtTime(O,Howler.ctx.currentTime,.1)):A.ctx.listener.setOrientation(l,e,u,Z,T,O),A)},Howl.prototype.init=(l=Howl.prototype.init,function(e){var u=this;return u._orientation=e.orientation||[1,0,0],u._stereo=e.stereo||null,u._pos=e.pos||null,u._pannerAttr={coneInnerAngle:void 0!==e.coneInnerAngle?e.coneInnerAngle:360,coneOuterAngle:void 0!==e.coneOuterAngle?e.coneOuterAngle:360,coneOuterGain:void 0!==e.coneOuterGain?e.coneOuterGain:0,distanceModel:void 0!==e.distanceModel?e.distanceModel:"inverse",maxDistance:void 0!==e.maxDistance?e.maxDistance:1e4,panningModel:void 0!==e.panningModel?e.panningModel:"HRTF",refDistance:void 0!==e.refDistance?e.refDistance:1,rolloffFactor:void 0!==e.rolloffFactor?e.rolloffFactor:1},u._onstereo=e.onstereo?[{fn:e.onstereo}]:[],u._onpos=e.onpos?[{fn:e.onpos}]:[],u._onorientation=e.onorientation?[{fn:e.onorientation}]:[],l.call(this,e)}),Howl.prototype.stereo=function(l,e){var u=this;if(!u._webAudio)return u;if("loaded"!==u._state)return u._queue.push({event:"stereo",action:function(){u.stereo(l,e)}}),u;var Z=void 0===Howler.ctx.createStereoPanner?"spatial":"stereo";if(void 0===e){if("number"!=typeof l)return u._stereo;u._stereo=l,u._pos=[l,0,0]}for(var T=u._getSoundIds(e),O=0;O<T.length;O++){var A=u._soundById(T[O]);if(A){if("number"!=typeof l)return A._stereo;A._stereo=l,A._pos=[l,0,0],A._node&&(A._pannerAttr.panningModel="equalpower",(!A._panner||!A._panner.pan)&&E(A,Z),"spatial"===Z?void 0!==A._panner.positionX?(A._panner.positionX.setValueAtTime(l,Howler.ctx.currentTime),A._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),A._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):A._panner.setPosition(l,0,0):A._panner.pan.setValueAtTime(l,Howler.ctx.currentTime)),u._emit("stereo",A._id)}}return u},Howl.prototype.pos=function(l,e,u,Z){var T=this;if(!T._webAudio)return T;if("loaded"!==T._state)return T._queue.push({event:"pos",action:function(){T.pos(l,e,u,Z)}}),T;if(e="number"!=typeof e?0:e,u="number"!=typeof u?-.5:u,void 0===Z){if("number"!=typeof l)return T._pos;T._pos=[l,e,u]}for(var O=T._getSoundIds(Z),A=0;A<O.length;A++){var h=T._soundById(O[A]);if(h){if("number"!=typeof l)return h._pos;h._pos=[l,e,u],h._node&&((!h._panner||h._panner.pan)&&E(h,"spatial"),void 0!==h._panner.positionX?(h._panner.positionX.setValueAtTime(l,Howler.ctx.currentTime),h._panner.positionY.setValueAtTime(e,Howler.ctx.currentTime),h._panner.positionZ.setValueAtTime(u,Howler.ctx.currentTime)):h._panner.setPosition(l,e,u)),T._emit("pos",h._id)}}return T},Howl.prototype.orientation=function(l,e,u,Z){var T=this;if(!T._webAudio)return T;if("loaded"!==T._state)return T._queue.push({event:"orientation",action:function(){T.orientation(l,e,u,Z)}}),T;if(e="number"!=typeof e?T._orientation[1]:e,u="number"!=typeof u?T._orientation[2]:u,void 0===Z){if("number"!=typeof l)return T._orientation;T._orientation=[l,e,u]}for(var O=T._getSoundIds(Z),A=0;A<O.length;A++){var h=T._soundById(O[A]);if(h){if("number"!=typeof l)return h._orientation;h._orientation=[l,e,u],h._node&&(h._panner||(h._pos||(h._pos=T._pos||[0,0,-.5]),E(h,"spatial")),void 0!==h._panner.orientationX?(h._panner.orientationX.setValueAtTime(l,Howler.ctx.currentTime),h._panner.orientationY.setValueAtTime(e,Howler.ctx.currentTime),h._panner.orientationZ.setValueAtTime(u,Howler.ctx.currentTime)):h._panner.setOrientation(l,e,u)),T._emit("orientation",h._id)}}return T},Howl.prototype.pannerAttr=function(){var u,Z,T,l=this,e=arguments;if(!l._webAudio)return l;if(0===e.length)return l._pannerAttr;if(1===e.length){if("object"!=typeof e[0])return(T=l._soundById(parseInt(e[0],10)))?T._pannerAttr:l._pannerAttr;u=e[0],void 0===Z&&(u.pannerAttr||(u.pannerAttr={coneInnerAngle:u.coneInnerAngle,coneOuterAngle:u.coneOuterAngle,coneOuterGain:u.coneOuterGain,distanceModel:u.distanceModel,maxDistance:u.maxDistance,refDistance:u.refDistance,rolloffFactor:u.rolloffFactor,panningModel:u.panningModel}),l._pannerAttr={coneInnerAngle:void 0!==u.pannerAttr.coneInnerAngle?u.pannerAttr.coneInnerAngle:l._coneInnerAngle,coneOuterAngle:void 0!==u.pannerAttr.coneOuterAngle?u.pannerAttr.coneOuterAngle:l._coneOuterAngle,coneOuterGain:void 0!==u.pannerAttr.coneOuterGain?u.pannerAttr.coneOuterGain:l._coneOuterGain,distanceModel:void 0!==u.pannerAttr.distanceModel?u.pannerAttr.distanceModel:l._distanceModel,maxDistance:void 0!==u.pannerAttr.maxDistance?u.pannerAttr.maxDistance:l._maxDistance,refDistance:void 0!==u.pannerAttr.refDistance?u.pannerAttr.refDistance:l._refDistance,rolloffFactor:void 0!==u.pannerAttr.rolloffFactor?u.pannerAttr.rolloffFactor:l._rolloffFactor,panningModel:void 0!==u.pannerAttr.panningModel?u.pannerAttr.panningModel:l._panningModel})}else 2===e.length&&(u=e[0],Z=parseInt(e[1],10));for(var O=l._getSoundIds(Z),A=0;A<O.length;A++)if(T=l._soundById(O[A])){var h=T._pannerAttr;h={coneInnerAngle:void 0!==u.coneInnerAngle?u.coneInnerAngle:h.coneInnerAngle,coneOuterAngle:void 0!==u.coneOuterAngle?u.coneOuterAngle:h.coneOuterAngle,coneOuterGain:void 0!==u.coneOuterGain?u.coneOuterGain:h.coneOuterGain,distanceModel:void 0!==u.distanceModel?u.distanceModel:h.distanceModel,maxDistance:void 0!==u.maxDistance?u.maxDistance:h.maxDistance,refDistance:void 0!==u.refDistance?u.refDistance:h.refDistance,rolloffFactor:void 0!==u.rolloffFactor?u.rolloffFactor:h.rolloffFactor,panningModel:void 0!==u.panningModel?u.panningModel:h.panningModel};var v=T._panner;v?(v.coneInnerAngle=h.coneInnerAngle,v.coneOuterAngle=h.coneOuterAngle,v.coneOuterGain=h.coneOuterGain,v.distanceModel=h.distanceModel,v.maxDistance=h.maxDistance,v.refDistance=h.refDistance,v.rolloffFactor=h.rolloffFactor,v.panningModel=h.panningModel):(T._pos||(T._pos=l._pos||[0,0,-.5]),E(T,"spatial"))}return l},Sound.prototype.init=function(l){return function(){var e=this,u=e._parent;e._orientation=u._orientation,e._stereo=u._stereo,e._pos=u._pos,e._pannerAttr=u._pannerAttr,l.call(this),e._stereo?u.stereo(e._stereo):e._pos&&u.pos(e._pos[0],e._pos[1],e._pos[2],e._id)}}(Sound.prototype.init),Sound.prototype.reset=function(l){return function(){var e=this,u=e._parent;return e._orientation=u._orientation,e._stereo=u._stereo,e._pos=u._pos,e._pannerAttr=u._pannerAttr,e._stereo?u.stereo(e._stereo):e._pos?u.pos(e._pos[0],e._pos[1],e._pos[2],e._id):e._panner&&(e._panner.disconnect(0),e._panner=void 0,u._refreshBuffer(e)),l.call(this)}}(Sound.prototype.reset);var E=function(l,e){"spatial"===(e=e||"spatial")?(l._panner=Howler.ctx.createPanner(),l._panner.coneInnerAngle=l._pannerAttr.coneInnerAngle,l._panner.coneOuterAngle=l._pannerAttr.coneOuterAngle,l._panner.coneOuterGain=l._pannerAttr.coneOuterGain,l._panner.distanceModel=l._pannerAttr.distanceModel,l._panner.maxDistance=l._pannerAttr.maxDistance,l._panner.refDistance=l._pannerAttr.refDistance,l._panner.rolloffFactor=l._pannerAttr.rolloffFactor,l._panner.panningModel=l._pannerAttr.panningModel,void 0!==l._panner.positionX?(l._panner.positionX.setValueAtTime(l._pos[0],Howler.ctx.currentTime),l._panner.positionY.setValueAtTime(l._pos[1],Howler.ctx.currentTime),l._panner.positionZ.setValueAtTime(l._pos[2],Howler.ctx.currentTime)):l._panner.setPosition(l._pos[0],l._pos[1],l._pos[2]),void 0!==l._panner.orientationX?(l._panner.orientationX.setValueAtTime(l._orientation[0],Howler.ctx.currentTime),l._panner.orientationY.setValueAtTime(l._orientation[1],Howler.ctx.currentTime),l._panner.orientationZ.setValueAtTime(l._orientation[2],Howler.ctx.currentTime)):l._panner.setOrientation(l._orientation[0],l._orientation[1],l._orientation[2])):(l._panner=Howler.ctx.createStereoPanner(),l._panner.pan.setValueAtTime(l._stereo,Howler.ctx.currentTime)),l._panner.connect(l._node),l._paused||l._parent.pause(l._id,!0).play(l._id,!0)}}()}}]);