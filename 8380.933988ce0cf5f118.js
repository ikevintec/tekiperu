"use strict";(self.webpackChunkmirage=self.webpackChunkmirage||[]).push([[8380],{75875:(nt,J,l)=>{l.d(J,{d:()=>v});var T=l(70655),a=l(5e3),I=l(85932),h=l(81575),q=l(8929),x=l(7625),E=l(12216),u=l(59783),P=l(69808),t=l(4119),b=l(40845),O=l(12145),Z=l(93075),F=l(9757),N=l(15315),f=l(31424),M=l(18872),V=l(98952),m=l(70050);const $=["searchInputModalRef"],Q=["searchAutocompleteRef"];function B(p,c){if(1&p){const s=a.EpF();a.TgZ(0,"button",16),a.NdJ("click",function(){return a.CHM(s),a.oxw().emitAddItem()}),a.qZA()}if(2&p){const s=a.oxw();a.Q6J("disabled",s.disableAddItem)}}function Y(p,c){if(1&p&&(a.TgZ(0,"span"),a._uU(1),a.qZA()),2&p){const s=a.oxw().$implicit;a.xp6(1),a.hij("",s.codigo," - ")}}function L(p,c){if(1&p&&(a.TgZ(0,"span",19),a._UZ(1,"app-mostrar-stock",20),a.qZA()),2&p){const s=a.oxw().$implicit;a.xp6(1),a.Q6J("producto",s)}}function R(p,c){if(1&p&&(a.YNc(0,Y,2,1,"span",17),a._uU(1),a.YNc(2,L,2,1,"span",18)),2&p){const s=c.$implicit,d=a.oxw();a.Q6J("ngIf",s.codigo),a.xp6(1),a.hij("",s.nombre," "),a.xp6(1),a.Q6J("ngIf",d.configCompany.inventario)}}function k(p,c){1&p&&(a.TgZ(0,"th"),a._uU(1,"Stock"),a.qZA())}function S(p,c){if(1&p&&(a.TgZ(0,"tr"),a.TgZ(1,"th"),a._uU(2,"C\xf3digo de barra"),a.qZA(),a.TgZ(3,"th"),a._uU(4,"Nombre"),a.qZA(),a.TgZ(5,"th"),a._uU(6,"Precio de venta"),a.qZA(),a.YNc(7,k,2,0,"th",17),a.TgZ(8,"th"),a._uU(9,"Seleccionar"),a.qZA(),a.qZA()),2&p){const s=a.oxw();a.xp6(7),a.Q6J("ngIf",s.configCompany.inventario)}}function H(p,c){if(1&p&&(a.TgZ(0,"td"),a._UZ(1,"app-mostrar-stock",24),a.qZA()),2&p){const s=a.oxw().$implicit;a.xp6(1),a.Q6J("producto",s)}}function K(p,c){if(1&p){const s=a.EpF();a.TgZ(0,"tr"),a.TgZ(1,"td"),a._uU(2),a.qZA(),a.TgZ(3,"td"),a._uU(4),a.qZA(),a.TgZ(5,"td"),a._UZ(6,"app-precio-producto-detalle",21),a.qZA(),a.YNc(7,H,2,1,"td",17),a.TgZ(8,"td",22),a.TgZ(9,"p-button",23),a.NdJ("onClick",function(){const W=a.CHM(s).$implicit;return a.oxw().emitProduct(W)}),a.qZA(),a.qZA(),a.qZA()}if(2&p){const s=c.$implicit,d=a.oxw();a.xp6(2),a.Oqu(s.codigoBarra),a.xp6(2),a.Oqu(s.nombre),a.xp6(2),a.Q6J("puntoVenta",d.puntoVenta)("producto",s),a.xp6(1),a.Q6J("ngIf",d.configCompany.inventario)}}const j=function(){return{width:"50vw"}},z=function(){return{height:"35vh"}};class v{constructor(c,s){this.productService=c,this.messageService=s,this.unsubscribe$=new q.xQ,this.displaySearchProduct=!1,this.filteredProducts=[],this.configCompany={},this.selectProduct=new a.vpe,this.addItem=new a.vpe}ngOnInit(){this.resultadoBusqueda=[],this.puntoVenta$.pipe((0,x.R)(this.unsubscribe$)).subscribe(c=>{this.puntoVenta=c}),this.configCompany$.pipe((0,x.R)(this.unsubscribe$)).subscribe(c=>{this.configCompany=c})}setFocusInput(){setTimeout(()=>{this.searchAutocompleteRef&&this.searchAutocompleteRef.focusInput()},30)}ngOnDestroy(){this.unsubscribe$.next(),this.unsubscribe$.complete()}get placeHolderBusqueda(){return"Ingrese t\xe9rmino de b\xfasqueda o c\xf3digo de barras"}get titleModal(){return this.titleModalSearch?this.titleModalSearch:"Buscar producto"}openDialogSearchProduct(){this.displaySearchProduct=!0,this.searchInput=void 0,this.resultadoBusqueda=[],this.setFocusInput(),this.autoSearchOnOpenModal&&this.searchProduct()}keyPressInputEvent(c){"Enter"===c.key&&(c.preventDefault(),this.searchProduct(!0))}inputEvent(){this.searchProduct()}changeTipoBusqueda(){this.searchInput="",setTimeout(()=>{this.searchInputModalRef.nativeElement.focus()},0)}searchProduct(c){let s=["paginacion=false","limit=50"];c?s.push(`codigoBarra=${this.searchInput}`):(this.searchInput&&s.push(`filterGlobal=${this.searchInput.replace("&","%26")}`),this.aditionalParamsGeneralSearch&&(s=[...s,...this.aditionalParamsGeneralSearch])),this.productService.findAllList(s.join("&")).subscribe(d=>{d.length||this.messageService.add({severity:"warn",summary:"B\xfasqueda de producto",detail:`Producto no encontrado (${this.searchInput})`}),1===d.length&&c&&this.emitProduct(d[0]),d.length>1&&c&&(this.displaySearchProduct=!0),this.resultadoBusqueda=d})}emitProduct(c){this.searchInput="",this.filteredProducts=[],this.searchInput="",this.setFocusInput(),this.selectProduct.emit(c),this.displaySearchProduct=!1}emitAddItem(){this.addItem.emit()}filterProductByCodigoAndNombre(c){let s=[`filterGlobal=${c.query.replace("&","%26")}`,"paginacion=false","limit=50"];this.aditionalParamsGeneralSearch&&(s=[...s,...this.aditionalParamsGeneralSearch]),this.productService.findAllList(s.join("&")).subscribe(d=>{this.filteredProducts=d})}}v.\u0275fac=function(c){return new(c||v)(a.Y36(E.M),a.Y36(u.ez))},v.\u0275cmp=a.Xpm({type:v,selectors:[["app-agregar-producto"]],viewQuery:function(c,s){if(1&c&&(a.Gf($,5),a.Gf(Q,5)),2&c){let d;a.iGM(d=a.CRH())&&(s.searchInputModalRef=d.first),a.iGM(d=a.CRH())&&(s.searchAutocompleteRef=d.first)}},inputs:{visibleAddItem:"visibleAddItem",aditionalParamsGeneralSearch:"aditionalParamsGeneralSearch",autoSearchOnOpenModal:"autoSearchOnOpenModal",titleModalSearch:"titleModalSearch",disableAddItem:"disableAddItem"},outputs:{selectProduct:"selectProduct",addItem:"addItem"},ngContentSelectors:["*"],decls:20,vars:19,consts:[[1,"p-inputgroup"],["tooltipPosition","top","pTooltip","Agregar item","pButton","","type","button","icon","fa fa-plus","class","p-button-success",3,"disabled","click",4,"ngIf"],[1,"p-fluid",2,"width","100%"],["field","nombre",3,"ngModel","suggestions","placeholder","minLength","onKeyUp","ngModelChange","onSelect","completeMethod"],["searchAutocompleteRef",""],["pTemplate","item"],["tooltipPosition","top","pTooltip","Abrir buscador","pButton","","type","button","icon","pi pi-search",3,"click"],["appendTo","body",3,"header","visible","modal","draggable","resizable","visibleChange"],[1,"grid","p-fluid"],[1,"col-12"],["type","text","pInputText","",2,"width","100%",3,"ngModel","placeholder","input","ngModelChange"],["searchInputModalRef",""],[3,"value"],["pTemplate","header"],["pTemplate","body"],["type","button","pButton","","icon","pi pi-times","label","Cerrar",1,"p-button-secondary",3,"click"],["tooltipPosition","top","pTooltip","Agregar item","pButton","","type","button","icon","fa fa-plus",1,"p-button-success",3,"disabled","click"],[4,"ngIf"],["class","ml-3",4,"ngIf"],[1,"ml-3"],["mostrar","tag",3,"producto"],[3,"puntoVenta","producto"],[2,"text-align","center"],["icon","pi pi-check",3,"onClick"],["mostrar","button",3,"producto"]],template:function(c,s){1&c&&(a.F$t(),a.TgZ(0,"div",0),a.YNc(1,B,1,1,"button",1),a.TgZ(2,"div",2),a.TgZ(3,"p-autoComplete",3,4),a.NdJ("onKeyUp",function(g){return s.keyPressInputEvent(g)})("ngModelChange",function(g){return s.searchInput=g})("onSelect",function(g){return s.emitProduct(g)})("completeMethod",function(g){return s.filterProductByCodigoAndNombre(g)}),a.YNc(5,R,3,3,"ng-template",5),a.qZA(),a.qZA(),a.Hsn(6),a.TgZ(7,"button",6),a.NdJ("click",function(){return s.openDialogSearchProduct()}),a.qZA(),a.qZA(),a.TgZ(8,"p-dialog",7),a.NdJ("visibleChange",function(g){return s.displaySearchProduct=g}),a.TgZ(9,"div",8),a.TgZ(10,"div",9),a.TgZ(11,"input",10,11),a.NdJ("input",function(){return s.inputEvent()})("ngModelChange",function(g){return s.searchInput=g}),a.qZA(),a.qZA(),a.TgZ(13,"div",9),a.TgZ(14,"p-scrollPanel"),a.TgZ(15,"p-table",12),a.YNc(16,S,10,1,"ng-template",13),a.YNc(17,K,10,5,"ng-template",14),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.TgZ(18,"p-footer"),a.TgZ(19,"button",15),a.NdJ("click",function(){return s.displaySearchProduct=!1}),a.qZA(),a.qZA(),a.qZA()),2&c&&(a.xp6(1),a.Q6J("ngIf",s.visibleAddItem),a.xp6(2),a.Q6J("ngModel",s.searchInput)("suggestions",s.filteredProducts)("placeholder",s.placeHolderBusqueda)("minLength",1),a.xp6(5),a.Akn(a.DdM(17,j)),a.Q6J("header",s.titleModal)("visible",s.displaySearchProduct)("modal",!0)("draggable",!1)("resizable",!1),a.xp6(3),a.Q6J("ngModel",s.searchInput)("placeholder",s.placeHolderBusqueda),a.xp6(3),a.Akn(a.DdM(18,z)),a.xp6(1),a.Q6J("value",s.resultadoBusqueda))},directives:[P.O5,t.u,b.Hq,O.Qc,Z.JJ,Z.On,u.jx,F.d,N.V,Z.Fj,f.o,M.P,V.iA,m.e,b.zx,u.$_],styles:[""]}),(0,T.gn)([(0,I.Ph)(h.Z.getOffice)],v.prototype,"puntoVenta$",void 0),(0,T.gn)([(0,I.Ph)(h.Z.getConfig)],v.prototype,"configCompany$",void 0)},88380:(nt,J,l)=>{l.r(J),l.d(J,{InventarioTrasladoModule:()=>te});var T=l(74202),a=l(54578),I=l(70655),h=l(82817),q=l(85932),x=l(81575),E=l(8929),u=l(93075),P=l(7625),t=l(5e3),b=l(32579),O=l(20207),Z=l(47745),F=l(6969),N=l(24394),f=l(59783),M=l(74297),V=l(14036),m=l(69808),$=l(43724),Q=l(31424),B=l(73407),Y=l(80422),L=l(75875),R=l(20657),k=l(4119),S=l(40845);function H(o,n){1&o&&t._UZ(0,"p-message",16)}function K(o,n){1&o&&t._UZ(0,"p-message",17)}function j(o,n){if(1&o){const e=t.EpF();t.TgZ(0,"p-fieldset",18),t.TgZ(1,"div",19),t.TgZ(2,"app-agregar-producto",20),t.NdJ("selectProduct",function(r){return t.CHM(e),t.oxw().addItemByProduct(r)}),t.qZA(),t.qZA(),t.qZA()}2&o&&(t.xp6(2),t.Q6J("visibleAddItem",!1))}function z(o,n){1&o&&(t.TgZ(0,"div",21),t._UZ(1,"p-message",22),t.qZA())}function G(o,n){1&o&&t._UZ(0,"p-message",39)}function v(o,n){1&o&&t._UZ(0,"p-message",40)}function p(o,n){1&o&&t._UZ(0,"p-message",41)}function c(o,n){if(1&o){const e=t.EpF();t.TgZ(0,"div",25),t.TgZ(1,"div",26),t.TgZ(2,"p-card"),t.TgZ(3,"div",1),t.TgZ(4,"div",27),t.TgZ(5,"div",28),t.TgZ(6,"div",29),t.TgZ(7,"label",30),t._uU(8,"Stock origen"),t.qZA(),t.TgZ(9,"p",31),t._uU(10),t.qZA(),t.qZA(),t.TgZ(11,"div",29),t.TgZ(12,"label",30),t._uU(13,"Stock destino"),t.qZA(),t.TgZ(14,"p",31),t._uU(15),t.qZA(),t.qZA(),t.TgZ(16,"div",32),t.TgZ(17,"label",30),t._uU(18,"Producto"),t.qZA(),t.TgZ(19,"p",31),t._uU(20),t.qZA(),t.qZA(),t.TgZ(21,"div",29),t.TgZ(22,"label",30),t._uU(23,"Cantidad"),t.qZA(),t._UZ(24,"input",33),t.YNc(25,G,1,0,"p-message",34),t.YNc(26,v,1,0,"p-message",35),t.YNc(27,p,1,0,"p-message",36),t.qZA(),t.qZA(),t.qZA(),t.TgZ(28,"div",37),t.TgZ(29,"button",38),t.NdJ("click",function(){t.CHM(e);const r=t.oxw().index;return t.oxw().deleteItemForm(r)}),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA()}if(2&o){const e=t.oxw(),i=e.index,r=e.$implicit,_=t.oxw();t.Q6J("formGroupName",i),t.xp6(10),t.Oqu(_.getStockInOriginByIndex(i)),t.xp6(5),t.Oqu(_.getStockInTargetByIndex(i)),t.xp6(5),t.Oqu(_.getProductoByIndex(i).nombre),t.xp6(5),t.Q6J("ngIf",r.get("cantidadSolicitud").touched&&(null==r.get("cantidadSolicitud").errors?null:r.get("cantidadSolicitud").errors.required)),t.xp6(1),t.Q6J("ngIf",r.get("cantidadSolicitud").touched&&(null==r.get("cantidadSolicitud").errors?null:r.get("cantidadSolicitud").errors.max)),t.xp6(1),t.Q6J("ngIf",r.get("cantidadSolicitud").touched&&(null==r.get("cantidadSolicitud").errors?null:r.get("cantidadSolicitud").errors.min))}}function s(o,n){if(1&o&&(t.TgZ(0,"div",23),t.YNc(1,c,30,7,"div",24),t.qZA()),2&o){const e=n.index,i=t.oxw();t.xp6(1),t.Q6J("ngIf",!i.getItemFormByIndex(e).value.eliminado)}}const d=function(){return{width:"100%"}};class g{constructor(n,e,i,r,_,U,D,w,tt,ee){this.route=n,this.router=e,this.inventoryTransferService=i,this.loginService=r,this.breadcrumbService=_,this.officeService=U,this.ls=D,this.fb=w,this.confirmationService=tt,this.messageService=ee,this.unsubscribe$=new E.xQ,this.puntosVenta=[]}ngOnInit(){this.builderForm(),this.validarPuntoVenta(),this.loadPuntosVenta(),this.loadTransferIsEdit(),this.breadcrumbService.setItems((0,h.kn)(this.route))}ngOnDestroy(){this.unsubscribe$.next(),this.unsubscribe$.complete()}builderForm(){this.modelForm=this.fb.group({puntoVentaOrigen:[void 0,[u.kI.required]],comentarioSolicitud:[void 0,[]],items:this.fb.array([])})}registrar(){(0,h.c2)(this.modelForm),this.modelForm.valid?this.confirmationService.confirm({message:`\xbfEst\xe1 seguro de ${this.isEdit?"actualizar":"registrar"} el traslado actual?`,accept:()=>{this.formToModel(),(this.isEdit?this.inventoryTransferService.update(this.model.id,this.model):this.inventoryTransferService.save(this.model)).subscribe(n=>{this.messageService.add({severity:"success",summary:"Registro de traslado",detail:"Traslado registrado correctamente."}),this.router.navigateByUrl("/inventario-traslados")})},acceptLabel:"Si",rejectLabel:"No"}):this.messageService.add({severity:"error",summary:"Error",detail:"Complete campos obligatorios (*)"})}get linkVolver(){return"/inventario-traslados"}get isEdit(){return this.route.snapshot.data.isEdit}get titleButtonAction(){return this.isEdit?"Actualizar traslado":"Registrar traslado"}get puntoVentaOrigen(){return this.modelForm.get("puntoVentaOrigen")}get comentarioSolicitud(){return this.modelForm.get("comentarioSolicitud")}get modelFormItems(){return this.modelForm.get("items")}getItemFormByIndex(n){return this.modelFormItems.at(n)}getProductoByIndex(n){return this.modelFormItems.at(n).value.producto}getStockInOriginByIndex(n){const e=this.getProductoByIndex(n).inventarios.find(i=>this.puntoVentaOrigen.value&&i.puntoVenta.id===this.puntoVentaOrigen.value.id);return e?e.stock:0}getStockInTargetByIndex(n){const e=this.getProductoByIndex(n).inventarios.find(i=>i.puntoVenta.id===this.puntoVentaDestino.id);return e?e.stock:0}updateValidatorsMaxQuantity(){for(let n=0;n<this.modelFormItems.controls.length;n++){const e=this.getProductoByIndex(n).inventarios.find(r=>r.puntoVenta.id===this.puntoVentaOrigen.value.id),i=e?e.stock:0;this.getItemFormByIndex(n).get("cantidadSolicitud").clearValidators(),this.getItemFormByIndex(n).get("cantidadSolicitud").setValidators([u.kI.required,u.kI.min(1),u.kI.max(i)]),this.getItemFormByIndex(n).get("cantidadSolicitud").updateValueAndValidity()}}addItemByProduct(n){this.modelFormItems.push(this.createItemForm({producto:n}))}deleteItemForm(n){this.modelFormItems.at(n)&&this.modelFormItems.at(n).value.id?this.modelFormItems.at(n).patchValue({eliminado:!0}):this.modelFormItems.removeAt(n)}createItemForm(n){const e=n.producto.inventarios.find(r=>r.puntoVenta.id===this.puntoVentaOrigen.value.id),i=e?e.stock:0;return this.fb.group({id:[n.id,[]],producto:[n.producto,[]],cantidadSolicitud:[n.cantidadSolicitud,[u.kI.required,u.kI.min(1),u.kI.max(i)]],eliminado:[!1,[]],modificado:[!1,[]]})}loadPuntosVenta(){this.officeService.findAll("",void 0,!1).subscribe(n=>{this.puntosVenta=n.filter(e=>e.id!==this.puntoVentaDestino.id)})}validarPuntoVenta(){this.puntoVenta$.pipe((0,P.R)(this.unsubscribe$)).subscribe(n=>{this.puntoVentaDestino=n,this.loadPuntosVenta(),this.modelForm.patchValue({puntoVentaOrigen:void 0})})}formToModel(){const n=this.modelForm.getRawValue();this.model||(this.model={}),this.model.puntoVentaOrigen=n.puntoVentaOrigen,this.model.puntoVentaDestino=this.puntoVentaDestino,this.model.comentarioSolicitud=n.comentarioSolicitud,this.model.items=[],n.items.forEach(e=>{this.model.items.push(e)})}modelToForm(n){this.model=n,this.modelForm.patchValue({puntoVentaOrigen:n.puntoVentaOrigen,comentarioSolicitud:n.comentarioSolicitud});const e=this.modelFormItems;n.items.forEach(i=>{e.push(this.createItemForm(i))})}loadTransferIsEdit(){const n=this.route.snapshot.params.id;n&&this.inventoryTransferService.findById(n).subscribe(e=>{this.model=e,this.modelToForm(e),this.updateValidatorsMaxQuantity()})}}g.\u0275fac=function(n){return new(n||g)(t.Y36(T.gz),t.Y36(T.F0),t.Y36(b.m),t.Y36(O.r),t.Y36(Z.p),t.Y36(F.l),t.Y36(N.E),t.Y36(u.qu),t.Y36(f.YP),t.Y36(f.ez))},g.\u0275cmp=t.Xpm({type:g,selectors:[["app-inventario-traslado"]],decls:25,vars:13,consts:[["novalidate","",3,"formGroup"],[1,"grid"],[1,"col-12","md:col-4"],[1,"label-form"],["formControlName","puntoVentaOrigen","placeholder","Seleccione...","optionLabel","nombre","id","puntoVenta",3,"options","onChange"],["severity","error","text","Seleccione un punto de venta de origen",4,"ngIf"],["disabled","","type","text","pInputText","",2,"width","100%",3,"value"],["formControlName","comentarioSolicitud","rows","3","pInputTextarea","",2,"width","100%"],["severity","error","text","Ingrese comentario de solicitud",4,"ngIf"],[1,"col-12"],["legend","Productos",4,"ngIf","ngIfElse"],["notOrigen",""],["formArrayName","items",4,"ngFor","ngForOf"],[1,"col-12",2,"text-align","center"],["pButton","","type","button",1,"lrm-1",3,"label","click"],["pButton","","type","button","label","Volver",1,"p-button-secondary","lrm-1",2,"margin-right","0.4rem",3,"routerLink"],["severity","error","text","Seleccione un punto de venta de origen"],["severity","error","text","Ingrese comentario de solicitud"],["legend","Productos"],[1,"head-items"],[3,"visibleAddItem","selectProduct"],[1,"m-t-3",2,"text-align","center"],["severity","warn","text","Seleccione el origen, para agregar items."],["formArrayName","items"],[3,"formGroupName",4,"ngIf"],[3,"formGroupName"],[2,"margin","10px 0"],[1,"col"],[1,"grid","p-fluid"],[1,"col-2"],[1,"label-form","text-bold"],[1,"mt-0"],[1,"col-6"],["formControlName","cantidadSolicitud","type","text","pInputText","","pKeyFilter","num",2,"width","100%"],["severity","error","text","Ingrese cantidad",4,"ngIf"],["severity","error","text","Cantidad m\xe1xima es de acuerdo al stock disponible en origen.",4,"ngIf"],["severity","error","text","Cantidad m\xednima es 1.",4,"ngIf"],[1,"col-fixed",2,"width","120px","text-align","center"],["pTooltip","Eliminar","pButton","","type","button","icon","pi pi-trash",1,"p-button-danger","lrm-1",3,"click"],["severity","error","text","Ingrese cantidad"],["severity","error","text","Cantidad m\xe1xima es de acuerdo al stock disponible en origen."],["severity","error","text","Cantidad m\xednima es 1."]],template:function(n,e){if(1&n&&(t.TgZ(0,"p-card"),t.TgZ(1,"form",0),t.TgZ(2,"div",1),t.TgZ(3,"div",2),t.TgZ(4,"label",3),t._uU(5,"Origen (*)"),t.qZA(),t.TgZ(6,"p-dropdown",4),t.NdJ("onChange",function(){return e.updateValidatorsMaxQuantity()}),t.qZA(),t.YNc(7,H,1,0,"p-message",5),t.qZA(),t.TgZ(8,"div",2),t.TgZ(9,"label",3),t._uU(10,"Destino (*)"),t.qZA(),t._UZ(11,"input",6),t.qZA(),t.TgZ(12,"div",2),t.TgZ(13,"label",3),t._uU(14,"Comentario de solicitud"),t.qZA(),t._UZ(15,"textarea",7),t.YNc(16,K,1,0,"p-message",8),t.qZA(),t.TgZ(17,"div",9),t.YNc(18,j,3,1,"p-fieldset",10),t.YNc(19,z,2,0,"ng-template",null,11,t.W1O),t.YNc(21,s,2,1,"div",12),t.qZA(),t.TgZ(22,"div",13),t.TgZ(23,"button",14),t.NdJ("click",function(){return e.registrar()}),t.qZA(),t._UZ(24,"button",15),t.qZA(),t.qZA(),t.qZA(),t.qZA()),2&n){const i=t.MAs(20);t.xp6(1),t.Q6J("formGroup",e.modelForm),t.xp6(5),t.Akn(t.DdM(12,d)),t.Q6J("options",e.puntosVenta),t.xp6(1),t.Q6J("ngIf",e.puntoVentaOrigen.touched&&(null==e.puntoVentaOrigen.errors?null:e.puntoVentaOrigen.errors.required)),t.xp6(4),t.Q6J("value",null==e.puntoVentaDestino?null:e.puntoVentaDestino.nombre),t.xp6(5),t.Q6J("ngIf",e.comentarioSolicitud.touched&&(null==e.comentarioSolicitud.errors?null:e.comentarioSolicitud.errors.required)),t.xp6(2),t.Q6J("ngIf",e.puntoVentaOrigen.value)("ngIfElse",i),t.xp6(3),t.Q6J("ngForOf",e.modelFormItems.controls),t.xp6(2),t.Q6J("label",e.titleButtonAction),t.xp6(1),t.Q6J("routerLink",e.linkVolver)}},directives:[M.Z,u._Y,u.JL,u.sg,V.Lt,u.JJ,u.u,m.O5,$.q,Q.o,u.Fj,B.g,Y.p,L.d,m.sg,u.CE,u.x0,R.Fr,k.u,S.Hq,T.rH],styles:[""]}),(0,I.gn)([(0,q.Ph)(x.Z.getOffice)],g.prototype,"puntoVenta$",void 0);var W=l(92340),et=l(75652),y=l(98952);function ot(o,n){if(1&o&&(t.TgZ(0,"div",1),t.TgZ(1,"label",2),t._uU(2,"Usuario atenci\xf3n"),t.qZA(),t.TgZ(3,"p",3),t._uU(4),t.qZA(),t.qZA(),t.TgZ(5,"div",1),t.TgZ(6,"label",2),t._uU(7,"Fecha atenci\xf3n"),t.qZA(),t.TgZ(8,"p",3),t._uU(9),t.ALo(10,"date"),t.qZA(),t.qZA(),t.TgZ(11,"div",1),t.TgZ(12,"label",2),t._uU(13,"Comentario de atenci\xf3n"),t.qZA(),t.TgZ(14,"p",3),t._uU(15),t.qZA(),t.qZA()),2&o){const e=t.oxw();t.xp6(4),t.Oqu(e.trasladoInventario.usuarioAtencion.nombreCompleto),t.xp6(5),t.Oqu(t.xi3(10,3,e.trasladoInventario.fechaAtencion,"dd/MM/yyyy hh:mm a")),t.xp6(6),t.Oqu(e.trasladoInventario.comentarioAtencion)}}function at(o,n){if(1&o&&(t.TgZ(0,"div",1),t.TgZ(1,"label",2),t._uU(2,"Usuario recepci\xf3n"),t.qZA(),t.TgZ(3,"p",3),t._uU(4),t.qZA(),t.qZA(),t.TgZ(5,"div",1),t.TgZ(6,"label",2),t._uU(7,"Fecha recepci\xf3n"),t.qZA(),t.TgZ(8,"p",3),t._uU(9),t.ALo(10,"date"),t.qZA(),t.qZA(),t.TgZ(11,"div",1),t.TgZ(12,"label",2),t._uU(13,"Comentario de recepci\xf3n"),t.qZA(),t.TgZ(14,"p",3),t._uU(15),t.qZA(),t.qZA()),2&o){const e=t.oxw();t.xp6(4),t.Oqu(e.trasladoInventario.usuarioRecepcion.nombreCompleto),t.xp6(5),t.Oqu(t.xi3(10,3,e.trasladoInventario.fechaRecepcion,"dd/MM/yyyy hh:mm a")),t.xp6(6),t.Oqu(e.trasladoInventario.comentarioRecepcion)}}function it(o,n){1&o&&(t.TgZ(0,"tr"),t.TgZ(1,"th"),t._uU(2,"Producto"),t.qZA(),t.TgZ(3,"th"),t._uU(4,"Cantidad solicitada"),t.qZA(),t.TgZ(5,"th"),t._uU(6,"Cantidad enviada"),t.qZA(),t.TgZ(7,"th"),t._uU(8,"Cantidad recepcionada"),t.qZA(),t.qZA())}function rt(o,n){if(1&o&&(t.TgZ(0,"tr"),t.TgZ(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.qZA(),t.qZA()),2&o){const e=n.$implicit;t.xp6(2),t.Oqu(null==e||null==e.producto?null:e.producto.nombre),t.xp6(2),t.Oqu(null==e?null:e.cantidadSolicitud),t.xp6(2),t.Oqu(null==e?null:e.cantidadAtencion),t.xp6(2),t.Oqu(null==e?null:e.cantidadRecepcion)}}let st=(()=>{class o{constructor(){}ngOnInit(){}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-inventario-traslado-detalle"]],inputs:{trasladoInventario:"trasladoInventario"},decls:23,vars:9,consts:[[1,"grid","p-fluid"],[1,"col-4"],[1,"label-form","text-bold"],[1,"mt-0"],[3,"ngIf"],[1,"col-12"],[3,"value"],["pTemplate","header"],["pTemplate","body"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"div",1),t.TgZ(2,"label",2),t._uU(3,"Usuario solicitante"),t.qZA(),t.TgZ(4,"p",3),t._uU(5),t.qZA(),t.qZA(),t.TgZ(6,"div",1),t.TgZ(7,"label",2),t._uU(8,"Fecha solicitud"),t.qZA(),t.TgZ(9,"p",3),t._uU(10),t.ALo(11,"date"),t.qZA(),t.qZA(),t.TgZ(12,"div",1),t.TgZ(13,"label",2),t._uU(14,"Comentario de solicitud"),t.qZA(),t.TgZ(15,"p",3),t._uU(16),t.qZA(),t.qZA(),t.YNc(17,ot,16,6,"ng-template",4),t.YNc(18,at,16,6,"ng-template",4),t.TgZ(19,"div",5),t.TgZ(20,"p-table",6),t.YNc(21,it,9,0,"ng-template",7),t.YNc(22,rt,9,4,"ng-template",8),t.qZA(),t.qZA(),t.qZA()),2&e&&(t.xp6(5),t.Oqu(i.trasladoInventario.usuarioSolicitud.nombreCompleto),t.xp6(5),t.Oqu(t.xi3(11,6,i.trasladoInventario.fechaSolicitud,"dd/MM/yyyy hh:mm a")),t.xp6(6),t.Oqu(i.trasladoInventario.comentarioSolicitud),t.xp6(1),t.Q6J("ngIf","ENVIADO"===i.trasladoInventario.estadoTraslado),t.xp6(1),t.Q6J("ngIf","RECEPCIONADO"===i.trasladoInventario.estadoTraslado),t.xp6(2),t.Q6J("value",i.trasladoInventario.items))},directives:[m.O5,y.iA,f.jx],pipes:[m.uU],styles:[""]}),o})(),lt=(()=>{class o{transform(e,i){return"PENDIENTE"===e?"Pendiente":"CANCELADO"===e?"Cancelado":"ENVIADO"===e?"Enviado":"RECEPCIONADO"===e?"Recepcionado":""}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275pipe=t.Yjl({name:"estadoTrasladoInventario",type:o,pure:!0}),o})();const ct=["dt"];function dt(o,n){if(1&o&&t._UZ(0,"p-sortIcon",19),2&o){const e=t.oxw().$implicit;t.Q6J("field",e.field)}}function pt(o,n){if(1&o&&(t.TgZ(0,"th",17),t._uU(1),t.YNc(2,dt,1,1,"p-sortIcon",18),t.qZA()),2&o){const e=n.$implicit;t.Q6J("pSortableColumn",e.field),t.xp6(1),t.hij(" ",e.header," "),t.xp6(1),t.Q6J("ngIf",!e.isActions)}}function ut(o,n){if(1&o&&(t.TgZ(0,"tr"),t._UZ(1,"th",15),t.YNc(2,pt,3,3,"th",16),t.qZA()),2&o){const e=n.$implicit;t.xp6(2),t.Q6J("ngForOf",e)}}function _t(o,n){1&o&&(t.TgZ(0,"span"),t._uU(1,"Entrada"),t.qZA())}function gt(o,n){1&o&&t._uU(0,"Salida")}function mt(o,n){if(1&o&&(t.ynx(0),t.YNc(1,_t,2,0,"span",28),t.YNc(2,gt,1,0,"ng-template",null,29,t.W1O),t.BQk()),2&o){const e=t.MAs(3),i=t.oxw(3).$implicit,r=t.oxw();t.xp6(1),t.Q6J("ngIf",r.isTransferIn(i))("ngIfElse",e)}}function Tt(o,n){if(1&o&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&o){const e=t.oxw(3).$implicit,i=t.oxw().$implicit;t.xp6(1),t.Oqu(i[e.field].nombre)}}function ft(o,n){if(1&o&&(t.ynx(0),t.YNc(1,Tt,2,1,"span",24),t.BQk()),2&o){const e=t.oxw(2).$implicit,i=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf",i[e.field])}}function vt(o,n){if(1&o&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&o){const e=t.oxw(3).$implicit,i=t.oxw().$implicit;t.xp6(1),t.Oqu(i[e.field].nombre)}}function ht(o,n){if(1&o&&(t.ynx(0),t.YNc(1,vt,2,1,"span",24),t.BQk()),2&o){const e=t.oxw(2).$implicit,i=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf",i[e.field])}}function Zt(o,n){if(1&o&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&o){const e=t.oxw(3).$implicit,i=t.oxw().$implicit;t.xp6(1),t.Oqu(i[e.field].nombreCompleto)}}function At(o,n){if(1&o&&(t.ynx(0),t.YNc(1,Zt,2,1,"span",24),t.BQk()),2&o){const e=t.oxw(2).$implicit,i=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf",i[e.field])}}function It(o,n){if(1&o&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"date"),t.qZA()),2&o){const e=t.oxw(3).$implicit,i=t.oxw().$implicit;t.xp6(1),t.Oqu(t.xi3(2,1,i[e.field],"dd/MM/yyyy hh:mm a"))}}function xt(o,n){if(1&o&&(t.ynx(0),t.YNc(1,It,3,4,"span",24),t.BQk()),2&o){const e=t.oxw(2).$implicit,i=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf",i[e.field])}}function bt(o,n){if(1&o&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"estadoTrasladoInventario"),t.qZA()),2&o){const e=t.oxw(3).$implicit,i=t.oxw().$implicit;t.xp6(1),t.Oqu(t.lcZ(2,1,i[e.field]))}}function yt(o,n){if(1&o&&(t.ynx(0),t.YNc(1,bt,3,3,"span",24),t.BQk()),2&o){const e=t.oxw(2).$implicit,i=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf",i[e.field])}}function Ct(o,n){if(1&o&&(t.ynx(0),t._uU(1),t.BQk()),2&o){const e=t.oxw(2).$implicit,i=t.oxw().$implicit;t.xp6(1),t.hij(" ",i[e.field]," ")}}function qt(o,n){1&o&&(t.ynx(0),t.YNc(1,mt,4,2,"ng-container",26),t.YNc(2,ft,2,1,"ng-container",26),t.YNc(3,ht,2,1,"ng-container",26),t.YNc(4,At,2,1,"ng-container",26),t.YNc(5,xt,2,1,"ng-container",26),t.YNc(6,yt,2,1,"ng-container",26),t.YNc(7,Ct,2,1,"ng-container",27),t.BQk()),2&o&&(t.xp6(1),t.Q6J("ngSwitchCase","tipoTraslado"),t.xp6(1),t.Q6J("ngSwitchCase","puntoVentaOrigen"),t.xp6(1),t.Q6J("ngSwitchCase","puntoVentaDestino"),t.xp6(1),t.Q6J("ngSwitchCase","usuarioSolicitud"),t.xp6(1),t.Q6J("ngSwitchCase","fechaSolicitud"),t.xp6(1),t.Q6J("ngSwitchCase","estadoTraslado"))}function Et(o,n){if(1&o){const e=t.EpF();t.TgZ(0,"button",39),t.NdJ("click",function(){t.CHM(e);const r=t.oxw(3).$implicit;return t.oxw().goEditTransfer(r)}),t.qZA()}}function Pt(o,n){if(1&o){const e=t.EpF();t.TgZ(0,"button",40),t.NdJ("click",function(){t.CHM(e);const r=t.oxw(3).$implicit;return t.oxw().anularTraslado(r)}),t.qZA()}}function Ot(o,n){if(1&o){const e=t.EpF();t.TgZ(0,"button",41),t.NdJ("click",function(){t.CHM(e);const r=t.oxw(3).$implicit;return t.oxw().goSendTransfer(r)}),t.qZA()}}function Nt(o,n){if(1&o){const e=t.EpF();t.TgZ(0,"button",42),t.NdJ("click",function(){t.CHM(e);const r=t.oxw(3).$implicit;return t.oxw().goReceiveTransfer(r)}),t.qZA()}}function Mt(o,n){if(1&o){const e=t.EpF();t.ynx(0,30),t.TgZ(1,"span",31),t._uU(2,"Acciones"),t.qZA(),t.TgZ(3,"div",32),t.YNc(4,Et,1,0,"button",33),t.YNc(5,Pt,1,0,"button",34),t.YNc(6,Ot,1,0,"button",35),t.YNc(7,Nt,1,0,"button",36),t.TgZ(8,"button",37),t.NdJ("click",function(){t.CHM(e);const r=t.oxw(2).$implicit;return t.oxw().openPdf(r)}),t.qZA(),t.TgZ(9,"button",38),t.NdJ("click",function(){t.CHM(e);const r=t.oxw(2).$implicit;return t.oxw().goGuiaRemision(r)}),t.qZA(),t.qZA(),t.BQk()}if(2&o){const e=t.oxw(2).$implicit,i=t.oxw();t.xp6(4),t.Q6J("ngIf","PENDIENTE"===e.estadoTraslado&&i.isTransferIn(e)),t.xp6(1),t.Q6J("ngIf","PENDIENTE"===e.estadoTraslado&&i.isTransferIn(e)),t.xp6(1),t.Q6J("ngIf","PENDIENTE"===e.estadoTraslado&&!i.isTransferIn(e)),t.xp6(1),t.Q6J("ngIf","ENVIADO"===e.estadoTraslado&&i.isTransferIn(e))}}function St(o,n){if(1&o&&(t.TgZ(0,"td",23),t.YNc(1,qt,8,6,"ng-container",24),t.YNc(2,Mt,10,4,"ng-container",25),t.qZA()),2&o){const e=n.$implicit;t.Q6J("ngSwitch",e.field),t.xp6(1),t.Q6J("ngIf",!e.isActions),t.xp6(1),t.Q6J("ngIf",e.isActions)}}function Ut(o,n){if(1&o&&(t.TgZ(0,"tr"),t.TgZ(1,"td"),t.TgZ(2,"a",20),t._UZ(3,"i",21),t.qZA(),t.qZA(),t.YNc(4,St,3,3,"td",22),t.qZA()),2&o){const e=n.$implicit,i=n.expanded,r=n.columns;t.xp6(2),t.Q6J("pRowToggler",e),t.xp6(1),t.Q6J("ngClass",i?"pi pi-chevron-down":"pi pi-chevron-right"),t.xp6(1),t.Q6J("ngForOf",r)}}function Dt(o,n){if(1&o){const e=t.EpF();t.TgZ(0,"div",43),t.TgZ(1,"button",44),t.NdJ("click",function(){return t.CHM(e),t.oxw().new()}),t.qZA(),t.qZA()}}function wt(o,n){if(1&o&&(t.TgZ(0,"tr"),t.TgZ(1,"td"),t._UZ(2,"app-inventario-traslado-detalle",45),t.qZA(),t.qZA()),2&o){const e=n.$implicit,i=n.columns;t.xp6(1),t.uIk("colspan",i.length+1),t.xp6(1),t.Q6J("trasladoInventario",e)}}const X=function(){return{width:"100%"}};class C{constructor(n,e,i,r,_,U,D,w){this.route=n,this.router=e,this.inventoryTransferService=i,this.loginService=r,this.breadcrumbService=_,this.ls=U,this.datePipe=D,this.confirmationService=w,this.unsubscribe$=new E.xQ,this.perPage=10}ngOnInit(){this.breadcrumbService.setItems((0,h.kn)(this.route)),this.validarPuntoVenta(),this.cols=[{field:"tipoTraslado",header:"Tipo traslado"},{field:"puntoVentaOrigen",header:"Origen"},{field:"puntoVentaDestino",header:"Destino"},{field:"usuarioSolicitud",header:"Solicitante"},{field:"fechaSolicitud",header:"Fecha"},{field:"estadoTraslado",header:"Estado"},{header:"Acciones",isActions:!0}];const n=new Date;this.filtroDesde=new Date(n.getFullYear(),n.getMonth(),1),this.filtroHasta=new Date(n.getFullYear(),n.getMonth()+1,0)}ngOnDestroy(){this.unsubscribe$.next(),this.unsubscribe$.complete()}new(){this.router.navigateByUrl("/inventario-traslados/nuevo")}resetAndRefreshTable(){this.tabla.reset(),this.refreshTable()}refreshTable(){this.tabla.reset(),this.lastLazyLoadEvent&&this.loadLazy(this.lastLazyLoadEvent)}loadLazy(n){const i=["pageNumber="+n.first/this.perPage,`perPage=${n.rows}`,`desde=${this.datePipe.transform(this.filtroDesde,"dd-MM-yyyy")}`,`hasta=${this.datePipe.transform(this.filtroHasta,"dd-MM-yyyy")}`,`idPuntoVenta=${this.filtroPuntoVenta.id}`];this.filtroEstado&&i.push(`estadoTraslado=${this.filtroEstado}`),n.sortOrder&&i.push(`sortOrder=${n.sortOrder}`),n.sortField&&i.push(`sortField=${n.sortField}`),this.inventoryTransferService.findAll(i.join("&")).subscribe(r=>{this.totalRecords=r.totalElements,this.inventoryTransfer=r.content})}validarPuntoVenta(){this.puntoVenta$.pipe((0,P.R)(this.unsubscribe$)).subscribe(n=>{this.filtroPuntoVenta=n,this.resetAndRefreshTable()})}anularTraslado(n){this.confirmationService.confirm({message:`\xbfEst\xe1 seguro de anular el traslado desde ${n.puntoVentaOrigen.nombre} hasta ${n.puntoVentaDestino.nombre}?`,accept:()=>{this.inventoryTransferService.delete(n.id).subscribe(()=>this.refreshTable())},acceptLabel:"Si",rejectLabel:"No"})}goEditTransfer(n){this.router.navigateByUrl(`/inventario-traslados/editar/${n.id}`)}goSendTransfer(n){this.router.navigateByUrl(`/inventario-traslados/enviar/${n.id}`)}goReceiveTransfer(n){this.router.navigateByUrl(`/inventario-traslados/recepcionar/${n.id}`)}isTransferIn(n){return this.filtroPuntoVenta.id===n.puntoVentaDestino.id}openPdf(n){(0,h.UU)(`${W.N.endpointApi}/public/pdf/inventory-transfer/${n.uuid}.pdf`)}goGuiaRemision(n){this.router.navigateByUrl(`/guia-remision/emitir-guia/traslado/${n.id}`)}}function Jt(o,n){if(1&o&&(t.TgZ(0,"div",2),t.TgZ(1,"label",3),t._uU(2,"Usuario atenci\xf3n"),t.qZA(),t.TgZ(3,"p",4),t._uU(4),t.qZA(),t.qZA(),t.TgZ(5,"div",2),t.TgZ(6,"label",3),t._uU(7,"Fecha atenci\xf3n"),t.qZA(),t.TgZ(8,"p",4),t._uU(9),t.ALo(10,"date"),t.qZA(),t.qZA(),t.TgZ(11,"div",2),t.TgZ(12,"label",3),t._uU(13,"Comentario de atenci\xf3n"),t.qZA(),t.TgZ(14,"p",4),t._uU(15),t.qZA(),t.qZA()),2&o){const e=t.oxw(2);t.xp6(4),t.Oqu(e.inventoryTransfer.usuarioAtencion.nombreCompleto),t.xp6(5),t.Oqu(t.xi3(10,3,e.inventoryTransfer.fechaAtencion,"dd/MM/yyyy hh:mm a")),t.xp6(6),t.Oqu(e.inventoryTransfer.comentarioAtencion)}}function Ft(o,n){if(1&o&&(t.TgZ(0,"div",2),t.TgZ(1,"label",3),t._uU(2,"Usuario recepci\xf3n"),t.qZA(),t.TgZ(3,"p",4),t._uU(4),t.qZA(),t.qZA(),t.TgZ(5,"div",2),t.TgZ(6,"label",3),t._uU(7,"Fecha recepci\xf3n"),t.qZA(),t.TgZ(8,"p",4),t._uU(9),t.ALo(10,"date"),t.qZA(),t.qZA(),t.TgZ(11,"div",2),t.TgZ(12,"label",3),t._uU(13,"Comentario de recepci\xf3n"),t.qZA(),t.TgZ(14,"p",4),t._uU(15),t.qZA(),t.qZA()),2&o){const e=t.oxw(2);t.xp6(4),t.Oqu(e.inventoryTransfer.usuarioRecepcion.nombreCompleto),t.xp6(5),t.Oqu(t.xi3(10,3,e.inventoryTransfer.fechaRecepcion,"dd/MM/yyyy hh:mm a")),t.xp6(6),t.Oqu(e.inventoryTransfer.comentarioRecepcion)}}function Vt(o,n){if(1&o){const e=t.EpF();t.TgZ(0,"div",7),t.TgZ(1,"label",3),t._uU(2,"Comentario de env\xedo"),t.qZA(),t.TgZ(3,"textarea",16),t.NdJ("ngModelChange",function(r){return t.CHM(e),t.oxw(2).inventoryTransfer.comentarioAtencion=r}),t.qZA(),t.qZA()}if(2&o){const e=t.oxw(2);t.xp6(3),t.Q6J("ngModel",e.inventoryTransfer.comentarioAtencion)}}function $t(o,n){if(1&o){const e=t.EpF();t.TgZ(0,"div",7),t.TgZ(1,"label",17),t._uU(2,"Comentario de recepci\xf3n"),t.qZA(),t.TgZ(3,"textarea",16),t.NdJ("ngModelChange",function(r){return t.CHM(e),t.oxw(2).inventoryTransfer.comentarioRecepcion=r}),t.qZA(),t.qZA()}if(2&o){const e=t.oxw(2);t.xp6(3),t.Q6J("ngModel",e.inventoryTransfer.comentarioRecepcion)}}function Qt(o,n){1&o&&(t.TgZ(0,"div",18),t._UZ(1,"p-message",19),t.qZA())}function Bt(o,n){1&o&&(t.TgZ(0,"div",18),t._UZ(1,"p-message",20),t.qZA())}function Yt(o,n){1&o&&(t.TgZ(0,"th"),t._uU(1,"Cantidad env\xedo"),t.qZA())}function Rt(o,n){1&o&&(t.TgZ(0,"th"),t._uU(1,"Cantidad recepci\xf3n"),t.qZA())}function kt(o,n){if(1&o&&(t.TgZ(0,"tr"),t.TgZ(1,"th"),t._uU(2,"Producto"),t.qZA(),t.TgZ(3,"th"),t._uU(4,"Stock origen"),t.qZA(),t.TgZ(5,"th"),t._uU(6,"Stock destino"),t.qZA(),t.TgZ(7,"th"),t._uU(8,"Cantidad solicitada"),t.qZA(),t.YNc(9,Yt,2,0,"th",0),t.YNc(10,Rt,2,0,"th",0),t.qZA()),2&o){const e=t.oxw(2);t.xp6(9),t.Q6J("ngIf","PENDIENTE"===e.inventoryTransfer.estadoTraslado||"ENVIADO"===e.inventoryTransfer.estadoTraslado),t.xp6(1),t.Q6J("ngIf","ENVIADO"===e.inventoryTransfer.estadoTraslado)}}function Lt(o,n){if(1&o){const e=t.EpF();t.TgZ(0,"td"),t.TgZ(1,"input",21),t.NdJ("ngModelChange",function(r){return t.CHM(e),t.oxw().$implicit.cantidadAtencion=r}),t.qZA(),t.qZA()}if(2&o){const e=t.oxw().$implicit,i=t.oxw(2);t.xp6(1),t.Q6J("disabled","ENVIADO"===i.inventoryTransfer.estadoTraslado)("ngModel",e.cantidadAtencion)}}function Ht(o,n){if(1&o){const e=t.EpF();t.TgZ(0,"td"),t.TgZ(1,"input",22),t.NdJ("ngModelChange",function(r){return t.CHM(e),t.oxw().$implicit.cantidadRecepcion=r}),t.qZA(),t.qZA()}if(2&o){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("ngModel",e.cantidadRecepcion)}}function Kt(o,n){if(1&o&&(t.TgZ(0,"tr"),t.TgZ(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.qZA(),t.YNc(9,Lt,2,2,"td",0),t.YNc(10,Ht,2,1,"td",0),t.qZA()),2&o){const e=n.$implicit,i=t.oxw(2);t.xp6(2),t.Oqu(null==e||null==e.producto?null:e.producto.nombre),t.xp6(2),t.Oqu(i.getStockInOriginByIndex(null==e?null:e.producto)),t.xp6(2),t.Oqu(i.getStockInTargetByIndex(null==e?null:e.producto)),t.xp6(2),t.Oqu(null==e?null:e.cantidadSolicitud),t.xp6(1),t.Q6J("ngIf","PENDIENTE"===i.inventoryTransfer.estadoTraslado||"ENVIADO"===i.inventoryTransfer.estadoTraslado),t.xp6(1),t.Q6J("ngIf","ENVIADO"===i.inventoryTransfer.estadoTraslado)}}function jt(o,n){if(1&o){const e=t.EpF();t.TgZ(0,"p-card"),t.TgZ(1,"h1"),t._uU(2),t.qZA(),t.TgZ(3,"div",1),t.TgZ(4,"div",2),t.TgZ(5,"label",3),t._uU(6,"Usuario solicitante"),t.qZA(),t.TgZ(7,"p",4),t._uU(8),t.qZA(),t.qZA(),t.TgZ(9,"div",2),t.TgZ(10,"label",3),t._uU(11,"Fecha solicitud"),t.qZA(),t.TgZ(12,"p",4),t._uU(13),t.ALo(14,"date"),t.qZA(),t.qZA(),t.TgZ(15,"div",2),t.TgZ(16,"label",3),t._uU(17,"Comentario de solicitud"),t.qZA(),t.TgZ(18,"p",4),t._uU(19),t.qZA(),t.qZA(),t.YNc(20,Jt,16,6,"ng-template",5),t.YNc(21,Ft,16,6,"ng-template",5),t.YNc(22,Vt,4,1,"div",6),t.YNc(23,$t,4,1,"div",6),t.TgZ(24,"div",7),t.TgZ(25,"p-fieldset",8),t.YNc(26,Qt,2,0,"div",9),t.YNc(27,Bt,2,0,"div",9),t.TgZ(28,"p-table",10),t.YNc(29,kt,11,2,"ng-template",11),t.YNc(30,Kt,11,6,"ng-template",12),t.qZA(),t.qZA(),t.qZA(),t.TgZ(31,"div",13),t.TgZ(32,"button",14),t.NdJ("click",function(){return t.CHM(e),t.oxw().registrar()}),t.qZA(),t._UZ(33,"button",15),t.qZA(),t.qZA(),t.qZA()}if(2&o){const e=t.oxw();t.xp6(2),t.lnq("",e.title," de ",e.inventoryTransfer.puntoVentaOrigen.nombre," a ",e.inventoryTransfer.puntoVentaDestino.nombre,""),t.xp6(6),t.Oqu(e.inventoryTransfer.usuarioSolicitud.nombreCompleto),t.xp6(5),t.Oqu(t.xi3(14,15,e.inventoryTransfer.fechaSolicitud,"dd/MM/yyyy hh:mm a")),t.xp6(6),t.Oqu(e.inventoryTransfer.comentarioSolicitud),t.xp6(1),t.Q6J("ngIf","ENVIADO"===e.inventoryTransfer.estadoTraslado),t.xp6(1),t.Q6J("ngIf","RECEPCIONADO"===e.inventoryTransfer.estadoTraslado),t.xp6(1),t.Q6J("ngIf","PENDIENTE"===e.inventoryTransfer.estadoTraslado),t.xp6(1),t.Q6J("ngIf","ENVIADO"===e.inventoryTransfer.estadoTraslado),t.xp6(3),t.Q6J("ngIf","PENDIENTE"===e.inventoryTransfer.estadoTraslado),t.xp6(1),t.Q6J("ngIf","ENVIADO"===e.inventoryTransfer.estadoTraslado),t.xp6(1),t.Q6J("value",e.inventoryTransfer.items),t.xp6(4),t.Q6J("label",e.titleButtonAction),t.xp6(1),t.Q6J("routerLink",e.linkVolver)}}C.\u0275fac=function(n){return new(n||C)(t.Y36(T.gz),t.Y36(T.F0),t.Y36(b.m),t.Y36(O.r),t.Y36(Z.p),t.Y36(N.E),t.Y36(m.uU),t.Y36(f.YP))},C.\u0275cmp=t.Xpm({type:C,selectors:[["app-inventario-traslados"]],viewQuery:function(n,e){if(1&n&&t.Gf(ct,7),2&n){let i;t.iGM(i=t.CRH())&&(e.tabla=i.first)}},decls:23,vars:24,consts:[[1,"grid"],[1,"col-12"],[1,"grid","p-fluid"],[1,"col-6","md:col-3","lg:col-2"],[1,"label-form"],["name","fechaInicio","dateFormat","dd/mm/yy",3,"ngModel","locale","onSelect","ngModelChange"],["name","fechaFin","dateFormat","dd/mm/yy",3,"ngModel","locale","onSelect","ngModelChange"],[1,"col-6","md:col-2","lg:col-2"],["placeholder","Seleccione...",3,"ngModel","options","showClear","onChange","ngModelChange"],["dataKey","id",3,"columns","value","lazy","paginator","rows","totalRecords","responsive","autoLayout","onLazyLoad"],["dt",""],["pTemplate","header"],["pTemplate","body"],["pTemplate","summary"],["pTemplate","rowexpansion"],[2,"width","3em"],[3,"pSortableColumn",4,"ngFor","ngForOf"],[3,"pSortableColumn"],["ariaLabel","Activa para ordenar","ariaLabelDesc","Activa para ordenar en orden descendente","ariaLabelAsc","Activa para ordenar en orden ascendente",3,"field",4,"ngIf"],["ariaLabel","Activa para ordenar","ariaLabelDesc","Activa para ordenar en orden descendente","ariaLabelAsc","Activa para ordenar en orden ascendente",3,"field"],["href","#",3,"pRowToggler"],[3,"ngClass"],[3,"ngSwitch",4,"ngFor","ngForOf"],[3,"ngSwitch"],[4,"ngIf"],["style","text-align: center",4,"ngIf"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[4,"ngIf","ngIfElse"],["esSalida",""],[2,"text-align","center"],[1,"p-column-title"],[1,"space-buttons"],["pButton","","icon","pi pi-pencil","pTooltip","Editar","class","p-button-warning",3,"click",4,"ngIf"],["pButton","","icon","fa fa-ban","pTooltip","Anular","class","p-button-danger",3,"click",4,"ngIf"],["pButton","","icon","fa fa-arrow-up","pTooltip","Atender solicitud","class","p-button-success",3,"click",4,"ngIf"],["pButton","","icon","fa fa-arrow-down","pTooltip","Recepcionar solicitud","class","p-button-success",3,"click",4,"ngIf"],["pTooltip","Exportar Pdf de traslado","type","button","pButton","","icon","fa fa-file-pdf-o",1,"p-button-secondary",3,"click"],["pButton","","icon","fa fa-truck","pTooltip","Generar Gu\xeda Remision",1,"",3,"click"],["pButton","","icon","pi pi-pencil","pTooltip","Editar",1,"p-button-warning",3,"click"],["pButton","","icon","fa fa-ban","pTooltip","Anular",1,"p-button-danger",3,"click"],["pButton","","icon","fa fa-arrow-up","pTooltip","Atender solicitud",1,"p-button-success",3,"click"],["pButton","","icon","fa fa-arrow-down","pTooltip","Recepcionar solicitud",1,"p-button-success",3,"click"],[2,"text-align","left"],["type","button","pButton","","icon","fa fa-plus","label","Nuevo",2,"margin-right","0.2rem",3,"click"],[3,"trasladoInventario"]],template:function(n,e){1&n&&(t.TgZ(0,"p-card"),t.TgZ(1,"div",0),t.TgZ(2,"div",1),t.TgZ(3,"div",2),t.TgZ(4,"div",3),t.TgZ(5,"label",4),t._uU(6,"Desde"),t.qZA(),t.TgZ(7,"p-calendar",5),t.NdJ("onSelect",function(){return e.resetAndRefreshTable()})("ngModelChange",function(r){return e.filtroDesde=r}),t.qZA(),t.qZA(),t.TgZ(8,"div",3),t.TgZ(9,"label",4),t._uU(10,"Hasta"),t.qZA(),t.TgZ(11,"p-calendar",6),t.NdJ("onSelect",function(){return e.resetAndRefreshTable()})("ngModelChange",function(r){return e.filtroHasta=r}),t.qZA(),t.qZA(),t.TgZ(12,"div",7),t.TgZ(13,"label",4),t._uU(14,"Estado"),t.qZA(),t.TgZ(15,"p-dropdown",8),t.NdJ("onChange",function(){return e.resetAndRefreshTable()})("ngModelChange",function(r){return e.filtroEstado=r}),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(16,"div",1),t.TgZ(17,"p-table",9,10),t.NdJ("onLazyLoad",function(r){return e.loadLazy(r)}),t.YNc(19,ut,3,1,"ng-template",11),t.YNc(20,Ut,5,3,"ng-template",12),t.YNc(21,Dt,2,0,"ng-template",13),t.YNc(22,wt,3,2,"ng-template",14),t.qZA(),t.qZA(),t.qZA(),t.qZA()),2&n&&(t.xp6(7),t.Akn(t.DdM(21,X)),t.Q6J("ngModel",e.filtroDesde)("locale",e.ls.calendarEs),t.xp6(4),t.Akn(t.DdM(22,X)),t.Q6J("ngModel",e.filtroHasta)("locale",e.ls.calendarEs),t.xp6(4),t.Akn(t.DdM(23,X)),t.Q6J("ngModel",e.filtroEstado)("options",e.ls.estadosInventarioTraslado)("showClear",!0),t.xp6(2),t.Q6J("columns",e.cols)("value",e.inventoryTransfer)("lazy",!0)("paginator",!0)("rows",e.perPage)("totalRecords",e.totalRecords)("responsive",!0)("autoLayout",!0))},directives:[M.Z,et.f,u.JJ,u.On,V.Lt,y.iA,f.jx,m.sg,y.lQ,m.O5,y.fz,y.jB,m.mk,m.RF,m.n9,m.ED,S.Hq,k.u,st],pipes:[m.uU,lt],styles:[""]}),(0,I.gn)([(0,q.Ph)(x.Z.getOffice)],C.prototype,"puntoVenta$",void 0);class A{constructor(n,e,i,r,_,U,D,w,tt){this.route=n,this.router=e,this.inventoryTransferService=i,this.loginService=r,this.breadcrumbService=_,this.officeService=U,this.ls=D,this.confirmationService=w,this.messageService=tt,this.unsubscribe$=new E.xQ}ngOnInit(){this.breadcrumbService.setItems((0,h.kn)(this.route)),this.loadTransferIsEdit(),this.validarPuntoVenta()}validarPuntoVenta(){this.puntoVenta$.pipe((0,P.R)(this.unsubscribe$)).subscribe(n=>{this.puntoVenta=n})}get title(){return this.route.snapshot.data.title}loadTransferIsEdit(){const n=this.route.snapshot.params.id;n&&this.inventoryTransferService.findById(n).subscribe(e=>{this.inventoryTransfer=e,"PENDIENTE"===e.estadoTraslado&&e.items.forEach(i=>i.cantidadAtencion=i.cantidadSolicitud),"ENVIADO"===e.estadoTraslado&&e.items.forEach(i=>i.cantidadRecepcion=i.cantidadAtencion)})}getStockInOriginByIndex(n){const e=n.inventarios.find(i=>this.inventoryTransfer.puntoVentaOrigen&&i.puntoVenta.id===this.inventoryTransfer.puntoVentaOrigen.id);return e?e.stock:0}getStockInTargetByIndex(n){const e=n.inventarios.find(i=>i.puntoVenta.id===this.inventoryTransfer.puntoVentaDestino.id);return e?e.stock:0}registrar(){if("PENDIENTE"===this.inventoryTransfer.estadoTraslado&&this.inventoryTransfer.items.find(e=>isNaN(e.cantidadAtencion)))return void this.messageService.add({severity:"error",summary:"Error",detail:"Ingresa las cantidades correctas a enviar."});if("ENVIADO"===this.inventoryTransfer.estadoTraslado&&this.inventoryTransfer.items.find(e=>isNaN(e.cantidadRecepcion)))return void this.messageService.add({severity:"error",summary:"Error",detail:"Ingresa las cantidades correctas a recepcionar."});const n={comentario:"PENDIENTE"===this.inventoryTransfer.estadoTraslado?this.inventoryTransfer.comentarioAtencion:this.inventoryTransfer.comentarioRecepcion,idPuntoVenta:this.puntoVenta.id,cantidades:this.inventoryTransfer.items.map(e=>({id:e.id,cantidad:"PENDIENTE"===this.inventoryTransfer.estadoTraslado?e.cantidadAtencion:e.cantidadRecepcion}))};this.confirmationService.confirm({message:`\xbfEst\xe1 seguro de ${"PENDIENTE"===this.inventoryTransfer.estadoTraslado?"enviar":"recepcionar"} el traslado actual?`,accept:()=>{("PENDIENTE"===this.inventoryTransfer.estadoTraslado?this.inventoryTransferService.send(this.inventoryTransfer.id,n):this.inventoryTransferService.receive(this.inventoryTransfer.id,n)).subscribe(e=>{this.messageService.add({severity:"success",summary:"Acci\xf3n de traslado",detail:`Traslado ${"PENDIENTE"===this.inventoryTransfer.estadoTraslado?"enviado":"recepcionado"} correctamente.`}),this.router.navigateByUrl("/inventario-traslados")})},acceptLabel:"Si",rejectLabel:"No"})}get linkVolver(){return"/inventario-traslados"}get titleButtonAction(){return"PENDIENTE"===this.inventoryTransfer.estadoTraslado?"Registrar env\xedo":"Registrar recepci\xf3n"}}A.\u0275fac=function(n){return new(n||A)(t.Y36(T.gz),t.Y36(T.F0),t.Y36(b.m),t.Y36(O.r),t.Y36(Z.p),t.Y36(F.l),t.Y36(N.E),t.Y36(f.YP),t.Y36(f.ez))},A.\u0275cmp=t.Xpm({type:A,selectors:[["app-inventario-traslado-accion"]],decls:1,vars:1,consts:[[4,"ngIf"],[1,"grid","p-fluid"],[1,"col-4"],[1,"label-form","text-bold"],[1,"mt-0"],[3,"ngIf"],["class","col-12",4,"ngIf"],[1,"col-12"],["legend","Productos"],["class","mb-2",4,"ngIf"],[3,"value"],["pTemplate","header"],["pTemplate","body"],[1,"col-12",2,"text-align","center"],["pButton","","type","button",1,"mb-2",3,"label","click"],["pButton","","type","button","label","Volver",1,"p-button-secondary",2,"margin-right","0.4rem",3,"routerLink"],["rows","2","pInputTextarea","",2,"width","100%",3,"ngModel","ngModelChange"],[1,"label-form"],[1,"mb-2"],["severity","info","text","Nota: puedes ingresar la cantidad real de cada producto que se enviar\xe1, en la columna (Cantidad a enviar)."],["severity","info","text","Nota: puedes ingresar la cantidad real de cada producto que se recepcionar\xe1, en la columna (Cantidad a recepcionar)."],["type","text","pInputText","","pKeyFilter","num",2,"width","100%",3,"disabled","ngModel","ngModelChange"],["type","text","pInputText","","pKeyFilter","num",2,"width","100%",3,"ngModel","ngModelChange"]],template:function(n,e){1&n&&t.YNc(0,jt,34,18,"p-card",0),2&n&&t.Q6J("ngIf",e.inventoryTransfer)},directives:[m.O5,M.Z,u.Fj,B.g,u.JJ,u.On,Y.p,$.q,y.iA,f.jx,Q.o,R.Fr,S.Hq,T.rH],pipes:[m.uU],styles:[""]}),(0,I.gn)([(0,q.Ph)(x.Z.getOffice)],A.prototype,"puntoVenta$",void 0);const zt=[{path:"nuevo",component:g,canActivate:[a.P],data:{isEdit:!1,breadcrumb:[{label:"Operaciones"},{label:"Inventario"},{label:"Traslados de inventario"},{label:"Nuevo traslado"}]}},{path:"editar/:id",component:g,canActivate:[a.P],data:{isEdit:!0,breadcrumb:[{label:"Operaciones"},{label:"Inventario"},{label:"Traslados de inventario"},{label:"Editar traslado"}]}},{path:"enviar/:id",component:A,canActivate:[a.P],data:{title:"Atender solicitud de traslado",breadcrumb:[{label:"Operaciones"},{label:"Inventario"},{label:"Traslados de inventario"},{label:"Enviar traslado"}]}},{path:"recepcionar/:id",component:A,canActivate:[a.P],data:{title:"Recepcionar traslado",breadcrumb:[{label:"Operaciones"},{label:"Inventario"},{label:"Traslados de inventario"},{label:"Recepcionar traslado"}]}},{path:"",component:C,canActivate:[a.P],data:{breadcrumb:[{label:"Operaciones"},{label:"Inventario"},{label:"Traslados de inventario"}]}}];let Gt=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[T.Bz.forChild(zt)],T.Bz]}),o})();var Wt=l(20958),Xt=l(19406);let te=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[Wt.m,Gt,Xt.P]]}),o})()}}]);