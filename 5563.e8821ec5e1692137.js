"use strict";(self.webpackChunkmirage=self.webpackChunkmirage||[]).push([[5563],{75875:(B,q,p)=>{p.d(q,{d:()=>b});var e=p(70655),t=p(5e3),T=p(85932),v=p(81575),h=p(8929),A=p(7625),M=p(12216),C=p(59783),y=p(69808),U=p(4119),E=p(40845),G=p(12145),x=p(93075),S=p(9757),P=p(15315),O=p(31424),N=p(18872),F=p(98952),D=p(70050);const a=["searchInputModalRef"],g=["searchAutocompleteRef"];function s(m,l){if(1&m){const i=t.EpF();t.TgZ(0,"button",16),t.NdJ("click",function(){return t.CHM(i),t.oxw().emitAddItem()}),t.qZA()}if(2&m){const i=t.oxw();t.Q6J("disabled",i.disableAddItem)}}function I(m,l){if(1&m&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&m){const i=t.oxw().$implicit;t.xp6(1),t.hij("",i.codigo," - ")}}function _(m,l){if(1&m&&(t.TgZ(0,"span",19),t._UZ(1,"app-mostrar-stock",20),t.qZA()),2&m){const i=t.oxw().$implicit;t.xp6(1),t.Q6J("producto",i)}}function Y(m,l){if(1&m&&(t.YNc(0,I,2,1,"span",17),t._uU(1),t.YNc(2,_,2,1,"span",18)),2&m){const i=l.$implicit,c=t.oxw();t.Q6J("ngIf",i.codigo),t.xp6(1),t.hij("",i.nombre," "),t.xp6(1),t.Q6J("ngIf",c.configCompany.inventario)}}function L(m,l){1&m&&(t.TgZ(0,"th"),t._uU(1,"Stock"),t.qZA())}function Q(m,l){if(1&m&&(t.TgZ(0,"tr"),t.TgZ(1,"th"),t._uU(2,"C\xf3digo de barra"),t.qZA(),t.TgZ(3,"th"),t._uU(4,"Nombre"),t.qZA(),t.TgZ(5,"th"),t._uU(6,"Precio de venta"),t.qZA(),t.YNc(7,L,2,0,"th",17),t.TgZ(8,"th"),t._uU(9,"Seleccionar"),t.qZA(),t.qZA()),2&m){const i=t.oxw();t.xp6(7),t.Q6J("ngIf",i.configCompany.inventario)}}function R(m,l){if(1&m&&(t.TgZ(0,"td"),t._UZ(1,"app-mostrar-stock",24),t.qZA()),2&m){const i=t.oxw().$implicit;t.xp6(1),t.Q6J("producto",i)}}function z(m,l){if(1&m){const i=t.EpF();t.TgZ(0,"tr"),t.TgZ(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._UZ(6,"app-precio-producto-detalle",21),t.qZA(),t.YNc(7,R,2,1,"td",17),t.TgZ(8,"td",22),t.TgZ(9,"p-button",23),t.NdJ("onClick",function(){const K=t.CHM(i).$implicit;return t.oxw().emitProduct(K)}),t.qZA(),t.qZA(),t.qZA()}if(2&m){const i=l.$implicit,c=t.oxw();t.xp6(2),t.Oqu(i.codigoBarra),t.xp6(2),t.Oqu(i.nombre),t.xp6(2),t.Q6J("puntoVenta",c.puntoVenta)("producto",i),t.xp6(1),t.Q6J("ngIf",c.configCompany.inventario)}}const $=function(){return{width:"50vw"}},k=function(){return{height:"35vh"}};class b{constructor(l,i){this.productService=l,this.messageService=i,this.unsubscribe$=new h.xQ,this.displaySearchProduct=!1,this.filteredProducts=[],this.configCompany={},this.selectProduct=new t.vpe,this.addItem=new t.vpe}ngOnInit(){this.resultadoBusqueda=[],this.puntoVenta$.pipe((0,A.R)(this.unsubscribe$)).subscribe(l=>{this.puntoVenta=l}),this.configCompany$.pipe((0,A.R)(this.unsubscribe$)).subscribe(l=>{this.configCompany=l})}setFocusInput(){setTimeout(()=>{this.searchAutocompleteRef&&this.searchAutocompleteRef.focusInput()},30)}ngOnDestroy(){this.unsubscribe$.next(),this.unsubscribe$.complete()}get placeHolderBusqueda(){return"Ingrese t\xe9rmino de b\xfasqueda o c\xf3digo de barras"}get titleModal(){return this.titleModalSearch?this.titleModalSearch:"Buscar producto"}openDialogSearchProduct(){this.displaySearchProduct=!0,this.searchInput=void 0,this.resultadoBusqueda=[],this.setFocusInput(),this.autoSearchOnOpenModal&&this.searchProduct()}keyPressInputEvent(l){"Enter"===l.key&&(l.preventDefault(),this.searchProduct(!0))}inputEvent(){this.searchProduct()}changeTipoBusqueda(){this.searchInput="",setTimeout(()=>{this.searchInputModalRef.nativeElement.focus()},0)}searchProduct(l){let i=["paginacion=false","limit=50"];l?i.push(`codigoBarra=${this.searchInput}`):(this.searchInput&&i.push(`filterGlobal=${this.searchInput.replace("&","%26")}`),this.aditionalParamsGeneralSearch&&(i=[...i,...this.aditionalParamsGeneralSearch])),this.productService.findAllList(i.join("&")).subscribe(c=>{c.length||this.messageService.add({severity:"warn",summary:"B\xfasqueda de producto",detail:`Producto no encontrado (${this.searchInput})`}),1===c.length&&l&&this.emitProduct(c[0]),c.length>1&&l&&(this.displaySearchProduct=!0),this.resultadoBusqueda=c})}emitProduct(l){this.searchInput="",this.filteredProducts=[],this.searchInput="",this.setFocusInput(),this.selectProduct.emit(l),this.displaySearchProduct=!1}emitAddItem(){this.addItem.emit()}filterProductByCodigoAndNombre(l){let i=[`filterGlobal=${l.query.replace("&","%26")}`,"paginacion=false","limit=50"];this.aditionalParamsGeneralSearch&&(i=[...i,...this.aditionalParamsGeneralSearch]),this.productService.findAllList(i.join("&")).subscribe(c=>{this.filteredProducts=c})}}b.\u0275fac=function(l){return new(l||b)(t.Y36(M.M),t.Y36(C.ez))},b.\u0275cmp=t.Xpm({type:b,selectors:[["app-agregar-producto"]],viewQuery:function(l,i){if(1&l&&(t.Gf(a,5),t.Gf(g,5)),2&l){let c;t.iGM(c=t.CRH())&&(i.searchInputModalRef=c.first),t.iGM(c=t.CRH())&&(i.searchAutocompleteRef=c.first)}},inputs:{visibleAddItem:"visibleAddItem",aditionalParamsGeneralSearch:"aditionalParamsGeneralSearch",autoSearchOnOpenModal:"autoSearchOnOpenModal",titleModalSearch:"titleModalSearch",disableAddItem:"disableAddItem"},outputs:{selectProduct:"selectProduct",addItem:"addItem"},ngContentSelectors:["*"],decls:20,vars:19,consts:[[1,"p-inputgroup"],["tooltipPosition","top","pTooltip","Agregar item","pButton","","type","button","icon","fa fa-plus","class","p-button-success",3,"disabled","click",4,"ngIf"],[1,"p-fluid",2,"width","100%"],["field","nombre",3,"ngModel","suggestions","placeholder","minLength","onKeyUp","ngModelChange","onSelect","completeMethod"],["searchAutocompleteRef",""],["pTemplate","item"],["tooltipPosition","top","pTooltip","Abrir buscador","pButton","","type","button","icon","pi pi-search",3,"click"],["appendTo","body",3,"header","visible","modal","draggable","resizable","visibleChange"],[1,"grid","p-fluid"],[1,"col-12"],["type","text","pInputText","",2,"width","100%",3,"ngModel","placeholder","input","ngModelChange"],["searchInputModalRef",""],[3,"value"],["pTemplate","header"],["pTemplate","body"],["type","button","pButton","","icon","pi pi-times","label","Cerrar",1,"p-button-secondary",3,"click"],["tooltipPosition","top","pTooltip","Agregar item","pButton","","type","button","icon","fa fa-plus",1,"p-button-success",3,"disabled","click"],[4,"ngIf"],["class","ml-3",4,"ngIf"],[1,"ml-3"],["mostrar","tag",3,"producto"],[3,"puntoVenta","producto"],[2,"text-align","center"],["icon","pi pi-check",3,"onClick"],["mostrar","button",3,"producto"]],template:function(l,i){1&l&&(t.F$t(),t.TgZ(0,"div",0),t.YNc(1,s,1,1,"button",1),t.TgZ(2,"div",2),t.TgZ(3,"p-autoComplete",3,4),t.NdJ("onKeyUp",function(Z){return i.keyPressInputEvent(Z)})("ngModelChange",function(Z){return i.searchInput=Z})("onSelect",function(Z){return i.emitProduct(Z)})("completeMethod",function(Z){return i.filterProductByCodigoAndNombre(Z)}),t.YNc(5,Y,3,3,"ng-template",5),t.qZA(),t.qZA(),t.Hsn(6),t.TgZ(7,"button",6),t.NdJ("click",function(){return i.openDialogSearchProduct()}),t.qZA(),t.qZA(),t.TgZ(8,"p-dialog",7),t.NdJ("visibleChange",function(Z){return i.displaySearchProduct=Z}),t.TgZ(9,"div",8),t.TgZ(10,"div",9),t.TgZ(11,"input",10,11),t.NdJ("input",function(){return i.inputEvent()})("ngModelChange",function(Z){return i.searchInput=Z}),t.qZA(),t.qZA(),t.TgZ(13,"div",9),t.TgZ(14,"p-scrollPanel"),t.TgZ(15,"p-table",12),t.YNc(16,Q,10,1,"ng-template",13),t.YNc(17,z,10,5,"ng-template",14),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(18,"p-footer"),t.TgZ(19,"button",15),t.NdJ("click",function(){return i.displaySearchProduct=!1}),t.qZA(),t.qZA(),t.qZA()),2&l&&(t.xp6(1),t.Q6J("ngIf",i.visibleAddItem),t.xp6(2),t.Q6J("ngModel",i.searchInput)("suggestions",i.filteredProducts)("placeholder",i.placeHolderBusqueda)("minLength",1),t.xp6(5),t.Akn(t.DdM(17,$)),t.Q6J("header",i.titleModal)("visible",i.displaySearchProduct)("modal",!0)("draggable",!1)("resizable",!1),t.xp6(3),t.Q6J("ngModel",i.searchInput)("placeholder",i.placeHolderBusqueda),t.xp6(3),t.Akn(t.DdM(18,k)),t.xp6(1),t.Q6J("value",i.resultadoBusqueda))},directives:[y.O5,U.u,E.Hq,G.Qc,x.JJ,x.On,C.jx,S.d,P.V,x.Fj,O.o,N.P,F.iA,D.e,E.zx,C.$_],styles:[""]}),(0,e.gn)([(0,T.Ph)(v.Z.getOffice)],b.prototype,"puntoVenta$",void 0),(0,e.gn)([(0,T.Ph)(v.Z.getConfig)],b.prototype,"configCompany$",void 0)},7786:(B,q,p)=>{p.d(q,{a:()=>D});var e=p(5e3),t=p(69808),T=p(98952),v=p(59783);function h(a,g){if(1&a&&(e.TgZ(0,"div",4),e.TgZ(1,"label",5),e._uU(2,"Etiqueta agrupaci\xf3n"),e.qZA(),e.TgZ(3,"p",6),e._uU(4),e.qZA(),e.qZA()),2&a){const s=e.oxw(2);e.xp6(4),e.Oqu(null==s.grupo?null:s.grupo.etiqueta)}}function A(a,g){1&a&&(e.TgZ(0,"span"),e._uU(1,"Si"),e.qZA())}function M(a,g){1&a&&e._uU(0,"No")}function C(a,g){if(1&a&&(e.TgZ(0,"div",4),e.TgZ(1,"label",5),e._uU(2,"Forzar m\xednimo"),e.qZA(),e.TgZ(3,"p",6),e._uU(4),e.qZA(),e.qZA()),2&a){const s=e.oxw(2);e.xp6(4),e.Oqu(null==s.grupo?null:s.grupo.forzarMinimo)}}function y(a,g){if(1&a&&(e.TgZ(0,"div",4),e.TgZ(1,"label",5),e._uU(2,"Forzar m\xe1ximo"),e.qZA(),e.TgZ(3,"p",6),e._uU(4),e.qZA(),e.qZA()),2&a){const s=e.oxw(2);e.xp6(4),e.Oqu(null==s.grupo?null:s.grupo.forzarMaximo)}}function U(a,g){1&a&&(e.TgZ(0,"span"),e._uU(1,"Si"),e.qZA())}function E(a,g){1&a&&e._uU(0,"No")}function G(a,g){1&a&&(e.TgZ(0,"th"),e._uU(1,"Porci\xf3n"),e.qZA())}function x(a,g){if(1&a&&(e.TgZ(0,"tr"),e.YNc(1,G,2,0,"th",0),e.TgZ(2,"th"),e._uU(3,"Unidad"),e.qZA(),e.TgZ(4,"th"),e._uU(5,"Producto"),e.qZA(),e.TgZ(6,"th"),e._uU(7,"Por defecto"),e.qZA(),e.TgZ(8,"th"),e._uU(9,"Orden"),e.qZA(),e.TgZ(10,"th"),e._uU(11,"Nombre opci\xf3n"),e.qZA(),e.TgZ(12,"th"),e._uU(13,"Costo adicional"),e.qZA(),e.qZA()),2&a){const s=e.oxw(2);e.xp6(1),e.Q6J("ngIf","INSUMO"===s.grupo.tipo)}}function S(a,g){if(1&a&&(e.TgZ(0,"td"),e._uU(1),e.qZA()),2&a){const s=e.oxw().$implicit;e.xp6(1),e.Oqu(s.porcion)}}function P(a,g){1&a&&(e.TgZ(0,"span"),e._uU(1,"Si"),e.qZA())}function O(a,g){1&a&&e._uU(0,"No")}function N(a,g){if(1&a&&(e.TgZ(0,"tr"),e.YNc(1,S,2,1,"td",0),e.TgZ(2,"td"),e._uU(3),e.qZA(),e.TgZ(4,"td"),e._uU(5),e.qZA(),e.TgZ(6,"td"),e.YNc(7,P,2,0,"span",7),e.YNc(8,O,1,0,"ng-template",null,14,e.W1O),e.qZA(),e.TgZ(10,"td"),e._uU(11),e.qZA(),e.TgZ(12,"td"),e._uU(13),e.qZA(),e.TgZ(14,"td"),e._uU(15),e.qZA(),e.qZA()),2&a){const s=g.$implicit,I=e.MAs(9),_=e.oxw(2);e.xp6(1),e.Q6J("ngIf","INSUMO"===_.grupo.tipo),e.xp6(2),e.Oqu(s.producto.unidad.descripcion),e.xp6(2),e.Oqu(s.producto.nombre),e.xp6(2),e.Q6J("ngIf",s.porDefecto)("ngIfElse",I),e.xp6(4),e.Oqu(s.orden),e.xp6(2),e.Oqu(s.nombre),e.xp6(2),e.Oqu(s.precio)}}function F(a,g){if(1&a&&(e.TgZ(0,"div"),e.TgZ(1,"h1",1),e._uU(2),e.qZA(),e.TgZ(3,"div",2),e.YNc(4,h,5,1,"div",3),e.TgZ(5,"div",4),e.TgZ(6,"label",5),e._uU(7,"Elecci\xf3n obligatoria"),e.qZA(),e.TgZ(8,"p",6),e.YNc(9,A,2,0,"span",7),e.YNc(10,M,1,0,"ng-template",null,8,e.W1O),e.qZA(),e.qZA(),e.YNc(12,C,5,1,"div",3),e.YNc(13,y,5,1,"div",3),e.TgZ(14,"div",4),e.TgZ(15,"label",5),e._uU(16,"Permitir cantidad"),e.qZA(),e.TgZ(17,"p",6),e.YNc(18,U,2,0,"span",7),e.YNc(19,E,1,0,"ng-template",null,9,e.W1O),e.qZA(),e.qZA(),e.TgZ(21,"div",10),e.TgZ(22,"p-table",11),e.YNc(23,x,14,1,"ng-template",12),e.YNc(24,N,16,8,"ng-template",13),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&a){const s=e.MAs(11),I=e.MAs(20),_=e.oxw();e.xp6(2),e.hij(" ",_.grupo.nombre,""),e.xp6(2),e.Q6J("ngIf",null==_.grupo?null:_.grupo.etiqueta),e.xp6(5),e.Q6J("ngIf",null==_.grupo?null:_.grupo.requerido)("ngIfElse",s),e.xp6(3),e.Q6J("ngIf",null==_.grupo?null:_.grupo.requerido),e.xp6(1),e.Q6J("ngIf",null==_.grupo?null:_.grupo.requerido),e.xp6(5),e.Q6J("ngIf",null==_.grupo?null:_.grupo.permitirCantidad)("ngIfElse",I),e.xp6(4),e.Q6J("value",_.grupo.opciones)}}let D=(()=>{class a{constructor(){}ngOnInit(){this.grupo||(this.grupo={nombre:"Agregar cebolla",etiqueta:"",forzarMinimo:1,forzarMaximo:1,orden:1,requerido:!0,permitirCantidad:!1,tipo:"INSUMO",opciones:[{nombre:"Cebolla",producto:{nombre:"Cebolla",unidad:{descripcion:"Gramo"}},porcion:1,orden:1,precio:0,porDefecto:!1},{nombre:"Tomate",producto:{nombre:"Tomate",unidad:{descripcion:"Gramo"}},porcion:1,orden:1,precio:5,porDefecto:!0}]})}}return a.\u0275fac=function(s){return new(s||a)},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-grupo-item"]],inputs:{grupo:"grupo"},decls:1,vars:1,consts:[[4,"ngIf"],[2,"margin-top","0"],[1,"grid"],["class","col-6 md:col-3",4,"ngIf"],[1,"col-6","md:col-3"],[1,"label-form","text-bold"],[1,"mt-0"],[4,"ngIf","ngIfElse"],["noRequired",""],["noQty",""],[1,"col-12"],[3,"value"],["pTemplate","header"],["pTemplate","body"],["noDefault",""]],template:function(s,I){1&s&&e.YNc(0,F,25,9,"div",0),2&s&&e.Q6J("ngIf",I.grupo)},directives:[t.O5,T.iA,v.jx],styles:[""]}),a})()},25563:(B,q,p)=>{p.d(q,{L:()=>se});var e=p(5e3),t=p(93075),T=p(82817),v=p(59783),h=p(75726),A=p(45330),M=p(17102),C=p(69808),y=p(43724),U=p(31424),E=p(42841),G=p(20657),x=p(74297),S=p(75875),P=p(98952),O=p(4119),N=p(40845),F=p(2836);function D(n,u){1&n&&e._UZ(0,"p-message",33)}function a(n,u){1&n&&e._UZ(0,"p-message",34)}function g(n,u){1&n&&e._UZ(0,"p-message",35)}function s(n,u){1&n&&e._UZ(0,"p-message",36)}function I(n,u){1&n&&e._UZ(0,"p-message",37)}function _(n,u){1&n&&e._UZ(0,"p-message",41)}function Y(n,u){if(1&n&&(e.TgZ(0,"div",6),e.TgZ(1,"label",38),e._uU(2,"Opciones m\xednimas (*)"),e.qZA(),e._UZ(3,"input",39),e.YNc(4,_,1,0,"p-message",40),e.qZA()),2&n){const o=e.oxw();e.xp6(4),e.Q6J("ngIf",o.modelForm.get("forzarMinimo").touched&&(null==o.modelForm.get("forzarMinimo").errors?null:o.modelForm.get("forzarMinimo").errors.required))}}function L(n,u){1&n&&e._UZ(0,"p-message",45)}function Q(n,u){if(1&n&&(e.TgZ(0,"div",6),e.TgZ(1,"label",42),e._uU(2,"Opciones m\xe1ximas (*)"),e.qZA(),e._UZ(3,"input",43),e.YNc(4,L,1,0,"p-message",44),e.qZA()),2&n){const o=e.oxw();e.xp6(4),e.Q6J("ngIf",o.modelForm.get("forzarMaximo").touched&&(null==o.modelForm.get("forzarMaximo").errors?null:o.modelForm.get("forzarMaximo").errors.required))}}function R(n,u){1&n&&(e.TgZ(0,"tr"),e.TgZ(1,"th"),e._uU(2,"Tipo"),e.qZA(),e.TgZ(3,"th"),e._uU(4,"Porci\xf3n"),e.qZA(),e.TgZ(5,"th"),e._uU(6,"Unidad"),e.qZA(),e.TgZ(7,"th"),e._uU(8,"Producto"),e.qZA(),e.TgZ(9,"th"),e._uU(10,"Seleccionado por defecto"),e.qZA(),e.TgZ(11,"th"),e._uU(12,"Orden"),e.qZA(),e.TgZ(13,"th"),e._uU(14,"Nombre a mostrar"),e.qZA(),e.TgZ(15,"th"),e._uU(16,"Costo adicional"),e.qZA(),e.TgZ(17,"th"),e._uU(18,"Acciones"),e.qZA(),e.qZA())}function z(n,u){1&n&&e._UZ(0,"input",59)}function $(n,u){if(1&n&&(e._uU(0),e._UZ(1,"i",60)),2&n){const o=e.oxw(2).$implicit;e.hij(" ",o.get("porcion").value," ")}}function k(n,u){1&n&&e._UZ(0,"p-message",61)}function w(n,u){if(1&n&&(e.TgZ(0,"td",51),e.TgZ(1,"p-cellEditor"),e.YNc(2,z,1,0,"ng-template",52),e.YNc(3,$,2,1,"ng-template",53),e.qZA(),e.YNc(4,k,1,0,"p-message",58),e.qZA()),2&n){const o=e.oxw().$implicit;e.xp6(4),e.Q6J("ngIf",o.get("porcion").touched&&(null==o.get("porcion").errors?null:o.get("porcion").errors.required))}}function b(n,u){if(1&n&&(e.TgZ(0,"td"),e._uU(1),e.qZA()),2&n){const o=e.oxw().$implicit;e.xp6(1),e.hij(" ",o.get("porcion").value," ")}}function m(n,u){1&n&&e._UZ(0,"input",62)}function l(n,u){if(1&n&&(e._uU(0),e._UZ(1,"i",60)),2&n){const o=e.oxw().$implicit;e.hij(" ",o.get("orden").value," ")}}function i(n,u){1&n&&e._UZ(0,"p-message",63)}function c(n,u){1&n&&e._UZ(0,"input",64)}function Z(n,u){if(1&n&&(e._uU(0),e._UZ(1,"i",60)),2&n){const o=e.oxw().$implicit;e.hij(" ",o.get("nombre").value," ")}}function K(n,u){1&n&&e._UZ(0,"p-message",65)}function j(n,u){1&n&&e._UZ(0,"input",66)}function X(n,u){if(1&n&&(e._uU(0),e._UZ(1,"i",60)),2&n){const o=e.oxw().$implicit;e.hij(" ",o.get("precio").value," ")}}function ee(n,u){1&n&&e._UZ(0,"p-message",67)}const te=function(){return{width:"100px"}};function oe(n,u){if(1&n){const o=e.EpF();e.TgZ(0,"tr",46),e.TgZ(1,"td"),e._uU(2),e.ALo(3,"tipoProducto"),e.qZA(),e.YNc(4,w,5,1,"td",47),e.YNc(5,b,2,1,"td",48),e.TgZ(6,"td"),e._uU(7),e.qZA(),e.TgZ(8,"td"),e._uU(9),e.qZA(),e.TgZ(10,"td",49),e._UZ(11,"p-toggleButton",50),e.qZA(),e.TgZ(12,"td",51),e.TgZ(13,"p-cellEditor"),e.YNc(14,m,1,0,"ng-template",52),e.YNc(15,l,2,1,"ng-template",53),e.qZA(),e.YNc(16,i,1,0,"p-message",54),e.qZA(),e.TgZ(17,"td",51),e.TgZ(18,"p-cellEditor"),e.YNc(19,c,1,0,"ng-template",52),e.YNc(20,Z,2,1,"ng-template",53),e.qZA(),e.YNc(21,K,1,0,"p-message",55),e.qZA(),e.TgZ(22,"td",51),e.TgZ(23,"p-cellEditor"),e.YNc(24,j,1,0,"ng-template",52),e.YNc(25,X,2,1,"ng-template",53),e.qZA(),e.YNc(26,ee,1,0,"p-message",56),e.qZA(),e.TgZ(27,"td",49),e.TgZ(28,"button",57),e.NdJ("click",function(){const f=e.CHM(o).rowIndex;return e.oxw().deleteItemOptionForm(f)}),e.qZA(),e.qZA(),e.qZA()}if(2&n){const r=u.$implicit;e.Q6J("formGroupName",u.rowIndex),e.xp6(2),e.hij(" ",e.lcZ(3,11,r.get("producto").value.tipoProducto)," "),e.xp6(2),e.Q6J("ngIf","INSUMO"===r.get("producto").value.tipoProducto),e.xp6(1),e.Q6J("ngIf","INSUMO"!==r.get("producto").value.tipoProducto),e.xp6(2),e.hij(" ",null==r.get("producto").value||null==r.get("producto").value.unidad?null:r.get("producto").value.unidad.descripcion,""),e.xp6(2),e.Oqu(null==r.get("producto").value?null:r.get("producto").value.nombre),e.xp6(2),e.Akn(e.DdM(13,te)),e.xp6(5),e.Q6J("ngIf",r.get("orden").touched&&(null==r.get("orden").errors?null:r.get("orden").errors.required)),e.xp6(5),e.Q6J("ngIf",r.get("nombre").touched&&(null==r.get("nombre").errors?null:r.get("nombre").errors.required)),e.xp6(5),e.Q6J("ngIf",r.get("precio").touched&&(null==r.get("precio").errors?null:r.get("precio").errors.required))}}const H=function(){return{width:"100%"}};let V=(()=>{class n{constructor(o,r,d,f,J,W){this.fb=o,this.messageService=r,this.groupService=d,this.confirmationService=f,this.ref=J,this.config=W}ngOnInit(){this.tiposProducto=[{label:"Platillo",value:"PLATILLO"},{label:"Insumo",value:"INSUMO"},{label:"Art\xedculo",value:"ARTICULO"}],this.tiposGrupo=[{label:"Insumo",value:"INSUMO"},{label:"Mezclador",value:"MEZCLADOR"}],this.builderForm(),this.changeTipoProducto(),this.loadModelForEdit()}builderForm(){this.modelForm=this.fb.group({nombre:[void 0,[t.kI.required]],etiqueta:[void 0,[]],requerido:[!1,[t.kI.required]],forzarMinimo:[1,[t.kI.required,t.kI.min(1)]],forzarMaximo:[1,[t.kI.required,t.kI.min(1)]],permitirCantidad:[!1,[t.kI.required]],tipo:["MEZCLADOR",[t.kI.required]],opciones:this.fb.array([]),tipoProducto:["PLATILLO",[]]}),this.modelForm.get("tipo").valueChanges.subscribe(o=>{"INSUMO"===o?(this.modelForm.patchValue({tipoProducto:"INSUMO"}),this.modelForm.get("tipoProducto").disable()):this.modelForm.get("tipoProducto").enable(),this.changeTipoProducto()})}changeRequerido(o){o.checked||this.modelForm.patchValue({forzarMinimo:1,forzarMaximo:1})}changeTipoProducto(){const o=this.modelForm.get("tipoProducto").value;switch(this.aditionalParamsSearchProduct=[`tipo=${o}`],o){case"PLATILLO":this.titleModalSearchProduct="Buscar platillo";break;case"INSUMO":this.titleModalSearchProduct="Buscar insumo";break;case"ARTICULO":this.titleModalSearchProduct="Buscar art\xedculo";break;default:this.titleModalSearchProduct="Buscar producto"}}registrar(){(0,T.c2)(this.modelForm),this.modelForm.valid?this.confirmationService.confirm({message:`\xbfEst\xe1 seguro de ${this.isEdit?"actualizar":"registrar"} la grupo actual?`,accept:()=>{this.formToModel(),(this.isEdit?this.groupService.update(this.model.id,this.model):this.groupService.save(this.model)).subscribe(o=>{this.ref.close(o)})},acceptLabel:"Si",rejectLabel:"No"}):this.messageService.add({severity:"error",summary:"Error",detail:"Complete campos obligatorios (*)"})}cancel(){this.ref.close()}get isEdit(){return this.config.data.isEdit}get titleButtonAction(){return this.isEdit?"Actualizar grupo":"Registrar grupo"}get modelFormOptions(){return this.modelForm.get("opciones")}addItemOptionFormByProduct(o){this.addItemOptionForm({producto:o})}addItemOptionForm(o){this.modelFormOptions.push(this.createItemOptionForm(o))}deleteItemOptionForm(o){this.modelFormOptions.removeAt(o)}createItemOptionForm(o){return this.fb.group({id:[o.id,[]],nombre:[o.nombre?o.nombre:`Agregar ${o.producto.nombre}`,[t.kI.required]],producto:[o.producto,[t.kI.required]],porcion:[o.porcion?o.porcion:1,[t.kI.required]],precio:[o.precio?o.precio:0,[t.kI.required]],porDefecto:[!!o.porDefecto&&o.porDefecto,[t.kI.required]],orden:[o.orden,[t.kI.required]]})}formToModel(){const o=this.modelForm.getRawValue();this.model||(this.model={}),this.model.nombre=o.nombre,this.model.etiqueta=o.etiqueta,this.model.requerido=o.requerido,this.model.forzarMinimo=o.forzarMinimo,this.model.forzarMaximo=o.forzarMaximo,this.model.permitirCantidad=o.permitirCantidad,this.model.tipo=o.tipo,this.model.opciones=[],o.opciones.forEach(r=>{this.model.opciones.push(r)})}modelToForm(o){this.model=o,this.modelForm.patchValue({nombre:o.nombre,etiqueta:o.etiqueta,requerido:o.requerido,forzarMinimo:o.forzarMinimo,forzarMaximo:o.forzarMaximo,permitirCantidad:o.permitirCantidad,tipo:o.tipo}),o.opciones.forEach(r=>{this.modelFormOptions.push(this.createItemOptionForm(r))})}loadModelForEdit(){const o=this.config.data.id;o&&setTimeout(()=>this.groupService.findById(o).subscribe(r=>{this.model=r,this.modelToForm(r)}))}}return n.\u0275fac=function(o){return new(o||n)(e.Y36(t.qu),e.Y36(v.ez),e.Y36(h.l),e.Y36(v.YP),e.Y36(A.E7),e.Y36(A.S))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-grupo"]],decls:49,vars:24,consts:[["novalidate","",3,"formGroup"],[1,"grid"],[1,"col-12","md:col-6","lg:col-3","p-fluid"],["for","nombre",1,"label-form"],["formControlName","tipo",3,"options"],["severity","error","text","Ingrese tipo",4,"ngIf"],[1,"col-12","md:col-6","lg:col-3"],["formControlName","nombre","id","nombre","type","text","pInputText","",2,"width","100%","margin-bottom","0.2em"],["severity","error","text","Ingrese nombre",4,"ngIf"],["for","etiqueta",1,"label-form"],["formControlName","etiqueta","id","etiqueta","type","text","pInputText","",2,"width","100%","margin-bottom","0.2em"],["severity","error","text","Ingrese etiqueta",4,"ngIf"],["for","permitirCantidad",1,"label-form"],["id","permitirCantidad","onLabel","Si","offLabel","No","formControlName","permitirCantidad",3,"onChange"],["severity","error","text","Defina si se permite cantidad en cada opci\xf3n",4,"ngIf"],["for","requerido",1,"label-form"],["id","requerido","onLabel","Si","offLabel","No","formControlName","requerido",3,"onChange"],["severity","error","text","Defina si es obligatorio",4,"ngIf"],["class","col-12 md:col-6 lg:col-3",4,"ngIf"],[1,"col-12"],["for","opciones",1,"label-form"],["id","opciones",1,"grid"],[1,"col-6"],["formControlName","tipoProducto",3,"options","onChange"],[3,"titleModalSearch","autoSearchOnOpenModal","aditionalParamsGeneralSearch","visibleAddItem","selectProduct"],[1,"mb-2"],["severity","info","text","Click en el lapiz para editar."],["formArrayName","opciones",3,"value","rows","responsive"],["pTemplate","header"],["pTemplate","body"],[1,"col-12","space-buttons",2,"text-align","center"],["pButton","","type","button","label","Cancelar",1,"p-button-secondary",3,"click"],["pButton","","type","button",3,"label","click"],["severity","error","text","Ingrese tipo"],["severity","error","text","Ingrese nombre"],["severity","error","text","Ingrese etiqueta"],["severity","error","text","Defina si se permite cantidad en cada opci\xf3n"],["severity","error","text","Defina si es obligatorio"],["for","forzarMinimo",1,"label-form"],["formControlName","forzarMinimo","pKeyFilter","num","id","forzarMinimo","type","text","pInputText","",2,"width","100%","margin-bottom","0.2em"],["severity","error","text","Ingrese opciones m\xednimas",4,"ngIf"],["severity","error","text","Ingrese opciones m\xednimas"],["for","forzarMaximo",1,"label-form"],["formControlName","forzarMaximo","pKeyFilter","num","id","forzarMaximo","type","text","pInputText","",2,"width","100%","margin-bottom","0.2em"],["severity","error","text","Ingrese opciones m\xe1ximas",4,"ngIf"],["severity","error","text","Ingrese opciones m\xe1ximas"],[3,"formGroupName"],["pEditableColumn","",4,"ngIf"],[4,"ngIf"],[2,"text-align","center"],["formControlName","porDefecto","onLabel","Si","offLabel","No"],["pEditableColumn",""],["pTemplate","input"],["pTemplate","output"],["severity","error","text","Ingrese orden",4,"ngIf"],["severity","error","text","Ingrese nombre a mostrar",4,"ngIf"],["severity","error","text","Ingrese costo adicional",4,"ngIf"],["pTooltip","Eliminar","pButton","","type","button","icon","pi pi-trash",1,"p-button-danger","lrm-1",3,"click"],["severity","error","text","Ingrese porci\xf3n",4,"ngIf"],["type","text","pInputText","","formControlName","porcion","pKeyFilter","num"],[1,"pi","pi-pencil",2,"font-size","1.5em","float","right"],["severity","error","text","Ingrese porci\xf3n"],["type","text","pInputText","","formControlName","orden","pKeyFilter","num"],["severity","error","text","Ingrese orden"],["type","text","pInputText","","formControlName","nombre"],["severity","error","text","Ingrese nombre a mostrar"],["type","text","pInputText","","formControlName","precio","pKeyFilter","num"],["severity","error","text","Ingrese costo adicional"]],template:function(o,r){1&o&&(e.TgZ(0,"form",0),e.TgZ(1,"div",1),e.TgZ(2,"div",2),e.TgZ(3,"label",3),e._uU(4,"Tipo (*)"),e.qZA(),e._UZ(5,"p-selectButton",4),e.YNc(6,D,1,0,"p-message",5),e.qZA(),e.TgZ(7,"div",6),e.TgZ(8,"label",3),e._uU(9,"Nombre (*)"),e.qZA(),e._UZ(10,"input",7),e.YNc(11,a,1,0,"p-message",8),e.qZA(),e.TgZ(12,"div",6),e.TgZ(13,"label",9),e._uU(14,"Etiqueta de agrupaci\xf3n"),e.qZA(),e._UZ(15,"input",10),e.YNc(16,g,1,0,"p-message",11),e.qZA(),e.TgZ(17,"div",6),e.TgZ(18,"label",12),e._uU(19,"Permitir cantidad en cada opci\xf3n (*)"),e.qZA(),e.TgZ(20,"div"),e.TgZ(21,"p-toggleButton",13),e.NdJ("onChange",function(f){return r.changeRequerido(f)}),e.qZA(),e.qZA(),e.YNc(22,s,1,0,"p-message",14),e.qZA(),e.TgZ(23,"div",6),e.TgZ(24,"label",15),e._uU(25,"Selecci\xf3n obligatoria (*)"),e.qZA(),e.TgZ(26,"div"),e.TgZ(27,"p-toggleButton",16),e.NdJ("onChange",function(f){return r.changeRequerido(f)}),e.qZA(),e.qZA(),e.YNc(28,I,1,0,"p-message",17),e.qZA(),e.YNc(29,Y,5,1,"div",18),e.YNc(30,Q,5,1,"div",18),e.TgZ(31,"div",19),e.TgZ(32,"label",20),e._uU(33,"Opciones"),e.qZA(),e.TgZ(34,"p-card"),e.TgZ(35,"div",21),e.TgZ(36,"div",22),e.TgZ(37,"p-selectButton",23),e.NdJ("onChange",function(){return r.changeTipoProducto()}),e.qZA(),e.qZA(),e.TgZ(38,"div",22),e.TgZ(39,"app-agregar-producto",24),e.NdJ("selectProduct",function(f){return r.addItemOptionFormByProduct(f)}),e.qZA(),e.qZA(),e.TgZ(40,"div",19),e.TgZ(41,"div",25),e._UZ(42,"p-message",26),e.qZA(),e.TgZ(43,"p-table",27),e.YNc(44,R,19,0,"ng-template",28),e.YNc(45,oe,29,14,"ng-template",29),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(46,"div",30),e.TgZ(47,"button",31),e.NdJ("click",function(){return r.cancel()}),e.qZA(),e.TgZ(48,"button",32),e.NdJ("click",function(){return r.registrar()}),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&o&&(e.Q6J("formGroup",r.modelForm),e.xp6(5),e.Q6J("options",r.tiposGrupo),e.xp6(1),e.Q6J("ngIf",r.modelForm.get("tipo").touched&&(null==r.modelForm.get("tipo").errors?null:r.modelForm.get("tipo").errors.required)),e.xp6(5),e.Q6J("ngIf",r.modelForm.get("nombre").touched&&(null==r.modelForm.get("nombre").errors?null:r.modelForm.get("nombre").errors.required)),e.xp6(5),e.Q6J("ngIf",r.modelForm.get("etiqueta").touched&&(null==r.modelForm.get("etiqueta").errors?null:r.modelForm.get("etiqueta").errors.required)),e.xp6(5),e.Akn(e.DdM(22,H)),e.xp6(1),e.Q6J("ngIf",r.modelForm.get("permitirCantidad").touched&&(null==r.modelForm.get("permitirCantidad").errors?null:r.modelForm.get("permitirCantidad").errors.required)),e.xp6(5),e.Akn(e.DdM(23,H)),e.xp6(1),e.Q6J("ngIf",r.modelForm.get("requerido").touched&&(null==r.modelForm.get("requerido").errors?null:r.modelForm.get("requerido").errors.required)),e.xp6(1),e.Q6J("ngIf",r.modelForm.get("requerido").value),e.xp6(1),e.Q6J("ngIf",r.modelForm.get("requerido").value),e.xp6(7),e.Q6J("options",r.tiposProducto),e.xp6(2),e.Q6J("titleModalSearch",r.titleModalSearchProduct)("autoSearchOnOpenModal",!0)("aditionalParamsGeneralSearch",r.aditionalParamsSearchProduct)("visibleAddItem",!1),e.xp6(4),e.Q6J("value",r.modelFormOptions.controls)("rows",10)("responsive",!0),e.xp6(5),e.Q6J("label",r.titleButtonAction))},directives:[t._Y,t.JL,t.sg,M.UN,t.JJ,t.u,C.O5,y.q,t.Fj,U.o,E.CO,G.Fr,x.Z,S.d,P.iA,t.CE,v.jx,t.x0,P.Wq,P.YL,O.u,N.Hq],pipes:[F.z],styles:[""]}),n})();var re=p(74202),ne=p(47745),ie=p(7786);function pe(n,u){if(1&n){const o=e.EpF();e.TgZ(0,"button",13),e.NdJ("click",function(){e.CHM(o);const d=e.oxw().$implicit;return e.oxw().select(d)}),e.qZA()}}function ae(n,u){if(1&n){const o=e.EpF();e.TgZ(0,"button",14),e.NdJ("click",function(){e.CHM(o);const d=e.oxw().$implicit;return e.oxw().openModalEditGroup(d)}),e.qZA()}}function ue(n,u){if(1&n){const o=e.EpF();e.TgZ(0,"button",15),e.NdJ("click",function(){e.CHM(o);const d=e.oxw().$implicit;return e.oxw().confirmDelete(d)}),e.qZA()}}function le(n,u){if(1&n&&(e.TgZ(0,"div",4),e.TgZ(1,"p-card"),e.TgZ(2,"div",0),e.TgZ(3,"div",1),e._UZ(4,"app-grupo-item",8),e.qZA(),e.TgZ(5,"div",9),e.YNc(6,pe,1,0,"button",10),e.YNc(7,ae,1,0,"button",11),e.YNc(8,ue,1,0,"button",12),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&n){const o=u.$implicit,r=e.oxw();e.xp6(4),e.Q6J("grupo",o),e.xp6(2),e.Q6J("ngIf",r.isModal),e.xp6(1),e.Q6J("ngIf",!r.isModal),e.xp6(1),e.Q6J("ngIf",!r.isModal)}}let se=(()=>{class n{constructor(o,r,d,f,J,W){this.route=o,this.breadcrumbService=r,this.confirmationService=d,this.groupService=f,this.dialogService=J,this.messageService=W,this.selectGroup=new e.vpe}ngOnInit(){this.tipoGrupo="all",this.tiposGrupo=[{label:"Todos",value:"all"},{label:"Insumo",value:"INSUMO"},{label:"Mezclador",value:"MEZCLADOR"}],this.isModal||this.breadcrumbService.setItems((0,T.kn)(this.route)),this.loadGroups()}loadGroups(){const o=[];this.nombre&&o.push(`nombre=${this.nombre}`),"all"!==this.tipoGrupo&&o.push(`tipo=${this.tipoGrupo}`),setTimeout(()=>this.groupService.findAll(o.join("&")).subscribe(r=>this.groups=r))}confirmDelete(o){this.confirmationService.confirm({message:"\xbfEst\xe1 seguro de eliminar este grupo?",accept:()=>{this.groupService.delete(o.id).subscribe(()=>{this.messageService.clear(),this.messageService.add({severity:"success",summary:"Mensaje",detail:"Grupo eliminada correctamente"}),this.loadGroups()})},acceptLabel:"Si",rejectLabel:"No"})}select(o){this.selectGroup.emit(o)}openModalNewGroup(){this.dialogService.open(V,{data:{isEdit:!1,tipo:this.tipoGrupo},header:"Nuevo grupo",width:"80%"}).onClose.subscribe(r=>{r&&(this.messageService.add({severity:"success",summary:"Registro de grupo",detail:"Grupo registrada correctamente."}),this.loadGroups())})}openModalEditGroup(o){this.dialogService.open(V,{data:{isEdit:!0,id:o.id},header:"Editar grupo",width:"80%"}).onClose.subscribe(d=>{d&&(this.messageService.add({severity:"success",summary:"Registro de grupo",detail:"Grupo actualizada correctamente."}),this.loadGroups())})}}return n.\u0275fac=function(o){return new(o||n)(e.Y36(re.gz),e.Y36(ne.p),e.Y36(v.YP),e.Y36(h.l),e.Y36(A.xA),e.Y36(v.ez))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-grupos"]],inputs:{isModal:"isModal"},outputs:{selectGroup:"selectGroup"},decls:11,vars:3,consts:[[1,"grid"],[1,"col-12"],["pButton","","type","button","icon","pi pi-plus","label","Nuevo grupo",3,"click"],[1,"grid","p-fluid"],[1,"col-12","md:col-6"],[3,"options","ngModel","onChange","ngModelChange"],["type","text","pInputText","","placeholder","Buscar por nombre",2,"width","100%",3,"input"],["class","col-12 md:col-6",4,"ngFor","ngForOf"],[3,"grupo"],[1,"col-12","center","space-buttons"],["pButton","","type","button","class","lrm-1","icon","pi pi-check","pTooltip","Seleccionar",3,"click",4,"ngIf"],["pButton","","type","button","icon","pi pi-pencil","pTooltip","Editar",3,"click",4,"ngIf"],["pTooltip","Eliminar","class","p-button-danger","pButton","","type","button","icon","pi pi-trash",3,"click",4,"ngIf"],["pButton","","type","button","icon","pi pi-check","pTooltip","Seleccionar",1,"lrm-1",3,"click"],["pButton","","type","button","icon","pi pi-pencil","pTooltip","Editar",3,"click"],["pTooltip","Eliminar","pButton","","type","button","icon","pi pi-trash",1,"p-button-danger",3,"click"]],template:function(o,r){1&o&&(e.TgZ(0,"p-card"),e.TgZ(1,"div",0),e.TgZ(2,"div",1),e.TgZ(3,"button",2),e.NdJ("click",function(){return r.openModalNewGroup()}),e.qZA(),e.qZA(),e.TgZ(4,"div",1),e.TgZ(5,"div",3),e.TgZ(6,"div",4),e.TgZ(7,"p-selectButton",5),e.NdJ("onChange",function(){return r.loadGroups()})("ngModelChange",function(f){return r.tipoGrupo=f}),e.qZA(),e.qZA(),e.TgZ(8,"div",4),e.TgZ(9,"input",6),e.NdJ("input",function(){return r.loadGroups()}),e.qZA(),e.qZA(),e.YNc(10,le,9,4,"div",7),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&o&&(e.xp6(7),e.Q6J("options",r.tiposGrupo)("ngModel",r.tipoGrupo),e.xp6(3),e.Q6J("ngForOf",r.groups))},directives:[x.Z,N.Hq,M.UN,t.JJ,t.On,U.o,C.sg,ie.a,C.O5,O.u],styles:[""]}),n})()},2836:(B,q,p)=>{p.d(q,{z:()=>t});var e=p(5e3);let t=(()=>{class T{transform(h,A){return"ARTICULO"===h?"Art\xedculo":"PAQUETE"===h?"Paquete":"PLATILLO"===h?"Platillo":"INSUMO"===h?"Insumo":"COMBO"===h?"Combo":"PLAN"===h?"Plan":""}}return T.\u0275fac=function(h){return new(h||T)},T.\u0275pipe=e.Yjl({name:"tipoProducto",type:T,pure:!0}),T})()}}]);