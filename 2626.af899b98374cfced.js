"use strict";(self.webpackChunkmirage=self.webpackChunkmirage||[]).push([[2626],{12626:(pe,_,r)=>{r.r(_),r.d(_,{SeriesModule:()=>ae});var c=r(74202),f=r(82817),e=r(5e3),v=r(23763),b=r(96310),S=r(20207),Z=r(47745),T=r(74297),A=r(14036),s=r(93075),u=r(98952),d=r(59783),m=r(69808),x=r(40845),I=r(4119),D=r(2314);const J=["dt"];function w(o,i){if(1&o&&e._UZ(0,"p-sortIcon",13),2&o){const t=e.oxw().$implicit;e.Q6J("field",t.field)}}function L(o,i){if(1&o&&(e.TgZ(0,"th",11),e._uU(1),e.YNc(2,w,1,1,"p-sortIcon",12),e.qZA()),2&o){const t=i.$implicit;e.Q6J("pSortableColumn",t.field),e.xp6(1),e.hij(" ",t.header," "),e.xp6(1),e.Q6J("ngIf",!t.isActions)}}function N(o,i){if(1&o&&(e.TgZ(0,"tr"),e.YNc(1,L,3,3,"th",10),e.qZA()),2&o){const t=i.$implicit;e.xp6(1),e.Q6J("ngForOf",t)}}function Y(o,i){if(1&o&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&o){const t=e.oxw(3).$implicit,n=e.oxw().$implicit;e.xp6(1),e.Oqu(n[t.field].nombre)}}function E(o,i){if(1&o&&(e.ynx(0),e.TgZ(1,"span",20),e._uU(2,"Punto de Venta"),e.qZA(),e.YNc(3,Y,2,1,"span",16),e.BQk()),2&o){const t=e.oxw(2).$implicit,n=e.oxw().$implicit;e.xp6(3),e.Q6J("ngIf",n[t.field])}}function V(o,i){if(1&o&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"tipoDocumento"),e.qZA()),2&o){const t=e.oxw(3).$implicit,n=e.oxw().$implicit;e.xp6(1),e.Oqu(e.lcZ(2,1,n[t.field]))}}function Q(o,i){if(1&o&&(e.ynx(0),e.TgZ(1,"span",20),e._uU(2,"Tipo Documento"),e.qZA(),e.YNc(3,V,3,3,"span",16),e.BQk()),2&o){const t=e.oxw(2).$implicit,n=e.oxw().$implicit;e.xp6(3),e.Q6J("ngIf",n[t.field])}}function F(o,i){if(1&o&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&o){const t=e.oxw(4).$implicit;e.xp6(1),e.Oqu(t.numero)}}function U(o,i){if(1&o&&(e.ynx(0),e.TgZ(1,"span",20),e._uU(2,"Serie"),e.qZA(),e.YNc(3,F,2,1,"span",16),e.BQk()),2&o){const t=e.oxw(2).$implicit,n=e.oxw().$implicit;e.xp6(3),e.Q6J("ngIf",n[t.field])}}function B(o,i){if(1&o&&(e.ynx(0),e._uU(1),e.BQk()),2&o){const t=e.oxw(2).$implicit,n=e.oxw().$implicit;e.xp6(1),e.hij(" ",n[t.field]," ")}}function q(o,i){1&o&&(e.ynx(0),e.YNc(1,E,4,1,"ng-container",18),e.YNc(2,Q,4,1,"ng-container",18),e.YNc(3,U,4,1,"ng-container",18),e.YNc(4,B,2,1,"ng-container",19),e.BQk()),2&o&&(e.xp6(1),e.Q6J("ngSwitchCase","puntoVenta"),e.xp6(1),e.Q6J("ngSwitchCase","tipoDocumento"),e.xp6(1),e.Q6J("ngSwitchCase","numero"))}function M(o,i){if(1&o&&(e.ynx(0,21),e.TgZ(1,"span",20),e._uU(2,"Acciones"),e.qZA(),e._UZ(3,"button",22),e.BQk()),2&o){const t=e.oxw(2).$implicit,n=e.oxw();e.xp6(3),e.Q6J("routerLink",n.linkUpdate(t.id))}}function $(o,i){if(1&o&&(e.TgZ(0,"td",15),e.YNc(1,q,5,3,"ng-container",16),e.YNc(2,M,4,1,"ng-container",17),e.qZA()),2&o){const t=i.$implicit;e.Q6J("ngSwitch",t.field),e.xp6(1),e.Q6J("ngIf",!t.isActions),e.xp6(1),e.Q6J("ngIf",t.isActions)}}function z(o,i){if(1&o&&(e.TgZ(0,"tr"),e.YNc(1,$,3,3,"td",14),e.qZA()),2&o){const t=i.columns;e.xp6(1),e.Q6J("ngForOf",t)}}function P(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"div",23),e.TgZ(1,"button",24),e.NdJ("click",function(){return e.CHM(t),e.oxw().new()}),e.qZA(),e.qZA()}}const O=function(){return{width:"100%"}};let k=(()=>{class o{constructor(t,n,a,l,p,h){this.route=t,this.router=n,this.serieService=a,this.companyService=l,this.loginService=p,this.breadcrumbService=h,this.perPage=10,this.puntosVenta=[]}ngOnInit(){this.breadcrumbService.setItems((0,f.kn)(this.route)),this.cols=[{field:"puntoVenta",header:"Punto de venta"},{field:"tipoDocumento",header:"Tipo de documento"},{field:"numero",header:"Serie"},{header:"Acciones",isActions:!0}],this.loading=!0,this.puntosVenta=this.loginService.getPuntosVentaUsuario(),this.loadIdEmpresa().then(()=>{this.companyService.findById(this.idEmpresa).subscribe(t=>{this.empresa=t})})}new(){this.router.navigateByUrl("/series/nuevo")}loadLazy(t){this.lastLazyLoadEvent=t,this.loading=!0;const l=["pageNumber="+t.first/this.perPage,`perPage=${t.rows}`];t.sortOrder&&l.push(`sortOrder=${t.sortOrder}`),t.sortField&&l.push(`sortField=${t.sortField}`),this.filtroPuntoVenta&&l.push(`idPuntoVenta=${this.filtroPuntoVenta.id}`),this.serieService.findAllPage(l.join("&")).subscribe(p=>{this.totalRecords=p.totalElements,this.series=p.content,this.loading=!1})}refreshTable(){this.lastLazyLoadEvent&&this.loadLazy(this.lastLazyLoadEvent)}loadIdEmpresa(){return new Promise(t=>{this.idEmpresa=this.loginService.getUser().empresa.id,t(void 0)})}linkUpdate(t){return`/series/editar/${t}`}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(c.gz),e.Y36(c.F0),e.Y36(v.E),e.Y36(b.J),e.Y36(S.r),e.Y36(Z.p))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-series"]],viewQuery:function(t,n){if(1&t&&e.Gf(J,7),2&t){let a;e.iGM(a=e.CRH())&&(n.tabla=a.first)}},decls:12,vars:14,consts:[[1,"grid"],[1,"col-12","md:col-2"],[2,"margin-bottom","0.5rem","margin-top","0"],["dataKey","id","placeholder","Seleccione...","optionLabel","nombre","name","puntoVenta",3,"ngModel","showClear","options","onChange","ngModelChange"],[1,"col-12"],["dataKey","id",3,"columns","value","lazy","paginator","rows","totalRecords","responsive","autoLayout","onLazyLoad"],["dt",""],["pTemplate","header"],["pTemplate","body"],["pTemplate","summary"],[3,"pSortableColumn",4,"ngFor","ngForOf"],[3,"pSortableColumn"],["ariaLabel","Activa para ordenar","ariaLabelDesc","Activa para ordenar en orden descendente","ariaLabelAsc","Activa para ordenar en orden ascendente",3,"field",4,"ngIf"],["ariaLabel","Activa para ordenar","ariaLabelDesc","Activa para ordenar en orden descendente","ariaLabelAsc","Activa para ordenar en orden ascendente",3,"field"],[3,"ngSwitch",4,"ngFor","ngForOf"],[3,"ngSwitch"],[4,"ngIf"],["style","text-align: center",4,"ngIf"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"p-column-title"],[2,"text-align","center"],["pButton","","type","button","icon","pi pi-pencil","pTooltip","Actualizar, Eliminar",1,"p-button-success",3,"routerLink"],[2,"text-align","left"],["type","button","pButton","","icon","fa fa-plus","label","Nuevo",2,"margin-right","0.2rem",3,"click"]],template:function(t,n){1&t&&(e.TgZ(0,"p-card"),e.TgZ(1,"div",0),e.TgZ(2,"div",1),e.TgZ(3,"h4",2),e._uU(4,"Punto de venta"),e.qZA(),e.TgZ(5,"p-dropdown",3),e.NdJ("onChange",function(){return n.refreshTable()})("ngModelChange",function(l){return n.filtroPuntoVenta=l}),e.qZA(),e.qZA(),e.TgZ(6,"div",4),e.TgZ(7,"p-table",5,6),e.NdJ("onLazyLoad",function(l){return n.loadLazy(l)}),e.YNc(9,N,2,1,"ng-template",7),e.YNc(10,z,2,1,"ng-template",8),e.YNc(11,P,2,0,"ng-template",9),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(5),e.Akn(e.DdM(13,O)),e.Q6J("ngModel",n.filtroPuntoVenta)("showClear",!0)("options",n.puntosVenta),e.xp6(2),e.Q6J("columns",n.cols)("value",n.series)("lazy",!0)("paginator",!0)("rows",n.perPage)("totalRecords",n.totalRecords)("responsive",!0)("autoLayout",!0))},directives:[T.Z,A.Lt,s.JJ,s.On,u.iA,d.jx,m.sg,u.lQ,m.O5,u.fz,m.RF,m.n9,m.ED,x.Hq,I.u,c.rH],pipes:[D.B],encapsulation:2}),o})();var g=r(54578),j=r(30567),R=r(6969),G=r(43724),H=r(31424);function K(o,i){1&o&&e._UZ(0,"p-message",20)}function X(o,i){1&o&&e._UZ(0,"p-message",21)}function W(o,i){1&o&&e._UZ(0,"p-message",22)}function ee(o,i){1&o&&e._UZ(0,"p-message",23)}function te(o,i){1&o&&e._UZ(0,"p-message",23)}function oe(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"button",24),e.NdJ("click",function(){return e.CHM(t),e.oxw().confirmDelete()}),e.qZA()}}const C=function(){return{width:"100%"}};let y=(()=>{class o{constructor(t,n,a,l,p,h,se,le,ce,me){this.route=t,this.router=n,this.serieService=a,this.companyService=l,this.puntoVentaService=p,this.messageService=h,this.loginService=se,this.confirmationService=le,this.fb=ce,this.breadcrumbService=me,this.puntosVenta=[],this.tiposDocumento=[]}ngOnInit(){this.breadcrumbService.setItems((0,f.kn)(this.route)),this.builderForm(),this.loadIdEmpresa().then(()=>{this.companyService.findById(this.idEmpresa).subscribe(t=>{this.empresa=t,this.loadData(),this.loadModel()})}),this.tiposDocumento=[{codigo:"01",nombre:"Factura"},{codigo:"03",nombre:"Boleta"},{codigo:"07",nombre:"Nota de cr\xe9dito"},{codigo:"08",nombre:"Nota de d\xe9bito"},{codigo:"09",nombre:"Gu\xeda de remisi\xf3n electr\xf3nica"},{codigo:"GM",nombre:"Gu\xeda de remisi\xf3n manual"},{codigo:"CE",nombre:"Constancia de entrega de existencias"},{codigo:"NV",nombre:"Nota de venta"},{codigo:"CO",nombre:"Cotizaci\xf3n"}]}builderForm(){this.modelForm=this.fb.group({puntoVenta:[null,[s.kI.required]],tipoDocumento:["",[s.kI.required]],numero:["",[s.kI.required,s.kI.maxLength(4),s.kI.minLength(4)]]})}submitForm(){let t,n;this.formToModel(),this.isEdit?(t=this.serieService.update(this.model),n="Serie actualizado correctamente."):(t=this.serieService.save(this.model),n="Serie registrado correctamente."),t.subscribe(a=>{this.messageService.add({severity:"success",summary:"Mensaje",detail:n}),this.router.navigateByUrl(this.linkVolver)})}formToModel(){this.model||(this.model={}),this.model.puntoVenta=this.modelForm.value.puntoVenta,this.model.numero=this.modelForm.value.numero,this.model.tipoDocumento=this.modelForm.value.tipoDocumento.codigo,this.model.empresa={id:this.idEmpresa}}modelToForm(t){this.modelForm.patchValue({puntoVenta:t.puntoVenta,numero:t.numero,tipoDocumento:this.tiposDocumento.find(n=>n.codigo===t.tipoDocumento)})}get textButtonAction(){return this.isEdit?"Actualizar":"Guardar"}get nameModulo(){return this.route.snapshot.data.title}get puntoVenta(){return this.modelForm.get("puntoVenta")}get numero(){return this.modelForm.get("numero")}get tipoDocumento(){return this.modelForm.get("tipoDocumento")}loadModel(){this.isEdit=this.route.snapshot.data.isEdit,this.isEdit&&this.route.params.subscribe(t=>{this.serieService.findById(t.id).subscribe(a=>{a&&(this.model=a,this.modelToForm(a))})})}confirmDelete(){this.confirmationService.confirm({message:"Estas seguro de eliminar este registro?",accept:()=>{this.serieService.deleteById(this.model.id).subscribe(()=>{this.messageService.clear(),this.messageService.add({severity:"success",summary:"Mensaje",detail:"Registro eliminado correctamente"}),this.router.navigateByUrl(this.linkVolver)})},acceptLabel:"Si",rejectLabel:"No"})}loadData(){(0,j.D)([this.puntoVentaService.findAll("",this.idEmpresa,!1)]).subscribe(t=>{this.puntosVenta=t[0]})}loadIdEmpresa(){return new Promise(t=>{this.idEmpresa=this.loginService.getUser().empresa.id,t(void 0)})}get linkVolver(){return"/series"}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(c.gz),e.Y36(c.F0),e.Y36(v.E),e.Y36(b.J),e.Y36(R.l),e.Y36(d.ez),e.Y36(S.r),e.Y36(d.YP),e.Y36(s.qu),e.Y36(Z.p))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-serie"]],decls:29,vars:20,consts:[[1,"grid"],[1,"col-12"],["novalidate","",3,"formGroup","ngSubmit"],[1,"grid","form-group"],[1,"col-12","md:col-2"],["for","puntoVenta",1,"label-form"],[1,"col-12","md:col-4"],["formControlName","puntoVenta","placeholder","Seleccione...","optionLabel","nombre","id","puntoVenta",3,"options","showClear"],["severity","error","text","Seleccione un punto de venta",4,"ngIf"],["for","tipoDocumento",1,"label-form"],["formControlName","tipoDocumento","placeholder","Seleccione...","optionLabel","nombre","id","tipoDocumento",3,"options","showClear"],["severity","error","text","Ingrese tipo de documento",4,"ngIf"],["for","numero",1,"label-form"],["formControlName","numero","id","numero","type","text","pInputText","",2,"width","100%","margin-bottom","0.2em"],["severity","error","text","Ingrese serie",4,"ngIf"],["severity","error","text","La serie debe ser de 4 d\xedgitos",4,"ngIf"],[1,"col-12",2,"text-align","center"],["pButton","","type","submit",2,"margin-right","0.4rem",3,"disabled","label"],["style","margin-right: 0.4rem","pButton","","type","button","label","Eliminar","class","p-button-danger",3,"click",4,"ngIf"],["pButton","","type","button","label","Volver",1,"p-button-secondary",2,"margin-right","0.4rem",3,"routerLink"],["severity","error","text","Seleccione un punto de venta"],["severity","error","text","Ingrese tipo de documento"],["severity","error","text","Ingrese serie"],["severity","error","text","La serie debe ser de 4 d\xedgitos"],["pButton","","type","button","label","Eliminar",1,"p-button-danger",2,"margin-right","0.4rem",3,"click"]],template:function(t,n){1&t&&(e.TgZ(0,"p-card"),e.TgZ(1,"div",0),e.TgZ(2,"div",1),e.TgZ(3,"form",2),e.NdJ("ngSubmit",function(){return n.submitForm()}),e.TgZ(4,"div",3),e.TgZ(5,"div",4),e.TgZ(6,"label",5),e._uU(7,"Punto de venta (*)"),e.qZA(),e.qZA(),e.TgZ(8,"div",6),e._UZ(9,"p-dropdown",7),e.YNc(10,K,1,0,"p-message",8),e.qZA(),e.TgZ(11,"div",4),e.TgZ(12,"label",9),e._uU(13,"Tipo de documento (*)"),e.qZA(),e.qZA(),e.TgZ(14,"div",6),e._UZ(15,"p-dropdown",10),e.YNc(16,X,1,0,"p-message",11),e.qZA(),e.TgZ(17,"div",4),e.TgZ(18,"label",12),e._uU(19,"Serie (*)"),e.qZA(),e.qZA(),e.TgZ(20,"div",6),e._UZ(21,"input",13),e.YNc(22,W,1,0,"p-message",14),e.YNc(23,ee,1,0,"p-message",15),e.YNc(24,te,1,0,"p-message",15),e.qZA(),e.TgZ(25,"div",16),e._UZ(26,"button",17),e.YNc(27,oe,1,0,"button",18),e._UZ(28,"button",19),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(3),e.Q6J("formGroup",n.modelForm),e.xp6(6),e.Akn(e.DdM(18,C)),e.Q6J("options",n.puntosVenta)("showClear",!0),e.xp6(1),e.Q6J("ngIf",n.puntoVenta.touched&&(null==n.puntoVenta.errors?null:n.puntoVenta.errors.required)),e.xp6(5),e.Akn(e.DdM(19,C)),e.Q6J("options",n.tiposDocumento)("showClear",!0),e.xp6(1),e.Q6J("ngIf",n.tipoDocumento.touched&&(null==n.tipoDocumento.errors?null:n.tipoDocumento.errors.required)),e.xp6(6),e.Q6J("ngIf",n.numero.touched&&(null==n.numero.errors?null:n.numero.errors.required)),e.xp6(1),e.Q6J("ngIf",null==n.numero.errors?null:n.numero.errors.minlength),e.xp6(1),e.Q6J("ngIf",null==n.numero.errors?null:n.numero.errors.maxlength),e.xp6(2),e.Q6J("disabled",!n.modelForm.valid)("label",n.textButtonAction),e.xp6(1),e.Q6J("ngIf",n.isEdit),e.xp6(1),e.Q6J("routerLink",n.linkVolver))},directives:[T.Z,s._Y,s.JL,s.sg,A.Lt,s.JJ,s.u,m.O5,G.q,s.Fj,H.o,x.Hq,c.rH],encapsulation:2}),o})();const ne=[{path:"",component:k,canActivate:[g.P],data:{breadcrumb:[{label:"Administraci\xf3n"},{label:"Series"}]}},{path:"editar/:id",component:y,data:{isEdit:!0,title:"Editar serie",breadcrumb:[{label:"Administraci\xf3n"},{label:"Series"},{label:"Editar serie"}]},canActivate:[g.P]},{path:"nuevo",component:y,data:{isEdit:!1,title:"Nueva serie",breadcrumb:[{label:"Administraci\xf3n"},{label:"Series"},{label:"Nueva serie"}]},canActivate:[g.P]}];let ie=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[[c.Bz.forChild(ne)],c.Bz]}),o})();var re=r(20958);let ae=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[[ie,re.m]]}),o})()}}]);