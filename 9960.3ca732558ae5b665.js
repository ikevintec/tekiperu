"use strict";(self.webpackChunkmirage=self.webpackChunkmirage||[]).push([[9960],{12689:(C,T,n)=>{n.d(T,{A:()=>v});var e=n(5e3),c=n(69808),_=n(98952),d=n(59783);function f(p,m){1&p&&(e.TgZ(0,"tr"),e.TgZ(1,"th"),e._uU(2,"Opci\xf3n"),e.qZA(),e.qZA())}function u(p,m){if(1&p&&(e.TgZ(0,"tr"),e.TgZ(1,"td"),e._uU(2),e.qZA(),e.qZA()),2&p){const s=m.$implicit;e.xp6(2),e.Oqu(s.opcion)}}function h(p,m){if(1&p&&(e.TgZ(0,"div"),e.TgZ(1,"h1",1),e._uU(2),e.qZA(),e.TgZ(3,"div",2),e.TgZ(4,"div",3),e.TgZ(5,"p-table",4),e.YNc(6,f,3,0,"ng-template",5),e.YNc(7,u,3,1,"ng-template",6),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&p){const s=e.oxw();e.xp6(2),e.hij(" ",s.preparacion.nombre,""),e.xp6(3),e.Q6J("value",s.preparacion.opciones)}}let v=(()=>{class p{constructor(){}ngOnInit(){}}return p.\u0275fac=function(s){return new(s||p)},p.\u0275cmp=e.Xpm({type:p,selectors:[["app-preparacion-item"]],inputs:{preparacion:"preparacion"},decls:1,vars:1,consts:[[4,"ngIf"],[2,"margin-top","0"],[1,"grid"],[1,"col-12"],[3,"value"],["pTemplate","header"],["pTemplate","body"]],template:function(s,g){1&s&&e.YNc(0,h,8,2,"div",0),2&s&&e.Q6J("ngIf",g.preparacion)},directives:[c.O5,_.iA,d.jx],styles:[""]}),p})()},19960:(C,T,n)=>{n.d(T,{Q:()=>k});var e=n(5e3),c=n(93075),_=n(82817),d=n(59783),f=n(46736),u=n(45330),h=n(74297),v=n(31424),p=n(69808),m=n(43724),s=n(40845),g=n(98952),A=n(4119);function x(i,a){1&i&&e._UZ(0,"p-message",15)}function F(i,a){1&i&&(e.TgZ(0,"tr"),e.TgZ(1,"th"),e._uU(2,"Opcion"),e.qZA(),e.TgZ(3,"th"),e._uU(4,"Acciones"),e.qZA(),e.qZA())}function I(i,a){1&i&&e._UZ(0,"input",23)}function y(i,a){if(1&i&&e._uU(0),2&i){const t=e.oxw().$implicit;e.hij(" ",t.get("opcion").value," ")}}function E(i,a){1&i&&e._UZ(0,"p-message",24)}function q(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"tr",16),e.TgZ(1,"td",17),e.TgZ(2,"p-cellEditor"),e.YNc(3,I,1,0,"ng-template",18),e.YNc(4,y,1,1,"ng-template",19),e.qZA(),e.YNc(5,E,1,0,"p-message",20),e.qZA(),e.TgZ(6,"td",21),e.TgZ(7,"button",22),e.NdJ("click",function(){const l=e.CHM(t).rowIndex;return e.oxw().deleteItemOptionForm(l)}),e.qZA(),e.qZA(),e.qZA()}if(2&i){const o=a.$implicit;e.Q6J("formGroupName",a.rowIndex),e.xp6(5),e.Q6J("ngIf",o.get("opcion").touched&&(null==o.get("opcion").errors?null:o.get("opcion").errors.required))}}let P=(()=>{class i{constructor(t,o,r,l,Z,b){this.fb=t,this.messageService=o,this.preparationService=r,this.confirmationService=l,this.ref=Z,this.config=b}ngOnInit(){this.builderForm(),this.loadModelForEdit()}builderForm(){this.modelForm=this.fb.group({nombre:[void 0,[c.kI.required]],opciones:this.fb.array([])})}registrar(){(0,_.c2)(this.modelForm),this.modelForm.valid?this.confirmationService.confirm({message:`\xbfEst\xe1 seguro de ${this.isEdit?"actualizar":"registrar"} la preparaci\xf3n actual?`,accept:()=>{this.formToModel(),(this.isEdit?this.preparationService.update(this.model.id,this.model):this.preparationService.save(this.model)).subscribe(t=>{this.ref.close(t)})},acceptLabel:"Si",rejectLabel:"No"}):this.messageService.add({severity:"error",summary:"Error",detail:"Complete campos obligatorios (*)"})}cancel(){this.ref.close()}get isEdit(){return this.config.data.isEdit}get titleButtonAction(){return this.isEdit?"Actualizar preparaci\xf3n":"Registrar preparaci\xf3n"}get modelFormOptions(){return this.modelForm.get("opciones")}addOption(){this.addItemOptionForm({eliminado:!1})}addItemOptionForm(t){this.modelFormOptions.push(this.createItemOptionForm(t))}deleteItemOptionForm(t){this.modelFormOptions.removeAt(t)}createItemOptionForm(t){return this.fb.group({id:[t.id,[]],opcion:[t.opcion,[c.kI.required]],eliminado:[!1,[]]})}formToModel(){const t=this.modelForm.getRawValue();this.model||(this.model={}),this.model.nombre=t.nombre,this.model.opciones=[],t.opciones.forEach(o=>{this.model.opciones.push(o)})}modelToForm(t){this.model=t,this.modelForm.patchValue({nombre:t.nombre});const o=this.modelFormOptions;t.opciones.forEach(r=>{o.push(this.createItemOptionForm(r))})}loadModelForEdit(){const t=this.config.data.id;t&&setTimeout(()=>this.preparationService.findById(t).subscribe(o=>{this.model=o,this.modelToForm(o)}))}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(c.qu),e.Y36(d.ez),e.Y36(f.B),e.Y36(d.YP),e.Y36(u.E7),e.Y36(u.S))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-preparacion"]],decls:19,vars:6,consts:[["novalidate","",3,"formGroup"],[1,"grid"],[1,"col-12"],[1,"label-form"],["formControlName","nombre","type","text","pInputText","",2,"width","100%"],["severity","error","text","Ingrese el nombre de la preparaci\xf3n",4,"ngIf"],["icon","pi pi-plus","pButton","","type","button","label","Agregar opci\xf3n",3,"click"],[1,"mb-2"],["severity","info","text","Click en el campo opci\xf3n para editar."],["formArrayName","opciones",3,"value","rows","responsive"],["pTemplate","header"],["pTemplate","body"],[1,"col-12","space-buttons",2,"text-align","center"],["pButton","","type","button","label","Cancelar",1,"p-button-secondary",2,"margin-right","0.4rem",3,"click"],["pButton","","type","button",3,"label","click"],["severity","error","text","Ingrese el nombre de la preparaci\xf3n"],[3,"formGroupName"],["pEditableColumn",""],["pTemplate","input"],["pTemplate","output"],["severity","error","text","Ingrese opci\xf3n",4,"ngIf"],[2,"text-align","center"],["pTooltip","Eliminar","pButton","","type","button","icon","pi pi-trash",1,"p-button-danger","lrm-1",3,"click"],["type","text","pInputText","","formControlName","opcion"],["severity","error","text","Ingrese opci\xf3n"]],template:function(t,o){1&t&&(e.TgZ(0,"p-card"),e.TgZ(1,"form",0),e.TgZ(2,"div",1),e.TgZ(3,"div",2),e.TgZ(4,"label",3),e._uU(5,"Nombre (*)"),e.qZA(),e._UZ(6,"input",4),e.YNc(7,x,1,0,"p-message",5),e.qZA(),e.TgZ(8,"div",2),e.TgZ(9,"button",6),e.NdJ("click",function(){return o.addOption()}),e.qZA(),e.qZA(),e.TgZ(10,"div",2),e.TgZ(11,"div",7),e._UZ(12,"p-message",8),e.qZA(),e.TgZ(13,"p-table",9),e.YNc(14,F,5,0,"ng-template",10),e.YNc(15,q,8,2,"ng-template",11),e.qZA(),e.qZA(),e.TgZ(16,"div",12),e.TgZ(17,"button",13),e.NdJ("click",function(){return o.cancel()}),e.qZA(),e.TgZ(18,"button",14),e.NdJ("click",function(){return o.registrar()}),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(1),e.Q6J("formGroup",o.modelForm),e.xp6(6),e.Q6J("ngIf",o.modelForm.get("nombre").touched&&(null==o.modelForm.get("nombre").errors?null:o.modelForm.get("nombre").errors.required)),e.xp6(6),e.Q6J("value",o.modelFormOptions.controls)("rows",10)("responsive",!0),e.xp6(5),e.Q6J("label",o.titleButtonAction))},directives:[h.Z,c._Y,c.JL,c.sg,c.Fj,c.JJ,c.u,v.o,p.O5,m.q,s.Hq,g.iA,c.CE,d.jx,c.x0,g.Wq,g.YL,A.u],styles:[""]}),i})();var N=n(74202),O=n(47745),Y=n(12689);function S(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"button",11),e.NdJ("click",function(){e.CHM(t);const r=e.oxw().$implicit;return e.oxw().select(r)}),e.qZA()}}function M(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"button",12),e.NdJ("click",function(){e.CHM(t);const r=e.oxw().$implicit;return e.oxw().openModalEditPreparation(r)}),e.qZA()}}function J(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"button",13),e.NdJ("click",function(){e.CHM(t);const r=e.oxw().$implicit;return e.oxw().confirmDelete(r)}),e.qZA()}}function B(i,a){if(1&i&&(e.TgZ(0,"div",5),e.TgZ(1,"p-card"),e.TgZ(2,"div",0),e.TgZ(3,"div",1),e._UZ(4,"app-preparacion-item",6),e.qZA(),e.TgZ(5,"div",7),e.YNc(6,S,1,0,"button",8),e.YNc(7,M,1,0,"button",9),e.YNc(8,J,1,0,"button",10),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&i){const t=a.$implicit,o=e.oxw();e.xp6(4),e.Q6J("preparacion",t),e.xp6(2),e.Q6J("ngIf",o.isModal),e.xp6(1),e.Q6J("ngIf",!o.isModal),e.xp6(1),e.Q6J("ngIf",!o.isModal)}}let k=(()=>{class i{constructor(t,o,r,l,Z,b){this.route=t,this.breadcrumbService=o,this.confirmationService=r,this.preparationService=l,this.dialogService=Z,this.messageService=b,this.selectPreparation=new e.vpe}ngOnInit(){this.isModal||this.breadcrumbService.setItems((0,_.kn)(this.route)),this.loadPreparations()}loadPreparations(t){const o=[];t&&o.push(`nombre=${t}`),setTimeout(()=>this.preparationService.findAll(o.join("&")).subscribe(r=>this.preparations=r))}openModalNewPreparation(){this.dialogService.open(P,{data:{isEdit:!1},header:"Nueva preparaci\xf3n",width:"80%"}).onClose.subscribe(o=>{o&&(this.messageService.add({severity:"success",summary:"Registro de preparaci\xf3n",detail:"Preparaci\xf3n registrada correctamente."}),this.loadPreparations())})}openModalEditPreparation(t){this.dialogService.open(P,{data:{isEdit:!0,id:t.id},header:"Editar preparaci\xf3n",width:"80%"}).onClose.subscribe(r=>{r&&(this.messageService.add({severity:"success",summary:"Registro de preparaci\xf3n",detail:"Preparaci\xf3n actualizada correctamente."}),this.loadPreparations())})}confirmDelete(t){this.confirmationService.confirm({message:"Est\xe1 seguro de eliminar esta preparaci\xf3n?",accept:()=>{this.preparationService.delete(t.id).subscribe(()=>{this.messageService.clear(),this.messageService.add({severity:"success",summary:"Mensaje",detail:"Preparaci\xf3n eliminada correctamente"}),this.loadPreparations()})},acceptLabel:"Si",rejectLabel:"No"})}select(t){this.selectPreparation.emit(t)}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(N.gz),e.Y36(O.p),e.Y36(d.YP),e.Y36(f.B),e.Y36(u.xA),e.Y36(d.ez))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-preparaciones"]],inputs:{isModal:"isModal"},outputs:{selectPreparation:"selectPreparation"},decls:9,vars:1,consts:[[1,"grid"],[1,"col-12"],["pButton","","type","button","icon","pi pi-plus","label","Nueva preparaci\xf3n",3,"click"],["type","text","pInputText","","placeholder","Buscar por nombre",2,"width","100%",3,"input"],["class","col-12 sm:col-6 md:col-4",4,"ngFor","ngForOf"],[1,"col-12","sm:col-6","md:col-4"],[3,"preparacion"],[1,"col-12","center","space-buttons"],["pButton","","type","button","icon","pi pi-check","pTooltip","Seleccionar preparaci\xf3n",3,"click",4,"ngIf"],["pButton","","type","button","icon","pi pi-pencil","pTooltip","Editar",3,"click",4,"ngIf"],["pTooltip","Eliminar","class","p-button-danger lrm-1","pButton","","type","button","icon","pi pi-trash",3,"click",4,"ngIf"],["pButton","","type","button","icon","pi pi-check","pTooltip","Seleccionar preparaci\xf3n",3,"click"],["pButton","","type","button","icon","pi pi-pencil","pTooltip","Editar",3,"click"],["pTooltip","Eliminar","pButton","","type","button","icon","pi pi-trash",1,"p-button-danger","lrm-1",3,"click"]],template:function(t,o){1&t&&(e.TgZ(0,"p-card"),e.TgZ(1,"div",0),e.TgZ(2,"div",1),e.TgZ(3,"button",2),e.NdJ("click",function(){return o.openModalNewPreparation()}),e.qZA(),e.qZA(),e.TgZ(4,"div",1),e.TgZ(5,"input",3),e.NdJ("input",function(l){return o.loadPreparations(l.target.value)}),e.qZA(),e.qZA(),e.TgZ(6,"div",1),e.TgZ(7,"div",0),e.YNc(8,B,9,4,"div",4),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(8),e.Q6J("ngForOf",o.preparations))},directives:[h.Z,s.Hq,v.o,p.sg,Y.A,p.O5,A.u],styles:[""]}),i})()}}]);