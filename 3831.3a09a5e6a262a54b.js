"use strict";(self.webpackChunkmirage=self.webpackChunkmirage||[]).push([[3831],{33831:(B,m,o)=>{o.r(m),o.d(m,{LoginModule:()=>R});var p=o(74202),T=o(70655),l=o(31639),f=o(85932),C=o(8929),L=o(30567),y=o(92340),b=o(81575),A=o(7625),t=o(5e3),x=o(20207),M=o(96310),S=o(86529),v=o(69808),Z=o(40845),c=o(93075),U=o(31424);const J=function(i,e){return{"layout-dark":i,"layout-light":e}};function q(i,e){if(1&i){const n=t.EpF();t.TgZ(0,"div",1),t.TgZ(1,"div",2),t.TgZ(2,"div",3),t.TgZ(3,"p-button",4),t.NdJ("click",function(){return t.CHM(n),t.oxw().dark=!0}),t.qZA(),t.TgZ(4,"p-button",5),t.NdJ("click",function(){return t.CHM(n),t.oxw().dark=!1}),t.qZA(),t.qZA(),t.TgZ(5,"div",6),t.TgZ(6,"div",7),t.TgZ(7,"div",8),t._UZ(8,"img",9),t.qZA(),t.TgZ(9,"h1"),t._uU(10,"Inicia sesi\xf3n en Teki"),t.qZA(),t.TgZ(11,"p"),t._uU(12,"Bienvenido, por favor ingresa tu usuario y contrase\xf1a para comenzar"),t.qZA(),t.TgZ(13,"form",10),t.NdJ("submit",function(s){return t.CHM(n),t.oxw().goLogin(s)}),t.TgZ(14,"div",11),t.TgZ(15,"div",12),t.TgZ(16,"label",13),t._uU(17,"Usuario"),t.qZA(),t.TgZ(18,"input",14),t.NdJ("ngModelChange",function(s){return t.CHM(n),t.oxw().loginRequest.username=s}),t.qZA(),t._UZ(19,"i",15),t.qZA(),t.TgZ(20,"div",12),t.TgZ(21,"label",16),t._uU(22,"Contrase\xf1a"),t.qZA(),t.TgZ(23,"input",17),t.NdJ("ngModelChange",function(s){return t.CHM(n),t.oxw().loginRequest.password=s}),t.qZA(),t._UZ(24,"i",18),t.qZA(),t.TgZ(25,"div",19),t._UZ(26,"button",20),t.TgZ(27,"a",21),t._uU(28,"Perdiste tu contrase\xf1a?"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t._UZ(29,"div",22),t.qZA(),t.qZA()}if(2&i){const n=t.oxw();t.Q6J("ngClass",t.WLB(4,J,n.dark,!n.dark)),t.xp6(8),t.Q6J("src",n.urlImageLogo,t.LSH),t.xp6(10),t.Q6J("ngModel",n.loginRequest.username),t.xp6(5),t.Q6J("ngModel",n.loginRequest.password)}}class u{constructor(e,n,r,s,a,h){this.router=e,this.loginService=n,this.companyService=r,this.route=s,this.store=a,this.saleStationService=h,this.unsubscribe$=new C.xQ,this.loginRequest={},this.dark=!1}ngOnInit(){this.urlImageLogo=y.N.urlLogo,this.sub=this.route.params.subscribe(e=>{if(e.encoded){this.encodedLogin=e.encoded,this.encodedLogin=e.encoded.split("-eq-").join("=");const n=atob(this.encodedLogin).split("*.*");this.loginRequest.username=n[0],this.loginRequest.password=n[1],this.goLogin()}}),this.estacionVenta$.pipe((0,A.R)(this.unsubscribe$)).subscribe(e=>{this.estacionVenta=e})}ngOnDestroy(){this.sub.unsubscribe(),this.unsubscribe$.next(),this.unsubscribe$.complete()}goLogin(e){e&&e.preventDefault(),this.loginService.logIn(this.loginRequest).subscribe(n=>{const r=n.user.estacionVenta;let s;if(n.user.avatarUrl||(n.user.avatarUrl="assets/layout/images/default-avatar.png"),s=r?n.user.puntosVenta.find(a=>a.id===r.puntoVenta.id):n.user.puntosVenta[0],this.store.dispatch(new l.bo(n)),this.store.dispatch(new l.T8(n.user.empresa)),this.store.dispatch(new l.vv(n.user.empresa)),s){this.store.dispatch(new l.wq({office:s}));const a=["paginacion=false",`idPuntoVenta=${s.id}`];(0,L.D)([this.companyService.getConfig(),this.saleStationService.findAllList(a.join("&"))]).subscribe(h=>{this.store.dispatch(new l.Vh({config:h[0]}));const d=h[1];if(r){const g=d.find(V=>V.id===r.id);this.store.dispatch(new l.rO(g?{saleStation:g}:{saleStation:d[0]}))}else this.estacionVenta&&d.find(g=>g.id===this.estacionVenta.id)?this.store.dispatch(new l.rO({saleStation:d.find(g=>g.id===this.estacionVenta.id)})):this.store.dispatch(new l.rO({saleStation:d[0]}));this.router.navigateByUrl(n.user.rutaInicial?n.user.rutaInicial:"")})}})}}u.\u0275fac=function(e){return new(e||u)(t.Y36(p.F0),t.Y36(x.r),t.Y36(M.J),t.Y36(p.gz),t.Y36(f.yh),t.Y36(S.i))},u.\u0275cmp=t.Xpm({type:u,selectors:[["app-login"]],decls:1,vars:1,consts:[["class","login-body",3,"ngClass",4,"ngIf"],[1,"login-body",3,"ngClass"],[1,"login-content"],[1,"night-switch"],["styleClass","dark-switch","icon","pi pi-circle-on",3,"click"],["styleClass","light-switch","icon","pi pi-circle-off",3,"click"],[1,"login-panel"],[1,"login-panel-content"],[1,"logo"],["alt","mirage-layout",3,"src"],[3,"submit"],[1,"forms"],[1,"login-input-wrapper"],["for","username"],["id","username","pInputText","","placeholder","Ingrese nombre de usuario","required","","type","text","name","username",3,"ngModel","ngModelChange"],[1,"pi","pi-user"],["for","password"],["pInputText","","required","","type","password","name","pass","id","password","placeholder","Ingrese contrase\xf1a","pPassword","",3,"ngModel","ngModelChange"],[1,"pi","pi-lock"],[1,"buttons"],["pButton","","type","submit","label","Iniciar sesi\xf3n"],["href","#",1,"secondary-button"],[1,"desert"]],template:function(e,n){1&e&&t.YNc(0,q,30,7,"div",0),2&e&&t.Q6J("ngIf",!n.encodedLogin)},directives:[v.O5,v.mk,Z.zx,c._Y,c.JL,c.F,c.Fj,U.o,c.Q7,c.JJ,c.On,Z.Hq],styles:[""]}),(0,T.gn)([(0,f.Ph)(b.Z.getSaleStation)],u.prototype,"estacionVenta$",void 0);const w=[{path:"",component:u},{path:":encoded",component:u}];let I=(()=>{class i{}return i.\u0275fac=function(n){return new(n||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[[p.Bz.forChild(w)],p.Bz]}),i})();var F=o(20958);let R=(()=>{class i{}return i.\u0275fac=function(n){return new(n||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[[I,F.m]]}),i})()}}]);