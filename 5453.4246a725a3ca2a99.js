"use strict";(self.webpackChunkmirage=self.webpackChunkmirage||[]).push([[5453],{46482:(ee,U,s)=>{s.d(U,{T:()=>j});var l=s(93075),e=s(30567),h=s(82817),t=s(5e3),T=s(74202),g=s(33379),v=s(96310),_=s(6969),u=s(87969),m=s(59783),c=s(20207),Z=s(86529),A=s(47745),x=s(74297),I=s(28061),C=s(69808),D=s(31424),M=s(43724),y=s(97152),O=s(14036),P=s(40845);function S(a,p){if(1&a&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&a){const o=t.oxw();t.xp6(1),t.hij("(",o.empresa.razonSocial,")")}}function L(a,p){1&a&&t._UZ(0,"p-message",46)}function N(a,p){1&a&&t._UZ(0,"p-message",47)}function B(a,p){1&a&&t._UZ(0,"p-message",47)}function R(a,p){1&a&&t._UZ(0,"p-message",48)}function Y(a,p){1&a&&t._UZ(0,"p-message",49)}function w(a,p){1&a&&t._UZ(0,"p-message",50)}function q(a,p){1&a&&t._UZ(0,"p-message",51)}function J(a,p){1&a&&t._UZ(0,"p-message",52)}function Q(a,p){1&a&&t._UZ(0,"p-message",53)}function F(a,p){1&a&&t._UZ(0,"p-message",54)}function $(a,p){if(1&a&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&a){const o=p.$implicit;t.xp6(1),t.Oqu(o.nombre)}}function K(a,p){1&a&&t._UZ(0,"p-message",55)}function W(a,p){if(1&a&&t._uU(0),2&a){const o=t.oxw();t.AsE(" ",null==o.estacionVenta||null==o.estacionVenta.value?null:o.estacionVenta.value.nombre," (",null==o.estacionVenta||null==o.estacionVenta.value||null==o.estacionVenta.value.puntoVenta?null:o.estacionVenta.value.puntoVenta.nombre,") ")}}function V(a,p){1&a&&t._UZ(0,"p-message",56)}function k(a,p){if(1&a){const o=t.EpF();t.TgZ(0,"button",57),t.NdJ("click",function(){return t.CHM(o),t.oxw().confirmDelete()}),t.qZA()}}const z=function(){return{"margin-bottom":"20px"}},b=function(){return{width:"100%"}};let j=(()=>{class a{constructor(o,n,i,r,d,f,E,H,G,X,te,oe){this.route=o,this.router=n,this.usuarioService=i,this.companyService=r,this.officeService=d,this.profileService=f,this.messageService=E,this.loginService=H,this.confirmationService=G,this.saleStationService=X,this.fb=te,this.breadcrumbService=oe,this.pvDisponibles=[],this.pvSeleccionados=[]}ngOnInit(){this.breadcrumbService.setItems((0,h.kn)(this.route)),this.builderForm(),this.loadIdEmpresa().then(()=>{this.companyService.findById(this.idEmpresa).subscribe(o=>{this.empresa=o,this.loadData().then(()=>this.loadModel()),this.loadEstaciones()})})}builderForm(){this.modelForm=this.fb.group({dni:["",[l.kI.required,l.kI.minLength(8),l.kI.maxLength(8),l.kI.pattern("^[0-9]+$")]],nombres:["",[l.kI.required]],username:["",[l.kI.required]],apellidos:["",[l.kI.required]],cargo:["",[l.kI.required]],perfil:[null,[l.kI.required]],estacionVenta:[null,[]],email:["",[l.kI.required,l.kI.email]]})}changeEmail(){if(!this.isEdit){const o=this.modelForm.getRawValue().email;this.modelForm.patchValue({username:o})}}submitForm(){let o,n;this.formToModel(),this.isEdit?(o=this.usuarioService.update(this.idEmpresa,this.model,this.modeRoot),n="Usuario actualizado correctamente."):(o=this.usuarioService.save(this.idEmpresa,this.model,this.modeRoot),n="Usuario registrado correctamente."),o.subscribe(i=>{this.messageService.add({severity:"success",summary:"Mensaje",detail:n}),this.router.navigateByUrl(this.linkVolver)})}formToModel(){this.model||(this.model={}),this.model.nombres=this.modelForm.value.nombres,this.model.username=this.modelForm.value.username,this.model.apellidos=this.modelForm.value.apellidos,this.model.dni=this.modelForm.value.dni,this.model.email=this.modelForm.value.email,this.model.cargo=this.modelForm.value.cargo,this.model.perfil=this.modelForm.value.perfil,this.model.estacionVenta=this.modelForm.value.estacionVenta,this.model.puntosVenta=this.pvSeleccionados,this.model.empresa={id:this.idEmpresa}}modelToForm(o){this.modelForm.patchValue({nombres:o.nombres,username:o.username,apellidos:o.apellidos,dni:o.dni,email:o.email,cargo:o.cargo,perfil:o.perfil,estacionVenta:o.estacionVenta})}get textButtonAction(){return this.isEdit?"Actualizar":"Guardar"}get nameModulo(){return this.route.snapshot.data.title}get nombres(){return this.modelForm.get("nombres")}get apellidos(){return this.modelForm.get("apellidos")}get dni(){return this.modelForm.get("dni")}get email(){return this.modelForm.get("email")}get cargo(){return this.modelForm.get("cargo")}get perfil(){return this.modelForm.get("perfil")}get estacionVenta(){return this.modelForm.get("estacionVenta")}get username(){return this.modelForm.get("username")}loadModel(){this.isEdit=this.route.snapshot.data.isEdit,this.isEdit&&this.route.params.subscribe(o=>{this.usuarioService.findById(this.idEmpresa,o.id,this.modeRoot).subscribe(i=>{i&&(this.model=i,this.modelToForm(i),i.puntosVenta.forEach(r=>{this.pvDisponibles.forEach(d=>{r.id===d.id&&this.pvSeleccionados.push(d)})}),this.pvSeleccionados.forEach(r=>{this.pvDisponibles.splice(this.pvDisponibles.findIndex(d=>d.id===r.id),1)}),this.loadEstaciones())})})}confirmDelete(){this.confirmationService.confirm({message:"Estas seguro de eliminar este registro?",accept:()=>{this.usuarioService.deleteById(this.idEmpresa,this.model.id,this.modeRoot).subscribe(()=>{this.messageService.clear(),this.messageService.add({severity:"success",summary:"Mensaje",detail:"Registro eliminado correctamente"}),this.router.navigateByUrl(this.linkVolver)})},acceptLabel:"Si",rejectLabel:"No"})}loadData(){return new Promise(o=>{(0,e.D)([this.profileService.findAll(this.idEmpresa,this.modeRoot),this.officeService.findAll("",this.idEmpresa,this.modeRoot)]).subscribe(n=>{this.pvDisponibles=n[1].map(r=>({id:r.id,nombre:r.nombre})),this.perfiles=n[0],o(void 0)})})}loadEstaciones(){this.saleStationService.findAllList("paginacion=false").subscribe(o=>{this.estaciones=o.filter(i=>this.pvSeleccionados.map(r=>r.id).includes(i.puntoVenta.id));const n=this.modelForm.get("estacionVenta").value;n&&!this.estaciones.map(i=>i.id).includes(n.id)&&this.modelForm.patchValue({estacionVenta:void 0})})}get modeRoot(){return this.route.snapshot.data.modeRoot}loadIdEmpresa(){return new Promise(o=>{this.modeRoot?this.route.params.subscribe(n=>{this.idEmpresa=n.idEmpresa,o(void 0)}):(this.idEmpresa=this.loginService.getUser().empresa.id,o(void 0))})}get linkVolver(){return this.modeRoot?`/empresas/${this.idEmpresa}/usuarios`:"/usuarios"}}return a.\u0275fac=function(o){return new(o||a)(t.Y36(T.gz),t.Y36(T.F0),t.Y36(g.i),t.Y36(v.J),t.Y36(_.l),t.Y36(u.H),t.Y36(m.ez),t.Y36(c.r),t.Y36(m.YP),t.Y36(Z.i),t.Y36(l.qu),t.Y36(A.p))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-usuario"]],decls:75,vars:39,consts:[[1,"p-panel-title"],[4,"ngIf"],[1,"grid"],[1,"col-12"],["novalidate","",3,"formGroup","ngSubmit"],[1,"grid","form-group"],[1,"col-12","md:col-2"],["for","dni",1,"label-form"],[1,"col-12","md:col-4"],["formControlName","dni","id","dni","type","text","pInputText","",2,"width","100%","margin-bottom","0.2em"],["severity","error","text","Ingrese DNI",4,"ngIf"],["severity","error","text","El dni debe tener 8 d\xedgitos",4,"ngIf"],["severity","error","text","El dni debe ser n\xfamerico",4,"ngIf"],["for","nombres",1,"label-form"],["formControlName","nombres","id","nombres","type","text","pInputText","",2,"width","100%","margin-bottom","0.2em"],["severity","error","text","Ingrese nombres",4,"ngIf"],["for","apellidos",1,"label-form"],["formControlName","apellidos","id","apellidos","type","text","pInputText","",2,"width","100%","margin-bottom","0.2em"],["severity","error","text","Ingrese apellidos",4,"ngIf"],["for","cargo",1,"label-form"],["formControlName","cargo","id","cargo","type","text","pInputText","",2,"width","100%","margin-bottom","0.2em"],["severity","error","text","Ingrese cargo",4,"ngIf"],["for","email",1,"label-form"],["placeholder","Email","formControlName","email","id","email","type","text","pInputText","",2,"width","100%","margin-bottom","0.2em",3,"input"],["severity","error","text","Ingrese email",4,"ngIf"],["severity","error","text","Ingrese un email v\xe1lido",4,"ngIf"],[1,"col-12","md:col-2",3,"hidden"],[1,"col-12","md:col-4",3,"hidden"],["placeholder","Usuario del sistema","formControlName","username","type","text","pInputText","",2,"width","100%","margin-bottom","0.2em"],["severity","error","text","Ingrese nombre de usuario",4,"ngIf"],[1,"col-12","md:col-6"],[1,"card","card-w-title"],[1,"label-form"],["sourceHeader","Disponibles","targetHeader","Asignados",3,"showSourceControls","showTargetControls","source","target","responsive","onMoveToSource","onMoveToTarget","onMoveAllToSource","onMoveAllToTarget"],["pTemplate","item"],["for","perfil",1,"label-form"],["dataKey","id","formControlName","perfil","placeholder","Seleccione...","optionLabel","nombre","id","perfil",3,"options","showClear"],["severity","error","text","Seleccione un perfil",4,"ngIf"],["for","ev",1,"label-form"],["dataKey","id","formControlName","estacionVenta","placeholder","Seleccione...","optionLabel","nombre","id","ev",3,"options","showClear"],["pTemplate","selectedItem"],["severity","error","text","Seleccione una estaci\xf3n de venta",4,"ngIf"],[1,"col-12",2,"text-align","center"],["pButton","","type","submit",2,"margin-right","0.4rem",3,"disabled","label"],["style","margin-right: 0.4rem","pButton","","type","button","label","Eliminar","class","p-button-danger",3,"click",4,"ngIf"],["pButton","","type","button","label","Volver",1,"p-button-secondary",2,"margin-right","0.4rem",3,"routerLink"],["severity","error","text","Ingrese DNI"],["severity","error","text","El dni debe tener 8 d\xedgitos"],["severity","error","text","El dni debe ser n\xfamerico"],["severity","error","text","Ingrese nombres"],["severity","error","text","Ingrese apellidos"],["severity","error","text","Ingrese cargo"],["severity","error","text","Ingrese email"],["severity","error","text","Ingrese un email v\xe1lido"],["severity","error","text","Ingrese nombre de usuario"],["severity","error","text","Seleccione un perfil"],["severity","error","text","Seleccione una estaci\xf3n de venta"],["pButton","","type","button","label","Eliminar",1,"p-button-danger",2,"margin-right","0.4rem",3,"click"]],template:function(o,n){1&o&&(t.TgZ(0,"p-card"),t.TgZ(1,"p-panel"),t.TgZ(2,"p-header"),t.TgZ(3,"span",0),t._uU(4),t.YNc(5,S,2,1,"span",1),t.qZA(),t.qZA(),t.TgZ(6,"div",2),t.TgZ(7,"div",3),t.TgZ(8,"form",4),t.NdJ("ngSubmit",function(){return n.submitForm()}),t.TgZ(9,"div",5),t.TgZ(10,"div",6),t.TgZ(11,"label",7),t._uU(12,"DNI (*)"),t.qZA(),t.qZA(),t.TgZ(13,"div",8),t._UZ(14,"input",9),t.YNc(15,L,1,0,"p-message",10),t.YNc(16,N,1,0,"p-message",11),t.YNc(17,B,1,0,"p-message",11),t.YNc(18,R,1,0,"p-message",12),t.qZA(),t.TgZ(19,"div",6),t.TgZ(20,"label",13),t._uU(21,"Nombres (*)"),t.qZA(),t.qZA(),t.TgZ(22,"div",8),t._UZ(23,"input",14),t.YNc(24,Y,1,0,"p-message",15),t.qZA(),t.TgZ(25,"div",6),t.TgZ(26,"label",16),t._uU(27,"Apellidos (*)"),t.qZA(),t.qZA(),t.TgZ(28,"div",8),t._UZ(29,"input",17),t.YNc(30,w,1,0,"p-message",18),t.qZA(),t.TgZ(31,"div",6),t.TgZ(32,"label",19),t._uU(33,"Cargo (*)"),t.qZA(),t.qZA(),t.TgZ(34,"div",8),t._UZ(35,"input",20),t.YNc(36,q,1,0,"p-message",21),t.qZA(),t.TgZ(37,"div",6),t.TgZ(38,"label",22),t._uU(39,"Email (*)"),t.qZA(),t.qZA(),t.TgZ(40,"div",8),t.TgZ(41,"input",23),t.NdJ("input",function(){return n.changeEmail()}),t.qZA(),t.YNc(42,J,1,0,"p-message",24),t.YNc(43,Q,1,0,"p-message",25),t.qZA(),t.TgZ(44,"div",26),t.TgZ(45,"label",22),t._uU(46,"Nombre de usuario (*)"),t.qZA(),t.qZA(),t.TgZ(47,"div",27),t._UZ(48,"input",28),t.YNc(49,F,1,0,"p-message",29),t.qZA(),t.TgZ(50,"div",3),t.TgZ(51,"div",2),t.TgZ(52,"div",30),t.TgZ(53,"div",31),t.TgZ(54,"label",32),t._uU(55,"Puntos de venta"),t.qZA(),t.TgZ(56,"p-pickList",33),t.NdJ("onMoveToSource",function(){return n.loadEstaciones()})("onMoveToTarget",function(){return n.loadEstaciones()})("onMoveAllToSource",function(){return n.loadEstaciones()})("onMoveAllToTarget",function(){return n.loadEstaciones()}),t.YNc(57,$,2,1,"ng-template",34),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(58,"div",6),t.TgZ(59,"label",35),t._uU(60,"Perfil (*)"),t.qZA(),t.qZA(),t.TgZ(61,"div",8),t._UZ(62,"p-dropdown",36),t.YNc(63,K,1,0,"p-message",37),t.qZA(),t.TgZ(64,"div",6),t.TgZ(65,"label",38),t._uU(66,"Estaci\xf3n de venta"),t.qZA(),t.qZA(),t.TgZ(67,"div",8),t.TgZ(68,"p-dropdown",39),t.YNc(69,W,1,2,"ng-template",40),t.qZA(),t.YNc(70,V,1,0,"p-message",41),t.qZA(),t.TgZ(71,"div",42),t._UZ(72,"button",43),t.YNc(73,k,1,0,"button",44),t._UZ(74,"button",45),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA()),2&o&&(t.xp6(1),t.Akn(t.DdM(36,z)),t.xp6(3),t.hij("",n.nameModulo," "),t.xp6(1),t.Q6J("ngIf",n.empresa&&n.modeRoot),t.xp6(3),t.Q6J("formGroup",n.modelForm),t.xp6(7),t.Q6J("ngIf",n.dni.touched&&(null==n.dni.errors?null:n.dni.errors.required)),t.xp6(1),t.Q6J("ngIf",null==n.dni.errors?null:n.dni.errors.minlength),t.xp6(1),t.Q6J("ngIf",null==n.dni.errors?null:n.dni.errors.maxlength),t.xp6(1),t.Q6J("ngIf",null==n.dni.errors?null:n.dni.errors.pattern),t.xp6(6),t.Q6J("ngIf",n.nombres.touched&&(null==n.nombres.errors?null:n.nombres.errors.required)),t.xp6(6),t.Q6J("ngIf",n.apellidos.touched&&(null==n.apellidos.errors?null:n.apellidos.errors.required)),t.xp6(6),t.Q6J("ngIf",n.cargo.touched&&(null==n.cargo.errors?null:n.cargo.errors.required)),t.xp6(6),t.Q6J("ngIf",n.email.touched&&(null==n.email.errors?null:n.email.errors.required)),t.xp6(1),t.Q6J("ngIf",n.email.touched&&(null==n.email.errors?null:n.email.errors.email)),t.xp6(1),t.Q6J("hidden",!n.modeRoot),t.xp6(3),t.Q6J("hidden",!n.modeRoot),t.xp6(2),t.Q6J("ngIf",n.username.touched&&(null==n.username.errors?null:n.username.errors.required)),t.xp6(7),t.Q6J("showSourceControls",!1)("showTargetControls",!1)("source",n.pvDisponibles)("target",n.pvSeleccionados)("responsive",!0),t.xp6(6),t.Akn(t.DdM(37,b)),t.Q6J("options",n.perfiles)("showClear",!0),t.xp6(1),t.Q6J("ngIf",n.perfil.touched&&(null==n.perfil.errors?null:n.perfil.errors.required)),t.xp6(5),t.Akn(t.DdM(38,b)),t.Q6J("options",n.estaciones)("showClear",!0),t.xp6(2),t.Q6J("ngIf",n.estacionVenta.touched&&(null==n.estacionVenta.errors?null:n.estacionVenta.errors.required)),t.xp6(2),t.Q6J("disabled",!n.modelForm.valid)("label",n.textButtonAction),t.xp6(1),t.Q6J("ngIf",n.isEdit),t.xp6(1),t.Q6J("routerLink",n.linkVolver))},directives:[x.Z,I.s,m.h4,C.O5,l._Y,l.JL,l.sg,l.Fj,l.JJ,l.u,D.o,M.q,y.G,m.jx,O.Lt,P.Hq,T.rH],encapsulation:2}),a})()},84165:(ee,U,s)=>{s.d(U,{g:()=>p});var l=s(82817),e=s(5e3),h=s(74202),t=s(33379),T=s(96310),g=s(20207),v=s(59783),_=s(47745),u=s(74297),m=s(28061),c=s(69808),Z=s(98952),A=s(40845),x=s(4119);function I(o,n){if(1&o&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&o){const i=e.oxw();e.xp6(1),e.hij("(",i.empresa.razonSocial,")")}}function C(o,n){if(1&o&&e._UZ(0,"p-sortIcon",12),2&o){const i=e.oxw().$implicit;e.Q6J("field",i.field)}}function D(o,n){if(1&o&&(e.TgZ(0,"th",10),e._uU(1),e.YNc(2,C,1,1,"p-sortIcon",11),e.qZA()),2&o){const i=n.$implicit;e.Q6J("pSortableColumn",i.field),e.xp6(1),e.hij(" ",i.header," "),e.xp6(1),e.Q6J("ngIf",!i.isActions)}}function M(o,n){if(1&o&&(e.TgZ(0,"tr"),e.YNc(1,D,3,3,"th",9),e.qZA()),2&o){const i=n.$implicit;e.xp6(1),e.Q6J("ngForOf",i)}}function y(o,n){if(1&o&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&o){const i=e.oxw(3).$implicit,r=e.oxw().$implicit;e.xp6(1),e.Oqu(r[i.field].nombre)}}function O(o,n){if(1&o&&(e.ynx(0),e.YNc(1,y,2,1,"span",1),e.BQk()),2&o){const i=e.oxw(2).$implicit,r=e.oxw().$implicit;e.xp6(1),e.Q6J("ngIf",r[i.field])}}function P(o,n){if(1&o&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&o){const i=e.oxw(4).$implicit;e.xp6(1),e.Oqu(i.nombres)}}function S(o,n){if(1&o&&(e.ynx(0),e.TgZ(1,"span",18),e._uU(2,"Nombre"),e.qZA(),e.YNc(3,P,2,1,"span",1),e.BQk()),2&o){const i=e.oxw(2).$implicit,r=e.oxw().$implicit;e.xp6(3),e.Q6J("ngIf",r[i.field])}}function L(o,n){if(1&o&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&o){const i=e.oxw(4).$implicit;e.xp6(1),e.Oqu(i.apellidos)}}function N(o,n){if(1&o&&(e.ynx(0),e.TgZ(1,"span",18),e._uU(2,"Apellidos"),e.qZA(),e.YNc(3,L,2,1,"span",1),e.BQk()),2&o){const i=e.oxw(2).$implicit,r=e.oxw().$implicit;e.xp6(3),e.Q6J("ngIf",r[i.field])}}function B(o,n){if(1&o&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&o){const i=e.oxw(4).$implicit;e.xp6(1),e.Oqu(i.dni)}}function R(o,n){if(1&o&&(e.ynx(0),e.TgZ(1,"span",18),e._uU(2,"DNI"),e.qZA(),e.YNc(3,B,2,1,"span",1),e.BQk()),2&o){const i=e.oxw(2).$implicit,r=e.oxw().$implicit;e.xp6(3),e.Q6J("ngIf",r[i.field])}}function Y(o,n){if(1&o&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&o){const i=e.oxw(4).$implicit;e.xp6(1),e.Oqu(i.email)}}function w(o,n){if(1&o&&(e.ynx(0),e.TgZ(1,"span",18),e._uU(2,"Email"),e.qZA(),e.YNc(3,Y,2,1,"span",1),e.BQk()),2&o){const i=e.oxw(2).$implicit,r=e.oxw().$implicit;e.xp6(3),e.Q6J("ngIf",r[i.field])}}function q(o,n){if(1&o&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&o){const i=e.oxw(4).$implicit;e.xp6(1),e.Oqu(i.username)}}function J(o,n){if(1&o&&(e.ynx(0),e.TgZ(1,"span",18),e._uU(2,"Nombre de usuario"),e.qZA(),e.YNc(3,q,2,1,"span",1),e.BQk()),2&o){const i=e.oxw(2).$implicit,r=e.oxw().$implicit;e.xp6(3),e.Q6J("ngIf",r[i.field])}}function Q(o,n){if(1&o&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&o){const i=e.oxw(4).$implicit;e.xp6(1),e.Oqu(i.cargo)}}function F(o,n){if(1&o&&(e.ynx(0),e.TgZ(1,"span",18),e._uU(2,"Cargo"),e.qZA(),e.YNc(3,Q,2,1,"span",1),e.BQk()),2&o){const i=e.oxw(2).$implicit,r=e.oxw().$implicit;e.xp6(3),e.Q6J("ngIf",r[i.field])}}function $(o,n){if(1&o&&(e.ynx(0),e._uU(1),e.BQk()),2&o){const i=e.oxw(2).$implicit,r=e.oxw().$implicit;e.xp6(1),e.hij(" ",r[i.field]," ")}}function K(o,n){1&o&&(e.ynx(0),e.YNc(1,O,2,1,"ng-container",16),e.YNc(2,S,4,1,"ng-container",16),e.YNc(3,N,4,1,"ng-container",16),e.YNc(4,R,4,1,"ng-container",16),e.YNc(5,w,4,1,"ng-container",16),e.YNc(6,J,4,1,"ng-container",16),e.YNc(7,F,4,1,"ng-container",16),e.YNc(8,$,2,1,"ng-container",17),e.BQk()),2&o&&(e.xp6(1),e.Q6J("ngSwitchCase","puntoVenta"),e.xp6(1),e.Q6J("ngSwitchCase","nombres"),e.xp6(1),e.Q6J("ngSwitchCase","apellidos"),e.xp6(1),e.Q6J("ngSwitchCase","dni"),e.xp6(1),e.Q6J("ngSwitchCase","email"),e.xp6(1),e.Q6J("ngSwitchCase","username"),e.xp6(1),e.Q6J("ngSwitchCase","cargo"))}function W(o,n){if(1&o){const i=e.EpF();e.TgZ(0,"button",22),e.NdJ("click",function(){e.CHM(i);const d=e.oxw(3).$implicit;return e.oxw().restorePassword(d)}),e.qZA()}}function V(o,n){if(1&o&&(e.ynx(0,19),e.TgZ(1,"span",18),e._uU(2,"Acciones"),e.qZA(),e.YNc(3,W,1,0,"button",20),e._UZ(4,"button",21),e.BQk()),2&o){const i=e.oxw(2).$implicit,r=e.oxw();e.xp6(3),e.Q6J("ngIf",!i.superUsuario),e.xp6(1),e.Q6J("routerLink",r.linkUpdate(i.id))}}function k(o,n){if(1&o&&(e.TgZ(0,"td",14),e.YNc(1,K,9,7,"ng-container",1),e.YNc(2,V,5,2,"ng-container",15),e.qZA()),2&o){const i=n.$implicit;e.Q6J("ngSwitch",i.field),e.xp6(1),e.Q6J("ngIf",!i.isActions),e.xp6(1),e.Q6J("ngIf",i.isActions)}}function z(o,n){if(1&o&&(e.TgZ(0,"tr"),e.YNc(1,k,3,3,"td",13),e.qZA()),2&o){const i=n.columns;e.xp6(1),e.Q6J("ngForOf",i)}}function b(o,n){1&o&&e._UZ(0,"button",26)}function j(o,n){if(1&o){const i=e.EpF();e.TgZ(0,"div",23),e.TgZ(1,"button",24),e.NdJ("click",function(){return e.CHM(i),e.oxw().newUser()}),e.qZA(),e.YNc(2,b,1,0,"button",25),e.qZA()}if(2&o){const i=e.oxw();e.xp6(2),e.Q6J("ngIf",i.modeRoot)}}const a=function(){return{"margin-bottom":"20px"}};let p=(()=>{class o{constructor(i,r,d,f,E,H,G,X){this.route=i,this.router=r,this.usuarioService=d,this.companyService=f,this.loginService=E,this.confirmationService=H,this.messageService=G,this.breadcrumbService=X,this.perPage=10}ngOnInit(){this.breadcrumbService.setItems((0,l.kn)(this.route)),this.cols=[{field:"nombres",header:"Nombres"},{field:"apellidos",header:"Apellidos"},{field:"dni",header:"DNI"},{field:"email",header:"Email"},{field:"username",header:"Nombre de usuario"},{field:"cargo",header:"Cargo"},{header:"Acciones",isActions:!0}],this.loading=!0,this.loadIdEmpresa().then(()=>{this.companyService.findById(this.idEmpresa).subscribe(i=>{this.empresa=i})})}newUser(){this.router.navigateByUrl(this.modeRoot?`/empresas/${this.idEmpresa}/usuarios/nuevo`:"/usuarios/nuevo")}restorePassword(i){this.confirmationService.confirm({message:`Estas seguro de restablecer la contrase\xf1a de ${i.nombres} ${i.apellidos}?`,accept:()=>{this.usuarioService.restorePassword(this.idEmpresa,i.id,this.modeRoot).subscribe(()=>{this.messageService.add({severity:"success",summary:"Mensaje",detail:"Contrase\xf1a restaurada correctamente."})})},acceptLabel:"Si",rejectLabel:"No"})}loadLazy(i){const r=this.idEmpresa;this.loading=!0;const f=["pageNumber="+i.first/this.perPage,`perPage=${i.rows}`];i.sortOrder&&f.push(`sortOrder=${i.sortOrder}`),i.sortField&&f.push(`sortField=${i.sortField}`),this.usuarioService.findAllPage(r,f.join("&"),this.modeRoot).subscribe(E=>{this.totalRecords=E.totalElements,this.users=E.content,this.loading=!1})}get modeRoot(){return this.route.snapshot.data.modeRoot}loadIdEmpresa(){return new Promise(i=>{this.modeRoot?this.route.params.subscribe(r=>{this.idEmpresa=r.idEmpresa,i(void 0)}):(this.idEmpresa=this.loginService.getUser().empresa.id,i(void 0))})}linkUpdate(i){return this.modeRoot?`/empresas/${this.idEmpresa}/usuarios/editar/${i}`:`/usuarios/editar/${i}`}}return o.\u0275fac=function(i){return new(i||o)(e.Y36(h.gz),e.Y36(h.F0),e.Y36(t.i),e.Y36(T.J),e.Y36(g.r),e.Y36(v.YP),e.Y36(v.ez),e.Y36(_.p))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-usuarios"]],decls:13,vars:12,consts:[[1,"p-panel-title"],[4,"ngIf"],[1,"grid"],[1,"col-12"],["dataKey","id",3,"columns","value","lazy","paginator","rows","totalRecords","responsive","autoLayout","onLazyLoad"],["dt",""],["pTemplate","header"],["pTemplate","body"],["pTemplate","summary"],[3,"pSortableColumn",4,"ngFor","ngForOf"],[3,"pSortableColumn"],["ariaLabel","Activa para ordenar","ariaLabelDesc","Activa para ordenar en orden descendente","ariaLabelAsc","Activa para ordenar en orden ascendente",3,"field",4,"ngIf"],["ariaLabel","Activa para ordenar","ariaLabelDesc","Activa para ordenar en orden descendente","ariaLabelAsc","Activa para ordenar en orden ascendente",3,"field"],[3,"ngSwitch",4,"ngFor","ngForOf"],[3,"ngSwitch"],["style","text-align: center",4,"ngIf"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"p-column-title"],[2,"text-align","center"],["style","margin-right: 0.2rem; margin-left: 0.2rem;","type","button","pButton","","icon","fa fa-unlock","pTooltip","Restaurar contrase\xf1a",3,"click",4,"ngIf"],["pButton","","type","button","icon","pi pi-pencil","pTooltip","Actualizar, Eliminar",1,"p-button-success",2,"margin-right","0.2rem","margin-left","0.2rem",3,"routerLink"],["type","button","pButton","","icon","fa fa-unlock","pTooltip","Restaurar contrase\xf1a",2,"margin-right","0.2rem","margin-left","0.2rem",3,"click"],[2,"text-align","left"],["type","button","pButton","","icon","fa fa-plus","label","Nuevo",2,"margin-right","0.2rem",3,"click"],["routerLink","/empresas","style","margin-right: 0.4rem","pButton","","type","button","label","Volver","class","p-button-secondary",4,"ngIf"],["routerLink","/empresas","pButton","","type","button","label","Volver",1,"p-button-secondary",2,"margin-right","0.4rem"]],template:function(i,r){1&i&&(e.TgZ(0,"p-card"),e.TgZ(1,"p-panel"),e.TgZ(2,"p-header"),e.TgZ(3,"span",0),e._uU(4,"Usuarios "),e.YNc(5,I,2,1,"span",1),e.qZA(),e.qZA(),e.TgZ(6,"div",2),e.TgZ(7,"div",3),e.TgZ(8,"p-table",4,5),e.NdJ("onLazyLoad",function(f){return r.loadLazy(f)}),e.YNc(10,M,2,1,"ng-template",6),e.YNc(11,z,2,1,"ng-template",7),e.YNc(12,j,3,1,"ng-template",8),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&i&&(e.xp6(1),e.Akn(e.DdM(11,a)),e.xp6(4),e.Q6J("ngIf",r.empresa&&r.modeRoot),e.xp6(3),e.Q6J("columns",r.cols)("value",r.users)("lazy",!0)("paginator",!0)("rows",r.perPage)("totalRecords",r.totalRecords)("responsive",!0)("autoLayout",!0))},directives:[u.Z,m.s,v.h4,c.O5,Z.iA,v.jx,c.sg,Z.lQ,Z.fz,c.RF,c.n9,c.ED,A.Hq,x.u,h.rH],encapsulation:2}),o})()},87969:(ee,U,s)=>{s.d(U,{H:()=>T});var l=s(92340),e=s(36644),h=s(5e3),t=s(40520);let T=(()=>{class g{constructor(_){this.http=_,this.baseUrl=l.N.endpointApi}findAllPage(_,u,m){const c=(0,e.S)(_,m);return this.http.get(`${c}/profiles?${u}`)}findAll(_,u){const m=(0,e.S)(_,u);return this.http.get(`${m}/profiles/all`)}findById(_,u,m){const c=(0,e.S)(_,m);return this.http.get(`${c}/profiles/${u}`)}save(_,u,m){const c=(0,e.S)(_,m);return this.http.post(`${c}/profiles`,u)}update(_,u,m){const c=(0,e.S)(_,m);return this.http.put(`${c}/profiles`,u)}deleteById(_,u,m){const c=(0,e.S)(_,m);return this.http.delete(`${c}/profiles/${u}`)}findAllModulesAccess(_){return this.http.get(`${this.baseUrl}/modules-access?${_}`)}}return g.\u0275fac=function(_){return new(_||g)(h.LFG(t.eN))},g.\u0275prov=h.Yz7({token:g,factory:g.\u0275fac,providedIn:"root"}),g})()}}]);