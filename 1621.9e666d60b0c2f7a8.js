"use strict";(self.webpackChunkmirage=self.webpackChunkmirage||[]).push([[1621],{61621:(L,d,o)=>{o.r(d),o.d(d,{MiPerfilModule:()=>Y});var m=o(74202),s=o(93075),g=o(82817),e=o(5e3),u=o(59783),c=o(20207),f=o(33379),v=o(85932),h=o(47745),Z=o(74297),b=o(31424),p=o(69808),T=o(43724),U=o(88205),M=o(40845);function F(i,l){1&i&&e._UZ(0,"p-message",23)}function I(i,l){1&i&&e._UZ(0,"p-message",24)}function x(i,l){1&i&&e._UZ(0,"p-message",25)}function A(i,l){if(1&i&&(e.TgZ(0,"li"),e._uU(1),e.qZA()),2&i){const r=l.$implicit;e.xp6(1),e.AsE("",r.name," - ",r.size," bytes ")}}function y(i,l){if(1&i&&(e.TgZ(0,"ul"),e.YNc(1,A,2,2,"li",27),e.qZA()),2&i){const r=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",r.uploadedFiles)}}function B(i,l){if(1&i&&e.YNc(0,y,2,1,"ul",26),2&i){const r=e.oxw();e.Q6J("ngIf",r.uploadedFiles.length)}}function C(i,l){1&i&&e._UZ(0,"p-message",28)}function P(i,l){if(1&i&&e._UZ(0,"img",29),2&i){const r=e.oxw();e.Q6J("src",r.avatarUrl.value,e.LSH)}}const S=[{path:"",component:(()=>{class i{constructor(r,t,a,n,q,Q,z){this.messageService=r,this.loginService=t,this.userService=a,this.fb=n,this.store=q,this.route=Q,this.breadcrumbService=z,this.uploadedFiles=[]}ngOnInit(){this.breadcrumbService.setItems((0,g.kn)(this.route)),this.loadModel(),this.builderFormBasic()}builderFormBasic(){this.modelFormBasic=this.fb.group({nombres:["",[s.kI.required]],apellidos:["",[s.kI.required]],dni:["",[s.kI.required]],avatarUrl:[""]})}submitFormBasic(){let r,t;this.formToModelBasic(),r=this.userService.saveMe(this.model),t="Perfil actualizado correctamente.",r.subscribe(a=>{this.messageService.add({severity:"success",summary:"Mensaje",detail:"Perfil actualizado correctamente."})})}formToModelBasic(){this.model||(this.model={}),this.model.nombres=this.modelFormBasic.value.nombres,this.model.apellidos=this.modelFormBasic.value.apellidos,this.model.dni=this.modelFormBasic.value.dni,this.model.avatarUrl=this.modelFormBasic.value.avatarUrl}modelToFormBasic(r){this.modelFormBasic.patchValue({nombres:r.nombres,apellidos:r.apellidos,dni:r.dni,avatarUrl:r.avatarUrl})}get nombres(){return this.modelFormBasic.get("nombres")}get apellidos(){return this.modelFormBasic.get("apellidos")}get dni(){return this.modelFormBasic.get("dni")}get avatarUrl(){return this.modelFormBasic.get("avatarUrl")}loadModel(){this.loginService.getUser(),this.userService.me().subscribe(t=>{this.model=t,this.modelToFormBasic(t)})}onFileUpload(r){const t=new FormData,a=r.files[0];t.append("file",a,a.name),this.userService.uploadImage(this.loginService.getUser().empresa.id,t).subscribe(n=>{this.modelFormBasic.patchValue({avatarUrl:n.url}),this.messageService.add({severity:"success",summary:"Archivo subido",detail:""})})}}return i.\u0275fac=function(r){return new(r||i)(e.Y36(u.ez),e.Y36(c.r),e.Y36(f.i),e.Y36(s.qu),e.Y36(v.yh),e.Y36(m.gz),e.Y36(h.p))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-mi-perfil"]],decls:35,vars:10,consts:[["novalidate","",3,"formGroup","ngSubmit"],[1,"grid","form-group"],[1,"col-12","md:col-2"],["for","nombres"],[1,"col-12","md:col-4"],["formControlName","nombres","id","nombres","type","text","pInputText","",2,"width","100%","margin-bottom","0.2em"],["severity","error","text","Ingrese nombres",4,"ngIf"],["for","apellidos"],["formControlName","apellidos","id","apellidos","type","text","pInputText","",2,"width","100%","margin-bottom","0.2em"],["severity","error","text","Ingrese apellidos",4,"ngIf"],["for","dni"],["formControlName","dni","id","dni","type","text","pInputText","",2,"width","100%","margin-bottom","0.2em"],["severity","error","text","Ingrese DNI",4,"ngIf"],[1,"col-4"],[1,"first"],["accept","image/*","chooseLabel","Selecciona una imagen","uploadLabel","Subir imagen","cancelLabel","Cancelar","name","file","maxFileSize","1000000",3,"customUpload","multiple","uploadHandler"],["pTemplate","content"],[2,"margin-top","0.5rem"],["onClick","this.select();","formControlName","avatarUrl","id","imagenUrl","type","text","pInputText","",2,"width","100%","margin-bottom","0.2em"],["severity","error","text","Ingrese url",4,"ngIf"],["style","width: 100%;",3,"src",4,"ngIf"],[2,"text-align","center","margin-top","1rem"],["pButton","","type","submit",2,"margin-right","0.4rem",3,"disabled","label"],["severity","error","text","Ingrese nombres"],["severity","error","text","Ingrese apellidos"],["severity","error","text","Ingrese DNI"],[4,"ngIf"],[4,"ngFor","ngForOf"],["severity","error","text","Ingrese url"],[2,"width","100%",3,"src"]],template:function(r,t){1&r&&(e.TgZ(0,"p-card"),e.TgZ(1,"form",0),e.NdJ("ngSubmit",function(){return t.submitFormBasic()}),e.TgZ(2,"div",1),e.TgZ(3,"div",2),e.TgZ(4,"label",3),e._uU(5,"Nombres (*)"),e.qZA(),e.qZA(),e.TgZ(6,"div",4),e._UZ(7,"input",5),e.YNc(8,F,1,0,"p-message",6),e.qZA(),e.TgZ(9,"div",2),e.TgZ(10,"label",7),e._uU(11,"Apellidos (*)"),e.qZA(),e.qZA(),e.TgZ(12,"div",4),e._UZ(13,"input",8),e.YNc(14,I,1,0,"p-message",9),e.qZA(),e.TgZ(15,"div",2),e.TgZ(16,"label",10),e._uU(17,"Dni"),e.qZA(),e.qZA(),e.TgZ(18,"div",4),e._UZ(19,"input",11),e.YNc(20,x,1,0,"p-message",12),e.qZA(),e.TgZ(21,"div",13),e.TgZ(22,"h3",14),e._uU(23,"Subir imagen"),e.qZA(),e.TgZ(24,"p-fileUpload",15),e.NdJ("uploadHandler",function(n){return t.onFileUpload(n)}),e.YNc(25,B,1,1,"ng-template",16),e.qZA(),e.TgZ(26,"div",17),e.TgZ(27,"label"),e._uU(28,"URL imagen"),e.qZA(),e._UZ(29,"input",18),e.YNc(30,C,1,0,"p-message",19),e.qZA(),e.qZA(),e.TgZ(31,"div",13),e.YNc(32,P,1,1,"img",20),e.qZA(),e.qZA(),e.TgZ(33,"div",21),e._UZ(34,"button",22),e.qZA(),e.qZA(),e.qZA()),2&r&&(e.xp6(1),e.Q6J("formGroup",t.modelFormBasic),e.xp6(7),e.Q6J("ngIf",t.nombres.touched&&(null==t.nombres.errors?null:t.nombres.errors.required)),e.xp6(6),e.Q6J("ngIf",t.apellidos.touched&&(null==t.apellidos.errors?null:t.apellidos.errors.required)),e.xp6(6),e.Q6J("ngIf",t.dni.touched&&(null==t.dni.errors?null:t.dni.errors.required)),e.xp6(4),e.Q6J("customUpload",!0)("multiple",!1),e.xp6(6),e.Q6J("ngIf",t.avatarUrl.touched&&(null==t.avatarUrl.errors?null:t.avatarUrl.errors.required)),e.xp6(2),e.Q6J("ngIf",t.avatarUrl.value),e.xp6(2),e.Q6J("disabled",!t.modelFormBasic.valid)("label","Actualizar datos"))},directives:[Z.Z,s._Y,s.JL,s.sg,s.Fj,s.JJ,s.u,b.o,p.O5,T.q,U.p,u.jx,p.sg,M.Hq],encapsulation:2}),i})(),data:{breadcrumb:[{label:"Mi perfil"}]}}];let J=(()=>{class i{}return i.\u0275fac=function(r){return new(r||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[m.Bz.forChild(S)],m.Bz]}),i})();var N=o(20958);let Y=(()=>{class i{}return i.\u0275fac=function(r){return new(r||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[J,N.m]]}),i})()}}]);